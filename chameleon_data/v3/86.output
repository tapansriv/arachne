-Dexec.args="single duck 86 1.48 0.0 0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
86 182.39667177200317
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
86 394.02138447761536
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.07498518123515686, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.07498518123515686, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

trial 0
id: 2, opp: 0.07498518123515686
id: 3, opp: 0.07498518123515686
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 3, opp: 0.07498518123515686
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
making cut ------------
cut id: 752, arachneId: 3
parent id: 751, arachneId: 2
made cut ------------
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

190
190
62.799937621
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

202
202
0.003548934
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.003303216
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 62.799937621 CARDINALITY: 190 COST: 0.025817752133077774
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.003548934 CARDINALITY: 202 COST: 1.4590062E-6
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.003303216 CARDINALITY: -1 COST: 1.3579888E-6
cut real save: 0.04916597009587908
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.049165970095879086, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.07498518123515686, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

estimated move size: 1.1158095238095238E-5GB
estimated BQ read size: 2.3432E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 62.803486555 seconds

estimated move cost: $0.0
estimated BQ read cost: $1.1716E-7
estimate billed runtime cost: $0.02581921113927778

estimated savings: $0.04916597009587908
min baseline cost: $0.07498529839515686
estimated hybrid cost: $0.02581932829927778
estimated cost for cut but no movement: $0.025820569128077776
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  01:06 min
[[1;34mINFO[m] Finished at: 2022-05-17T12:17:38Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
86 182.39667177200317
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
86 394.02138447761536
replaying trial 0
0, 3
id: 2, opp: 0.07498518123515686
id: 3, opp: 0.07498518123515686
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 3, opp: 0.07498518123515686
CHOSEN: 3
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.049165970095879086, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.07498518123515686, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

trial 1
id: 2, opp: 0.049165970095879086
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 6, opp: 0.07498510079515686
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

190
190
62.652373433
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

190
190
62.920695125
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.005895326
finished query
FINISHED PROFILING FOR TRIAL 1
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 62.652373433 CARDINALITY: 190 COST: 0.025757086855788886
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 62.920695125 CARDINALITY: 190 COST: 0.025867396884722223
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.005895326 CARDINALITY: -1 COST: 2.4236340222222224E-6
cut real save: 0.02336071585464574
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.0024585136446320308, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.02826378624586537, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

estimated move size: 9.409523809523809E-6GB
estimated BQ read size: 1.976E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 125.573068558 seconds

estimated move cost: $0.0
estimated BQ read cost: $9.880000000000001E-8
estimate billed runtime cost: $0.051624483740511116

estimated savings: $0.02336071585464574
min baseline cost: $0.07498529839515686
estimated hybrid cost: $0.05162458254051112
estimated cost for cut but no movement: $0.051626907374533335
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  02:08 min
[[1;34mINFO[m] Finished at: 2022-05-17T12:19:48Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
86 182.39667177200317
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
86 394.02138447761536
replaying trial 0
0, 3
id: 2, opp: 0.07498518123515686
id: 3, opp: 0.07498518123515686
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 3, opp: 0.07498518123515686
CHOSEN: 3
replaying trial 1
1, 6
id: 2, opp: 0.049165970095879086
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 6, opp: 0.07498510079515686
CHOSEN: 6
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.0024585136446320308, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.02826378624586537, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.07498510079515686, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

trial 2
id: 9, opp: 0.06831552367515686
-------
id: 9, opp: 0.06831552367515686
making cut ------------
cut id: 859, arachneId: 9
parent id: 853, arachneId: 8
made cut ------------
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

144769368
144769368
116.242222222
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

60.219408879
finished query
FINISHED PROFILING FOR TRIAL 2
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 116.242222222 CARDINALITY: 144769368 COST: 0.0477884691357111
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 60.219408879 CARDINALITY: -1 COST: 0.024756868094700003
cut real save: 0.020527054539445755
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.0024585136446320308, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.02826378624586537, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

estimated move size: 0.5875023542857143GB
estimated BQ read size: 1.333954944GB
estimated extra read size: 0.1758GB, estimated extra move size: 0.036GB
estimate billed runtime: 116.242222222 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.0066697747200000004
estimate billed runtime cost: $0.0477884691357111

estimated savings: $0.020527054539445755
min baseline cost: $0.07498529839515686
estimated hybrid cost: $0.0544582438557111
estimated cost for cut but no movement: $0.07254533723041111
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  03:00 min
[[1;34mINFO[m] Finished at: 2022-05-17T12:22:50Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
86 182.39667177200317
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
86 394.02138447761536
replaying trial 0
0, 3
id: 2, opp: 0.07498518123515686
id: 3, opp: 0.07498518123515686
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 3, opp: 0.07498518123515686
CHOSEN: 3
replaying trial 1
1, 6
id: 2, opp: 0.049165970095879086
id: 6, opp: 0.07498510079515686
id: 9, opp: 0.06831552367515686
-------
id: 6, opp: 0.07498510079515686
CHOSEN: 6
replaying trial 2
2, 9
id: 9, opp: 0.06831552367515686
-------
id: 9, opp: 0.06831552367515686
CHOSEN: 9
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.0024585136446320308, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.02826378624586537, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.4155331550798431, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.41553325889984305, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.4155330448798431, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.41553304146984305, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155331410998431, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.41553303907984307, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.41553303851984313, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.4155330460998431, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.027196631659445754, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -2.947729648431485E-4, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.006085547684843137, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.06831552367515686, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.06252474895515686, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.030867194620156843, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.41553303849984313, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.41549397192484316, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.41549398656484315, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.41549434890484316, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.41496603849984315, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.4164120384998431, arachneId = 18

trial 3
no more candidates to check
FOUND PLAN
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  3.020 s
[[1;34mINFO[m] Finished at: 2022-05-17T12:22:55Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
