-Dexec.args="single duck 40 1.48 0.0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
40 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
40 923.8805139064789
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
40 922.8996036052704
START: :
218:ProfileSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  237:ProfileAggregate(group=[{0, 1}], sales_before=[SUM($2)], sales_after=[SUM($3)]): rowcount = 121906, timing = null, opportunity = 0.30433857909999995
    255:ProfileProject(w_state=[$1], i_item_id=[$2], $f2=[CASE($5, $3, 0:DECIMAL(19, 0))], $f3=[CASE($6, $3, 0:DECIMAL(19, 0))]): rowcount = 1723576, timing = null, opportunity = 0.304130362
      273:ProfileJoin(condition=[=($0, $4)], joinType=[inner]): rowcount = 1723576, timing = null, opportunity = 0.30402694744
        286:ProfileProject(cs_sold_date_sk=[$0], w_state=[$2], i_item_id=[$5], -=[$3]): rowcount = 27565422, timing = null, opportunity = 0.300731840805
          299:ProfileJoin(condition=[=($4, $1)], joinType=[inner]): rowcount = 27565422, timing = null, opportunity = 0.29962922392499997
            307:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$2], w_state=[$5], -=[$3]): rowcount = 1432779728, timing = null, opportunity = 0.20314176470499995
              315:ProfileJoin(condition=[=($1, $4)], joinType=[inner]): rowcount = 1432779728, timing = null, opportunity = 0.14583057558499998
                320:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$1], cs_item_sk=[$2], -=[-($4, CASE(IS NOT NULL($7), $8, 0:DECIMAL(19, 0)))]): rowcount = 1439980416, timing = null, opportunity = 0.18823788588499996
                  325:ProfileJoin(condition=[AND(=($3, $6), =($2, $5))], joinType=[left]): rowcount = 1439980416, timing = null, opportunity = 0.044239844284999996
                    327:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$14], cs_item_sk=[$15], cs_order_number=[$17], cs_sales_price=[$21]): rowcount = 1439980416, timing = null, opportunity = 0.08168002932499996
                      328:ProfileTableScan(table=[[tpcds, catalog_sales]]): rowcount = 1439980416, timing = null, opportunity = -0.7535086119550001
                    330:ProfileProject(cr_item_sk=[$2], cr_order_number=[$16], cr_refunded_cash=[$23], CAST=[$23]): rowcount = 287993512, timing = null, opportunity = -0.698789844675
                      331:ProfileTableScan(table=[[tpcds, catalog_returns]]): rowcount = 287993512, timing = null, opportunity = -0.8312668601950002
                333:ProfileProject(w_warehouse_sk=[$0], w_state=[$10]): rowcount = 40, timing = null, opportunity = -0.753508586655
                  334:ProfileTableScan(table=[[tpcds, warehouse]]): rowcount = 40, timing = null, opportunity = -0.753508638455
            338:ProfileProject(i_item_sk=[$0], i_item_id=[$1]): rowcount = 122, timing = null, opportunity = -0.7526296241550001
              341:ProfileProject(i_item_sk=[$0], i_item_id=[$1], i_current_price=[$5]): rowcount = 122, timing = null, opportunity = -0.7526296265949999
                343:ProfileFilter(condition=[SEARCH($5, Sarg[[0.99:DECIMAL(3, 2)..1.49:DECIMAL(3, 2)]]:DECIMAL(3, 2))]): rowcount = 122, timing = null, opportunity = -0.752629969415
                  344:ProfileTableScan(table=[[tpcds, item]]): rowcount = 122, timing = null, opportunity = -0.752629969415
        348:ProfileProject(d_date_sk=[$0], <=[<($1, 2000-03-11)], >==[>=($1, 2000-03-11)]): rowcount = 37628, timing = null, opportunity = -0.7534717884200002
          351:ProfileProject(d_date_sk=[$0], d_date=[$2]): rowcount = 37628, timing = null, opportunity = -0.7534710358600001
            353:ProfileFilter(condition=[SEARCH($2, Sarg[[2000-02-10..2000-04-10]])]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002
              354:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002

trial 0
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_40_0 AS SELECT "t7"."w_state", "t7"."i_item_id", SUM(CASE WHEN "t10"."<" THEN "t7"."-" ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t10".">=" THEN "t7"."-" ELSE 0 END) AS "sales_after"
FROM (SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk") AS "t7"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t10" ON "t7"."cs_sold_date_sk" = "t10"."d_date_sk"
GROUP BY "t7"."w_state", "t7"."i_item_id"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT *
FROM "duck_table_40_0"
ORDER BY "w_state", "i_item_id"
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_40_0 AS SELECT "t7"."w_state", "t7"."i_item_id", SUM(CASE WHEN "t10"."<" THEN "t7"."-" ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t10".">=" THEN "t7"."-" ELSE 0 END) AS "sales_after"
FROM (SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk") AS "t7"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t10" ON "t7"."cs_sold_date_sk" = "t10"."d_date_sk"
GROUP BY "t7"."w_state", "t7"."i_item_id"

121906
121906
922.963529606
finished query
STARTING QRY: SELECT *
FROM "duck_table_40_0"
ORDER BY "w_state", "i_item_id"
FETCH NEXT 100 ROWS ONLY

0.034232499
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 922.963529606 CARDINALITY: 121906 COST: 0.3794405621713556
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.034232499 CARDINALITY: -1 COST: 1.40733607E-5
cut real save: -1.1329650219063556
Post Trial ::
218:ProfileSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  237:ProfileAggregate(group=[{0, 1}], sales_before=[SUM($2)], sales_after=[SUM($3)]): rowcount = 121906, timing = null, opportunity = 0.30433857909999995
    255:ProfileProject(w_state=[$1], i_item_id=[$2], $f2=[CASE($5, $3, 0:DECIMAL(19, 0))], $f3=[CASE($6, $3, 0:DECIMAL(19, 0))]): rowcount = 1723576, timing = null, opportunity = 0.304130362
      273:ProfileJoin(condition=[=($0, $4)], joinType=[inner]): rowcount = 1723576, timing = null, opportunity = 0.30402694744
        286:ProfileProject(cs_sold_date_sk=[$0], w_state=[$2], i_item_id=[$5], -=[$3]): rowcount = 27565422, timing = null, opportunity = 0.300731840805
          299:ProfileJoin(condition=[=($4, $1)], joinType=[inner]): rowcount = 27565422, timing = null, opportunity = 0.29962922392499997
            307:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$2], w_state=[$5], -=[$3]): rowcount = 1432779728, timing = null, opportunity = 0.20314176470499995
              315:ProfileJoin(condition=[=($1, $4)], joinType=[inner]): rowcount = 1432779728, timing = null, opportunity = 0.14583057558499998
                320:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$1], cs_item_sk=[$2], -=[-($4, CASE(IS NOT NULL($7), $8, 0:DECIMAL(19, 0)))]): rowcount = 1439980416, timing = null, opportunity = 0.18823788588499996
                  325:ProfileJoin(condition=[AND(=($3, $6), =($2, $5))], joinType=[left]): rowcount = 1439980416, timing = null, opportunity = 0.044239844284999996
                    327:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$14], cs_item_sk=[$15], cs_order_number=[$17], cs_sales_price=[$21]): rowcount = 1439980416, timing = null, opportunity = 0.08168002932499996
                      328:ProfileTableScan(table=[[tpcds, catalog_sales]]): rowcount = 1439980416, timing = null, opportunity = -0.7535086119550001
                    330:ProfileProject(cr_item_sk=[$2], cr_order_number=[$16], cr_refunded_cash=[$23], CAST=[$23]): rowcount = 287993512, timing = null, opportunity = -0.698789844675
                      331:ProfileTableScan(table=[[tpcds, catalog_returns]]): rowcount = 287993512, timing = null, opportunity = -0.8312668601950002
                333:ProfileProject(w_warehouse_sk=[$0], w_state=[$10]): rowcount = 40, timing = null, opportunity = -0.753508586655
                  334:ProfileTableScan(table=[[tpcds, warehouse]]): rowcount = 40, timing = null, opportunity = -0.753508638455
            338:ProfileProject(i_item_sk=[$0], i_item_id=[$1]): rowcount = 122, timing = null, opportunity = -0.7526296241550001
              341:ProfileProject(i_item_sk=[$0], i_item_id=[$1], i_current_price=[$5]): rowcount = 122, timing = null, opportunity = -0.7526296265949999
                343:ProfileFilter(condition=[SEARCH($5, Sarg[[0.99:DECIMAL(3, 2)..1.49:DECIMAL(3, 2)]]:DECIMAL(3, 2))]): rowcount = 122, timing = null, opportunity = -0.752629969415
                  344:ProfileTableScan(table=[[tpcds, item]]): rowcount = 122, timing = null, opportunity = -0.752629969415
        348:ProfileProject(d_date_sk=[$0], <=[<($1, 2000-03-11)], >==[>=($1, 2000-03-11)]): rowcount = 37628, timing = null, opportunity = -0.7534717884200002
          351:ProfileProject(d_date_sk=[$0], d_date=[$2]): rowcount = 37628, timing = null, opportunity = -0.7534710358600001
            353:ProfileFilter(condition=[SEARCH($2, Sarg[[2000-02-10..2000-04-10]])]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002
              354:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002

trial 1
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_40_0 AS SELECT "t7"."w_state", "t7"."i_item_id", CASE WHEN "t10"."<" THEN "t7"."-" ELSE 0 END AS "$f2", CASE WHEN "t10".">=" THEN "t7"."-" ELSE 0 END AS "$f3"
FROM (SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk") AS "t7"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t10" ON "t7"."cs_sold_date_sk" = "t10"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "w_state", "i_item_id", SUM("$f2") AS "sales_before", SUM("$f3") AS "sales_after"
FROM "duck_table_40_0"
GROUP BY "w_state", "i_item_id"
ORDER BY "w_state", "i_item_id"
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_40_0 AS SELECT "t7"."w_state", "t7"."i_item_id", CASE WHEN "t10"."<" THEN "t7"."-" ELSE 0 END AS "$f2", CASE WHEN "t10".">=" THEN "t7"."-" ELSE 0 END AS "$f3"
FROM (SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk") AS "t7"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t10" ON "t7"."cs_sold_date_sk" = "t10"."d_date_sk"

1723576
1723576
374.74098451
finished query
STARTING QRY: SELECT "w_state", "i_item_id", SUM("$f2") AS "sales_before", SUM("$f3") AS "sales_after"
FROM "duck_table_40_0"
GROUP BY "w_state", "i_item_id"
ORDER BY "w_state", "i_item_id"
FETCH NEXT 100 ROWS ONLY

0.417630105
finished query
FINISHED PROFILING FOR TRIAL 1
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 374.74098451 CARDINALITY: 1723576 COST: 0.15406018252077777
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.417630105 CARDINALITY: -1 COST: 1.716923765E-4
cut real save: -0.9077928593557778
Post Trial ::
218:ProfileSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  237:ProfileAggregate(group=[{0, 1}], sales_before=[SUM($2)], sales_after=[SUM($3)]): rowcount = 121906, timing = null, opportunity = 0.15027839657922218
    255:ProfileProject(w_state=[$1], i_item_id=[$2], $f2=[CASE($5, $3, 0:DECIMAL(19, 0))], $f3=[CASE($6, $3, 0:DECIMAL(19, 0))]): rowcount = 1723576, timing = null, opportunity = 0.304130362
      273:ProfileJoin(condition=[=($0, $4)], joinType=[inner]): rowcount = 1723576, timing = null, opportunity = 0.30402694744
        286:ProfileProject(cs_sold_date_sk=[$0], w_state=[$2], i_item_id=[$5], -=[$3]): rowcount = 27565422, timing = null, opportunity = 0.300731840805
          299:ProfileJoin(condition=[=($4, $1)], joinType=[inner]): rowcount = 27565422, timing = null, opportunity = 0.29962922392499997
            307:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$2], w_state=[$5], -=[$3]): rowcount = 1432779728, timing = null, opportunity = 0.20314176470499995
              315:ProfileJoin(condition=[=($1, $4)], joinType=[inner]): rowcount = 1432779728, timing = null, opportunity = 0.14583057558499998
                320:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$1], cs_item_sk=[$2], -=[-($4, CASE(IS NOT NULL($7), $8, 0:DECIMAL(19, 0)))]): rowcount = 1439980416, timing = null, opportunity = 0.18823788588499996
                  325:ProfileJoin(condition=[AND(=($3, $6), =($2, $5))], joinType=[left]): rowcount = 1439980416, timing = null, opportunity = 0.044239844284999996
                    327:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$14], cs_item_sk=[$15], cs_order_number=[$17], cs_sales_price=[$21]): rowcount = 1439980416, timing = null, opportunity = 0.08168002932499996
                      328:ProfileTableScan(table=[[tpcds, catalog_sales]]): rowcount = 1439980416, timing = null, opportunity = -0.7535086119550001
                    330:ProfileProject(cr_item_sk=[$2], cr_order_number=[$16], cr_refunded_cash=[$23], CAST=[$23]): rowcount = 287993512, timing = null, opportunity = -0.698789844675
                      331:ProfileTableScan(table=[[tpcds, catalog_returns]]): rowcount = 287993512, timing = null, opportunity = -0.8312668601950002
                333:ProfileProject(w_warehouse_sk=[$0], w_state=[$10]): rowcount = 40, timing = null, opportunity = -0.753508586655
                  334:ProfileTableScan(table=[[tpcds, warehouse]]): rowcount = 40, timing = null, opportunity = -0.753508638455
            338:ProfileProject(i_item_sk=[$0], i_item_id=[$1]): rowcount = 122, timing = null, opportunity = -0.7526296241550001
              341:ProfileProject(i_item_sk=[$0], i_item_id=[$1], i_current_price=[$5]): rowcount = 122, timing = null, opportunity = -0.7526296265949999
                343:ProfileFilter(condition=[SEARCH($5, Sarg[[0.99:DECIMAL(3, 2)..1.49:DECIMAL(3, 2)]]:DECIMAL(3, 2))]): rowcount = 122, timing = null, opportunity = -0.752629969415
                  344:ProfileTableScan(table=[[tpcds, item]]): rowcount = 122, timing = null, opportunity = -0.752629969415
        348:ProfileProject(d_date_sk=[$0], <=[<($1, 2000-03-11)], >==[>=($1, 2000-03-11)]): rowcount = 37628, timing = null, opportunity = -0.7534717884200002
          351:ProfileProject(d_date_sk=[$0], d_date=[$2]): rowcount = 37628, timing = null, opportunity = -0.7534710358600001
            353:ProfileFilter(condition=[SEARCH($2, Sarg[[2000-02-10..2000-04-10]])]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002
              354:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002

trial 2
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_40_0 AS SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id", SUM(CASE WHEN "t1"."<" THEN "duck_table_40_0"."-" ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t1".">=" THEN "duck_table_40_0"."-" ELSE 0 END) AS "sales_after"
FROM "duck_table_40_0"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t1" ON "duck_table_40_0"."cs_sold_date_sk" = "t1"."d_date_sk"
GROUP BY "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id"
ORDER BY "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id"
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_40_0 AS SELECT "t3"."cs_sold_date_sk", "t3"."w_state", "t6"."i_item_id", "t3"."-"
FROM (SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t6" ON "t3"."cs_item_sk" = "t6"."i_item_sk"

89560822
89560822
517.825967002
finished query
STARTING QRY: SELECT "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id", SUM(CASE WHEN "t1"."<" THEN "duck_table_40_0"."-" ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t1".">=" THEN "duck_table_40_0"."-" ELSE 0 END) AS "sales_after"
FROM "duck_table_40_0"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t1" ON "duck_table_40_0"."cs_sold_date_sk" = "t1"."d_date_sk"
GROUP BY "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id"
ORDER BY "duck_table_40_0"."w_state", "duck_table_40_0"."i_item_id"
FETCH NEXT 100 ROWS ONLY

34.798940656
finished query
FINISHED PROFILING FOR TRIAL 2
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 517.825967002 CARDINALITY: 89560822 COST: 0.21288400865637777
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 34.798940656 CARDINALITY: -1 COST: 0.014306231158577777
cut real save: -0.9780355274713779
Post Trial ::
218:ProfileSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  237:ProfileAggregate(group=[{0, 1}], sales_before=[SUM($2)], sales_after=[SUM($3)]): rowcount = 121906, timing = null, opportunity = -0.06260561207715559
    255:ProfileProject(w_state=[$1], i_item_id=[$2], $f2=[CASE($5, $3, 0:DECIMAL(19, 0))], $f3=[CASE($6, $3, 0:DECIMAL(19, 0))]): rowcount = 1723576, timing = null, opportunity = 0.09124635334362222
      273:ProfileJoin(condition=[=($0, $4)], joinType=[inner]): rowcount = 1723576, timing = null, opportunity = 0.0911429387836222
        286:ProfileProject(cs_sold_date_sk=[$0], w_state=[$2], i_item_id=[$5], -=[$3]): rowcount = 27565422, timing = null, opportunity = 0.300731840805
          299:ProfileJoin(condition=[=($4, $1)], joinType=[inner]): rowcount = 27565422, timing = null, opportunity = 0.29962922392499997
            307:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$2], w_state=[$5], -=[$3]): rowcount = 1432779728, timing = null, opportunity = 0.20314176470499995
              315:ProfileJoin(condition=[=($1, $4)], joinType=[inner]): rowcount = 1432779728, timing = null, opportunity = 0.14583057558499998
                320:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$1], cs_item_sk=[$2], -=[-($4, CASE(IS NOT NULL($7), $8, 0:DECIMAL(19, 0)))]): rowcount = 1439980416, timing = null, opportunity = 0.18823788588499996
                  325:ProfileJoin(condition=[AND(=($3, $6), =($2, $5))], joinType=[left]): rowcount = 1439980416, timing = null, opportunity = 0.044239844284999996
                    327:ProfileProject(cs_sold_date_sk=[$0], cs_warehouse_sk=[$14], cs_item_sk=[$15], cs_order_number=[$17], cs_sales_price=[$21]): rowcount = 1439980416, timing = null, opportunity = 0.08168002932499996
                      328:ProfileTableScan(table=[[tpcds, catalog_sales]]): rowcount = 1439980416, timing = null, opportunity = -0.7535086119550001
                    330:ProfileProject(cr_item_sk=[$2], cr_order_number=[$16], cr_refunded_cash=[$23], CAST=[$23]): rowcount = 287993512, timing = null, opportunity = -0.698789844675
                      331:ProfileTableScan(table=[[tpcds, catalog_returns]]): rowcount = 287993512, timing = null, opportunity = -0.8312668601950002
                333:ProfileProject(w_warehouse_sk=[$0], w_state=[$10]): rowcount = 40, timing = null, opportunity = -0.753508586655
                  334:ProfileTableScan(table=[[tpcds, warehouse]]): rowcount = 40, timing = null, opportunity = -0.753508638455
            338:ProfileProject(i_item_sk=[$0], i_item_id=[$1]): rowcount = 122, timing = null, opportunity = -0.7526296241550001
              341:ProfileProject(i_item_sk=[$0], i_item_id=[$1], i_current_price=[$5]): rowcount = 122, timing = null, opportunity = -0.7526296265949999
                343:ProfileFilter(condition=[SEARCH($5, Sarg[[0.99:DECIMAL(3, 2)..1.49:DECIMAL(3, 2)]]:DECIMAL(3, 2))]): rowcount = 122, timing = null, opportunity = -0.752629969415
                  344:ProfileTableScan(table=[[tpcds, item]]): rowcount = 122, timing = null, opportunity = -0.752629969415
        348:ProfileProject(d_date_sk=[$0], <=[<($1, 2000-03-11)], >==[>=($1, 2000-03-11)]): rowcount = 37628, timing = null, opportunity = -0.7534717884200002
          351:ProfileProject(d_date_sk=[$0], d_date=[$2]): rowcount = 37628, timing = null, opportunity = -0.7534710358600001
            353:ProfileFilter(condition=[SEARCH($2, Sarg[[2000-02-10..2000-04-10]])]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002
              354:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 37628, timing = null, opportunity = -0.7534896617200002

trial 3
CTAS: duck_table_40_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_40_0 AS SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "t2"."w_state", "t2"."i_item_id", SUM(CASE WHEN "t5"."<" THEN "t2"."-" ELSE 0 END) AS "sales_before", SUM(CASE WHEN "t5".">=" THEN "t2"."-" ELSE 0 END) AS "sales_after"
FROM (SELECT "duck_table_40_0"."cs_sold_date_sk", "duck_table_40_0"."w_state", "t1"."i_item_id", "duck_table_40_0"."-"
FROM "duck_table_40_0"
INNER JOIN (SELECT "i_item_sk", "i_item_id"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item
WHERE "i_current_price" >= 0.99 AND "i_current_price" <= 1.49) AS "t1" ON "duck_table_40_0"."cs_item_sk" = "t1"."i_item_sk") AS "t2"
INNER JOIN (SELECT "d_date_sk", "d_date" < DATE '2000-03-11' AS "<", "d_date" >= DATE '2000-03-11' AS ">="
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_date" >= DATE '2000-02-10' AND "d_date" <= DATE '2000-04-10') AS "t5" ON "t2"."cs_sold_date_sk" = "t5"."d_date_sk"
GROUP BY "t2"."w_state", "t2"."i_item_id"
ORDER BY "t2"."w_state", "t2"."i_item_id"
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_40_0 AS SELECT "t1"."cs_sold_date_sk", "t1"."cs_item_sk", "t2"."w_state", "t1"."-"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_warehouse_sk", "t"."cs_item_sk", "t"."cs_sales_price" - CASE WHEN "t0"."cr_refunded_cash" IS NOT NULL THEN "t0"."CAST" ELSE 0 END AS "-"
FROM (SELECT "cs_sold_date_sk", "cs_warehouse_sk", "cs_item_sk", "cs_order_number", "cs_sales_price"
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales) AS "t"
LEFT JOIN (SELECT "cr_item_sk", "cr_order_number", "cr_refunded_cash", "cr_refunded_cash" AS "CAST"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns) AS "t0" ON "t"."cs_order_number" = "t0"."cr_order_number" AND "t"."cs_item_sk" = "t0"."cr_item_sk") AS "t1"
INNER JOIN (SELECT "w_warehouse_sk", "w_state"
FROM '/mnt/disks/tpcds/parquet/warehouse.parquet' AS warehouse) AS "t2" ON "t1"."cs_warehouse_sk" = "t2"."w_warehouse_sk"

