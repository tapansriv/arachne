-Dexec.args="single duck 11 1.48 0.0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
11 1.48 0.0 GCP
/home/cc/arachneDB/baseline/duck_chameleon_baseline.json
11 3236.113775730133
/home/cc/arachneDB/baseline/duck_c_chameleon_baseline.json
11 2929.7487201690674
START: :
615:ProfileSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], dir3=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  711:ProfileProject(customer_id=[$1], customer_first_name=[$2], customer_last_name=[$3], customer_preferred_cust_flag=[$4]): rowcount = 2304688, timing = null, opportunity = 1.1302434675200002
    807:ProfileJoin(condition=[AND(=($0, $8), >(CASE($6, /($9, $5), 0.0:DECIMAL(19, 4)), $7))], joinType=[inner]): rowcount = 2304688, timing = null, opportunity = 1.12996690496
      879:ProfileProject(customer_id=[$0], customer_id0=[$1], customer_first_name0=[$2], customer_last_name0=[$3], customer_preferred_cust_flag0=[$4], year_total1=[$5], >=[$6], CASE=[CASE($7, $8, 0.0:DECIMAL(19, 4))]): rowcount = 9405902, timing = null, opportunity = -0.6975109181949999
        950:ProfileProject(customer_id=[$0], customer_id0=[$1], customer_first_name0=[$2], customer_last_name0=[$3], customer_preferred_cust_flag0=[$4], year_total1=[$8], >=[$9], >7=[$5], /=[$6]): rowcount = 9405902, timing = null, opportunity = -0.6976990362349997
          1021:ProfileJoin(condition=[=($0, $7)], joinType=[inner]): rowcount = 9405902, timing = null, opportunity = -0.6978871542749996
            1068:ProfileProject(customer_id=[$0], customer_id0=[$3], customer_first_name0=[$4], customer_last_name0=[$5], customer_preferred_cust_flag0=[$6], >=[$2], /=[/($7, $1)]): rowcount = 9578832, timing = null, opportunity = -0.6973470103549997
              1115:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 9578832, timing = null, opportunity = -0.6975385869949997
                1138:ProfileProject(customer_id=[$0], year_total=[$2], >=[>($2, 0)]): rowcount = 11784563, timing = null, opportunity = -0.6967130476549996
                  1160:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 11784563, timing = null, opportunity = -0.6969487389149998
                    1181:ProfileFilter(condition=[AND(=($9, 's'), =($7, 2001), >($8, 0))]): rowcount = 11784563, timing = null, opportunity = -0.6983628864749998
                      1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                        1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                          1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                            1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                              1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                                1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                                  1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                    1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                      1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                        1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                          1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                            1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                              1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                                1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                                  1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                    1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                      1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                1326:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], *=[*($5, 1.0000:DECIMAL(5, 4))]): rowcount = 23579122, timing = null, opportunity = -0.6983638860749997
                  1348:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 23579122, timing = null, opportunity = -0.6993070509549997
                    1368:ProfileFilter(condition=[AND(=($9, 's'), =($7, +(2001, 1)))]): rowcount = 23579122, timing = null, opportunity = -0.7007217982749996
                      1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                        1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                          1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                            1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                              1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                                1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                                  1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                    1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                      1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                        1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                          1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                            1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                              1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                                1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                                  1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                    1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                      1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
            1391:ProfileProject(customer_id=[$0], year_total=[$2], >=[>($2, 0)]): rowcount = 15152454, timing = null, opportunity = -0.6969151211149995
              1413:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 15152454, timing = null, opportunity = -0.6972181701949995
                1433:ProfileFilter(condition=[AND(=($9, 'w'), =($7, 2001), >($8, 0))]): rowcount = 15152454, timing = null, opportunity = -0.6990364646749996
                  1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                    1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                      1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                        1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                          1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                            1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                              1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                  1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                  1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                            1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                              1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                    1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                      1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                        1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                          1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                            1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                              1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                  1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                  1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                            1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                              1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
      1456:ProfileProject(customer_id=[$0], *=[*($2, 1.0000:DECIMAL(5, 4))]): rowcount = 15200068, timing = null, opportunity = -0.6966139765949995
        1478:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 15200068, timing = null, opportunity = -0.6972219793149994
          1498:ProfileFilter(condition=[AND(=($9, 'w'), =($7, +(2001, 1)))]): rowcount = 15200068, timing = null, opportunity = -0.6990459874749997
            1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
              1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                  1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                    1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                      1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                        1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                          1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                            1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                          1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                            1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                      1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                        1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
              1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                  1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                    1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                      1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                        1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                          1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                            1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                          1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                            1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                      1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                        1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999

trial 0
CTAS: duck_table_11_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_11_0 AS SELECT "t1"."c_customer_id" AS "customer_id", "t1"."c_first_name" AS "customer_first_name", "t1"."c_last_name" AS "customer_last_name", "t1"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t1"."c_birth_country" AS "customer_birth_country", "t1"."c_login" AS "customer_login", "t1"."c_email_address" AS "customer_email_address", "t2"."d_year" AS "dyear", SUM("t1"."-") AS "year_total", 's' AS "sale_type"
FROM (SELECT "t"."c_customer_id", "t"."c_first_name", "t"."c_last_name", "t"."c_preferred_cust_flag", "t"."c_birth_country", "t"."c_login", "t"."c_email_address", "t0"."ss_sold_date_sk", "t0"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t"
INNER JOIN (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price" - "ss_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales) AS "t0" ON "t"."c_customer_sk" = "t0"."ss_customer_sk") AS "t1"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t2" ON "t1"."ss_sold_date_sk" = "t2"."d_date_sk"
GROUP BY "t1"."c_customer_id", "t1"."c_first_name", "t1"."c_last_name", "t1"."c_preferred_cust_flag", "t1"."c_birth_country", "t1"."c_login", "t1"."c_email_address", "t2"."d_year"
UNION ALL
SELECT "t8"."c_customer_id" AS "customer_id", "t8"."c_first_name" AS "customer_first_name", "t8"."c_last_name" AS "customer_last_name", "t8"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t8"."c_birth_country" AS "customer_birth_country", "t8"."c_login" AS "customer_login", "t8"."c_email_address" AS "customer_email_address", "t9"."d_year" AS "dyear", SUM("t8"."-") AS "year_total", 'w' AS "sale_type"
FROM (SELECT "t6"."c_customer_id", "t6"."c_first_name", "t6"."c_last_name", "t6"."c_preferred_cust_flag", "t6"."c_birth_country", "t6"."c_login", "t6"."c_email_address", "t7"."ws_sold_date_sk", "t7"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t6"
INNER JOIN (SELECT "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_list_price" - "ws_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t7" ON "t6"."c_customer_sk" = "t7"."ws_bill_customer_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk"
GROUP BY "t8"."c_customer_id", "t8"."c_first_name", "t8"."c_last_name", "t8"."c_preferred_cust_flag", "t8"."c_birth_country", "t8"."c_login", "t8"."c_email_address", "t9"."d_year"

CTAS: duck_table_11_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_11_1 AS SELECT "t10"."customer_id0" AS "customer_id", "t10"."customer_first_name0" AS "customer_first_name", "t10"."customer_last_name0" AS "customer_last_name", "t10"."customer_preferred_cust_flag0" AS "customer_preferred_cust_flag"
FROM (SELECT "t5"."customer_id", "t5"."customer_id0", "t5"."customer_first_name0", "t5"."customer_last_name0", "t5"."customer_preferred_cust_flag0", "t8"."year_total" AS "year_total1", "t8".">", CASE WHEN "t5".">" THEN "t5"."/" ELSE 0.0 END AS "CASE"
FROM (SELECT "t1"."customer_id", "t4"."customer_id" AS "customer_id0", "t4"."customer_first_name" AS "customer_first_name0", "t4"."customer_last_name" AS "customer_last_name0", "t4"."customer_preferred_cust_flag" AS "customer_preferred_cust_flag0", "t1".">", "t4"."*" / "t1"."year_total" AS "/"
FROM (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_0"
WHERE "sale_type" = 's' AND "dyear" = 2001 AND "year_total" > 0) AS "t1"
INNER JOIN (SELECT "customer_id", "customer_first_name", "customer_last_name", "customer_preferred_cust_flag", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_0"
WHERE "sale_type" = 's' AND "dyear" = 2001 + 1) AS "t4" ON "t1"."customer_id" = "t4"."customer_id") AS "t5"
INNER JOIN (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_0"
WHERE "sale_type" = 'w' AND "dyear" = 2001 AND "year_total" > 0) AS "t8" ON "t5"."customer_id" = "t8"."customer_id") AS "t10"
INNER JOIN (SELECT "customer_id", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_0"
WHERE "sale_type" = 'w' AND "dyear" = 2001 + 1) AS "t13" ON "t10"."customer_id" = "t13"."customer_id" AND CASE WHEN "t10".">" THEN "t13"."*" / "t10"."year_total1" ELSE 0.0 END > "t10"."CASE"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT *
FROM "duck_table_11_1"
ORDER BY "customer_id" NULLS FIRST, "customer_first_name" NULLS FIRST, "customer_last_name" NULLS FIRST, "customer_preferred_cust_flag" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_11_0 AS SELECT "t1"."c_customer_id" AS "customer_id", "t1"."c_first_name" AS "customer_first_name", "t1"."c_last_name" AS "customer_last_name", "t1"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t1"."c_birth_country" AS "customer_birth_country", "t1"."c_login" AS "customer_login", "t1"."c_email_address" AS "customer_email_address", "t2"."d_year" AS "dyear", SUM("t1"."-") AS "year_total", 's' AS "sale_type"
FROM (SELECT "t"."c_customer_id", "t"."c_first_name", "t"."c_last_name", "t"."c_preferred_cust_flag", "t"."c_birth_country", "t"."c_login", "t"."c_email_address", "t0"."ss_sold_date_sk", "t0"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t"
INNER JOIN (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price" - "ss_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales) AS "t0" ON "t"."c_customer_sk" = "t0"."ss_customer_sk") AS "t1"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t2" ON "t1"."ss_sold_date_sk" = "t2"."d_date_sk"
GROUP BY "t1"."c_customer_id", "t1"."c_first_name", "t1"."c_last_name", "t1"."c_preferred_cust_flag", "t1"."c_birth_country", "t1"."c_login", "t1"."c_email_address", "t2"."d_year"
UNION ALL
SELECT "t8"."c_customer_id" AS "customer_id", "t8"."c_first_name" AS "customer_first_name", "t8"."c_last_name" AS "customer_last_name", "t8"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t8"."c_birth_country" AS "customer_birth_country", "t8"."c_login" AS "customer_login", "t8"."c_email_address" AS "customer_email_address", "t9"."d_year" AS "dyear", SUM("t8"."-") AS "year_total", 'w' AS "sale_type"
FROM (SELECT "t6"."c_customer_id", "t6"."c_first_name", "t6"."c_last_name", "t6"."c_preferred_cust_flag", "t6"."c_birth_country", "t6"."c_login", "t6"."c_email_address", "t7"."ws_sold_date_sk", "t7"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t6"
INNER JOIN (SELECT "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_list_price" - "ws_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t7" ON "t6"."c_customer_sk" = "t7"."ws_bill_customer_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk"
GROUP BY "t8"."c_customer_id", "t8"."c_first_name", "t8"."c_last_name", "t8"."c_preferred_cust_flag", "t8"."c_birth_country", "t8"."c_login", "t8"."c_email_address", "t9"."d_year"

97526579
97526579
3062.460677614
finished query
STARTING QRY: CREATE TABLE duck_table_11_1 AS SELECT "t10"."customer_id0" AS "customer_id", "t10"."customer_first_name0" AS "customer_first_name", "t10"."customer_last_name0" AS "customer_last_name", "t10"."customer_preferred_cust_flag0" AS "customer_preferred_cust_flag"
FROM (SELECT "t5"."customer_id", "t5"."customer_id0", "t5"."customer_first_name0", "t5"."customer_last_name0", "t5"."customer_preferred_cust_flag0", "t8"."year_total" AS "year_total1", "t8".">", CASE WHEN "t5".">" THEN "t5"."/" ELSE 0.0 END AS "CASE"
FROM (SELECT "t1"."customer_id", "t4"."customer_id" AS "customer_id0", "t4"."customer_first_name" AS "customer_first_name0", "t4"."customer_last_name" AS "customer_last_name0", "t4"."customer_preferred_cust_flag" AS "customer_preferred_cust_flag0", "t1".">", "t4"."*" / "t1"."year_total" AS "/"
FROM (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_0"
WHERE "sale_type" = 's' AND "dyear" = 2001 AND "year_total" > 0) AS "t1"
INNER JOIN (SELECT "customer_id", "customer_first_name", "customer_last_name", "customer_preferred_cust_flag", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_0"
WHERE "sale_type" = 's' AND "dyear" = 2001 + 1) AS "t4" ON "t1"."customer_id" = "t4"."customer_id") AS "t5"
INNER JOIN (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_0"
WHERE "sale_type" = 'w' AND "dyear" = 2001 AND "year_total" > 0) AS "t8" ON "t5"."customer_id" = "t8"."customer_id") AS "t10"
INNER JOIN (SELECT "customer_id", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_0"
WHERE "sale_type" = 'w' AND "dyear" = 2001 + 1) AS "t13" ON "t10"."customer_id" = "t13"."customer_id" AND CASE WHEN "t10".">" THEN "t13"."*" / "t10"."year_total1" ELSE 0.0 END > "t10"."CASE"

2304688
2304688
51.216226614
finished query
STARTING QRY: SELECT *
FROM "duck_table_11_1"
ORDER BY "customer_id" NULLS FIRST, "customer_first_name" NULLS FIRST, "customer_last_name" NULLS FIRST, "customer_preferred_cust_flag" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.781717629
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_11_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 3062.460677614 CARDINALITY: 97526579 COST: 1.2590116119079777
CTAS: duck_table_11_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 51.216226614 CARDINALITY: 2304688 COST: 0.021055559830199997
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.781717629 CARDINALITY: -1 COST: 3.213728030333333E-4
cut real save: -1.9762575206531774
Post Trial ::
615:ProfileSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], dir3=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0
  711:ProfileProject(customer_id=[$1], customer_first_name=[$2], customer_last_name=[$3], customer_preferred_cust_flag=[$4]): rowcount = 2304688, timing = null, opportunity = 1.1302434675200002
    807:ProfileJoin(condition=[AND(=($0, $8), >(CASE($6, /($9, $5), 0.0:DECIMAL(19, 4)), $7))], joinType=[inner]): rowcount = 2304688, timing = null, opportunity = 1.12996690496
      879:ProfileProject(customer_id=[$0], customer_id0=[$1], customer_first_name0=[$2], customer_last_name0=[$3], customer_preferred_cust_flag0=[$4], year_total1=[$5], >=[$6], CASE=[CASE($7, $8, 0.0:DECIMAL(19, 4))]): rowcount = 9405902, timing = null, opportunity = -0.6975109181949999
        950:ProfileProject(customer_id=[$0], customer_id0=[$1], customer_first_name0=[$2], customer_last_name0=[$3], customer_preferred_cust_flag0=[$4], year_total1=[$8], >=[$9], >7=[$5], /=[$6]): rowcount = 9405902, timing = null, opportunity = -0.6976990362349997
          1021:ProfileJoin(condition=[=($0, $7)], joinType=[inner]): rowcount = 9405902, timing = null, opportunity = -0.6978871542749996
            1068:ProfileProject(customer_id=[$0], customer_id0=[$3], customer_first_name0=[$4], customer_last_name0=[$5], customer_preferred_cust_flag0=[$6], >=[$2], /=[/($7, $1)]): rowcount = 9578832, timing = null, opportunity = -0.6973470103549997
              1115:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 9578832, timing = null, opportunity = -0.6975385869949997
                1138:ProfileProject(customer_id=[$0], year_total=[$2], >=[>($2, 0)]): rowcount = 11784563, timing = null, opportunity = -0.6967130476549996
                  1160:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 11784563, timing = null, opportunity = -0.6969487389149998
                    1181:ProfileFilter(condition=[AND(=($9, 's'), =($7, 2001), >($8, 0))]): rowcount = 11784563, timing = null, opportunity = -0.6983628864749998
                      1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                        1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                          1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                            1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                              1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                                1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                                  1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                    1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                      1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                        1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                          1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                            1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                              1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                                1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                                  1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                    1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                      1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                1326:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], *=[*($5, 1.0000:DECIMAL(5, 4))]): rowcount = 23579122, timing = null, opportunity = -0.6983638860749997
                  1348:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 23579122, timing = null, opportunity = -0.6993070509549997
                    1368:ProfileFilter(condition=[AND(=($9, 's'), =($7, +(2001, 1)))]): rowcount = 23579122, timing = null, opportunity = -0.7007217982749996
                      1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                        1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                          1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                            1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                              1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                                1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                                  1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                    1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                      1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                        1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                          1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                            1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                              1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                                1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                                  1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                    1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                      1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                    1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                      1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                                1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                                  1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
            1391:ProfileProject(customer_id=[$0], year_total=[$2], >=[>($2, 0)]): rowcount = 15152454, timing = null, opportunity = -0.6969151211149995
              1413:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 15152454, timing = null, opportunity = -0.6972181701949995
                1433:ProfileFilter(condition=[AND(=($9, 'w'), =($7, 2001), >($8, 0))]): rowcount = 15152454, timing = null, opportunity = -0.6990364646749996
                  1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
                    1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                      1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                        1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                          1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                            1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                              1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                                1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                  1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                                  1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                            1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                              1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
                    1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                      1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                        1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                          1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                            1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                              1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                                1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                                  1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                                1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                                  1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                            1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                              1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
      1456:ProfileProject(customer_id=[$0], *=[*($2, 1.0000:DECIMAL(5, 4))]): rowcount = 15200068, timing = null, opportunity = -0.6966139765949995
        1478:ProfileProject(customer_id=[$0], dyear=[$7], year_total=[$8], sale_type=[$9]): rowcount = 15200068, timing = null, opportunity = -0.6972219793149994
          1498:ProfileFilter(condition=[AND(=($9, 'w'), =($7, +(2001, 1)))]): rowcount = 15200068, timing = null, opportunity = -0.6990459874749997
            1182:ProfileUnion(all=[true]): rowcount = 97526579, timing = null, opportunity = 1.0524065793600001
              1212:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['s']): rowcount = 59449908, timing = null, opportunity = 0.5812285792650002
                1221:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 59449908, timing = null, opportunity = 0.5859845719050001
                  1229:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 2685588011, timing = null, opportunity = -1.304834862255
                    1237:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 2685588011, timing = null, opportunity = -8.287363690855
                      1242:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ss_sold_date_sk=[$8], -=[$10]): rowcount = 2750387156, timing = null, opportunity = -8.062434907295
                        1247:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 2750387156, timing = null, opportunity = -8.502496852255002
                          1249:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                            1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                          1252:ProfileProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3], -=[-($17, $14)]): rowcount = 146098, timing = null, opportunity = 0.6287534421450002
                            1253:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 146098, timing = null, opportunity = 0.628519685345
                      1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                        1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999
              1266:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=['w']): rowcount = 38076671, timing = null, opportunity = -0.23686705499500005
                1275:ProfileAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], year_total=[SUM($8)]): rowcount = 38076671, timing = null, opportunity = -0.23382092131499999
                  1283:ProfileProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$10], $f8=[$8]): rowcount = 719730582, timing = null, opportunity = -0.7246117372349996
                    1290:ProfileJoin(condition=[=($7, $9)], joinType=[inner]): rowcount = 719730582, timing = null, opportunity = -2.595911250435
                      1295:ProfileProject(c_customer_id=[$1], c_first_name=[$2], c_last_name=[$3], c_preferred_cust_flag=[$4], c_birth_country=[$5], c_login=[$6], c_email_address=[$7], ws_sold_date_sk=[$8], -=[$10]): rowcount = 719820455, timing = null, opportunity = -2.481038355995
                        1299:ProfileJoin(condition=[=($0, $9)], joinType=[inner]): rowcount = 719820455, timing = null, opportunity = -2.596209628795
                          1300:ProfileProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16]): rowcount = 720000376, timing = null, opportunity = -2.913607131954999
                            1250:ProfileTableScan(table=[[tpcds, customer]]): rowcount = 720000376, timing = null, opportunity = -6.444008981875001
                          1302:ProfileProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4], -=[-($25, $22)]): rowcount = 146098, timing = null, opportunity = -0.20644078171500024
                            1303:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 146098, timing = null, opportunity = -0.2068031047550003
                      1255:ProfileProject(d_date_sk=[$0], d_year=[$6]): rowcount = 24000000, timing = null, opportunity = -0.7036468926599999
                        1256:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 24000000, timing = null, opportunity = -0.798686892659999

trial 1
CTAS: duck_table_11_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_11_0 AS SELECT "t1"."c_customer_id" AS "customer_id", "t1"."c_first_name" AS "customer_first_name", "t1"."c_last_name" AS "customer_last_name", "t1"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t1"."c_birth_country" AS "customer_birth_country", "t1"."c_login" AS "customer_login", "t1"."c_email_address" AS "customer_email_address", "t2"."d_year" AS "dyear", SUM("t1"."-") AS "year_total", 's' AS "sale_type"
FROM (SELECT "t"."c_customer_id", "t"."c_first_name", "t"."c_last_name", "t"."c_preferred_cust_flag", "t"."c_birth_country", "t"."c_login", "t"."c_email_address", "t0"."ss_sold_date_sk", "t0"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t"
INNER JOIN (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price" - "ss_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales) AS "t0" ON "t"."c_customer_sk" = "t0"."ss_customer_sk") AS "t1"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t2" ON "t1"."ss_sold_date_sk" = "t2"."d_date_sk"
GROUP BY "t1"."c_customer_id", "t1"."c_first_name", "t1"."c_last_name", "t1"."c_preferred_cust_flag", "t1"."c_birth_country", "t1"."c_login", "t1"."c_email_address", "t2"."d_year"
UNION ALL
SELECT "t8"."c_customer_id" AS "customer_id", "t8"."c_first_name" AS "customer_first_name", "t8"."c_last_name" AS "customer_last_name", "t8"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t8"."c_birth_country" AS "customer_birth_country", "t8"."c_login" AS "customer_login", "t8"."c_email_address" AS "customer_email_address", "t9"."d_year" AS "dyear", SUM("t8"."-") AS "year_total", 'w' AS "sale_type"
FROM (SELECT "t6"."c_customer_id", "t6"."c_first_name", "t6"."c_last_name", "t6"."c_preferred_cust_flag", "t6"."c_birth_country", "t6"."c_login", "t6"."c_email_address", "t7"."ws_sold_date_sk", "t7"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t6"
INNER JOIN (SELECT "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_list_price" - "ws_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t7" ON "t6"."c_customer_sk" = "t7"."ws_bill_customer_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk"
GROUP BY "t8"."c_customer_id", "t8"."c_first_name", "t8"."c_last_name", "t8"."c_preferred_cust_flag", "t8"."c_birth_country", "t8"."c_login", "t8"."c_email_address", "t9"."d_year"

CTAS: duck_table_11_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_11_1 AS SELECT "t1"."c_customer_id" AS "customer_id", "t1"."c_first_name" AS "customer_first_name", "t1"."c_last_name" AS "customer_last_name", "t1"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t1"."c_birth_country" AS "customer_birth_country", "t1"."c_login" AS "customer_login", "t1"."c_email_address" AS "customer_email_address", "t2"."d_year" AS "dyear", SUM("t1"."-") AS "year_total", 's' AS "sale_type"
FROM (SELECT "t"."c_customer_id", "t"."c_first_name", "t"."c_last_name", "t"."c_preferred_cust_flag", "t"."c_birth_country", "t"."c_login", "t"."c_email_address", "t0"."ss_sold_date_sk", "t0"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t"
INNER JOIN (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price" - "ss_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales) AS "t0" ON "t"."c_customer_sk" = "t0"."ss_customer_sk") AS "t1"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t2" ON "t1"."ss_sold_date_sk" = "t2"."d_date_sk"
GROUP BY "t1"."c_customer_id", "t1"."c_first_name", "t1"."c_last_name", "t1"."c_preferred_cust_flag", "t1"."c_birth_country", "t1"."c_login", "t1"."c_email_address", "t2"."d_year"
UNION ALL
SELECT "t8"."c_customer_id" AS "customer_id", "t8"."c_first_name" AS "customer_first_name", "t8"."c_last_name" AS "customer_last_name", "t8"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t8"."c_birth_country" AS "customer_birth_country", "t8"."c_login" AS "customer_login", "t8"."c_email_address" AS "customer_email_address", "t9"."d_year" AS "dyear", SUM("t8"."-") AS "year_total", 'w' AS "sale_type"
FROM (SELECT "t6"."c_customer_id", "t6"."c_first_name", "t6"."c_last_name", "t6"."c_preferred_cust_flag", "t6"."c_birth_country", "t6"."c_login", "t6"."c_email_address", "t7"."ws_sold_date_sk", "t7"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t6"
INNER JOIN (SELECT "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_list_price" - "ws_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t7" ON "t6"."c_customer_sk" = "t7"."ws_bill_customer_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk"
GROUP BY "t8"."c_customer_id", "t8"."c_first_name", "t8"."c_last_name", "t8"."c_preferred_cust_flag", "t8"."c_birth_country", "t8"."c_login", "t8"."c_email_address", "t9"."d_year"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "t10"."customer_id0" AS "customer_id", "t10"."customer_first_name0" AS "customer_first_name", "t10"."customer_last_name0" AS "customer_last_name", "t10"."customer_preferred_cust_flag0" AS "customer_preferred_cust_flag"
FROM (SELECT "t5"."customer_id", "t5"."customer_id0", "t5"."customer_first_name0", "t5"."customer_last_name0", "t5"."customer_preferred_cust_flag0", "t8"."year_total" AS "year_total1", "t8".">", CASE WHEN "t5".">" THEN "t5"."/" ELSE 0.0 END AS "CASE"
FROM (SELECT "t1"."customer_id", "t4"."customer_id" AS "customer_id0", "t4"."customer_first_name" AS "customer_first_name0", "t4"."customer_last_name" AS "customer_last_name0", "t4"."customer_preferred_cust_flag" AS "customer_preferred_cust_flag0", "t1".">", "t4"."*" / "t1"."year_total" AS "/"
FROM (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_1"
WHERE "sale_type" = 's' AND "dyear" = 2001 AND "year_total" > 0) AS "t1"
INNER JOIN (SELECT "customer_id", "customer_first_name", "customer_last_name", "customer_preferred_cust_flag", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_1"
WHERE "sale_type" = 's' AND "dyear" = 2001 + 1) AS "t4" ON "t1"."customer_id" = "t4"."customer_id") AS "t5"
INNER JOIN (SELECT "customer_id", "year_total", "year_total" > 0 AS ">"
FROM "duck_table_11_1"
WHERE "sale_type" = 'w' AND "dyear" = 2001 AND "year_total" > 0) AS "t8" ON "t5"."customer_id" = "t8"."customer_id") AS "t10"
INNER JOIN (SELECT "customer_id", "year_total" * 1.0000 AS "*"
FROM "duck_table_11_1"
WHERE "sale_type" = 'w' AND "dyear" = 2001 + 1) AS "t13" ON "t10"."customer_id" = "t13"."customer_id" AND CASE WHEN "t10".">" THEN "t13"."*" / "t10"."year_total1" ELSE 0.0 END > "t10"."CASE"
ORDER BY "t10"."customer_id0" NULLS FIRST, "t10"."customer_first_name0" NULLS FIRST, "t10"."customer_last_name0" NULLS FIRST, "t10"."customer_preferred_cust_flag0" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_11_0 AS SELECT "t1"."c_customer_id" AS "customer_id", "t1"."c_first_name" AS "customer_first_name", "t1"."c_last_name" AS "customer_last_name", "t1"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t1"."c_birth_country" AS "customer_birth_country", "t1"."c_login" AS "customer_login", "t1"."c_email_address" AS "customer_email_address", "t2"."d_year" AS "dyear", SUM("t1"."-") AS "year_total", 's' AS "sale_type"
FROM (SELECT "t"."c_customer_id", "t"."c_first_name", "t"."c_last_name", "t"."c_preferred_cust_flag", "t"."c_birth_country", "t"."c_login", "t"."c_email_address", "t0"."ss_sold_date_sk", "t0"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t"
INNER JOIN (SELECT "ss_sold_date_sk", "ss_customer_sk", "ss_ext_list_price" - "ss_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales) AS "t0" ON "t"."c_customer_sk" = "t0"."ss_customer_sk") AS "t1"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t2" ON "t1"."ss_sold_date_sk" = "t2"."d_date_sk"
GROUP BY "t1"."c_customer_id", "t1"."c_first_name", "t1"."c_last_name", "t1"."c_preferred_cust_flag", "t1"."c_birth_country", "t1"."c_login", "t1"."c_email_address", "t2"."d_year"
UNION ALL
SELECT "t8"."c_customer_id" AS "customer_id", "t8"."c_first_name" AS "customer_first_name", "t8"."c_last_name" AS "customer_last_name", "t8"."c_preferred_cust_flag" AS "customer_preferred_cust_flag", "t8"."c_birth_country" AS "customer_birth_country", "t8"."c_login" AS "customer_login", "t8"."c_email_address" AS "customer_email_address", "t9"."d_year" AS "dyear", SUM("t8"."-") AS "year_total", 'w' AS "sale_type"
FROM (SELECT "t6"."c_customer_id", "t6"."c_first_name", "t6"."c_last_name", "t6"."c_preferred_cust_flag", "t6"."c_birth_country", "t6"."c_login", "t6"."c_email_address", "t7"."ws_sold_date_sk", "t7"."-"
FROM (SELECT "c_customer_sk", "c_customer_id", "c_first_name", "c_last_name", "c_preferred_cust_flag", "c_birth_country", "c_login", "c_email_address"
FROM '/mnt/disks/tpcds/parquet/customer.parquet' AS customer) AS "t6"
INNER JOIN (SELECT "ws_sold_date_sk", "ws_bill_customer_sk", "ws_ext_list_price" - "ws_ext_discount_amt" AS "-"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t7" ON "t6"."c_customer_sk" = "t7"."ws_bill_customer_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim) AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk"
GROUP BY "t8"."c_customer_id", "t8"."c_first_name", "t8"."c_last_name", "t8"."c_preferred_cust_flag", "t8"."c_birth_country", "t8"."c_login", "t8"."c_email_address", "t9"."d_year"

