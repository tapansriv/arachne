                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7895612.57..7895612.82 rows=100 width=51)
   ->  Sort  (cost=7895612.57..7895702.01 rows=35775 width=51)
         Sort Key: customer.c_last_name NULLS FIRST, customer.c_first_name NULLS FIRST, current_addr.ca_city NULLS FIRST, customer_address.ca_city NULLS FIRST, store_sales.ss_ticket_number NULLS FIRST
         ->  Nested Loop  (cost=7735586.80..7894245.28 rows=35775 width=51)
               Join Filter: ((current_addr.ca_city)::text <> (customer_address.ca_city)::text)
               ->  Nested Loop  (cost=7735586.37..7876377.35 rows=35833 width=46)
                     ->  Finalize GroupAggregate  (cost=7735585.95..7740249.34 rows=35833 width=37)
                           Group Key: store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city
                           ->  Gather Merge  (cost=7735585.95..7739443.11 rows=29860 width=37)
                                 Workers Planned: 2
                                 ->  Partial GroupAggregate  (cost=7734585.92..7734996.50 rows=14930 width=37)
                                       Group Key: store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city
                                       ->  Sort  (cost=7734585.92..7734623.25 rows=14930 width=37)
                                             Sort Key: store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city
                                             ->  Parallel Hash Join  (cost=7708681.45..7733550.83 rows=14930 width=37)
                                                   Hash Cond: (customer_address.ca_address_sk = store_sales.ss_addr_sk)
                                                   ->  Parallel Seq Scan on customer_address  (cost=0.00..23244.67 rows=416667 width=13)
                                                   ->  Parallel Hash  (cost=7708486.07..7708486.07 rows=15631 width=28)
                                                         ->  Hash Join  (cost=2363.78..7708486.07 rows=15631 width=28)
                                                               Hash Cond: (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)
                                                               ->  Hash Join  (cost=2183.28..7708133.35 rows=65567 width=32)
                                                                     Hash Cond: (store_sales.ss_store_sk = store.s_store_sk)
                                                                     ->  Parallel Hash Join  (cost=2161.54..7706826.89 rows=484546 width=36)
                                                                           Hash Cond: (store_sales.ss_sold_date_sk = date_dim.d_date_sk)
                                                                           ->  Parallel Seq Scan on store_sales  (cost=0.00..7389799.50 rows=119942250 width=40)
                                                                           ->  Parallel Hash  (cost=2159.26..2159.26 rows=182 width=4)
                                                                                 ->  Parallel Seq Scan on date_dim  (cost=0.00..2159.26 rows=182 width=4)
                                                                                       Filter: ((d_dow = ANY ('{6,0}'::integer[])) AND (d_year = ANY ('{1999,2000,2001}'::integer[])))
                                                                     ->  Hash  (cost=21.02..21.02 rows=57 width=4)
                                                                           ->  Seq Scan on store  (cost=0.00..21.02 rows=57 width=4)
                                                                                 Filter: ((s_city)::text = ANY ('{Fairview,Midway}'::text[]))
                                                               ->  Hash  (cost=158.00..158.00 rows=1800 width=4)
                                                                     ->  Seq Scan on household_demographics  (cost=0.00..158.00 rows=1800 width=4)
                                                                           Filter: ((hd_dep_count = 4) OR (hd_vehicle_count = 3))
                     ->  Index Scan using customer_pkey on customer  (cost=0.43..3.79 rows=1 width=21)
                           Index Cond: (c_customer_sk = store_sales.ss_customer_sk)
               ->  Index Scan using customer_address_pkey on customer_address current_addr  (cost=0.42..0.49 rows=1 width=13)
                     Index Cond: (ca_address_sk = customer.c_current_addr_sk)
 JIT:
   Functions: 58
   Options: Inlining true, Optimization true, Expressions true, Deforming true
(41 rows)

