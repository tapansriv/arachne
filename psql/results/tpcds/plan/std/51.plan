                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=14274716.54..14274716.79 rows=100 width=40)
   ->  Sort  (cost=14274716.54..14289197.74 rows=5792478 width=40)
         Sort Key: y.item_sk NULLS FIRST, y.d_date NULLS FIRST
         ->  Subquery Scan on y  (cost=13445122.01..14053332.20 rows=5792478 width=40)
               Filter: (y.web_cumulative > y.store_cumulative)
               ->  WindowAgg  (cost=13445122.01..13836114.28 rows=17377434 width=40)
                     ->  Sort  (cost=13445122.01..13488565.60 rows=17377434 width=24)
                           Sort Key: (CASE WHEN (web_sales.ws_item_sk IS NOT NULL) THEN web_sales.ws_item_sk ELSE store_sales.ss_item_sk END), (CASE WHEN (date_dim_1.d_date IS NOT NULL) THEN date_dim_1.d_date ELSE date_dim.d_date END)
                           ->  Hash Full Join  (cost=10374504.92..10642676.73 rows=17377434 width=24)
                                 Hash Cond: ((store_sales.ss_item_sk = web_sales.ws_item_sk) AND (date_dim.d_date = date_dim_1.d_date))
                                 ->  WindowAgg  (cost=7785150.79..8010474.01 rows=1629580 width=16)
                                       ->  Finalize GroupAggregate  (cost=7785150.79..7981956.36 rows=1629580 width=16)
                                             Group Key: store_sales.ss_item_sk, date_dim.d_date
                                             ->  Gather Merge  (cost=7785150.79..7955475.68 rows=1357984 width=16)
                                                   Workers Planned: 2
                                                   ->  Partial GroupAggregate  (cost=7784150.77..7797730.61 rows=678992 width=16)
                                                         Group Key: store_sales.ss_item_sk, date_dim.d_date
                                                         ->  Sort  (cost=7784150.77..7785848.25 rows=678992 width=16)
                                                               Sort Key: store_sales.ss_item_sk, date_dim.d_date
                                                               ->  Parallel Hash Join  (cost=2108.74..7706774.09 rows=678992 width=16)
                                                                     Hash Cond: (store_sales.ss_sold_date_sk = date_dim.d_date_sk)
                                                                     ->  Parallel Seq Scan on store_sales  (cost=0.00..7389799.50 rows=119942250 width=16)
                                                                           Filter: (ss_item_sk IS NOT NULL)
                                                                     ->  Parallel Hash  (cost=2105.55..2105.55 rows=255 width=8)
                                                                           ->  Parallel Seq Scan on date_dim  (cost=0.00..2105.55 rows=255 width=8)
                                                                                 Filter: ((d_month_seq >= 1200) AND (d_month_seq <= 1211))
                                 ->  Hash  (cost=2580872.88..2580872.88 rows=426550 width=16)
                                       ->  WindowAgg  (cost=2517628.06..2576607.38 rows=426550 width=16)
                                             ->  Finalize GroupAggregate  (cost=2517628.06..2569142.75 rows=426550 width=16)
                                                   Group Key: web_sales.ws_item_sk, date_dim_1.d_date
                                                   ->  Gather Merge  (cost=2517628.06..2562211.32 rows=355458 width=16)
                                                         Workers Planned: 2
                                                         ->  Partial GroupAggregate  (cost=2516628.04..2520182.62 rows=177729 width=16)
                                                               Group Key: web_sales.ws_item_sk, date_dim_1.d_date
                                                               ->  Sort  (cost=2516628.04..2517072.36 rows=177729 width=16)
                                                                     Sort Key: web_sales.ws_item_sk, date_dim_1.d_date
                                                                     ->  Parallel Hash Join  (cost=2108.74..2498092.67 rows=177729 width=16)
                                                                           Hash Cond: (web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)
                                                                           ->  Parallel Seq Scan on web_sales  (cost=0.00..2417251.13 rows=29991713 width=16)
                                                                                 Filter: (ws_item_sk IS NOT NULL)
                                                                           ->  Parallel Hash  (cost=2105.55..2105.55 rows=255 width=8)
                                                                                 ->  Parallel Seq Scan on date_dim date_dim_1  (cost=0.00..2105.55 rows=255 width=8)
                                                                                       Filter: ((d_month_seq >= 1200) AND (d_month_seq <= 1211))
 JIT:
   Functions: 76
   Options: Inlining true, Optimization true, Expressions true, Deforming true
(46 rows)

