                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=15530952.09..15530952.34 rows=100 width=73)
   ->  Sort  (cost=15530952.09..15530952.38 rows=117 width=73)
         Sort Key: item_2.i_item_id NULLS FIRST, (sum(store_sales.ss_ext_sales_price)) NULLS FIRST
         ->  Merge Join  (cost=15466052.35..15530948.07 rows=117 width=73)
               Merge Cond: ((item_1.i_item_id)::text = (item_2.i_item_id)::text)
               Join Filter: (((sum(store_sales.ss_ext_sales_price)) >= ('0.9'::double precision * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) <= ('1.1'::double precision * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) >= ('0.9'::double precision * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) <= ('1.1'::double precision * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) >= ('0.9'::double precision * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(store_sales.ss_ext_sales_price)) <= ('1.1'::double precision * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) >= ('0.9'::double precision * (sum(store_sales.ss_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) <= ('1.1'::double precision * (sum(store_sales.ss_ext_sales_price)))))
               ->  Merge Join  (cost=7608562.42..7627767.00 rows=5840 width=50)
                     Merge Cond: ((item.i_item_id)::text = (item_1.i_item_id)::text)
                     Join Filter: (((sum(catalog_sales.cs_ext_sales_price)) >= ('0.9'::double precision * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(catalog_sales.cs_ext_sales_price)) <= ('1.1'::double precision * (sum(web_sales.ws_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) >= ('0.9'::double precision * (sum(catalog_sales.cs_ext_sales_price)))) AND ((sum(web_sales.ws_ext_sales_price)) <= ('1.1'::double precision * (sum(catalog_sales.cs_ext_sales_price)))))
                     ->  Finalize GroupAggregate  (cost=2546874.04..2547685.24 rows=6896 width=25)
                           Group Key: item.i_item_id
                           InitPlan 3 (returns $2)
                             ->  Seq Scan on date_dim date_dim_8  (cost=0.00..2374.11 rows=1 width=4)
                                   Filter: (d_date = '2000-01-03'::date)
                           ->  Gather Merge  (cost=2544499.92..2545213.43 rows=5746 width=25)
                                 Workers Planned: 2
                                 Params Evaluated: $2
                                 ->  Partial GroupAggregate  (cost=2543499.90..2543550.18 rows=2873 width=25)
                                       Group Key: item.i_item_id
                                       ->  Sort  (cost=2543499.90..2543507.08 rows=2873 width=25)
                                             Sort Key: item.i_item_id
                                             ->  Parallel Hash Join  (cost=2533774.15..2543334.87 rows=2873 width=25)
                                                   Hash Cond: (item.i_item_sk = web_sales.ws_item_sk)
                                                   ->  Parallel Seq Scan on item  (cost=0.00..9230.00 rows=85000 width=21)
                                                   ->  Parallel Hash  (cost=2533738.24..2533738.24 rows=2873 width=12)
                                                         ->  Parallel Hash Join  (cost=4001.77..2533738.24 rows=2873 width=12)
                                                               Hash Cond: (web_sales.ws_sold_date_sk = date_dim.d_date_sk)
                                                               ->  Parallel Seq Scan on web_sales  (cost=0.00..2417251.13 rows=29991713 width=16)
                                                               ->  Parallel Hash  (cost=4001.72..4001.72 rows=4 width=4)
                                                                     ->  Parallel Hash Semi Join  (cost=1998.17..4001.72 rows=4 width=4)
                                                                           Hash Cond: (date_dim.d_date = date_dim_1.d_date)
                                                                           ->  Parallel Seq Scan on date_dim  (cost=0.00..1890.70 rows=42970 width=8)
                                                                           ->  Parallel Hash  (cost=1998.12..1998.12 rows=4 width=4)
                                                                                 ->  Parallel Seq Scan on date_dim date_dim_1  (cost=0.00..1998.12 rows=4 width=4)
                                                                                       Filter: (d_week_seq = $2)
                     ->  Materialize  (cost=5061688.38..5063473.78 rows=13719 width=25)
                           ->  Finalize GroupAggregate  (cost=5061688.38..5063302.29 rows=13719 width=25)
                                 Group Key: item_1.i_item_id
                                 InitPlan 2 (returns $1)
                                   ->  Seq Scan on date_dim date_dim_7  (cost=0.00..2374.11 rows=1 width=4)
                                         Filter: (d_date = '2000-01-03'::date)
                                 ->  Gather Merge  (cost=5059314.27..5060733.83 rows=11432 width=25)
                                       Workers Planned: 2
                                       Params Evaluated: $1
                                       ->  Partial GroupAggregate  (cost=5058314.24..5058414.27 rows=5716 width=25)
                                             Group Key: item_1.i_item_id
                                             ->  Sort  (cost=5058314.24..5058328.53 rows=5716 width=25)
                                                   Sort Key: item_1.i_item_id
                                                   ->  Parallel Hash Join  (cost=5048384.97..5057957.54 rows=5716 width=25)
                                                         Hash Cond: (item_1.i_item_sk = catalog_sales.cs_item_sk)
                                                         ->  Parallel Seq Scan on item item_1  (cost=0.00..9230.00 rows=85000 width=21)
                                                         ->  Parallel Hash  (cost=5048313.52..5048313.52 rows=5716 width=12)
                                                               ->  Parallel Hash Join  (cost=4001.77..5048313.52 rows=5716 width=12)
                                                                     Hash Cond: (catalog_sales.cs_sold_date_sk = date_dim_2.d_date_sk)
                                                                     ->  Parallel Seq Scan on catalog_sales  (cost=0.00..4819292.97 rows=59996297 width=16)
                                                                     ->  Parallel Hash  (cost=4001.72..4001.72 rows=4 width=4)
                                                                           ->  Parallel Hash Semi Join  (cost=1998.17..4001.72 rows=4 width=4)
                                                                                 Hash Cond: (date_dim_2.d_date = date_dim_3.d_date)
                                                                                 ->  Parallel Seq Scan on date_dim date_dim_2  (cost=0.00..1890.70 rows=42970 width=8)
                                                                                 ->  Parallel Hash  (cost=1998.12..1998.12 rows=4 width=4)
                                                                                       ->  Parallel Seq Scan on date_dim date_dim_3  (cost=0.00..1998.12 rows=4 width=4)
                                                                                             Filter: (d_week_seq = $1)
               ->  Materialize  (cost=7857489.94..7860918.58 rows=26344 width=25)
                     ->  Finalize GroupAggregate  (cost=7857489.94..7860589.28 rows=26344 width=25)
                           Group Key: item_2.i_item_id
                           InitPlan 1 (returns $0)
                             ->  Seq Scan on date_dim date_dim_6  (cost=0.00..2374.11 rows=1 width=4)
                                   Filter: (d_date = '2000-01-03'::date)
                           ->  Gather Merge  (cost=7855115.83..7857841.96 rows=21954 width=25)
                                 Workers Planned: 2
                                 Params Evaluated: $0
                                 ->  Partial GroupAggregate  (cost=7854115.80..7854307.90 rows=10977 width=25)
                                       Group Key: item_2.i_item_id
                                       ->  Sort  (cost=7854115.80..7854143.25 rows=10977 width=25)
                                             Sort Key: item_2.i_item_id
                                             ->  Parallel Hash Join  (cost=7843784.64..7853379.13 rows=10977 width=25)
                                                   Hash Cond: (item_2.i_item_sk = store_sales.ss_item_sk)
                                                   ->  Parallel Seq Scan on item item_2  (cost=0.00..9230.00 rows=85000 width=21)
                                                   ->  Parallel Hash  (cost=7843647.42..7843647.42 rows=10977 width=12)
                                                         ->  Parallel Hash Join  (cost=4001.77..7843647.42 rows=10977 width=12)
                                                               Hash Cond: (store_sales.ss_sold_date_sk = date_dim_4.d_date_sk)
                                                               ->  Parallel Seq Scan on store_sales  (cost=0.00..7389799.50 rows=119942250 width=16)
                                                               ->  Parallel Hash  (cost=4001.72..4001.72 rows=4 width=4)
                                                                     ->  Parallel Hash Semi Join  (cost=1998.17..4001.72 rows=4 width=4)
                                                                           Hash Cond: (date_dim_4.d_date = date_dim_5.d_date)
                                                                           ->  Parallel Seq Scan on date_dim date_dim_4  (cost=0.00..1890.70 rows=42970 width=8)
                                                                           ->  Parallel Hash  (cost=1998.12..1998.12 rows=4 width=4)
                                                                                 ->  Parallel Seq Scan on date_dim date_dim_5  (cost=0.00..1998.12 rows=4 width=4)
                                                                                       Filter: (d_week_seq = $0)
 JIT:
   Functions: 138
   Options: Inlining true, Optimization true, Expressions true, Deforming true
(92 rows)

