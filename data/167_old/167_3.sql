CREATE TABLE duck_table_167_0 AS SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_web_page_sk", "t"."*" AS "*", "t2"."d_date_sk", "t2"."d_year", "t2"."d_moy", "t2"."d_qoy"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"
;
SELECT *
FROM (SELECT "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", RANK() OVER (PARTITION BY "i_category" ORDER BY "sumsales" DESC) AS "rk"
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT "t2"."i_category", "t2"."i_class", "t2"."i_brand", "t2"."i_product_name", "t1"."d_year", "t1"."d_qoy", "t1"."d_moy", "t1"."wp_web_page_id", SUM("t1"."*") AS "sumsales"
FROM (SELECT "t"."ws_item_sk", "t"."d_year", "t"."d_moy", "t"."d_qoy", "t0"."wp_web_page_id", "t"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t0" ON "t"."ws_web_page_sk" = "t0"."wp_web_page_sk") AS "t1"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t2" ON "t1"."ws_item_sk" = "t2"."i_item_sk"
GROUP BY "t2"."i_category", "t2"."i_class", "t2"."i_brand", "t2"."i_product_name", "t1"."d_year", "t1"."d_qoy", "t1"."d_moy", "t1"."wp_web_page_id"
UNION ALL
SELECT "t12"."i_category", "t12"."i_class", "t12"."i_brand", "t12"."i_product_name", "t12"."d_year", "t12"."d_qoy", "t12"."d_moy", NULL AS "wp_web_page_id", SUM("t12"."sumsales") AS "sumsales"
FROM (SELECT "t9"."i_category", "t9"."i_class", "t9"."i_brand", "t9"."i_product_name", "t8"."d_year", "t8"."d_qoy", "t8"."d_moy", SUM("t8"."*") AS "sumsales"
FROM (SELECT "t6"."ws_item_sk", "t6"."d_year", "t6"."d_moy", "t6"."d_qoy", "t7"."wp_web_page_id", "t6"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t6"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t7" ON "t6"."ws_web_page_sk" = "t7"."wp_web_page_sk") AS "t8"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t9" ON "t8"."ws_item_sk" = "t9"."i_item_sk"
GROUP BY "t9"."i_category", "t9"."i_class", "t9"."i_brand", "t9"."i_product_name", "t8"."d_year", "t8"."d_qoy", "t8"."d_moy", "t8"."wp_web_page_id") AS "t12"
GROUP BY "t12"."i_category", "t12"."i_class", "t12"."i_brand", "t12"."i_product_name", "t12"."d_year", "t12"."d_qoy", "t12"."d_moy") AS "t"
UNION ALL
SELECT "t22"."i_category", "t22"."i_class", "t22"."i_brand", "t22"."i_product_name", "t22"."d_year", "t22"."d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t22"."sumsales") AS "sumsales"
FROM (SELECT "t19"."i_category", "t19"."i_class", "t19"."i_brand", "t19"."i_product_name", "t18"."d_year", "t18"."d_qoy", SUM("t18"."*") AS "sumsales"
FROM (SELECT "t16"."ws_item_sk", "t16"."d_year", "t16"."d_moy", "t16"."d_qoy", "t17"."wp_web_page_id", "t16"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t16"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t17" ON "t16"."ws_web_page_sk" = "t17"."wp_web_page_sk") AS "t18"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t19" ON "t18"."ws_item_sk" = "t19"."i_item_sk"
GROUP BY "t19"."i_category", "t19"."i_class", "t19"."i_brand", "t19"."i_product_name", "t18"."d_year", "t18"."d_qoy", "t18"."d_moy", "t18"."wp_web_page_id") AS "t22"
GROUP BY "t22"."i_category", "t22"."i_class", "t22"."i_brand", "t22"."i_product_name", "t22"."d_year", "t22"."d_qoy") AS "t"
UNION ALL
SELECT "t32"."i_category", "t32"."i_class", "t32"."i_brand", "t32"."i_product_name", "t32"."d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t32"."sumsales") AS "sumsales"
FROM (SELECT "t29"."i_category", "t29"."i_class", "t29"."i_brand", "t29"."i_product_name", "t28"."d_year", SUM("t28"."*") AS "sumsales"
FROM (SELECT "t26"."ws_item_sk", "t26"."d_year", "t26"."d_moy", "t26"."d_qoy", "t27"."wp_web_page_id", "t26"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t26"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t27" ON "t26"."ws_web_page_sk" = "t27"."wp_web_page_sk") AS "t28"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t29" ON "t28"."ws_item_sk" = "t29"."i_item_sk"
GROUP BY "t29"."i_category", "t29"."i_class", "t29"."i_brand", "t29"."i_product_name", "t28"."d_year", "t28"."d_qoy", "t28"."d_moy", "t28"."wp_web_page_id") AS "t32"
GROUP BY "t32"."i_category", "t32"."i_class", "t32"."i_brand", "t32"."i_product_name", "t32"."d_year") AS "t"
UNION ALL
SELECT "t42"."i_category", "t42"."i_class", "t42"."i_brand", "t42"."i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t42"."sumsales") AS "sumsales"
FROM (SELECT "t39"."i_category", "t39"."i_class", "t39"."i_brand", "t39"."i_product_name", SUM("t38"."*") AS "sumsales"
FROM (SELECT "t36"."ws_item_sk", "t36"."d_year", "t36"."d_moy", "t36"."d_qoy", "t37"."wp_web_page_id", "t36"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t36"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t37" ON "t36"."ws_web_page_sk" = "t37"."wp_web_page_sk") AS "t38"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t39" ON "t38"."ws_item_sk" = "t39"."i_item_sk"
GROUP BY "t39"."i_category", "t39"."i_class", "t39"."i_brand", "t39"."i_product_name", "t38"."d_year", "t38"."d_qoy", "t38"."d_moy", "t38"."wp_web_page_id") AS "t42"
GROUP BY "t42"."i_category", "t42"."i_class", "t42"."i_brand", "t42"."i_product_name") AS "t"
UNION ALL
SELECT "t52"."i_category", "t52"."i_class", "t52"."i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t52"."sumsales") AS "sumsales"
FROM (SELECT "t49"."i_category", "t49"."i_class", "t49"."i_brand", SUM("t48"."*") AS "sumsales"
FROM (SELECT "t46"."ws_item_sk", "t46"."d_year", "t46"."d_moy", "t46"."d_qoy", "t47"."wp_web_page_id", "t46"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t46"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t47" ON "t46"."ws_web_page_sk" = "t47"."wp_web_page_sk") AS "t48"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t49" ON "t48"."ws_item_sk" = "t49"."i_item_sk"
GROUP BY "t49"."i_category", "t49"."i_class", "t49"."i_brand", "t49"."i_product_name", "t48"."d_year", "t48"."d_qoy", "t48"."d_moy", "t48"."wp_web_page_id") AS "t52"
GROUP BY "t52"."i_category", "t52"."i_class", "t52"."i_brand") AS "t"
UNION ALL
SELECT "t62"."i_category", "t62"."i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t62"."sumsales") AS "sumsales"
FROM (SELECT "t59"."i_category", "t59"."i_class", SUM("t58"."*") AS "sumsales"
FROM (SELECT "t56"."ws_item_sk", "t56"."d_year", "t56"."d_moy", "t56"."d_qoy", "t57"."wp_web_page_id", "t56"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t56"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t57" ON "t56"."ws_web_page_sk" = "t57"."wp_web_page_sk") AS "t58"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t59" ON "t58"."ws_item_sk" = "t59"."i_item_sk"
GROUP BY "t59"."i_category", "t59"."i_class", "t59"."i_brand", "t59"."i_product_name", "t58"."d_year", "t58"."d_qoy", "t58"."d_moy", "t58"."wp_web_page_id") AS "t62"
GROUP BY "t62"."i_category", "t62"."i_class") AS "t"
UNION ALL
SELECT "t72"."i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t72"."sumsales") AS "sumsales"
FROM (SELECT "t69"."i_category", SUM("t68"."*") AS "sumsales"
FROM (SELECT "t66"."ws_item_sk", "t66"."d_year", "t66"."d_moy", "t66"."d_qoy", "t67"."wp_web_page_id", "t66"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t66"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t67" ON "t66"."ws_web_page_sk" = "t67"."wp_web_page_sk") AS "t68"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t69" ON "t68"."ws_item_sk" = "t69"."i_item_sk"
GROUP BY "t69"."i_category", "t69"."i_class", "t69"."i_brand", "t69"."i_product_name", "t68"."d_year", "t68"."d_qoy", "t68"."d_moy", "t68"."wp_web_page_id") AS "t72"
GROUP BY "t72"."i_category") AS "t"
UNION ALL
SELECT NULL AS "i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t82"."sumsales") AS "sumsales"
FROM (SELECT SUM("t78"."*") AS "sumsales"
FROM (SELECT "t76"."ws_item_sk", "t76"."d_year", "t76"."d_moy", "t76"."d_qoy", "t77"."wp_web_page_id", "t76"."*"
FROM (SELECT "ws_item_sk", "ws_web_page_sk", "d_year", "d_moy", "d_qoy", "*"
FROM "duck_table_167_0") AS "t76"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t77" ON "t76"."ws_web_page_sk" = "t77"."wp_web_page_sk") AS "t78"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t79" ON "t78"."ws_item_sk" = "t79"."i_item_sk"
GROUP BY "t79"."i_category", "t79"."i_class", "t79"."i_brand", "t79"."i_product_name", "t78"."d_year", "t78"."d_qoy", "t78"."d_moy", "t78"."wp_web_page_id") AS "t82") AS "t85") AS "t86"
WHERE "rk" <= 100
ORDER BY "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", "rk"
FETCH NEXT 100 ROWS ONLY
;
