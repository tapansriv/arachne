-Dexec.args="single duck tpcds 86 1.48 0.0 0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_2tb/duck_baseline_2tb.json
86 381.2709984779358
/home/tapansriv/arachneDB/baseline_2tb/duck_c_baseline_2tb.json
86 359.0227515697479
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.1475981251520075, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.1475981251520075, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

trial 0
hi
7
id: 2, opp: 0.1475981251520075
id: 3, opp: 0.1475981251520075
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 3, opp: 0.1475981251520075
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
g_category INTEGER
g_class INTEGER
lochierarchy INTEGER
LogicalTableScan
making cut ------------
cut id: 752, arachneId: 3
parent id: 751, arachneId: 2
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

141
141
266.188666228
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

153
153
0.006556662
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.004274257
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 266.188666228 CARDINALITY: 141 COST: 0.10943311833817776
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.006556662 CARDINALITY: 153 COST: 2.6955166E-6
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.004274257 CARDINALITY: -1 COST: 1.7571945444444443E-6
cut real save: 0.03816234581166447
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.03816231129722973, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.1475981251520075, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

estimated move size: 7.871006216321672E-6GB
estimated BQ read size: 1.6529113054275513E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 266.19522288999997 seconds

estimated move cost: $0.0
estimated BQ read cost: $8.264556527137756E-8
estimate billed runtime cost: $0.10943581385477776

estimated savings: $0.03816234581166447
min baseline cost: $0.15143966453422972
estimated hybrid cost: $0.11327731872256525
estimated cost for cut but no movement: $0.11327899327154443
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  04:30 min
[[1;34mINFO[m] Finished at: 2022-11-22T18:43:11Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 1"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_2tb/duck_baseline_2tb.json
86 381.2709984779358
/home/tapansriv/arachneDB/baseline_2tb/duck_c_baseline_2tb.json
86 359.0227515697479
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
7
id: 2, opp: 0.1475981251520075
id: 3, opp: 0.1475981251520075
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 3, opp: 0.1475981251520075
CHOSEN: 3
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.03816231129722973, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.1475981251520075, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

trial 1
hi
6
id: 2, opp: 0.03816231129722973
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 6, opp: 0.1475980447120075
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

141
141
120.777643428
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

141
141
123.277188682
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.007519371
finished query
FINISHED PROFILING FOR TRIAL 1
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 120.777643428 CARDINALITY: 141 COST: 0.04965303118706667
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 123.277188682 CARDINALITY: 141 COST: 0.05068062201371112
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.007519371 CARDINALITY: -1 COST: 3.091296966666667E-6
cut real save: 0.04726452082665854
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

estimated move size: 6.503292492457798E-6GB
estimated BQ read size: 1.3656914234161377E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 244.05483211 seconds

estimated move cost: $0.0
estimated BQ read cost: $6.828457117080689E-8
estimate billed runtime cost: $0.10033365320077779

estimated savings: $0.04726452082665854
min baseline cost: $0.15143966453422972
estimated hybrid cost: $0.10417514370757118
estimated cost for cut but no movement: $0.10417816671996666
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  04:08 min
[[1;34mINFO[m] Finished at: 2022-11-22T18:47:21Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 2"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_2tb/duck_baseline_2tb.json
86 381.2709984779358
/home/tapansriv/arachneDB/baseline_2tb/duck_c_baseline_2tb.json
86 359.0227515697479
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
7
id: 2, opp: 0.1475981251520075
id: 3, opp: 0.1475981251520075
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 3, opp: 0.1475981251520075
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.03816231129722973
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 6, opp: 0.1475980447120075
CHOSEN: 6
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.1475980447120075, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.07231817095200749, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.0665273962320075, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

trial 2
hi
4
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 9, opp: 0.1409284675920075
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_item_sk INTEGER
ws_net_paid DECIMAL
LogicalTableScan
making cut ------------
cut id: 859, arachneId: 9
parent id: 853, arachneId: 8
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

289563397
289563397
104.144724997
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

108.411123518
finished query
FINISHED PROFILING FOR TRIAL 2
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 104.144724997 CARDINALITY: 289563397 COST: 0.04281505360987778
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 108.411123518 CARDINALITY: -1 COST: 0.04456901744628888
cut real save: 0.09311711156579196
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

estimated move size: 1.063340679651215GB
estimated BQ read size: 2.3332154272675516GB
estimated extra read size: 0.1758GB, estimated extra move size: 0.036GB
estimate billed runtime: 104.144724997 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.011666077136337757
estimate billed runtime cost: $0.04281505360987778

estimated savings: $0.09311711156579196
min baseline cost: $0.15143966453422972
estimated hybrid cost: $0.05832255296843776
estimated cost for cut but no movement: $0.09122549327838887
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  03:37 min
[[1;34mINFO[m] Finished at: 2022-11-22T18:51:00Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 3"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_2tb/duck_baseline_2tb.json
86 381.2709984779358
/home/tapansriv/arachneDB/baseline_2tb/duck_c_baseline_2tb.json
86 359.0227515697479
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
7
id: 2, opp: 0.1475981251520075
id: 3, opp: 0.1475981251520075
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 3, opp: 0.1475981251520075
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.03816231129722973
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 6, opp: 0.1475980447120075
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 9, opp: 0.1409284675920075
CHOSEN: 9
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.10478299110212971, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.02950311734212971, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.02371234262212972, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.1409284675920075, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

trial 3
hi
3
id: 7, opp: 0.02950311734212971
id: 8, opp: 0.02371234262212972
id: 10, opp: 0.1351376928720075
-------
id: 10, opp: 0.1351376928720075
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_sold_date_sk INTEGER
ws_item_sk INTEGER
ws_net_paid DECIMAL
d_date_sk INTEGER
LogicalTableScan
making cut ------------
cut id: 864, arachneId: 10
parent id: 859, arachneId: 9
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_net_paid", "t2"."d_date_sk"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("t"."ws_net_paid") AS "total_sum", "t0"."i_category", "t0"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t0" ON "t"."ws_item_sk" = "t0"."i_item_sk"
GROUP BY "t0"."i_category", "t0"."i_class"
UNION
SELECT SUM("t8"."total_sum") AS "total_sum", "t8"."i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t5"."i_category", SUM("t4"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t4"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t5" ON "t4"."ws_item_sk" = "t5"."i_item_sk"
GROUP BY "t5"."i_category", "t5"."i_class") AS "t8"
GROUP BY "t8"."i_category") AS "t"
UNION
SELECT SUM("t16"."total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("t12"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t12"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t13" ON "t12"."ws_item_sk" = "t13"."i_item_sk"
GROUP BY "t13"."i_category", "t13"."i_class") AS "t16") AS "t19"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_net_paid", "t2"."d_date_sk"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

289563397
289563397
132.978158664
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("t"."ws_net_paid") AS "total_sum", "t0"."i_category", "t0"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t0" ON "t"."ws_item_sk" = "t0"."i_item_sk"
GROUP BY "t0"."i_category", "t0"."i_class"
UNION
SELECT SUM("t8"."total_sum") AS "total_sum", "t8"."i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t5"."i_category", SUM("t4"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t4"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t5" ON "t4"."ws_item_sk" = "t5"."i_item_sk"
GROUP BY "t5"."i_category", "t5"."i_class") AS "t8"
GROUP BY "t8"."i_category") AS "t"
UNION
SELECT SUM("t16"."total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("t12"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t12"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t13" ON "t12"."ws_item_sk" = "t13"."i_item_sk"
GROUP BY "t13"."i_category", "t13"."i_class") AS "t16") AS "t19"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

105.576013026
finished query
FINISHED PROFILING FOR TRIAL 3
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 132.978158664 CARDINALITY: 289563397 COST: 0.05466879856186667
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 105.576013026 CARDINALITY: -1 COST: 0.0434034720218
cut real save: 0.07047628947746531
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

estimated move size: 2.09068135930243GB
estimated BQ read size: 4.490630854535103GB
estimated extra read size: 0.1758GB, estimated extra move size: 0.036GB
estimate billed runtime: 132.978158664 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.022453154272675514
estimate billed runtime cost: $0.05466879856186667

estimated savings: $0.07047628947746531
min baseline cost: $0.15143966453422972
estimated hybrid cost: $0.0809633750567644
estimated cost for cut but no movement: $0.10191369280588888
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  04:03 min
[[1;34mINFO[m] Finished at: 2022-11-22T18:55:05Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 4"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_2tb/duck_baseline_2tb.json
86 381.2709984779358
/home/tapansriv/arachneDB/baseline_2tb/duck_c_baseline_2tb.json
86 359.0227515697479
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
7
id: 2, opp: 0.1475981251520075
id: 3, opp: 0.1475981251520075
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 3, opp: 0.1475981251520075
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.03816231129722973
id: 6, opp: 0.1475980447120075
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 6, opp: 0.1475980447120075
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.07231817095200749
id: 8, opp: 0.0665273962320075
id: 9, opp: 0.1409284675920075
id: 10, opp: 0.1351376928720075
-------
id: 9, opp: 0.1409284675920075
CHOSEN: 9
replaying trial 3
3, 10
3
id: 7, opp: 0.02950311734212971
id: 8, opp: 0.02371234262212972
id: 10, opp: 0.1351376928720075
-------
id: 10, opp: 0.1351376928720075
CHOSEN: 10
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.06217134190354806, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.0530691812495481, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3429202111629925, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3429203149829924, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34292010096299247, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3429200975529924, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292019718299244, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34292009516299243, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.3429200946029925, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.34292010218299246, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.050114192540263044, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.02516568121973696, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = -0.03095645593973695, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.08625966903014083, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.1351376928720075, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.10348013853700748, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = -0.3429200945829925, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = -0.3428810280079925, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = -0.3428810426479925, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = -0.3428814049879925, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = -0.3423530945829925, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = -0.34379909458299246, arachneId = 18

trial 4
hi
0
no more candidates to check
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_item_sk INTEGER
ws_net_paid DECIMAL
LogicalTableScan
making cut ------------
cut id: 859, arachneId: 9
parent id: 853, arachneId: 8
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

finished query. now moving
materializing table to /mnt/disks/tpcds/duck_table_86_0.parquet
moving file to GC storage
File /mnt/disks/tpcds/duck_table_86_0.parquet uploaded to bucket arachne_duckdb/ as duck_table_86_0.parquet
loading table into BQ
GCS Parquet was not loaded. 
com.google.cloud.bigquery.BigQueryException: Not found: URI gs://arachne_duckdb/duck_table_86_0.parquet
GCS Parquet was not loaded. 
com.google.cloud.bigquery.BigQueryException: Not found: URI gs://arachne_duckdb/duck_table_86_0.parquet
GCS Parquet was not loaded. 
com.google.cloud.bigquery.BigQueryException: Not found: URI gs://arachne_duckdb/duck_table_86_0.parquet
GCS Parquet was not loaded. 
com.google.cloud.bigquery.BigQueryException: Not found: URI gs://arachne_duckdb/duck_table_86_0.parquet
Loaded 289563397 rows. 
GCS parquet loaded successfully.
finished all
gsutil rm gs://arachne_duckdb//duck_table_86_0
DROP TABLE tpcds.duck_table_86_0
moved table: duck_table_86_0
Total runtime(seconds): 166.466106552, Query time: 87.950753479, Move time: 78.515353073, cost($): 0.06843606602693335
finished query
STARTING QRY: SELECT total_sum, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN g_class = 0 THEN i_category ELSE NULL END ORDER BY total_sum IS NULL DESC, total_sum DESC) AS rank_within_parent, CASE WHEN lochierarchy = 0 THEN i_category ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM(duck_table_86_0.ws_net_paid) AS total_sum, t.i_category, t.i_class, 0 AS g_category, 0 AS g_class, 0 AS lochierarchy
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_0
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t ON duck_table_86_0.ws_item_sk = t.i_item_sk
GROUP BY t.i_category, t.i_class
UNION DISTINCT
SELECT SUM(t6.total_sum) AS total_sum, t6.i_category, CAST(NULL AS STRING) AS i_class, 0 AS g_category, 1 AS g_class, 1 AS lochierarchy
FROM (SELECT t3.i_category, SUM(duck_table_86_00.ws_net_paid) AS total_sum
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_00
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t3 ON duck_table_86_00.ws_item_sk = t3.i_item_sk
GROUP BY t3.i_category, t3.i_class) AS t6
GROUP BY t6.i_category)
UNION DISTINCT
SELECT SUM(t13.total_sum) AS total_sum, CAST(NULL AS STRING) AS i_category, CAST(NULL AS STRING) AS i_class, 1 AS g_category, 1 AS g_class, 2 AS lochierarchy
FROM (SELECT SUM(duck_table_86_01.ws_net_paid) AS total_sum
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_01
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t10 ON duck_table_86_01.ws_item_sk = t10.i_item_sk
GROUP BY t10.i_category, t10.i_class) AS t13) AS t16
ORDER BY lochierarchy IS NULL DESC, lochierarchy DESC, CASE WHEN lochierarchy = 0 THEN i_category ELSE NULL END, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN g_class = 0 THEN i_category ELSE NULL END ORDER BY total_sum IS NULL DESC, total_sum DESC)
LIMIT 100

Query performed successfully.
Total bytes billed: 4648337408, cost: 0.02113819122314453
finished query. now moving
Total runtime(seconds): 4.584569029, cost($): 0.02113819122314453
finished query
CTAS: duck_table_86_0 SRC: GCP DEST: BQ NUM INPUTS: 0 RUNTIME: 166.466106552 CARDINALITY: -1 COST: 0.06843606602693335
CTAS: null SRC: BQ DEST: null NUM INPUTS: 0 RUNTIME: 4.584569029 CARDINALITY: -1 COST: 0.02113819122314453
node id: 9
hybrid cost: $0.08957425725007788
min baseline cost: $0.15143966453422972
real savings: $0.06186540728415184
TOTAL COST OF ARACHNE PLAN: $0.08957425725007788, MIN BASELINE: $0.15143966453422972
total cost: 86,0.08957425725007788,0.16058616604092915,0.15143966453422972,0.643623046875
total runtime: 171.050675581(seconds)
FOUND PLAN
node id: 9
estimated savings: $0.09311711156579196
min baseline cost: $0.15143966453422972
estimated cost for cut but no movement: $0.09122549327838887
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  02:54 min
[[1;34mINFO[m] Finished at: 2022-11-22T18:58:03Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 5"
-Dexec.args="single duck tpcds 86 1.48 0.0 6"
-Dexec.args="single duck tpcds 86 1.48 0.0 7"
-Dexec.args="single duck tpcds 86 1.48 0.0 8"
-Dexec.args="single duck tpcds 86 1.48 0.0 9"
-Dexec.args="single duck tpcds 86 1.48 0.0 10"
-Dexec.args="single duck tpcds 86 1.48 0.0 11"
-Dexec.args="single duck tpcds 86 1.48 0.0 12"
-Dexec.args="single duck tpcds 86 1.48 0.0 13"
-Dexec.args="single duck tpcds 86 1.48 0.0 14"
-Dexec.args="single duck tpcds 86 1.48 0.0 15"
-Dexec.args="single duck tpcds 86 1.48 0.0 16"
-Dexec.args="single duck tpcds 86 1.48 0.0 17"
-Dexec.args="single duck tpcds 86 1.48 0.0 18"
-Dexec.args="single duck tpcds 86 1.48 0.0 19"
