-Dexec.args="single duck tpcds 86 1.48 0.0 0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.6049325749836522, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.6049325749836522, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = 0.11441423866865219, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = 0.1144141348486522, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = 0.11441434886865215, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = 0.11441435227865221, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441425264865218, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = 0.11441435466865224, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = 0.11441435522865218, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441434764865221, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 0
hi
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
g_category INTEGER
g_class INTEGER
lochierarchy INTEGER
LogicalTableScan
making cut ------------
cut id: 752, arachneId: 3
parent id: 751, arachneId: 2
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

199
199
583.084401512
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_0"

211
211
0.005554209
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM "duck_table_86_1"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.003280732
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 583.084401512 CARDINALITY: 199 COST: 0.23971247617715555
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.005554209 CARDINALITY: 211 COST: 2.2833970333333335E-6
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.003280732 CARDINALITY: -1 COST: 1.348745377777778E-6
cut real save: 0.36521781859420654
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.3652178154094633, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.6049325749836522, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = 0.11441423866865219, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = 0.1144141348486522, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = 0.11441434886865215, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = 0.11441435227865221, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441425264865218, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = 0.11441435466865224, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = 0.11441435522865218, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441434764865221, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 1.0854786350613549E-5GB
estimated BQ read size: 2.2795051336288452E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 583.089955721 seconds

estimated move cost: $0.0
estimated BQ read cost: $1.1397525668144226E-7
estimate billed runtime cost: $0.2397147595741889

estimated savings: $0.36521781859420654
min baseline cost: $0.6087741143658744
estimated hybrid cost: $0.2435562957716678
estimated cost for cut but no movement: $0.24355753054178889
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  09:46 min
[[1;34mINFO[m] Finished at: 2022-11-27T03:50:32Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 1"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = 0.3652178154094633, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = 0.6049325749836522, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = 0.11441423866865219, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = 0.1144141348486522, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = 0.11441434886865215, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = 0.11441435227865221, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441425264865218, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = 0.11441435466865224, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = 0.11441435522865218, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = 0.11441434764865221, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 1
hi
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
i_category VARCHAR
i_class VARCHAR
total_sum DECIMAL
LogicalTableScan
making cut ------------
cut id: 836, arachneId: 6
parent id: 826, arachneId: 5
parent id: 911, arachneId: 21
parent id: 947, arachneId: 24
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

199
199
560.708725117
finished query
STARTING QRY: CREATE TABLE duck_table_86_1 AS SELECT "t4"."i_category", "t4"."i_class", SUM("t3"."ws_net_paid") AS "total_sum"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class"

199
199
552.033145209
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_1"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM "duck_table_86_1"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM "duck_table_86_1") AS "t7"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

0.005991184
finished query
FINISHED PROFILING FOR TRIAL 1
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 560.708725117 CARDINALITY: 199 COST: 0.23051358699254443
CTAS: duck_table_86_1 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 552.033145209 CARDINALITY: 199 COST: 0.22694695969703338
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 0.005991184 CARDINALITY: -1 COST: 2.463042311111111E-6
cut real save: 0.1474720490808143
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 9.178405716305687E-6GB
estimated BQ read size: 1.9274652004241943E-5GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 1112.741870326 seconds

estimated move cost: $0.0
estimated BQ read cost: $9.637326002120972E-8
estimate billed runtime cost: $0.4574605466895778

estimated savings: $0.1474720490808143
min baseline cost: $0.6087741143658744
estimated hybrid cost: $0.46130206528506007
estimated cost for cut but no movement: $0.4613044319541112
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  18:36 min
[[1;34mINFO[m] Finished at: 2022-11-27T04:09:09Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 2"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
CHOSEN: 6
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.6049324945436522, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.5296526207836522, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5238618460636522, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 2
hi
4
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 9, opp: 0.5982629174236522
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_item_sk INTEGER
ws_net_paid DECIMAL
LogicalTableScan
making cut ------------
cut id: 859, arachneId: 9
parent id: 853, arachneId: 8
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

1447524643
1447524643
447.574334099
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("duck_table_86_0"."ws_net_paid") AS "total_sum", "t"."i_category", "t"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t" ON "duck_table_86_0"."ws_item_sk" = "t"."i_item_sk"
GROUP BY "t"."i_category", "t"."i_class"
UNION
SELECT SUM("t6"."total_sum") AS "total_sum", "t6"."i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t3"."i_category", SUM("duck_table_86_00"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_00"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t3" ON "duck_table_86_00"."ws_item_sk" = "t3"."i_item_sk"
GROUP BY "t3"."i_category", "t3"."i_class") AS "t6"
GROUP BY "t6"."i_category") AS "t"
UNION
SELECT SUM("t13"."total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("duck_table_86_01"."ws_net_paid") AS "total_sum"
FROM "duck_table_86_0" AS "duck_table_86_01"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t10" ON "duck_table_86_01"."ws_item_sk" = "t10"."i_item_sk"
GROUP BY "t10"."i_category", "t10"."i_class") AS "t13") AS "t16"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

661.494375618
finished query
FINISHED PROFILING FOR TRIAL 2
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 447.574334099 CARDINALITY: 1447524643 COST: 0.18400278179625557
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 661.494375618 CARDINALITY: -1 COST: 0.2719476877540667
cut real save: 0.36612641525387213
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 5.171666199383281GB
estimated BQ read size: 10.960699018704892GB
estimated extra read size: 0.1758GB, estimated extra move size: 0.036GB
estimate billed runtime: 447.574334099 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.05480349509352446
estimate billed runtime cost: $0.18400278179625557

estimated savings: $0.36612641525387213
min baseline cost: $0.6087741143658744
estimated hybrid cost: $0.24264769911200224
estimated cost for cut but no movement: $0.4597918917725445
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  18:34 min
[[1;34mINFO[m] Finished at: 2022-11-27T04:27:45Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 3"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 9, opp: 0.5982629174236522
CHOSEN: 9
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.4209297127473966, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.3456498389873966, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.3398590642673966, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.5982629174236522, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 3
hi
3
id: 7, opp: 0.3456498389873966
id: 8, opp: 0.3398590642673966
id: 10, opp: 0.5924721427036522
-------
id: 10, opp: 0.5924721427036522
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_sold_date_sk INTEGER
ws_item_sk INTEGER
ws_net_paid DECIMAL
d_date_sk INTEGER
LogicalTableScan
making cut ------------
cut id: 864, arachneId: 10
parent id: 859, arachneId: 9
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_net_paid", "t2"."d_date_sk"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("t"."ws_net_paid") AS "total_sum", "t0"."i_category", "t0"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t0" ON "t"."ws_item_sk" = "t0"."i_item_sk"
GROUP BY "t0"."i_category", "t0"."i_class"
UNION
SELECT SUM("t8"."total_sum") AS "total_sum", "t8"."i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t5"."i_category", SUM("t4"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t4"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t5" ON "t4"."ws_item_sk" = "t5"."i_item_sk"
GROUP BY "t5"."i_category", "t5"."i_class") AS "t8"
GROUP BY "t8"."i_category") AS "t"
UNION
SELECT SUM("t16"."total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("t12"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t12"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t13" ON "t12"."ws_item_sk" = "t13"."i_item_sk"
GROUP BY "t13"."i_category", "t13"."i_class") AS "t16") AS "t19"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_net_paid", "t2"."d_date_sk"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

1447524643
1447524643
556.113732952
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("t"."ws_net_paid") AS "total_sum", "t0"."i_category", "t0"."i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t0" ON "t"."ws_item_sk" = "t0"."i_item_sk"
GROUP BY "t0"."i_category", "t0"."i_class"
UNION
SELECT SUM("t8"."total_sum") AS "total_sum", "t8"."i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "t5"."i_category", SUM("t4"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t4"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t5" ON "t4"."ws_item_sk" = "t5"."i_item_sk"
GROUP BY "t5"."i_category", "t5"."i_class") AS "t8"
GROUP BY "t8"."i_category") AS "t"
UNION
SELECT SUM("t16"."total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("t12"."ws_net_paid") AS "total_sum"
FROM (SELECT "ws_item_sk", "ws_net_paid"
FROM "duck_table_86_0") AS "t12"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t13" ON "t12"."ws_item_sk" = "t13"."i_item_sk"
GROUP BY "t13"."i_category", "t13"."i_class") AS "t16") AS "t19"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

686.386213924
finished query
FINISHED PROFILING FOR TRIAL 3
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 556.113732952 CARDINALITY: 1447524643 COST: 0.22862453465804441
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 686.386213924 CARDINALITY: -1 COST: 0.28218099905764443
cut real save: 0.2675801672985588
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 10.307332398766562GB
estimated BQ read size: 21.74559803740978GB
estimated extra read size: 0.1758GB, estimated extra move size: 0.036GB
estimate billed runtime: 556.113732952 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.10872799018704891
estimate billed runtime cost: $0.22862453465804441

estimated savings: $0.2675801672985588
min baseline cost: $0.6087741143658744
estimated hybrid cost: $0.34119394706731554
estimated cost for cut but no movement: $0.5146469559379111
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  20:50 min
[[1;34mINFO[m] Finished at: 2022-11-27T04:48:39Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 4"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 9, opp: 0.5982629174236522
CHOSEN: 9
replaying trial 3
3, 10
3
id: 7, opp: 0.3456498389873966
id: 8, opp: 0.3398590642673966
id: 10, opp: 0.5924721427036522
-------
id: 10, opp: 0.5924721427036522
CHOSEN: 10
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = 0.19230517808935219, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 4
hi
2
id: 7, opp: 0.11702530432935218
id: 8, opp: 0.11123452960935218
-------
id: 7, opp: 0.11702530432935218
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
i_category VARCHAR
i_class VARCHAR
ws_net_paid DECIMAL
LogicalTableScan
making cut ------------
cut id: 845, arachneId: 7
parent id: 836, arachneId: 6
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", "t3"."ws_net_paid"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("ws_net_paid") AS "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "i_category", SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t2"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t7") AS "t10"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t4"."i_category", "t4"."i_class", "t3"."ws_net_paid"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"

1447524643
1447524643
1164.675774823
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("ws_net_paid") AS "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "i_category", SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t2"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t7") AS "t10"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

551.466743867
finished query
FINISHED PROFILING FOR TRIAL 4
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 1164.675774823 CARDINALITY: 1447524643 COST: 0.4788111518716777
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 551.466743867 CARDINALITY: -1 COST: 0.22671410581198886
cut real save: -0.5748968959438435
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 66.76366059198266GB
estimated BQ read size: 140.20368724316359GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 1164.675774823 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.7010184362158179
estimate billed runtime cost: $0.4788111518716777

estimated savings: $-0.5748968959438435
min baseline cost: $0.6087741143658744
estimated hybrid cost: $1.1836710103097179
estimated cost for cut but no movement: $0.7093666799058889
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  28:42 min
[[1;34mINFO[m] Finished at: 2022-11-27T05:17:28Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 5"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 9, opp: 0.5982629174236522
CHOSEN: 9
replaying trial 3
3, 10
3
id: 7, opp: 0.3456498389873966
id: 8, opp: 0.3398590642673966
id: 10, opp: 0.5924721427036522
-------
id: 10, opp: 0.5924721427036522
CHOSEN: 10
replaying trial 4
4, 7
2
id: 7, opp: 0.11702530432935218
id: 8, opp: 0.11123452960935218
-------
id: 7, opp: 0.11702530432935218
CHOSEN: 7
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = 0.11702530432935218, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 5
hi
1
id: 8, opp: 0.11123452960935218
-------
id: 8, opp: 0.11123452960935218
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_item_sk INTEGER
ws_net_paid DECIMAL
i_item_sk INTEGER
i_class VARCHAR
i_category VARCHAR
LogicalTableScan
making cut ------------
cut id: 853, arachneId: 8
parent id: 845, arachneId: 7
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
CREATE TABLE duck_table_86_0 AS SELECT "t3"."ws_item_sk", "t3"."ws_net_paid", "t4"."i_item_sk", "t4"."i_class", "t4"."i_category"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"

CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: -1.0 CARDINALITY: -1 COST: 0.0
SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("ws_net_paid") AS "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", NULL AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "i_category", SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t4"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", NULL AS "i_category", NULL AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t10") AS "t13"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t3"."ws_item_sk", "t3"."ws_net_paid", "t4"."i_item_sk", "t4"."i_class", "t4"."i_category"
FROM (SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_class", "i_category"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"

1447524643
1447524643
1253.843389534
finished query
STARTING QRY: SELECT "total_sum", "i_category", "i_class", "lochierarchy", RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) AS "rank_within_parent", CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM("ws_net_paid") AS "total_sum", "i_category", "i_class", 0 AS "g_category", 0 AS "g_class", 0 AS "lochierarchy"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class"
UNION
SELECT SUM("total_sum") AS "total_sum", "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 0 AS "g_category", 1 AS "g_class", 1 AS "lochierarchy"
FROM (SELECT "i_category", SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t4"
GROUP BY "i_category") AS "t"
UNION
SELECT SUM("total_sum") AS "total_sum", CAST(NULL AS VARCHAR(50)) AS "i_category", CAST(NULL AS VARCHAR(50)) AS "i_class", 1 AS "g_category", 1 AS "g_class", 2 AS "lochierarchy"
FROM (SELECT SUM("ws_net_paid") AS "total_sum"
FROM "duck_table_86_0"
GROUP BY "i_category", "i_class") AS "t10") AS "t13"
ORDER BY "lochierarchy" DESC, CASE WHEN "lochierarchy" = 0 THEN "i_category" ELSE NULL END NULLS FIRST, RANK() OVER (PARTITION BY "lochierarchy", CASE WHEN "g_class" = 0 THEN "i_category" ELSE NULL END ORDER BY "total_sum" DESC) NULLS FIRST
FETCH NEXT 100 ROWS ONLY

922.97361759
finished query
FINISHED PROFILING FOR TRIAL 5
CTAS: duck_table_86_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 1253.843389534 CARDINALITY: 1447524643 COST: 0.5154689490306444
CTAS: null SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 922.97361759 CARDINALITY: -1 COST: 0.37944470945366665
cut real save: -0.6654791881963348
Post Trial ::
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

estimated move size: 71.89932679136594GB
estimated BQ read size: 150.98858626186848GB
estimated extra read size: 0.0GB, estimated extra move size: 0.0GB
estimate billed runtime: 1253.843389534 seconds

estimated move cost: $0.0
estimated BQ read cost: $0.7549429313093424
estimate billed runtime cost: $0.5154689490306444

estimated savings: $-0.6654791881963348
min baseline cost: $0.6087741143658744
estimated hybrid cost: $1.2742533025622091
estimated cost for cut but no movement: $0.8987550807065332
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  36:25 min
[[1;34mINFO[m] Finished at: 2022-11-27T05:54:04Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 6"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
86 1.48 0.0 GCP
/home/tapansriv/arachneDB/baseline_10tb/duck_baseline_10tb.json
86 1527.8251299858093
/home/tapansriv/arachneDB/baseline_10tb/duck_c_baseline_10tb.json
86 1471.4578998088837
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.4E-5 (d_date_sk) PROJECTION
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
0 720000376 24.685373 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002752 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.264358 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.085864 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073658 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.291786 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.060886 (i_category, i_class, ws_net_paid) PROJECTION
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
1 190 1.2E-5 (i_category, total_sum) PROJECTION
1 190 1.1E-5 (i_category, total_sum) PROJECTION
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
2 201 5.0E-6 () UNION
1 201 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
0 720000376 24.249524 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
0 732 0.002771 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
1 732 2.0E-5 (d_date_sk) PROJECTION
2 144769368 6.256921 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
1 144769368 1.071187 (ws_item_sk, ws_net_paid) PROJECTION
0 600000 0.073263 (i_item_sk, i_class, i_category) PARQUET_SCAN
2 144769368 9.241411 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
1 144769368 1.083439 (i_category, i_class, ws_net_paid) PROJECTION
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
1 380 1.4E-5 (total_sum) PROJECTION
1 380 1.3E-5 (total_sum) PROJECTION
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
2 202 5.0E-6 () UNION
1 202 3.0E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
------- 1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
rel#238:ProfileSort.PROFILE(input=ProfileProject#279,sort0=$3,sort1=$5,sort2=$4,dir0=DESC,dir1=ASC-nulls-first,dir2=ASC-nulls-first,fetch=100)
1 0 4.93E-4 (Top 100, [INFOSEPARATOR], #3 DESC, #5 ASC, #4 ASC) TOP_N
hi
------- 1 202 7.2E-5 (total_sum, i_category, i_class, lochierarchy, rank_within_parent, CASE WHEN (lochierarchy=0) THEN (i_category) ELSE (NULL)) PROJECTION
rel#279:ProfileProject.PROFILE(input=ProfileUnion#280,inputs=0..2,exprs=[$5, RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC), CASE(=($5, 0), $1, null:VARCHAR)])
1 202 6.43E-4 (RANK() OVER(PARTITION BY lochierarchy, CASE WHEN (g_class=0) THEN (i_category) ELSE (NULL) ORDER BY total_sum DESC NULLS FIRST)) WINDOW
hi
------- 1 202 7.9E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#280:ProfileUnion.PROFILE(input#0=ProfileUnion#321,input#1=ProfileProject#472,all=false)
2 202 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 201 9.3E-5 (#0, #1, #2, #3, #4, #5) PROJECTION
rel#321:ProfileUnion.PROFILE(input#0=ProfileProject#359,input#1=ProfileProject#434,all=false)
2 201 5.0E-6 () UNION
----------------
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
total_sum, i_category, i_class, g_category, g_class, lochierarchy, 
----------------
indices 0 0
------- 1 190 3.0E-5 (total_sum, i_category, i_class, g_category, g_class, lochierarchy) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 19.933518 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
------- 1 144769368 1.821947 (i_category, i_class, ws_net_paid) PROJECTION
rel#390:ProfileJoin.PROFILE(left=ProfileProject#397,right=ProfileProject#419,condition==($2, $0),joinType=inner)
2 144769368 13.613145 (INNER, ws_item_sk=i_item_sk) HASH_JOIN
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
ws_item_sk, ws_net_paid, 
i_item_sk, i_class, i_category, 
----------------
left child matched left profile node
indices 0 0
------- 1 144769368 1.791225 (ws_item_sk, ws_net_paid) PROJECTION
rel#404:ProfileJoin.PROFILE(left=ProfileProject#406,right=ProfileProject#411,condition==($3, $0),joinType=inner)
2 144769368 10.271776 (INNER, ws_sold_date_sk=d_date_sk) HASH_JOIN
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
ws_sold_date_sk, ws_item_sk, ws_net_paid, 
d_date_sk, 
----------------
left child matched left profile node
indices 0 0
------- 0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
rel#407:ProfileTableScan.PROFILE(table=[tpcds, web_sales])
0 720000376 205.987175 (ws_sold_date_sk, ws_item_sk, ws_net_paid) PARQUET_SCAN
hi
indices 1 1
------- 1 732 2.4E-5 (d_date_sk) PROJECTION
ProfileFilter ProfileTableScan false
rel#417:ProfileTableScan.PROFILE(table=[tpcds, date_dim])
0 732 0.002823 (d_date_sk, d_month_seq, [INFOSEPARATOR], Filters: d_month_seq>=1200 AND d_month_seq<=1211 AND d_month_seq IS NOT NULL) PARQUET_SCAN
hi
indices 1 1
------- 0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
rel#420:ProfileTableScan.PROFILE(table=[tpcds, item])
0 600000 0.073814 (i_item_sk, i_class, i_category) PARQUET_SCAN
hi
indices 1 1
------- 1 11 2.9E-5 (total_sum, i_category, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#447:ProfileAggregate.PROFILE(input=ProfileProject#458,group={0},total_sum=SUM($1))
1 11 4.8E-5 (#0, sum(#1)) HASH_GROUP_BY
hi
------- 1 190 1.1E-5 (i_category, total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 190 11.594679 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
indices 1 1
------- 1 1 2.9E-5 (total_sum, NULL, NULL, g_category, g_class, lochierarchy) PROJECTION
rel#485:ProfileAggregate.PROFILE(input=ProfileProject#496,group={},total_sum=SUM($0))
1 1 1.3E-5 (sum(#0)) SIMPLE_AGGREGATE
hi
------- 1 380 1.3E-5 (total_sum) PROJECTION
rel#370:ProfileAggregate.PROFILE(input=ProfileProject#380,group={0, 1},total_sum=SUM($2))
1 380 11.660437 (#0, #1, sum(#2)) HASH_GROUP_BY
hi
replaying trial 0
0, 3
18
id: 2, opp: 0.6049325749836522
id: 3, opp: 0.6049325749836522
id: 22, opp: 0.11441435466865224
id: 23, opp: 0.11441435522865218
id: 24, opp: 0.11441434764865221
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
id: 13, opp: 0.11445342182365215
id: 14, opp: 0.11445340718365216
id: 15, opp: 0.11445304484365215
id: 4, opp: 0.11441423866865219
id: 19, opp: 0.11441434886865215
id: 20, opp: 0.11441435227865221
id: 21, opp: 0.11441425264865218
id: 5, opp: 0.1144141348486522
-------
id: 3, opp: 0.6049325749836522
CHOSEN: 3
replaying trial 1
1, 6
6
id: 2, opp: 0.3652178154094633
id: 6, opp: 0.6049324945436522
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 6, opp: 0.6049324945436522
CHOSEN: 6
replaying trial 2
2, 9
4
id: 7, opp: 0.5296526207836522
id: 8, opp: 0.5238618460636522
id: 9, opp: 0.5982629174236522
id: 10, opp: 0.5924721427036522
-------
id: 9, opp: 0.5982629174236522
CHOSEN: 9
replaying trial 3
3, 10
3
id: 7, opp: 0.3456498389873966
id: 8, opp: 0.3398590642673966
id: 10, opp: 0.5924721427036522
-------
id: 10, opp: 0.5924721427036522
CHOSEN: 10
replaying trial 4
4, 7
2
id: 7, opp: 0.11702530432935218
id: 8, opp: 0.11123452960935218
-------
id: 7, opp: 0.11702530432935218
CHOSEN: 7
replaying trial 5
5, 8
1
id: 8, opp: 0.11123452960935218
-------
id: 8, opp: 0.11123452960935218
CHOSEN: 8
START: :
238:ProfileSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], fetch=[100]): rowcount = 0, timing = null, opportunity = -1.0, arachneId = 1
  279:ProfileProject(total_sum=[$0], i_category=[$1], i_class=[$2], lochierarchy=[$5], rank_within_parent=[RANK() OVER (PARTITION BY $5, CASE(=($4, 0), $1, null:VARCHAR) ORDER BY $0 DESC)], EXPR$5=[CASE(=($5, 0), $1, null:VARCHAR)]): rowcount = 202, timing = null, opportunity = -0.09224273128011451, arachneId = 2
    280:ProfileUnion(all=[false]): rowcount = 202, timing = null, opportunity = -0.30998851839550345, arachneId = 3
      321:ProfileUnion(all=[false]): rowcount = 201, timing = null, opportunity = -0.3430463080209256, arachneId = 4
        359:ProfileProject(total_sum=[$2], i_category=[$0], i_class=[$1], g_category=[0], g_class=[0], lochierarchy=[0]): rowcount = 380, timing = null, opportunity = -0.3430464118409256, arachneId = 5
          370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
            380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
              390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                  404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                    406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                      407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                    411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                      414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                        416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                          417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                  420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
        434:ProfileProject(total_sum=[$1], i_category=[$0], i_class=[null:NULL], g_category=[0], g_class=[1], lochierarchy=[1]): rowcount = 11, timing = null, opportunity = -0.34304619782092566, arachneId = 19
          447:ProfileAggregate(group=[{0}], total_sum=[SUM($1)]): rowcount = 11, timing = null, opportunity = -0.3430461944109256, arachneId = 20
            458:ProfileProject(i_category=[$0], total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430462940409256, arachneId = 21
              370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
                380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
                  390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                    397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                      404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                        406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                          407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                        411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                          414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                            416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                              417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                    419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                      420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18
      472:ProfileProject(total_sum=[$0], i_category=[null:NULL], i_class=[null:NULL], g_category=[1], g_class=[1], lochierarchy=[2]): rowcount = 1, timing = null, opportunity = -0.34304619202092557, arachneId = 22
        485:ProfileAggregate(group=[{}], total_sum=[SUM($0)]): rowcount = 1, timing = null, opportunity = -0.34304619146092563, arachneId = 23
          496:ProfileProject(total_sum=[$2]): rowcount = 380, timing = null, opportunity = -0.3430461990409256, arachneId = 24
            370:ProfileAggregate(group=[{0, 1}], total_sum=[SUM($2)]): rowcount = 380, timing = null, opportunity = -0.28650597378232556, arachneId = 6
              380:ProfileProject(i_category=[$4], i_class=[$3], ws_net_paid=[$1]): rowcount = 144769368, timing = null, opportunity = -0.39844364470129223, arachneId = 7
                390:ProfileJoin(condition=[=($2, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.11123452960935218, arachneId = 8
                  397:ProfileProject(ws_item_sk=[$1], ws_net_paid=[$2]): rowcount = 144769368, timing = null, opportunity = 0.3696383827656078, arachneId = 9
                    404:ProfileJoin(condition=[=($3, $0)], joinType=[inner]): rowcount = 144769368, timing = null, opportunity = 0.5924721427036522, arachneId = 10
                      406:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_net_paid=[$29]): rowcount = 720000376, timing = null, opportunity = 0.5608145883686522, arachneId = 11
                        407:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 720000376, timing = null, opportunity = 0.11441435524865218, arachneId = 12
                      411:ProfileProject(d_date_sk=[$0]): rowcount = 732, timing = null, opportunity = 0.11445342182365215, arachneId = 13
                        414:ProfileProject(d_date_sk=[$0], d_month_seq=[$3]): rowcount = 732, timing = null, opportunity = 0.11445340718365216, arachneId = 14
                          416:ProfileFilter(condition=[AND(>=($3, 1200), <=($3, +(1200, 11)))]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 15
                            417:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 732, timing = null, opportunity = 0.11445304484365215, arachneId = 16
                  419:ProfileProject(i_item_sk=[$0], i_class=[$10], i_category=[$12]): rowcount = 600000, timing = null, opportunity = 0.11498135524865216, arachneId = 17
                    420:ProfileTableScan(table=[[tpcds, item]]): rowcount = 600000, timing = null, opportunity = 0.11353535524865216, arachneId = 18

trial 6
hi
0
no more candidates to check
LogicalSort
LogicalProject
LogicalUnion
LogicalUnion
LogicalProject
LogicalAggregate
LogicalProject
LogicalJoin
LogicalProject
LogicalJoin
LogicalProject
LogicalTableScan
LogicalProject
LogicalProject
LogicalFilter
LogicalTableScan
LogicalProject
LogicalTableScan
LogicalProject
LogicalAggregate
LogicalProject
LogicalProject
LogicalAggregate
LogicalProject
ws_item_sk INTEGER
ws_net_paid DECIMAL
LogicalTableScan
making cut ------------
cut id: 859, arachneId: 9
parent id: 853, arachneId: 8
made cut ------------
total_sum DECIMAL
i_category VARCHAR
i_class VARCHAR
lochierarchy INTEGER
rank_within_parent BIGINT
EXPR$5 VARCHAR
STARTING QRY: CREATE TABLE duck_table_86_0 AS SELECT "t"."ws_item_sk", "t"."ws_net_paid"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_net_paid"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11) AS "t2" ON "t"."ws_sold_date_sk" = "t2"."d_date_sk"

finished query. now moving
materializing table to /mnt/disks/tpcds/duck_table_86_0.parquet
moving file to GC storage
File /mnt/disks/tpcds/duck_table_86_0.parquet uploaded to bucket arachne_duckdb/ as duck_table_86_0.parquet
loading table into BQ
Loaded 579126794 rows. 
GCS parquet loaded successfully.
finished all
gsutil rm gs://arachne_duckdb//duck_table_86_0
DROP TABLE tpcds.duck_table_86_0
moved table: duck_table_86_0
Total runtime(seconds): 575.267422842, Query time: 418.527930641, Move time: 156.739492201, cost($): 0.23649882939060002
finished query
STARTING QRY: SELECT total_sum, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN g_class = 0 THEN i_category ELSE NULL END ORDER BY total_sum IS NULL DESC, total_sum DESC) AS rank_within_parent, CASE WHEN lochierarchy = 0 THEN i_category ELSE NULL END
FROM (SELECT *
FROM (SELECT SUM(duck_table_86_0.ws_net_paid) AS total_sum, t.i_category, t.i_class, 0 AS g_category, 0 AS g_class, 0 AS lochierarchy
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_0
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t ON duck_table_86_0.ws_item_sk = t.i_item_sk
GROUP BY t.i_category, t.i_class
UNION DISTINCT
SELECT SUM(t6.total_sum) AS total_sum, t6.i_category, CAST(NULL AS STRING) AS i_class, 0 AS g_category, 1 AS g_class, 1 AS lochierarchy
FROM (SELECT t3.i_category, SUM(duck_table_86_00.ws_net_paid) AS total_sum
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_00
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t3 ON duck_table_86_00.ws_item_sk = t3.i_item_sk
GROUP BY t3.i_category, t3.i_class) AS t6
GROUP BY t6.i_category)
UNION DISTINCT
SELECT SUM(t13.total_sum) AS total_sum, CAST(NULL AS STRING) AS i_category, CAST(NULL AS STRING) AS i_class, 1 AS g_category, 1 AS g_class, 2 AS lochierarchy
FROM (SELECT SUM(duck_table_86_01.ws_net_paid) AS total_sum
FROM `arachne-multicloud.tpcds.duck_table_86_0` AS duck_table_86_01
INNER JOIN (SELECT i_item_sk, i_class, i_category
FROM `arachne-multicloud.tpcds.item` AS item) AS t10 ON duck_table_86_01.ws_item_sk = t10.i_item_sk
GROUP BY t10.i_category, t10.i_class) AS t13) AS t16
ORDER BY lochierarchy IS NULL DESC, lochierarchy DESC, CASE WHEN lochierarchy = 0 THEN i_category ELSE NULL END, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN g_class = 0 THEN i_category ELSE NULL END ORDER BY total_sum IS NULL DESC, total_sum DESC)
LIMIT 100

Query performed successfully.
Total bytes billed: 9286189056, cost: 0.04222869873046875
finished query. now moving
Total runtime(seconds): 5.63045402, cost($): 0.04222869873046875
finished query
CTAS: duck_table_86_0 SRC: GCP DEST: BQ NUM INPUTS: 0 RUNTIME: 575.267422842 CARDINALITY: -1 COST: 0.23649882939060002
CTAS: null SRC: BQ DEST: null NUM INPUTS: 0 RUNTIME: 5.63045402 CARDINALITY: -1 COST: 0.04222869873046875
node id: 9
hybrid cost: $0.27872752812106877
min baseline cost: $0.6087741143658744
real savings: $0.3300465862448056
TOTAL COST OF ARACHNE PLAN: $0.27872752812106877, MIN BASELINE: $0.6087741143658744
total cost: 86,0.27872752812106877,0.6319473089941661,0.6087741143658744,3.21814453125
total runtime: 580.897876862(seconds)
FOUND PLAN
node id: 9
estimated savings: $0.36612641525387213
min baseline cost: $0.6087741143658744
estimated cost for cut but no movement: $0.4597918917725445
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  09:44 min
[[1;34mINFO[m] Finished at: 2022-11-27T06:03:58Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
-Dexec.args="single duck tpcds 86 1.48 0.0 7"
-Dexec.args="single duck tpcds 86 1.48 0.0 8"
-Dexec.args="single duck tpcds 86 1.48 0.0 9"
-Dexec.args="single duck tpcds 86 1.48 0.0 10"
-Dexec.args="single duck tpcds 86 1.48 0.0 11"
-Dexec.args="single duck tpcds 86 1.48 0.0 12"
-Dexec.args="single duck tpcds 86 1.48 0.0 13"
-Dexec.args="single duck tpcds 86 1.48 0.0 14"
-Dexec.args="single duck tpcds 86 1.48 0.0 15"
-Dexec.args="single duck tpcds 86 1.48 0.0 16"
-Dexec.args="single duck tpcds 86 1.48 0.0 17"
-Dexec.args="single duck tpcds 86 1.48 0.0 18"
-Dexec.args="single duck tpcds 86 1.48 0.0 19"
