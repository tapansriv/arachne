CREATE TABLE duck_table_167_0 AS SELECT "d_date_sk", "d_month_seq", "d_year", "d_moy", "d_qoy"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11
;
SELECT *
FROM (SELECT "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", RANK() OVER (PARTITION BY "i_category" ORDER BY "sumsales" DESC) AS "rk"
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT "t4"."i_category", "t4"."i_class", "t4"."i_brand", "t4"."i_product_name", "t3"."d_year", "t3"."d_qoy", "t3"."d_moy", "t3"."wp_web_page_id", SUM("t3"."*") AS "sumsales"
FROM (SELECT "t1"."ws_item_sk", "t1"."d_year", "t1"."d_moy", "t1"."d_qoy", "t2"."wp_web_page_id", "t1"."*" AS "*"
FROM (SELECT "t"."ws_item_sk", "t"."ws_web_page_sk", "t0"."d_year", "t0"."d_moy", "t0"."d_qoy", "t"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t0" ON "t"."ws_sold_date_sk" = "t0"."d_date_sk") AS "t1"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t2" ON "t1"."ws_web_page_sk" = "t2"."wp_web_page_sk") AS "t3"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t4" ON "t3"."ws_item_sk" = "t4"."i_item_sk"
GROUP BY "t4"."i_category", "t4"."i_class", "t4"."i_brand", "t4"."i_product_name", "t3"."d_year", "t3"."d_qoy", "t3"."d_moy", "t3"."wp_web_page_id"
UNION ALL
SELECT "t16"."i_category", "t16"."i_class", "t16"."i_brand", "t16"."i_product_name", "t16"."d_year", "t16"."d_qoy", "t16"."d_moy", NULL AS "wp_web_page_id", SUM("t16"."sumsales") AS "sumsales"
FROM (SELECT "t13"."i_category", "t13"."i_class", "t13"."i_brand", "t13"."i_product_name", "t12"."d_year", "t12"."d_qoy", "t12"."d_moy", SUM("t12"."*") AS "sumsales"
FROM (SELECT "t10"."ws_item_sk", "t10"."d_year", "t10"."d_moy", "t10"."d_qoy", "t11"."wp_web_page_id", "t10"."*" AS "*"
FROM (SELECT "t8"."ws_item_sk", "t8"."ws_web_page_sk", "t9"."d_year", "t9"."d_moy", "t9"."d_qoy", "t8"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t8"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t9" ON "t8"."ws_sold_date_sk" = "t9"."d_date_sk") AS "t10"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t11" ON "t10"."ws_web_page_sk" = "t11"."wp_web_page_sk") AS "t12"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t13" ON "t12"."ws_item_sk" = "t13"."i_item_sk"
GROUP BY "t13"."i_category", "t13"."i_class", "t13"."i_brand", "t13"."i_product_name", "t12"."d_year", "t12"."d_qoy", "t12"."d_moy", "t12"."wp_web_page_id") AS "t16"
GROUP BY "t16"."i_category", "t16"."i_class", "t16"."i_brand", "t16"."i_product_name", "t16"."d_year", "t16"."d_qoy", "t16"."d_moy") AS "t"
UNION ALL
SELECT "t28"."i_category", "t28"."i_class", "t28"."i_brand", "t28"."i_product_name", "t28"."d_year", "t28"."d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t28"."sumsales") AS "sumsales"
FROM (SELECT "t25"."i_category", "t25"."i_class", "t25"."i_brand", "t25"."i_product_name", "t24"."d_year", "t24"."d_qoy", SUM("t24"."*") AS "sumsales"
FROM (SELECT "t22"."ws_item_sk", "t22"."d_year", "t22"."d_moy", "t22"."d_qoy", "t23"."wp_web_page_id", "t22"."*" AS "*"
FROM (SELECT "t20"."ws_item_sk", "t20"."ws_web_page_sk", "t21"."d_year", "t21"."d_moy", "t21"."d_qoy", "t20"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t20"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t21" ON "t20"."ws_sold_date_sk" = "t21"."d_date_sk") AS "t22"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t23" ON "t22"."ws_web_page_sk" = "t23"."wp_web_page_sk") AS "t24"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t25" ON "t24"."ws_item_sk" = "t25"."i_item_sk"
GROUP BY "t25"."i_category", "t25"."i_class", "t25"."i_brand", "t25"."i_product_name", "t24"."d_year", "t24"."d_qoy", "t24"."d_moy", "t24"."wp_web_page_id") AS "t28"
GROUP BY "t28"."i_category", "t28"."i_class", "t28"."i_brand", "t28"."i_product_name", "t28"."d_year", "t28"."d_qoy") AS "t"
UNION ALL
SELECT "t40"."i_category", "t40"."i_class", "t40"."i_brand", "t40"."i_product_name", "t40"."d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t40"."sumsales") AS "sumsales"
FROM (SELECT "t37"."i_category", "t37"."i_class", "t37"."i_brand", "t37"."i_product_name", "t36"."d_year", SUM("t36"."*") AS "sumsales"
FROM (SELECT "t34"."ws_item_sk", "t34"."d_year", "t34"."d_moy", "t34"."d_qoy", "t35"."wp_web_page_id", "t34"."*" AS "*"
FROM (SELECT "t32"."ws_item_sk", "t32"."ws_web_page_sk", "t33"."d_year", "t33"."d_moy", "t33"."d_qoy", "t32"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t32"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t33" ON "t32"."ws_sold_date_sk" = "t33"."d_date_sk") AS "t34"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t35" ON "t34"."ws_web_page_sk" = "t35"."wp_web_page_sk") AS "t36"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t37" ON "t36"."ws_item_sk" = "t37"."i_item_sk"
GROUP BY "t37"."i_category", "t37"."i_class", "t37"."i_brand", "t37"."i_product_name", "t36"."d_year", "t36"."d_qoy", "t36"."d_moy", "t36"."wp_web_page_id") AS "t40"
GROUP BY "t40"."i_category", "t40"."i_class", "t40"."i_brand", "t40"."i_product_name", "t40"."d_year") AS "t"
UNION ALL
SELECT "t52"."i_category", "t52"."i_class", "t52"."i_brand", "t52"."i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t52"."sumsales") AS "sumsales"
FROM (SELECT "t49"."i_category", "t49"."i_class", "t49"."i_brand", "t49"."i_product_name", SUM("t48"."*") AS "sumsales"
FROM (SELECT "t46"."ws_item_sk", "t46"."d_year", "t46"."d_moy", "t46"."d_qoy", "t47"."wp_web_page_id", "t46"."*" AS "*"
FROM (SELECT "t44"."ws_item_sk", "t44"."ws_web_page_sk", "t45"."d_year", "t45"."d_moy", "t45"."d_qoy", "t44"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t44"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t45" ON "t44"."ws_sold_date_sk" = "t45"."d_date_sk") AS "t46"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t47" ON "t46"."ws_web_page_sk" = "t47"."wp_web_page_sk") AS "t48"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t49" ON "t48"."ws_item_sk" = "t49"."i_item_sk"
GROUP BY "t49"."i_category", "t49"."i_class", "t49"."i_brand", "t49"."i_product_name", "t48"."d_year", "t48"."d_qoy", "t48"."d_moy", "t48"."wp_web_page_id") AS "t52"
GROUP BY "t52"."i_category", "t52"."i_class", "t52"."i_brand", "t52"."i_product_name") AS "t"
UNION ALL
SELECT "t64"."i_category", "t64"."i_class", "t64"."i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t64"."sumsales") AS "sumsales"
FROM (SELECT "t61"."i_category", "t61"."i_class", "t61"."i_brand", SUM("t60"."*") AS "sumsales"
FROM (SELECT "t58"."ws_item_sk", "t58"."d_year", "t58"."d_moy", "t58"."d_qoy", "t59"."wp_web_page_id", "t58"."*" AS "*"
FROM (SELECT "t56"."ws_item_sk", "t56"."ws_web_page_sk", "t57"."d_year", "t57"."d_moy", "t57"."d_qoy", "t56"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t56"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t57" ON "t56"."ws_sold_date_sk" = "t57"."d_date_sk") AS "t58"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t59" ON "t58"."ws_web_page_sk" = "t59"."wp_web_page_sk") AS "t60"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t61" ON "t60"."ws_item_sk" = "t61"."i_item_sk"
GROUP BY "t61"."i_category", "t61"."i_class", "t61"."i_brand", "t61"."i_product_name", "t60"."d_year", "t60"."d_qoy", "t60"."d_moy", "t60"."wp_web_page_id") AS "t64"
GROUP BY "t64"."i_category", "t64"."i_class", "t64"."i_brand") AS "t"
UNION ALL
SELECT "t76"."i_category", "t76"."i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t76"."sumsales") AS "sumsales"
FROM (SELECT "t73"."i_category", "t73"."i_class", SUM("t72"."*") AS "sumsales"
FROM (SELECT "t70"."ws_item_sk", "t70"."d_year", "t70"."d_moy", "t70"."d_qoy", "t71"."wp_web_page_id", "t70"."*" AS "*"
FROM (SELECT "t68"."ws_item_sk", "t68"."ws_web_page_sk", "t69"."d_year", "t69"."d_moy", "t69"."d_qoy", "t68"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t68"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t69" ON "t68"."ws_sold_date_sk" = "t69"."d_date_sk") AS "t70"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t71" ON "t70"."ws_web_page_sk" = "t71"."wp_web_page_sk") AS "t72"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t73" ON "t72"."ws_item_sk" = "t73"."i_item_sk"
GROUP BY "t73"."i_category", "t73"."i_class", "t73"."i_brand", "t73"."i_product_name", "t72"."d_year", "t72"."d_qoy", "t72"."d_moy", "t72"."wp_web_page_id") AS "t76"
GROUP BY "t76"."i_category", "t76"."i_class") AS "t"
UNION ALL
SELECT "t88"."i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t88"."sumsales") AS "sumsales"
FROM (SELECT "t85"."i_category", SUM("t84"."*") AS "sumsales"
FROM (SELECT "t82"."ws_item_sk", "t82"."d_year", "t82"."d_moy", "t82"."d_qoy", "t83"."wp_web_page_id", "t82"."*" AS "*"
FROM (SELECT "t80"."ws_item_sk", "t80"."ws_web_page_sk", "t81"."d_year", "t81"."d_moy", "t81"."d_qoy", "t80"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t80"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t81" ON "t80"."ws_sold_date_sk" = "t81"."d_date_sk") AS "t82"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t83" ON "t82"."ws_web_page_sk" = "t83"."wp_web_page_sk") AS "t84"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t85" ON "t84"."ws_item_sk" = "t85"."i_item_sk"
GROUP BY "t85"."i_category", "t85"."i_class", "t85"."i_brand", "t85"."i_product_name", "t84"."d_year", "t84"."d_qoy", "t84"."d_moy", "t84"."wp_web_page_id") AS "t88"
GROUP BY "t88"."i_category") AS "t"
UNION ALL
SELECT NULL AS "i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t100"."sumsales") AS "sumsales"
FROM (SELECT SUM("t96"."*") AS "sumsales"
FROM (SELECT "t94"."ws_item_sk", "t94"."d_year", "t94"."d_moy", "t94"."d_qoy", "t95"."wp_web_page_id", "t94"."*" AS "*"
FROM (SELECT "t92"."ws_item_sk", "t92"."ws_web_page_sk", "t93"."d_year", "t93"."d_moy", "t93"."d_qoy", "t92"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t92"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t93" ON "t92"."ws_sold_date_sk" = "t93"."d_date_sk") AS "t94"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t95" ON "t94"."ws_web_page_sk" = "t95"."wp_web_page_sk") AS "t96"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t97" ON "t96"."ws_item_sk" = "t97"."i_item_sk"
GROUP BY "t97"."i_category", "t97"."i_class", "t97"."i_brand", "t97"."i_product_name", "t96"."d_year", "t96"."d_qoy", "t96"."d_moy", "t96"."wp_web_page_id") AS "t100") AS "t103") AS "t104"
WHERE "rk" <= 100
ORDER BY "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", "rk"
FETCH NEXT 100 ROWS ONLY
;
