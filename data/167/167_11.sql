CREATE TABLE duck_table_167_0 AS SELECT *
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_month_seq" >= 1200 AND "d_month_seq" <= 1200 + 11
;
SELECT *
FROM (SELECT "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", RANK() OVER (PARTITION BY "i_category" ORDER BY "sumsales" DESC) AS "rk"
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT *
FROM (SELECT "t5"."i_category", "t5"."i_class", "t5"."i_brand", "t5"."i_product_name", "t4"."d_year", "t4"."d_qoy", "t4"."d_moy", "t4"."wp_web_page_id", SUM("t4"."*") AS "sumsales"
FROM (SELECT "t2"."ws_item_sk", "t2"."d_year", "t2"."d_moy", "t2"."d_qoy", "t3"."wp_web_page_id", "t2"."*" AS "*"
FROM (SELECT "t"."ws_item_sk", "t"."ws_web_page_sk", "t1"."d_year", "t1"."d_moy", "t1"."d_qoy", "t"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t1" ON "t"."ws_sold_date_sk" = "t1"."d_date_sk") AS "t2"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t3" ON "t2"."ws_web_page_sk" = "t3"."wp_web_page_sk") AS "t4"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t5" ON "t4"."ws_item_sk" = "t5"."i_item_sk"
GROUP BY "t5"."i_category", "t5"."i_class", "t5"."i_brand", "t5"."i_product_name", "t4"."d_year", "t4"."d_qoy", "t4"."d_moy", "t4"."wp_web_page_id"
UNION ALL
SELECT "t18"."i_category", "t18"."i_class", "t18"."i_brand", "t18"."i_product_name", "t18"."d_year", "t18"."d_qoy", "t18"."d_moy", NULL AS "wp_web_page_id", SUM("t18"."sumsales") AS "sumsales"
FROM (SELECT "t15"."i_category", "t15"."i_class", "t15"."i_brand", "t15"."i_product_name", "t14"."d_year", "t14"."d_qoy", "t14"."d_moy", SUM("t14"."*") AS "sumsales"
FROM (SELECT "t12"."ws_item_sk", "t12"."d_year", "t12"."d_moy", "t12"."d_qoy", "t13"."wp_web_page_id", "t12"."*" AS "*"
FROM (SELECT "t9"."ws_item_sk", "t9"."ws_web_page_sk", "t11"."d_year", "t11"."d_moy", "t11"."d_qoy", "t9"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t9"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t11" ON "t9"."ws_sold_date_sk" = "t11"."d_date_sk") AS "t12"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t13" ON "t12"."ws_web_page_sk" = "t13"."wp_web_page_sk") AS "t14"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t15" ON "t14"."ws_item_sk" = "t15"."i_item_sk"
GROUP BY "t15"."i_category", "t15"."i_class", "t15"."i_brand", "t15"."i_product_name", "t14"."d_year", "t14"."d_qoy", "t14"."d_moy", "t14"."wp_web_page_id") AS "t18"
GROUP BY "t18"."i_category", "t18"."i_class", "t18"."i_brand", "t18"."i_product_name", "t18"."d_year", "t18"."d_qoy", "t18"."d_moy") AS "t"
UNION ALL
SELECT "t31"."i_category", "t31"."i_class", "t31"."i_brand", "t31"."i_product_name", "t31"."d_year", "t31"."d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t31"."sumsales") AS "sumsales"
FROM (SELECT "t28"."i_category", "t28"."i_class", "t28"."i_brand", "t28"."i_product_name", "t27"."d_year", "t27"."d_qoy", SUM("t27"."*") AS "sumsales"
FROM (SELECT "t25"."ws_item_sk", "t25"."d_year", "t25"."d_moy", "t25"."d_qoy", "t26"."wp_web_page_id", "t25"."*" AS "*"
FROM (SELECT "t22"."ws_item_sk", "t22"."ws_web_page_sk", "t24"."d_year", "t24"."d_moy", "t24"."d_qoy", "t22"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t22"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t24" ON "t22"."ws_sold_date_sk" = "t24"."d_date_sk") AS "t25"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t26" ON "t25"."ws_web_page_sk" = "t26"."wp_web_page_sk") AS "t27"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t28" ON "t27"."ws_item_sk" = "t28"."i_item_sk"
GROUP BY "t28"."i_category", "t28"."i_class", "t28"."i_brand", "t28"."i_product_name", "t27"."d_year", "t27"."d_qoy", "t27"."d_moy", "t27"."wp_web_page_id") AS "t31"
GROUP BY "t31"."i_category", "t31"."i_class", "t31"."i_brand", "t31"."i_product_name", "t31"."d_year", "t31"."d_qoy") AS "t"
UNION ALL
SELECT "t44"."i_category", "t44"."i_class", "t44"."i_brand", "t44"."i_product_name", "t44"."d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t44"."sumsales") AS "sumsales"
FROM (SELECT "t41"."i_category", "t41"."i_class", "t41"."i_brand", "t41"."i_product_name", "t40"."d_year", SUM("t40"."*") AS "sumsales"
FROM (SELECT "t38"."ws_item_sk", "t38"."d_year", "t38"."d_moy", "t38"."d_qoy", "t39"."wp_web_page_id", "t38"."*" AS "*"
FROM (SELECT "t35"."ws_item_sk", "t35"."ws_web_page_sk", "t37"."d_year", "t37"."d_moy", "t37"."d_qoy", "t35"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t35"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t37" ON "t35"."ws_sold_date_sk" = "t37"."d_date_sk") AS "t38"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t39" ON "t38"."ws_web_page_sk" = "t39"."wp_web_page_sk") AS "t40"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t41" ON "t40"."ws_item_sk" = "t41"."i_item_sk"
GROUP BY "t41"."i_category", "t41"."i_class", "t41"."i_brand", "t41"."i_product_name", "t40"."d_year", "t40"."d_qoy", "t40"."d_moy", "t40"."wp_web_page_id") AS "t44"
GROUP BY "t44"."i_category", "t44"."i_class", "t44"."i_brand", "t44"."i_product_name", "t44"."d_year") AS "t"
UNION ALL
SELECT "t57"."i_category", "t57"."i_class", "t57"."i_brand", "t57"."i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t57"."sumsales") AS "sumsales"
FROM (SELECT "t54"."i_category", "t54"."i_class", "t54"."i_brand", "t54"."i_product_name", SUM("t53"."*") AS "sumsales"
FROM (SELECT "t51"."ws_item_sk", "t51"."d_year", "t51"."d_moy", "t51"."d_qoy", "t52"."wp_web_page_id", "t51"."*" AS "*"
FROM (SELECT "t48"."ws_item_sk", "t48"."ws_web_page_sk", "t50"."d_year", "t50"."d_moy", "t50"."d_qoy", "t48"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t48"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t50" ON "t48"."ws_sold_date_sk" = "t50"."d_date_sk") AS "t51"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t52" ON "t51"."ws_web_page_sk" = "t52"."wp_web_page_sk") AS "t53"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t54" ON "t53"."ws_item_sk" = "t54"."i_item_sk"
GROUP BY "t54"."i_category", "t54"."i_class", "t54"."i_brand", "t54"."i_product_name", "t53"."d_year", "t53"."d_qoy", "t53"."d_moy", "t53"."wp_web_page_id") AS "t57"
GROUP BY "t57"."i_category", "t57"."i_class", "t57"."i_brand", "t57"."i_product_name") AS "t"
UNION ALL
SELECT "t70"."i_category", "t70"."i_class", "t70"."i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t70"."sumsales") AS "sumsales"
FROM (SELECT "t67"."i_category", "t67"."i_class", "t67"."i_brand", SUM("t66"."*") AS "sumsales"
FROM (SELECT "t64"."ws_item_sk", "t64"."d_year", "t64"."d_moy", "t64"."d_qoy", "t65"."wp_web_page_id", "t64"."*" AS "*"
FROM (SELECT "t61"."ws_item_sk", "t61"."ws_web_page_sk", "t63"."d_year", "t63"."d_moy", "t63"."d_qoy", "t61"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t61"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t63" ON "t61"."ws_sold_date_sk" = "t63"."d_date_sk") AS "t64"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t65" ON "t64"."ws_web_page_sk" = "t65"."wp_web_page_sk") AS "t66"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t67" ON "t66"."ws_item_sk" = "t67"."i_item_sk"
GROUP BY "t67"."i_category", "t67"."i_class", "t67"."i_brand", "t67"."i_product_name", "t66"."d_year", "t66"."d_qoy", "t66"."d_moy", "t66"."wp_web_page_id") AS "t70"
GROUP BY "t70"."i_category", "t70"."i_class", "t70"."i_brand") AS "t"
UNION ALL
SELECT "t83"."i_category", "t83"."i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t83"."sumsales") AS "sumsales"
FROM (SELECT "t80"."i_category", "t80"."i_class", SUM("t79"."*") AS "sumsales"
FROM (SELECT "t77"."ws_item_sk", "t77"."d_year", "t77"."d_moy", "t77"."d_qoy", "t78"."wp_web_page_id", "t77"."*" AS "*"
FROM (SELECT "t74"."ws_item_sk", "t74"."ws_web_page_sk", "t76"."d_year", "t76"."d_moy", "t76"."d_qoy", "t74"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t74"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t76" ON "t74"."ws_sold_date_sk" = "t76"."d_date_sk") AS "t77"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t78" ON "t77"."ws_web_page_sk" = "t78"."wp_web_page_sk") AS "t79"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t80" ON "t79"."ws_item_sk" = "t80"."i_item_sk"
GROUP BY "t80"."i_category", "t80"."i_class", "t80"."i_brand", "t80"."i_product_name", "t79"."d_year", "t79"."d_qoy", "t79"."d_moy", "t79"."wp_web_page_id") AS "t83"
GROUP BY "t83"."i_category", "t83"."i_class") AS "t"
UNION ALL
SELECT "t96"."i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t96"."sumsales") AS "sumsales"
FROM (SELECT "t93"."i_category", SUM("t92"."*") AS "sumsales"
FROM (SELECT "t90"."ws_item_sk", "t90"."d_year", "t90"."d_moy", "t90"."d_qoy", "t91"."wp_web_page_id", "t90"."*" AS "*"
FROM (SELECT "t87"."ws_item_sk", "t87"."ws_web_page_sk", "t89"."d_year", "t89"."d_moy", "t89"."d_qoy", "t87"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t87"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t89" ON "t87"."ws_sold_date_sk" = "t89"."d_date_sk") AS "t90"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t91" ON "t90"."ws_web_page_sk" = "t91"."wp_web_page_sk") AS "t92"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t93" ON "t92"."ws_item_sk" = "t93"."i_item_sk"
GROUP BY "t93"."i_category", "t93"."i_class", "t93"."i_brand", "t93"."i_product_name", "t92"."d_year", "t92"."d_qoy", "t92"."d_moy", "t92"."wp_web_page_id") AS "t96"
GROUP BY "t96"."i_category") AS "t"
UNION ALL
SELECT NULL AS "i_category", NULL AS "i_class", NULL AS "i_brand", NULL AS "i_product_name", NULL AS "d_year", NULL AS "d_qoy", NULL AS "d_moy", NULL AS "wp_web_page_id", SUM("t109"."sumsales") AS "sumsales"
FROM (SELECT SUM("t105"."*") AS "sumsales"
FROM (SELECT "t103"."ws_item_sk", "t103"."d_year", "t103"."d_moy", "t103"."d_qoy", "t104"."wp_web_page_id", "t103"."*" AS "*"
FROM (SELECT "t100"."ws_item_sk", "t100"."ws_web_page_sk", "t102"."d_year", "t102"."d_moy", "t102"."d_qoy", "t100"."*" AS "*"
FROM (SELECT "ws_sold_date_sk", "ws_item_sk", "ws_web_page_sk", "ws_sales_price" * "ws_quantity" AS "*"
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales) AS "t100"
INNER JOIN (SELECT "d_date_sk", "d_year", "d_moy", "d_qoy"
FROM "duck_table_167_0") AS "t102" ON "t100"."ws_sold_date_sk" = "t102"."d_date_sk") AS "t103"
INNER JOIN (SELECT "wp_web_page_sk", "wp_web_page_id"
FROM '/mnt/disks/tpcds/parquet/web_page.parquet' AS web_page) AS "t104" ON "t103"."ws_web_page_sk" = "t104"."wp_web_page_sk") AS "t105"
INNER JOIN (SELECT "i_item_sk", "i_brand", "i_class", "i_category", "i_product_name"
FROM '/mnt/disks/tpcds/parquet/item.parquet' AS item) AS "t106" ON "t105"."ws_item_sk" = "t106"."i_item_sk"
GROUP BY "t106"."i_category", "t106"."i_class", "t106"."i_brand", "t106"."i_product_name", "t105"."d_year", "t105"."d_qoy", "t105"."d_moy", "t105"."wp_web_page_id") AS "t109") AS "t112") AS "t113"
WHERE "rk" <= 100
ORDER BY "i_category", "i_class", "i_brand", "i_product_name", "d_year", "d_qoy", "d_moy", "wp_web_page_id", "sumsales", "rk"
FETCH NEXT 100 ROWS ONLY
;
