-Dexec.args="single duck 49 1.48 0.0"
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)
WARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------< [0;36morg.arachne:arachne[0;1m >-------------------------[m
[[1;34mINFO[m] [1mBuilding arachne 1.0-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mexec-maven-plugin:3.0.0:java[m [1m(default-cli)[m @ [36marachne[0;1m ---[m
GCP
49 1.48 0.0 GCP

SELECT channel,
       item,
       return_ratio,
       return_rank,
       currency_rank
FROM
  (SELECT 'web' AS channel,
          web.item,
          web.return_ratio,
          web.return_rank,
          web.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT ws.ws_item_sk AS item,
                (cast(sum(coalesce(wr.wr_return_quantity,0)) AS decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(wr.wr_return_amt,0)) AS decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' ws
         LEFT OUTER JOIN '/mnt/disks/tpcds/parquet/web_returns.parquet' wr ON (ws.ws_order_number = wr.wr_order_number
                                            AND ws.ws_item_sk = wr.wr_item_sk) ,'/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
         WHERE wr.wr_return_amt > 10000
           AND ws.ws_net_profit > 1
           AND ws.ws_net_paid > 0
           AND ws.ws_quantity > 0
           AND ws_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY ws.ws_item_sk) in_web) web
   WHERE (web.return_rank <= 10
          OR web.currency_rank <= 10)
   UNION SELECT 'catalog' AS channel,
                catalog.item,
                catalog.return_ratio,
                catalog.return_rank,
                catalog.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT cs.cs_item_sk AS item,
                (cast(sum(coalesce(cr.cr_return_quantity,0)) AS decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(cr.cr_return_amount,0)) AS decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' cs
         LEFT OUTER JOIN '/mnt/disks/tpcds/parquet/catalog_returns.parquet' cr ON (cs.cs_order_number = cr.cr_order_number
                                                AND cs.cs_item_sk = cr.cr_item_sk) ,'/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
         WHERE cr.cr_return_amount > 10000
           AND cs.cs_net_profit > 1
           AND cs.cs_net_paid > 0
           AND cs.cs_quantity > 0
           AND cs_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY cs.cs_item_sk) in_cat) CATALOG
   WHERE (catalog.return_rank <= 10
          OR catalog.currency_rank <=10)
   UNION SELECT 'store' AS channel,
                store.item,
                store.return_ratio,
                store.return_rank,
                store.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT sts.ss_item_sk AS item,
                (cast(sum(coalesce(sr.sr_return_quantity,0)) AS decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(sr.sr_return_amt,0)) AS decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' sts
         LEFT OUTER JOIN '/mnt/disks/tpcds/parquet/store_returns.parquet' sr ON (sts.ss_ticket_number = sr.sr_ticket_number
                                              AND sts.ss_item_sk = sr.sr_item_sk) ,'/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
         WHERE sr.sr_return_amt > 10000
           AND sts.ss_net_profit > 1
           AND sts.ss_net_paid > 0
           AND sts.ss_quantity > 0
           AND ss_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY sts.ss_item_sk) in_store) store
   WHERE (store.return_rank <= 10
          OR store.currency_rank <= 10) ) sq1
ORDER BY 1 NULLS FIRST,
         4 NULLS FIRST,
         5 NULLS FIRST,
         2 NULLS FIRST
LIMIT 100;

BASE:
501:ProfileSort(sort0=[$0], sort1=[$3], sort2=[$4], sort3=[$1], dir0=[ASC-nulls-first], dir1=[ASC-nulls-first], dir2=[ASC-nulls-first], dir3=[ASC-nulls-first], fetch=[100]): rowcount = 100.0, cumulative cost = {100.0 rows, 5.716155339693007E8 cpu, 0.0 io, 0.0 money}
  556:ProfileProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 3878898.0027038767, cumulative cost = {3878898.0027038767 rows, 1.9394490013519384E7 cpu, 0.0 io, 0.0 money}
    557:ProfileUnion(all=[false]): rowcount = 3878898.0027038767, cumulative cost = {3878898.0027038767 rows, 3878898.0027038767 cpu, 0.0 io, 0.0 money}
      612:ProfileUnion(all=[false]): rowcount = 4992460.384141982, cumulative cost = {4992460.384141982 rows, 4992460.384141982 cpu, 0.0 io, 0.0 money}
        666:ProfileProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 6.163509374999999, cumulative cost = {6.163509374999999 rows, 30.817546874999998 cpu, 0.0 io, 0.0 money}
          683:ProfileProject(item=[$0], return_ratio=[$1], return_rank=[$3], currency_rank=[$4]): rowcount = 6.163509374999999, cumulative cost = {6.163509374999999 rows, 24.654037499999998 cpu, 0.0 io, 0.0 money}
            699:ProfileFilter(condition=[OR(<=($3, 10), <=($4, 10))]): rowcount = 6.163509374999999, cumulative cost = {6.163509374999999 rows, 24.654037499999998 cpu, 0.0 io, 0.0 money}
              714:ProfileProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL)], currency_ratio=[/(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL)], return_rank=[RANK() OVER (ORDER BY /(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL))], currency_rank=[RANK() OVER (ORDER BY /(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL))]): rowcount = 24.654037499999998, cumulative cost = {24.654037499999998 rows, 123.27018749999999 cpu, 0.0 io, 0.0 money}
                728:ProfileAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)], agg#2=[SUM($3)], agg#3=[SUM($4)]): rowcount = 24.654037499999998, cumulative cost = {38.21376282738447 rows, 0.0 cpu, 0.0 io, 0.0 money}
                  741:ProfileProject(item=[$1], $f1=[$4], $f2=[$2], $f3=[$5], $f4=[$3]): rowcount = 246.54037499999998, cumulative cost = {246.54037499999998 rows, 1232.701875 cpu, 0.0 io, 0.0 money}
                    754:ProfileJoin(condition=[=($0, $6)], joinType=[inner]): rowcount = 246.54037499999998, cumulative cost = {246.54037499999998 rows, 0.0 cpu, 0.0 io, 0.0 money}
                      762:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_quantity=[$2], ws_net_paid=[$3], CASE=[CASE(IS NOT NULL($4), $6, 0)], CASE5=[CASE(IS NOT NULL($5), $7, 0:DECIMAL(19, 0))]): rowcount = 1.0, cumulative cost = {1.0 rows, 6.0 cpu, 0.0 io, 0.0 money}
                        769:ProfileProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_quantity=[$18], ws_net_paid=[$29], wr_return_quantity=[$48], wr_return_amt=[$49], CAST=[CAST($48):INTEGER NOT NULL], CAST7=[CAST($49):DECIMAL(19, 0) NOT NULL]): rowcount = 1.0, cumulative cost = {1.0 rows, 8.0 cpu, 0.0 io, 0.0 money}
                          775:ProfileProject(ws_sold_date_sk=[$0], ws_sold_time_sk=[$1], ws_ship_date_sk=[$2], ws_item_sk=[$3], ws_bill_customer_sk=[$4], ws_bill_cdemo_sk=[$5], ws_bill_hdemo_sk=[$6], ws_bill_addr_sk=[$7], ws_ship_customer_sk=[$8], ws_ship_cdemo_sk=[$9], ws_ship_hdemo_sk=[$10], ws_ship_addr_sk=[$11], ws_web_page_sk=[$12], ws_web_site_sk=[$13], ws_ship_mode_sk=[$14], ws_warehouse_sk=[$15], ws_promo_sk=[$16], ws_order_number=[$17], ws_quantity=[$18], ws_wholesale_cost=[$19], ws_list_price=[$20], ws_sales_price=[$21], ws_ext_discount_amt=[$22], ws_ext_sales_price=[$23], ws_ext_wholesale_cost=[$24], ws_ext_list_price=[$25], ws_ext_tax=[$26], ws_coupon_amt=[$27], ws_ext_ship_cost=[$28], ws_net_paid=[$29], ws_net_paid_inc_tax=[$30], ws_net_paid_inc_ship=[$31], ws_net_paid_inc_ship_tax=[$32], ws_net_profit=[$33], wr_returned_date_sk=[$36], wr_returned_time_sk=[$37], wr_item_sk=[$38], wr_refunded_customer_sk=[$39], wr_refunded_cdemo_sk=[$40], wr_refunded_hdemo_sk=[$41], wr_refunded_addr_sk=[$42], wr_returning_customer_sk=[$43], wr_returning_cdemo_sk=[$44], wr_returning_hdemo_sk=[$45], wr_returning_addr_sk=[$46], wr_web_page_sk=[$47], wr_reason_sk=[$48], wr_order_number=[$49], wr_return_quantity=[$50], wr_return_amt=[$51], wr_return_tax=[$52], wr_return_amt_inc_tax=[$53], wr_fee=[$54], wr_return_ship_cost=[$55], wr_refunded_cash=[$56], wr_reversed_charge=[$57], wr_account_credit=[$58], wr_net_loss=[$59]): rowcount = 1.0, cumulative cost = {1.0 rows, 58.0 cpu, 0.0 io, 0.0 money}
                            781:ProfileJoin(condition=[AND(=($17, $35), =($3, $34))], joinType=[inner]): rowcount = 1.0, cumulative cost = {1.0 rows, 0.0 cpu, 0.0 io, 0.0 money}
                              783:ProfileFilter(condition=[AND(>($33, 1), >($29, 0), >($18, 0))]): rowcount = 1.0, cumulative cost = {1.0 rows, 1.0 cpu, 0.0 io, 0.0 money}
                                784:ProfileTableScan(table=[[tpcds, web_sales]]): rowcount = 1.0, cumulative cost = {1.0 rows, 2.0 cpu, 0.0 io, 0.0 money}
                              787:ProfileProject(wr_item_sk=[$2], wr_order_number=[$13], CAST=[CAST($0):INTEGER], CAST3=[CAST($1):INTEGER], CAST4=[CAST($2):INTEGER], CAST5=[CAST($3):INTEGER], CAST6=[CAST($4):INTEGER], CAST7=[CAST($5):INTEGER], CAST8=[CAST($6):INTEGER], CAST9=[CAST($7):INTEGER], CAST10=[CAST($8):INTEGER], CAST11=[CAST($9):INTEGER], CAST12=[CAST($10):INTEGER], CAST13=[CAST($11):INTEGER], CAST14=[CAST($12):INTEGER], CAST15=[CAST($13):INTEGER], CAST16=[CAST($14):INTEGER], CAST17=[CAST($15):DECIMAL(19, 0)], CAST18=[CAST($16):DECIMAL(19, 0)], CAST19=[CAST($17):DECIMAL(19, 0)], CAST20=[CAST($18):DECIMAL(19, 0)], CAST21=[CAST($19):DECIMAL(19, 0)], CAST22=[CAST($20):DECIMAL(19, 0)], CAST23=[CAST($21):DECIMAL(19, 0)], CAST24=[CAST($22):DECIMAL(19, 0)], CAST25=[CAST($23):DECIMAL(19, 0)]): rowcount = 1.0, cumulative cost = {1.0 rows, 26.0 cpu, 0.0 io, 0.0 money}
                                789:ProfileFilter(condition=[>($15, 10000)]): rowcount = 1.0, cumulative cost = {1.0 rows, 1.0 cpu, 0.0 io, 0.0 money}
                                  790:ProfileTableScan(table=[[tpcds, web_returns]]): rowcount = 1.0, cumulative cost = {1.0 rows, 2.0 cpu, 0.0 io, 0.0 money}
                      794:ProfileProject(d_date_sk=[$0]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 1643.6025 cpu, 0.0 io, 0.0 money}
                        797:ProfileProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 4930.8075 cpu, 0.0 io, 0.0 money}
                          799:ProfileFilter(condition=[AND(=($6, 2001), =($8, 12))]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 73049.0 cpu, 0.0 io, 0.0 money}
                            800:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 73049.0, cumulative cost = {73049.0 rows, 73050.0 cpu, 0.0 io, 0.0 money}
        818:ProfileProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 9984914.604774589, cumulative cost = {9984914.604774589 rows, 4.992457302387294E7 cpu, 0.0 io, 0.0 money}
          835:ProfileProject(item=[$0], return_ratio=[$1], return_rank=[$3], currency_rank=[$4]): rowcount = 9984914.604774589, cumulative cost = {9984914.604774589 rows, 3.9939658419098355E7 cpu, 0.0 io, 0.0 money}
            851:ProfileFilter(condition=[OR(<=($3, 10), <=($4, 10))]): rowcount = 9984914.604774589, cumulative cost = {9984914.604774589 rows, 3.9939658419098355E7 cpu, 0.0 io, 0.0 money}
              866:ProfileProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL)], currency_ratio=[/(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL)], return_rank=[RANK() OVER (ORDER BY /(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL))], currency_rank=[RANK() OVER (ORDER BY /(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL))]): rowcount = 3.9939658419098355E7, cumulative cost = {3.9939658419098355E7 rows, 1.9969829209549177E8 cpu, 0.0 io, 0.0 money}
                880:ProfileAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)], agg#2=[SUM($3)], agg#3=[SUM($4)]): rowcount = 3.9939658419098355E7, cumulative cost = {6.190647816748774E7 rows, 0.0 cpu, 0.0 io, 0.0 money}
                  893:ProfileProject(item=[$1], $f1=[$4], $f2=[$2], $f3=[$5], $f4=[$3]): rowcount = 3.9939658419098353E8, cumulative cost = {3.9939658419098353E8 rows, 1.9969829209549177E9 cpu, 0.0 io, 0.0 money}
                    905:ProfileJoin(condition=[=($0, $6)], joinType=[inner]): rowcount = 3.9939658419098353E8, cumulative cost = {3.9939658419098353E8 rows, 0.0 cpu, 0.0 io, 0.0 money}
                      913:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_quantity=[$2], cs_net_paid=[$3], CASE=[CASE(IS NOT NULL($4), $6, 0)], CASE5=[CASE(IS NOT NULL($5), $7, 0:DECIMAL(19, 0))]): rowcount = 1620004.7728125, cumulative cost = {1620004.7728125 rows, 9720028.636875 cpu, 0.0 io, 0.0 money}
                        920:ProfileProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_quantity=[$18], cs_net_paid=[$29], cr_return_quantity=[$51], cr_return_amount=[$52], CAST=[CAST($51):INTEGER NOT NULL], CAST7=[CAST($52):DECIMAL(19, 0) NOT NULL]): rowcount = 1620004.7728125, cumulative cost = {1620004.7728125 rows, 1.29600381825E7 cpu, 0.0 io, 0.0 money}
                          926:ProfileProject(cs_sold_date_sk=[$0], cs_sold_time_sk=[$1], cs_ship_date_sk=[$2], cs_bill_customer_sk=[$3], cs_bill_cdemo_sk=[$4], cs_bill_hdemo_sk=[$5], cs_bill_addr_sk=[$6], cs_ship_customer_sk=[$7], cs_ship_cdemo_sk=[$8], cs_ship_hdemo_sk=[$9], cs_ship_addr_sk=[$10], cs_call_center_sk=[$11], cs_catalog_page_sk=[$12], cs_ship_mode_sk=[$13], cs_warehouse_sk=[$14], cs_item_sk=[$15], cs_promo_sk=[$16], cs_order_number=[$17], cs_quantity=[$18], cs_wholesale_cost=[$19], cs_list_price=[$20], cs_sales_price=[$21], cs_ext_discount_amt=[$22], cs_ext_sales_price=[$23], cs_ext_wholesale_cost=[$24], cs_ext_list_price=[$25], cs_ext_tax=[$26], cs_coupon_amt=[$27], cs_ext_ship_cost=[$28], cs_net_paid=[$29], cs_net_paid_inc_tax=[$30], cs_net_paid_inc_ship=[$31], cs_net_paid_inc_ship_tax=[$32], cs_net_profit=[$33], cr_returned_date_sk=[$36], cr_returned_time_sk=[$37], cr_item_sk=[$38], cr_refunded_customer_sk=[$39], cr_refunded_cdemo_sk=[$40], cr_refunded_hdemo_sk=[$41], cr_refunded_addr_sk=[$42], cr_returning_customer_sk=[$43], cr_returning_cdemo_sk=[$44], cr_returning_hdemo_sk=[$45], cr_returning_addr_sk=[$46], cr_call_center_sk=[$47], cr_catalog_page_sk=[$48], cr_ship_mode_sk=[$49], cr_warehouse_sk=[$50], cr_reason_sk=[$51], cr_order_number=[$52], cr_return_quantity=[$53], cr_return_amount=[$54], cr_return_tax=[$55], cr_return_amt_inc_tax=[$56], cr_fee=[$57], cr_return_ship_cost=[$58], cr_refunded_cash=[$59], cr_reversed_charge=[$60], cr_store_credit=[$61], cr_net_loss=[$62]): rowcount = 1620004.7728125, cumulative cost = {1620004.7728125 rows, 9.882029114156249E7 cpu, 0.0 io, 0.0 money}
                            932:ProfileJoin(condition=[AND(=($17, $35), =($15, $34))], joinType=[inner]): rowcount = 1620004.7728125, cumulative cost = {1620004.7728125 rows, 0.0 cpu, 0.0 io, 0.0 money}
                              934:ProfileFilter(condition=[AND(>($33, 1), >($29, 0), >($18, 0))]): rowcount = 7.2000212125E7, cumulative cost = {7.2000212125E7 rows, 5.76001697E8 cpu, 0.0 io, 0.0 money}
                                935:ProfileTableScan(table=[[tpcds, catalog_sales]]): rowcount = 5.76001697E8, cumulative cost = {5.76001697E8 rows, 5.76001698E8 cpu, 0.0 io, 0.0 money}
                              938:ProfileProject(cr_item_sk=[$2], cr_order_number=[$16], CAST=[CAST($0):INTEGER], CAST3=[CAST($1):INTEGER], CAST4=[CAST($2):INTEGER], CAST5=[CAST($3):INTEGER], CAST6=[CAST($4):INTEGER], CAST7=[CAST($5):INTEGER], CAST8=[CAST($6):INTEGER], CAST9=[CAST($7):INTEGER], CAST10=[CAST($8):INTEGER], CAST11=[CAST($9):INTEGER], CAST12=[CAST($10):INTEGER], CAST13=[CAST($11):INTEGER], CAST14=[CAST($12):INTEGER], CAST15=[CAST($13):INTEGER], CAST16=[CAST($14):INTEGER], CAST17=[CAST($15):INTEGER], CAST18=[CAST($16):INTEGER], CAST19=[CAST($17):INTEGER], CAST20=[CAST($18):DECIMAL(19, 0)], CAST21=[CAST($19):DECIMAL(19, 0)], CAST22=[CAST($20):DECIMAL(19, 0)], CAST23=[CAST($21):DECIMAL(19, 0)], CAST24=[CAST($22):DECIMAL(19, 0)], CAST25=[CAST($23):DECIMAL(19, 0)], CAST26=[CAST($24):DECIMAL(19, 0)], CAST27=[CAST($25):DECIMAL(19, 0)], CAST28=[CAST($26):DECIMAL(19, 0)]): rowcount = 1.0, cumulative cost = {1.0 rows, 29.0 cpu, 0.0 io, 0.0 money}
                                940:ProfileFilter(condition=[>($18, 10000)]): rowcount = 1.0, cumulative cost = {1.0 rows, 1.0 cpu, 0.0 io, 0.0 money}
                                  941:ProfileTableScan(table=[[tpcds, catalog_returns]]): rowcount = 1.0, cumulative cost = {1.0 rows, 2.0 cpu, 0.0 io, 0.0 money}
                      794:ProfileProject(d_date_sk=[$0]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 1643.6025 cpu, 0.0 io, 0.0 money}
                        797:ProfileProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 4930.8075 cpu, 0.0 io, 0.0 money}
                          799:ProfileFilter(condition=[AND(=($6, 2001), =($8, 12))]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 73049.0 cpu, 0.0 io, 0.0 money}
                            800:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 73049.0, cumulative cost = {73049.0 rows, 73050.0 cpu, 0.0 io, 0.0 money}
      959:ProfileProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 2765335.621265772, cumulative cost = {2765335.621265772 rows, 1.382667810632886E7 cpu, 0.0 io, 0.0 money}
        976:ProfileProject(item=[$0], return_ratio=[$1], return_rank=[$3], currency_rank=[$4]): rowcount = 2765335.621265772, cumulative cost = {2765335.621265772 rows, 1.1061342485063087E7 cpu, 0.0 io, 0.0 money}
          992:ProfileFilter(condition=[OR(<=($3, 10), <=($4, 10))]): rowcount = 2765335.621265772, cumulative cost = {2765335.621265772 rows, 1.1061342485063087E7 cpu, 0.0 io, 0.0 money}
            1007:ProfileProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL)], currency_ratio=[/(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL)], return_rank=[RANK() OVER (ORDER BY /(CAST($1):DECIMAL(15, 4) NOT NULL, CAST($2):DECIMAL(15, 4) NOT NULL))], currency_rank=[RANK() OVER (ORDER BY /(CAST($3):DECIMAL(15, 4) NOT NULL, CAST($4):DECIMAL(15, 4) NOT NULL))]): rowcount = 1.1061342485063087E7, cumulative cost = {1.1061342485063087E7 rows, 5.530671242531544E7 cpu, 0.0 io, 0.0 money}
              1021:ProfileAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)], agg#2=[SUM($3)], agg#3=[SUM($4)]): rowcount = 1.1061342485063087E7, cumulative cost = {1.7145082961631432E7 rows, 0.0 cpu, 0.0 io, 0.0 money}
                1034:ProfileProject(item=[$1], $f1=[$4], $f2=[$2], $f3=[$5], $f4=[$3]): rowcount = 1.1061342485063086E8, cumulative cost = {1.1061342485063086E8 rows, 5.530671242531543E8 cpu, 0.0 io, 0.0 money}
                  1046:ProfileJoin(condition=[=($0, $6)], joinType=[inner]): rowcount = 1.1061342485063086E8, cumulative cost = {1.1061342485063086E8 rows, 0.0 cpu, 0.0 io, 0.0 money}
                    1054:ProfileProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_quantity=[$2], ss_net_paid=[$3], CASE=[CASE(IS NOT NULL($4), $6, 0)], CASE5=[CASE(IS NOT NULL($5), $7, 0:DECIMAL(19, 0))]): rowcount = 448662.515625, cumulative cost = {448662.515625 rows, 2691975.09375 cpu, 0.0 io, 0.0 money}
                      1061:ProfileProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_quantity=[$10], ss_net_paid=[$20], sr_return_quantity=[$33], sr_return_amt=[$34], CAST=[CAST($33):INTEGER NOT NULL], CAST7=[CAST($34):DECIMAL(19, 0) NOT NULL]): rowcount = 448662.515625, cumulative cost = {448662.515625 rows, 3589300.125 cpu, 0.0 io, 0.0 money}
                        1067:ProfileProject(ss_sold_date_sk=[$0], ss_sold_time_sk=[$1], ss_item_sk=[$2], ss_customer_sk=[$3], ss_cdemo_sk=[$4], ss_hdemo_sk=[$5], ss_addr_sk=[$6], ss_store_sk=[$7], ss_promo_sk=[$8], ss_ticket_number=[$9], ss_quantity=[$10], ss_wholesale_cost=[$11], ss_list_price=[$12], ss_sales_price=[$13], ss_ext_discount_amt=[$14], ss_ext_sales_price=[$15], ss_ext_wholesale_cost=[$16], ss_ext_list_price=[$17], ss_ext_tax=[$18], ss_coupon_amt=[$19], ss_net_paid=[$20], ss_net_paid_inc_tax=[$21], ss_net_profit=[$22], sr_returned_date_sk=[$25], sr_return_time_sk=[$26], sr_item_sk=[$27], sr_customer_sk=[$28], sr_cdemo_sk=[$29], sr_hdemo_sk=[$30], sr_addr_sk=[$31], sr_store_sk=[$32], sr_reason_sk=[$33], sr_ticket_number=[$34], sr_return_quantity=[$35], sr_return_amt=[$36], sr_return_tax=[$37], sr_return_amt_inc_tax=[$38], sr_fee=[$39], sr_return_ship_cost=[$40], sr_refunded_cash=[$41], sr_reversed_charge=[$42], sr_store_credit=[$43], sr_net_loss=[$44]): rowcount = 448662.515625, cumulative cost = {448662.515625 rows, 1.9292488171875E7 cpu, 0.0 io, 0.0 money}
                          1073:ProfileJoin(condition=[AND(=($9, $24), =($2, $23))], joinType=[inner]): rowcount = 448662.515625, cumulative cost = {448662.515625 rows, 0.0 cpu, 0.0 io, 0.0 money}
                            1075:ProfileFilter(condition=[AND(>($22, 1), >($20, 0), >($10, 0))]): rowcount = 1.994055625E7, cumulative cost = {1.994055625E7 rows, 1.5952445E8 cpu, 0.0 io, 0.0 money}
                              1076:ProfileTableScan(table=[[tpcds, store_sales]]): rowcount = 1.5952445E8, cumulative cost = {1.5952445E8 rows, 1.59524451E8 cpu, 0.0 io, 0.0 money}
                            1079:ProfileProject(sr_item_sk=[$2], sr_ticket_number=[$9], CAST=[CAST($0):INTEGER], CAST3=[CAST($1):INTEGER], CAST4=[CAST($2):INTEGER], CAST5=[CAST($3):INTEGER], CAST6=[CAST($4):INTEGER], CAST7=[CAST($5):INTEGER], CAST8=[CAST($6):INTEGER], CAST9=[CAST($7):INTEGER], CAST10=[CAST($8):INTEGER], CAST11=[CAST($9):INTEGER], CAST12=[CAST($10):INTEGER], CAST13=[CAST($11):DECIMAL(19, 0)], CAST14=[CAST($12):DECIMAL(19, 0)], CAST15=[CAST($13):DECIMAL(19, 0)], CAST16=[CAST($14):DECIMAL(19, 0)], CAST17=[CAST($15):DECIMAL(19, 0)], CAST18=[CAST($16):DECIMAL(19, 0)], CAST19=[CAST($17):DECIMAL(19, 0)], CAST20=[CAST($18):DECIMAL(19, 0)], CAST21=[CAST($19):DECIMAL(19, 0)]): rowcount = 1.0, cumulative cost = {1.0 rows, 22.0 cpu, 0.0 io, 0.0 money}
                              1081:ProfileFilter(condition=[>($11, 10000)]): rowcount = 1.0, cumulative cost = {1.0 rows, 1.0 cpu, 0.0 io, 0.0 money}
                                1082:ProfileTableScan(table=[[tpcds, store_returns]]): rowcount = 1.0, cumulative cost = {1.0 rows, 2.0 cpu, 0.0 io, 0.0 money}
                    794:ProfileProject(d_date_sk=[$0]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 1643.6025 cpu, 0.0 io, 0.0 money}
                      797:ProfileProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 4930.8075 cpu, 0.0 io, 0.0 money}
                        799:ProfileFilter(condition=[AND(=($6, 2001), =($8, 12))]): rowcount = 1643.6025, cumulative cost = {1643.6025 rows, 73049.0 cpu, 0.0 io, 0.0 money}
                          800:ProfileTableScan(table=[[tpcds, date_dim]]): rowcount = 73049.0, cumulative cost = {73049.0 rows, 73050.0 cpu, 0.0 io, 0.0 money}

trial 0
java.lang.RuntimeException: Issue matching: rel#1583:ProfileUnion.PROFILE(input#0=ProfileUnion#1636,input#1=ProfileProject#1946,all=false) , 1 971 2.46E-4 HASH_GROUP_BY
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:184)
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:222)
	at org.arachne.profiling.ProfileMatcher.goMatchCard(ProfileMatcher.java:131)
	at org.arachne.collection.Collector.constructTree(Collector.java:662)
	at org.arachne.collection.Collector.go(Collector.java:98)
	at org.arachne.ArachneQueryProcessor.run(ArachneQueryProcessor.java:281)
	at org.arachne.ArachneQueryProcessor.main(ArachneQueryProcessor.java:340)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:254)
	at java.base/java.lang.Thread.run(Thread.java:829)
missing column name: channel
missing column name: item
missing column name: return_ratio
missing column name: return_rank
missing column name: currency_rank
STARTING QRY: CREATE TABLE duck_table_49_0 AS SELECT "t4"."ss_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."ss_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."ss_net_paid") AS "$f4"
FROM (SELECT "t"."ss_sold_date_sk", "t"."ss_item_sk", "t"."ss_quantity", "t"."ss_net_paid", CASE WHEN "t1"."CAST12" IS NOT NULL THEN CAST("t1"."CAST12" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST13" IS NOT NULL THEN CAST("t1"."CAST13" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales
WHERE "ss_net_profit" > 1 AND "ss_net_paid" > 0 AND "ss_quantity" > 0) AS "t"
INNER JOIN (SELECT "sr_item_sk", "sr_ticket_number", CAST("sr_returned_date_sk" AS INTEGER) AS "CAST", CAST("sr_return_time_sk" AS INTEGER) AS "CAST3", CAST("sr_item_sk" AS INTEGER) AS "CAST4", CAST("sr_customer_sk" AS INTEGER) AS "CAST5", CAST("sr_cdemo_sk" AS INTEGER) AS "CAST6", CAST("sr_hdemo_sk" AS INTEGER) AS "CAST7", CAST("sr_addr_sk" AS INTEGER) AS "CAST8", CAST("sr_store_sk" AS INTEGER) AS "CAST9", CAST("sr_reason_sk" AS INTEGER) AS "CAST10", CAST("sr_ticket_number" AS INTEGER) AS "CAST11", CAST("sr_return_quantity" AS INTEGER) AS "CAST12", CAST("sr_return_amt" AS DECIMAL(19, 0)) AS "CAST13", CAST("sr_return_tax" AS DECIMAL(19, 0)) AS "CAST14", CAST("sr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST15", CAST("sr_fee" AS DECIMAL(19, 0)) AS "CAST16", CAST("sr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST17", CAST("sr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST18", CAST("sr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST19", CAST("sr_store_credit" AS DECIMAL(19, 0)) AS "CAST20", CAST("sr_net_loss" AS DECIMAL(19, 0)) AS "CAST21"
FROM '/mnt/disks/tpcds/parquet/store_returns.parquet' AS store_returns
WHERE "sr_return_amt" > 10000) AS "t1" ON "t"."ss_ticket_number" = "t1"."sr_ticket_number" AND "t"."ss_item_sk" = "t1"."sr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ss_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."ss_item_sk"

2290.995589304
12397
12397
finished query
STARTING QRY: SELECT *
FROM (SELECT *
FROM (SELECT 'web' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t9"."item", CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t4"."ws_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."ws_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."ws_net_paid") AS "$f4"
FROM (SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_quantity", "t"."ws_net_paid", CASE WHEN "t1"."CAST16" IS NOT NULL THEN CAST("t1"."CAST16" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST17" IS NOT NULL THEN CAST("t1"."CAST17" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales
WHERE "ws_net_profit" > 1 AND "ws_net_paid" > 0 AND "ws_quantity" > 0) AS "t"
INNER JOIN (SELECT "wr_item_sk", "wr_order_number", CAST("wr_returned_date_sk" AS INTEGER) AS "CAST", CAST("wr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("wr_item_sk" AS INTEGER) AS "CAST4", CAST("wr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("wr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("wr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("wr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("wr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("wr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("wr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("wr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("wr_web_page_sk" AS INTEGER) AS "CAST13", CAST("wr_reason_sk" AS INTEGER) AS "CAST14", CAST("wr_order_number" AS INTEGER) AS "CAST15", CAST("wr_return_quantity" AS INTEGER) AS "CAST16", CAST("wr_return_amt" AS DECIMAL(19, 0)) AS "CAST17", CAST("wr_return_tax" AS DECIMAL(19, 0)) AS "CAST18", CAST("wr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST19", CAST("wr_fee" AS DECIMAL(19, 0)) AS "CAST20", CAST("wr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST21", CAST("wr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST22", CAST("wr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST23", CAST("wr_account_credit" AS DECIMAL(19, 0)) AS "CAST24", CAST("wr_net_loss" AS DECIMAL(19, 0)) AS "CAST25"
FROM '/mnt/disks/tpcds/parquet/web_returns.parquet' AS web_returns
WHERE "wr_return_amt" > 10000) AS "t1" ON "t"."ws_order_number" = "t1"."wr_order_number" AND "t"."ws_item_sk" = "t1"."wr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ws_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."ws_item_sk") AS "t9") AS "t10"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10
UNION
SELECT 'catalog' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t24"."item", CAST("t24"."$f1" AS DECIMAL(15, 4)) / CAST("t24"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t24"."$f3" AS DECIMAL(15, 4)) / CAST("t24"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t24"."$f1" AS DECIMAL(15, 4)) / CAST("t24"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t24"."$f3" AS DECIMAL(15, 4)) / CAST("t24"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t19"."cs_item_sk" AS "item", SUM("t19"."CASE") AS "$f1", SUM("t19"."cs_quantity") AS "$f2", SUM("t19"."CASE5") AS "$f3", SUM("t19"."cs_net_paid") AS "$f4"
FROM (SELECT "t14"."cs_sold_date_sk", "t14"."cs_item_sk", "t14"."cs_quantity", "t14"."cs_net_paid", CASE WHEN "t16"."CAST19" IS NOT NULL THEN CAST("t16"."CAST19" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t16"."CAST20" IS NOT NULL THEN CAST("t16"."CAST20" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales
WHERE "cs_net_profit" > 1 AND "cs_net_paid" > 0 AND "cs_quantity" > 0) AS "t14"
INNER JOIN (SELECT "cr_item_sk", "cr_order_number", CAST("cr_returned_date_sk" AS INTEGER) AS "CAST", CAST("cr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("cr_item_sk" AS INTEGER) AS "CAST4", CAST("cr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("cr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("cr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("cr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("cr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("cr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("cr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("cr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("cr_call_center_sk" AS INTEGER) AS "CAST13", CAST("cr_catalog_page_sk" AS INTEGER) AS "CAST14", CAST("cr_ship_mode_sk" AS INTEGER) AS "CAST15", CAST("cr_warehouse_sk" AS INTEGER) AS "CAST16", CAST("cr_reason_sk" AS INTEGER) AS "CAST17", CAST("cr_order_number" AS INTEGER) AS "CAST18", CAST("cr_return_quantity" AS INTEGER) AS "CAST19", CAST("cr_return_amount" AS DECIMAL(19, 0)) AS "CAST20", CAST("cr_return_tax" AS DECIMAL(19, 0)) AS "CAST21", CAST("cr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST22", CAST("cr_fee" AS DECIMAL(19, 0)) AS "CAST23", CAST("cr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST24", CAST("cr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST25", CAST("cr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST26", CAST("cr_store_credit" AS DECIMAL(19, 0)) AS "CAST27", CAST("cr_net_loss" AS DECIMAL(19, 0)) AS "CAST28"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns
WHERE "cr_return_amount" > 10000) AS "t16" ON "t14"."cs_order_number" = "t16"."cr_order_number" AND "t14"."cs_item_sk" = "t16"."cr_item_sk") AS "t19"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t22" ON "t19"."cs_sold_date_sk" = "t22"."d_date_sk"
GROUP BY "t19"."cs_item_sk") AS "t24") AS "t25"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t"
UNION
SELECT 'store' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "item", CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM "duck_table_49_0") AS "t30"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t34"
ORDER BY "channel" NULLS FIRST, "return_rank" NULLS FIRST, "currency_rank" NULLS FIRST, "item" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

1908.659309057
finished query
FINISHED PROFILING FOR TRIAL 0
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.995589304 CARDINALITY: 12397 COST: 0.9418537422694222
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1908.659309057 CARDINALITY: -1 COST: 0.7846710492789889
2
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.995589304 CARDINALITY: 12397 COST: 0.9418537422694222
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1908.659309057 CARDINALITY: -1 COST: 0.7846710492789889
BEGUN PROCESSING
missing column name: d_month_seq
missing column name: item
missing column name: $f1
missing column name: $f2
missing column name: $f3
missing column name: $f4
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1908.659309057 CARDINALITY: -1 COST: 0.7846710492789889
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.995589304 CARDINALITY: 12397 COST: 0.9418537422694222
rowSize: 20
{"bqSize":316.22886365500005,"compressed":221.30221806666665,"mvmtCost":0.0,"runtime":2290.995589304,"runCost":0.9418537422694222,"bqCost":1.5811443182750002,"cutNoHybrid":4199.654898361}
baseline runtime: 1162.0166726112366 baselineBQ read size: 2.53469130752E11
arachneCost: 2.522998060544422, baselineCost2: 0.4777179654068417, baseline: 1.26734565376, cutNoHybrid: 1.7265247915484112
FINISHED PROCESSING FOR TRIAL 0 plan not found. repeating...
trial 1
java.lang.RuntimeException: Issue matching: rel#2560:ProfileUnion.PROFILE(input#0=ProfileUnion#2613,input#1=ProfileProject#2923,all=false) , 1 971 2.46E-4 HASH_GROUP_BY
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:184)
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:222)
	at org.arachne.profiling.ProfileMatcher.goMatchCard(ProfileMatcher.java:131)
	at org.arachne.collection.Collector.constructTree(Collector.java:662)
	at org.arachne.collection.Collector.go(Collector.java:98)
	at org.arachne.ArachneQueryProcessor.run(ArachneQueryProcessor.java:281)
	at org.arachne.ArachneQueryProcessor.main(ArachneQueryProcessor.java:340)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:254)
	at java.base/java.lang.Thread.run(Thread.java:829)
missing column name: channel
missing column name: item
missing column name: return_ratio
missing column name: return_rank
missing column name: currency_rank
STARTING QRY: CREATE TABLE duck_table_49_0 AS SELECT "t4"."ws_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."ws_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."ws_net_paid") AS "$f4"
FROM (SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_quantity", "t"."ws_net_paid", CASE WHEN "t1"."CAST16" IS NOT NULL THEN CAST("t1"."CAST16" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST17" IS NOT NULL THEN CAST("t1"."CAST17" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales
WHERE "ws_net_profit" > 1 AND "ws_net_paid" > 0 AND "ws_quantity" > 0) AS "t"
INNER JOIN (SELECT "wr_item_sk", "wr_order_number", CAST("wr_returned_date_sk" AS INTEGER) AS "CAST", CAST("wr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("wr_item_sk" AS INTEGER) AS "CAST4", CAST("wr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("wr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("wr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("wr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("wr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("wr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("wr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("wr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("wr_web_page_sk" AS INTEGER) AS "CAST13", CAST("wr_reason_sk" AS INTEGER) AS "CAST14", CAST("wr_order_number" AS INTEGER) AS "CAST15", CAST("wr_return_quantity" AS INTEGER) AS "CAST16", CAST("wr_return_amt" AS DECIMAL(19, 0)) AS "CAST17", CAST("wr_return_tax" AS DECIMAL(19, 0)) AS "CAST18", CAST("wr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST19", CAST("wr_fee" AS DECIMAL(19, 0)) AS "CAST20", CAST("wr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST21", CAST("wr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST22", CAST("wr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST23", CAST("wr_account_credit" AS DECIMAL(19, 0)) AS "CAST24", CAST("wr_net_loss" AS DECIMAL(19, 0)) AS "CAST25"
FROM '/mnt/disks/tpcds/parquet/web_returns.parquet' AS web_returns
WHERE "wr_return_amt" > 10000) AS "t1" ON "t"."ws_order_number" = "t1"."wr_order_number" AND "t"."ws_item_sk" = "t1"."wr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ws_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."ws_item_sk"

680.27597049
17231
17231
finished query
STARTING QRY: SELECT *
FROM (SELECT *
FROM (SELECT 'web' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "item", CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM "duck_table_49_0") AS "t"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10
UNION
SELECT 'catalog' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t13"."item", CAST("t13"."$f1" AS DECIMAL(15, 4)) / CAST("t13"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t13"."$f3" AS DECIMAL(15, 4)) / CAST("t13"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t13"."$f1" AS DECIMAL(15, 4)) / CAST("t13"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t13"."$f3" AS DECIMAL(15, 4)) / CAST("t13"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t8"."cs_item_sk" AS "item", SUM("t8"."CASE") AS "$f1", SUM("t8"."cs_quantity") AS "$f2", SUM("t8"."CASE5") AS "$f3", SUM("t8"."cs_net_paid") AS "$f4"
FROM (SELECT "t3"."cs_sold_date_sk", "t3"."cs_item_sk", "t3"."cs_quantity", "t3"."cs_net_paid", CASE WHEN "t5"."CAST19" IS NOT NULL THEN CAST("t5"."CAST19" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t5"."CAST20" IS NOT NULL THEN CAST("t5"."CAST20" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales
WHERE "cs_net_profit" > 1 AND "cs_net_paid" > 0 AND "cs_quantity" > 0) AS "t3"
INNER JOIN (SELECT "cr_item_sk", "cr_order_number", CAST("cr_returned_date_sk" AS INTEGER) AS "CAST", CAST("cr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("cr_item_sk" AS INTEGER) AS "CAST4", CAST("cr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("cr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("cr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("cr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("cr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("cr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("cr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("cr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("cr_call_center_sk" AS INTEGER) AS "CAST13", CAST("cr_catalog_page_sk" AS INTEGER) AS "CAST14", CAST("cr_ship_mode_sk" AS INTEGER) AS "CAST15", CAST("cr_warehouse_sk" AS INTEGER) AS "CAST16", CAST("cr_reason_sk" AS INTEGER) AS "CAST17", CAST("cr_order_number" AS INTEGER) AS "CAST18", CAST("cr_return_quantity" AS INTEGER) AS "CAST19", CAST("cr_return_amount" AS DECIMAL(19, 0)) AS "CAST20", CAST("cr_return_tax" AS DECIMAL(19, 0)) AS "CAST21", CAST("cr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST22", CAST("cr_fee" AS DECIMAL(19, 0)) AS "CAST23", CAST("cr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST24", CAST("cr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST25", CAST("cr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST26", CAST("cr_store_credit" AS DECIMAL(19, 0)) AS "CAST27", CAST("cr_net_loss" AS DECIMAL(19, 0)) AS "CAST28"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns
WHERE "cr_return_amount" > 10000) AS "t5" ON "t3"."cs_order_number" = "t5"."cr_order_number" AND "t3"."cs_item_sk" = "t5"."cr_item_sk") AS "t8"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t11" ON "t8"."cs_sold_date_sk" = "t11"."d_date_sk"
GROUP BY "t8"."cs_item_sk") AS "t13") AS "t14"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t"
UNION
SELECT 'store' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t29"."item", CAST("t29"."$f1" AS DECIMAL(15, 4)) / CAST("t29"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t29"."$f3" AS DECIMAL(15, 4)) / CAST("t29"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t29"."$f1" AS DECIMAL(15, 4)) / CAST("t29"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t29"."$f3" AS DECIMAL(15, 4)) / CAST("t29"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t24"."ss_item_sk" AS "item", SUM("t24"."CASE") AS "$f1", SUM("t24"."ss_quantity") AS "$f2", SUM("t24"."CASE5") AS "$f3", SUM("t24"."ss_net_paid") AS "$f4"
FROM (SELECT "t19"."ss_sold_date_sk", "t19"."ss_item_sk", "t19"."ss_quantity", "t19"."ss_net_paid", CASE WHEN "t21"."CAST12" IS NOT NULL THEN CAST("t21"."CAST12" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t21"."CAST13" IS NOT NULL THEN CAST("t21"."CAST13" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales
WHERE "ss_net_profit" > 1 AND "ss_net_paid" > 0 AND "ss_quantity" > 0) AS "t19"
INNER JOIN (SELECT "sr_item_sk", "sr_ticket_number", CAST("sr_returned_date_sk" AS INTEGER) AS "CAST", CAST("sr_return_time_sk" AS INTEGER) AS "CAST3", CAST("sr_item_sk" AS INTEGER) AS "CAST4", CAST("sr_customer_sk" AS INTEGER) AS "CAST5", CAST("sr_cdemo_sk" AS INTEGER) AS "CAST6", CAST("sr_hdemo_sk" AS INTEGER) AS "CAST7", CAST("sr_addr_sk" AS INTEGER) AS "CAST8", CAST("sr_store_sk" AS INTEGER) AS "CAST9", CAST("sr_reason_sk" AS INTEGER) AS "CAST10", CAST("sr_ticket_number" AS INTEGER) AS "CAST11", CAST("sr_return_quantity" AS INTEGER) AS "CAST12", CAST("sr_return_amt" AS DECIMAL(19, 0)) AS "CAST13", CAST("sr_return_tax" AS DECIMAL(19, 0)) AS "CAST14", CAST("sr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST15", CAST("sr_fee" AS DECIMAL(19, 0)) AS "CAST16", CAST("sr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST17", CAST("sr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST18", CAST("sr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST19", CAST("sr_store_credit" AS DECIMAL(19, 0)) AS "CAST20", CAST("sr_net_loss" AS DECIMAL(19, 0)) AS "CAST21"
FROM '/mnt/disks/tpcds/parquet/store_returns.parquet' AS store_returns
WHERE "sr_return_amt" > 10000) AS "t21" ON "t19"."ss_ticket_number" = "t21"."sr_ticket_number" AND "t19"."ss_item_sk" = "t21"."sr_item_sk") AS "t24"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t27" ON "t24"."ss_sold_date_sk" = "t27"."d_date_sk"
GROUP BY "t24"."ss_item_sk") AS "t29") AS "t30"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t34"
ORDER BY "channel" NULLS FIRST, "return_rank" NULLS FIRST, "currency_rank" NULLS FIRST, "item" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

3519.080508718
finished query
FINISHED PROFILING FOR TRIAL 1
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 680.27597049 CARDINALITY: 17231 COST: 0.2796690100903333
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 3519.080508718 CARDINALITY: -1 COST: 1.4467330980285111
2
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 680.27597049 CARDINALITY: 17231 COST: 0.2796690100903333
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 3519.080508718 CARDINALITY: -1 COST: 1.4467330980285111
BEGUN PROCESSING
missing column name: d_month_seq
missing column name: item
missing column name: $f1
missing column name: $f2
missing column name: $f3
missing column name: $f4
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 3519.080508718 CARDINALITY: -1 COST: 1.4467330980285111
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 680.27597049 CARDINALITY: 17231 COST: 0.2796690100903333
rowSize: 20
{"bqSize":499.396024115,"compressed":343.00226410476193,"mvmtCost":0.0,"runtime":680.27597049,"runCost":0.2796690100903333,"bqCost":2.496980120575,"cutNoHybrid":4199.356479208}
baseline runtime: 1162.0166726112366 baselineBQ read size: 2.53469130752E11
arachneCost: 2.776649130665333, baselineCost2: 0.4777179654068417, baseline: 1.26734565376, cutNoHybrid: 1.7264021081188443
FINISHED PROCESSING FOR TRIAL 1 plan not found. repeating...
trial 2
java.lang.RuntimeException: Issue matching: rel#3537:ProfileUnion.PROFILE(input#0=ProfileUnion#3590,input#1=ProfileProject#3900,all=false) , 1 971 2.46E-4 HASH_GROUP_BY
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:184)
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:222)
	at org.arachne.profiling.ProfileMatcher.goMatchCard(ProfileMatcher.java:131)
	at org.arachne.collection.Collector.constructTree(Collector.java:662)
	at org.arachne.collection.Collector.go(Collector.java:98)
	at org.arachne.ArachneQueryProcessor.run(ArachneQueryProcessor.java:281)
	at org.arachne.ArachneQueryProcessor.main(ArachneQueryProcessor.java:340)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:254)
	at java.base/java.lang.Thread.run(Thread.java:829)
missing column name: channel
missing column name: item
missing column name: return_ratio
missing column name: return_rank
missing column name: currency_rank
STARTING QRY: CREATE TABLE duck_table_49_0 AS SELECT "t4"."cs_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."cs_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."cs_net_paid") AS "$f4"
FROM (SELECT "t"."cs_sold_date_sk", "t"."cs_item_sk", "t"."cs_quantity", "t"."cs_net_paid", CASE WHEN "t1"."CAST19" IS NOT NULL THEN CAST("t1"."CAST19" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST20" IS NOT NULL THEN CAST("t1"."CAST20" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales
WHERE "cs_net_profit" > 1 AND "cs_net_paid" > 0 AND "cs_quantity" > 0) AS "t"
INNER JOIN (SELECT "cr_item_sk", "cr_order_number", CAST("cr_returned_date_sk" AS INTEGER) AS "CAST", CAST("cr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("cr_item_sk" AS INTEGER) AS "CAST4", CAST("cr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("cr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("cr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("cr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("cr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("cr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("cr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("cr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("cr_call_center_sk" AS INTEGER) AS "CAST13", CAST("cr_catalog_page_sk" AS INTEGER) AS "CAST14", CAST("cr_ship_mode_sk" AS INTEGER) AS "CAST15", CAST("cr_warehouse_sk" AS INTEGER) AS "CAST16", CAST("cr_reason_sk" AS INTEGER) AS "CAST17", CAST("cr_order_number" AS INTEGER) AS "CAST18", CAST("cr_return_quantity" AS INTEGER) AS "CAST19", CAST("cr_return_amount" AS DECIMAL(19, 0)) AS "CAST20", CAST("cr_return_tax" AS DECIMAL(19, 0)) AS "CAST21", CAST("cr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST22", CAST("cr_fee" AS DECIMAL(19, 0)) AS "CAST23", CAST("cr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST24", CAST("cr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST25", CAST("cr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST26", CAST("cr_store_credit" AS DECIMAL(19, 0)) AS "CAST27", CAST("cr_net_loss" AS DECIMAL(19, 0)) AS "CAST28"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns
WHERE "cr_return_amount" > 10000) AS "t1" ON "t"."cs_order_number" = "t1"."cr_order_number" AND "t"."cs_item_sk" = "t1"."cr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."cs_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."cs_item_sk"

1223.458668511
33147
33147
finished query
STARTING QRY: SELECT *
FROM (SELECT *
FROM (SELECT 'web' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t9"."item", CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t4"."ws_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."ws_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."ws_net_paid") AS "$f4"
FROM (SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_quantity", "t"."ws_net_paid", CASE WHEN "t1"."CAST16" IS NOT NULL THEN CAST("t1"."CAST16" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST17" IS NOT NULL THEN CAST("t1"."CAST17" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales
WHERE "ws_net_profit" > 1 AND "ws_net_paid" > 0 AND "ws_quantity" > 0) AS "t"
INNER JOIN (SELECT "wr_item_sk", "wr_order_number", CAST("wr_returned_date_sk" AS INTEGER) AS "CAST", CAST("wr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("wr_item_sk" AS INTEGER) AS "CAST4", CAST("wr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("wr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("wr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("wr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("wr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("wr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("wr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("wr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("wr_web_page_sk" AS INTEGER) AS "CAST13", CAST("wr_reason_sk" AS INTEGER) AS "CAST14", CAST("wr_order_number" AS INTEGER) AS "CAST15", CAST("wr_return_quantity" AS INTEGER) AS "CAST16", CAST("wr_return_amt" AS DECIMAL(19, 0)) AS "CAST17", CAST("wr_return_tax" AS DECIMAL(19, 0)) AS "CAST18", CAST("wr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST19", CAST("wr_fee" AS DECIMAL(19, 0)) AS "CAST20", CAST("wr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST21", CAST("wr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST22", CAST("wr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST23", CAST("wr_account_credit" AS DECIMAL(19, 0)) AS "CAST24", CAST("wr_net_loss" AS DECIMAL(19, 0)) AS "CAST25"
FROM '/mnt/disks/tpcds/parquet/web_returns.parquet' AS web_returns
WHERE "wr_return_amt" > 10000) AS "t1" ON "t"."ws_order_number" = "t1"."wr_order_number" AND "t"."ws_item_sk" = "t1"."wr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ws_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."ws_item_sk") AS "t9") AS "t10"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10
UNION
SELECT 'catalog' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "item", CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("$f1" AS DECIMAL(15, 4)) / CAST("$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("$f3" AS DECIMAL(15, 4)) / CAST("$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM "duck_table_49_0") AS "t14"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t"
UNION
SELECT 'store' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t29"."item", CAST("t29"."$f1" AS DECIMAL(15, 4)) / CAST("t29"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t29"."$f3" AS DECIMAL(15, 4)) / CAST("t29"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t29"."$f1" AS DECIMAL(15, 4)) / CAST("t29"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t29"."$f3" AS DECIMAL(15, 4)) / CAST("t29"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t24"."ss_item_sk" AS "item", SUM("t24"."CASE") AS "$f1", SUM("t24"."ss_quantity") AS "$f2", SUM("t24"."CASE5") AS "$f3", SUM("t24"."ss_net_paid") AS "$f4"
FROM (SELECT "t19"."ss_sold_date_sk", "t19"."ss_item_sk", "t19"."ss_quantity", "t19"."ss_net_paid", CASE WHEN "t21"."CAST12" IS NOT NULL THEN CAST("t21"."CAST12" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t21"."CAST13" IS NOT NULL THEN CAST("t21"."CAST13" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales
WHERE "ss_net_profit" > 1 AND "ss_net_paid" > 0 AND "ss_quantity" > 0) AS "t19"
INNER JOIN (SELECT "sr_item_sk", "sr_ticket_number", CAST("sr_returned_date_sk" AS INTEGER) AS "CAST", CAST("sr_return_time_sk" AS INTEGER) AS "CAST3", CAST("sr_item_sk" AS INTEGER) AS "CAST4", CAST("sr_customer_sk" AS INTEGER) AS "CAST5", CAST("sr_cdemo_sk" AS INTEGER) AS "CAST6", CAST("sr_hdemo_sk" AS INTEGER) AS "CAST7", CAST("sr_addr_sk" AS INTEGER) AS "CAST8", CAST("sr_store_sk" AS INTEGER) AS "CAST9", CAST("sr_reason_sk" AS INTEGER) AS "CAST10", CAST("sr_ticket_number" AS INTEGER) AS "CAST11", CAST("sr_return_quantity" AS INTEGER) AS "CAST12", CAST("sr_return_amt" AS DECIMAL(19, 0)) AS "CAST13", CAST("sr_return_tax" AS DECIMAL(19, 0)) AS "CAST14", CAST("sr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST15", CAST("sr_fee" AS DECIMAL(19, 0)) AS "CAST16", CAST("sr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST17", CAST("sr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST18", CAST("sr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST19", CAST("sr_store_credit" AS DECIMAL(19, 0)) AS "CAST20", CAST("sr_net_loss" AS DECIMAL(19, 0)) AS "CAST21"
FROM '/mnt/disks/tpcds/parquet/store_returns.parquet' AS store_returns
WHERE "sr_return_amt" > 10000) AS "t21" ON "t19"."ss_ticket_number" = "t21"."sr_ticket_number" AND "t19"."ss_item_sk" = "t21"."sr_item_sk") AS "t24"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t27" ON "t24"."ss_sold_date_sk" = "t27"."d_date_sk"
GROUP BY "t24"."ss_item_sk") AS "t29") AS "t30"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t34"
ORDER BY "channel" NULLS FIRST, "return_rank" NULLS FIRST, "currency_rank" NULLS FIRST, "item" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

2972.57607217
finished query
FINISHED PROFILING FOR TRIAL 2
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 1223.458668511 CARDINALITY: 33147 COST: 0.5029774526100778
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 2972.57607217 CARDINALITY: -1 COST: 1.222059051892111
2
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 1223.458668511 CARDINALITY: 33147 COST: 0.5029774526100778
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 2972.57607217 CARDINALITY: -1 COST: 1.222059051892111
BEGUN PROCESSING
missing column name: d_month_seq
missing column name: item
missing column name: $f1
missing column name: $f2
missing column name: $f3
missing column name: $f4
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 2972.57607217 CARDINALITY: -1 COST: 1.222059051892111
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 1223.458668511 CARDINALITY: 33147 COST: 0.5029774526100778
rowSize: 20
{"bqSize":392.83916945899995,"compressed":270.30241568571427,"mvmtCost":0.0,"runtime":1223.458668511,"runCost":0.5029774526100778,"bqCost":1.9641958472949999,"cutNoHybrid":4196.034740681}
baseline runtime: 1162.0166726112366 baselineBQ read size: 2.53469130752E11
arachneCost: 2.4671732999050775, baselineCost2: 0.4777179654068417, baseline: 1.26734565376, cutNoHybrid: 1.7250365045021887
FINISHED PROCESSING FOR TRIAL 2 plan not found. repeating...
trial 3
java.lang.RuntimeException: Issue matching: rel#4514:ProfileUnion.PROFILE(input#0=ProfileUnion#4567,input#1=ProfileProject#4877,all=false) , 1 971 2.46E-4 HASH_GROUP_BY
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:184)
	at org.arachne.profiling.ProfileMatcher.matchCardinality(ProfileMatcher.java:222)
	at org.arachne.profiling.ProfileMatcher.goMatchCard(ProfileMatcher.java:131)
	at org.arachne.collection.Collector.constructTree(Collector.java:662)
	at org.arachne.collection.Collector.go(Collector.java:98)
	at org.arachne.ArachneQueryProcessor.run(ArachneQueryProcessor.java:281)
	at org.arachne.ArachneQueryProcessor.main(ArachneQueryProcessor.java:340)
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:254)
	at java.base/java.lang.Thread.run(Thread.java:829)
missing column name: channel
missing column name: item
missing column name: return_ratio
missing column name: return_rank
missing column name: currency_rank
STARTING QRY: CREATE TABLE duck_table_49_0 AS SELECT "t4"."ss_item_sk" AS "item", "t4"."CASE" AS "$f1", "t4"."ss_quantity" AS "$f2", "t4"."CASE5" AS "$f3", "t4"."ss_net_paid" AS "$f4"
FROM (SELECT "t"."ss_sold_date_sk", "t"."ss_item_sk", "t"."ss_quantity", "t"."ss_net_paid", CASE WHEN "t1"."CAST12" IS NOT NULL THEN CAST("t1"."CAST12" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST13" IS NOT NULL THEN CAST("t1"."CAST13" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/store_sales.parquet' AS store_sales
WHERE "ss_net_profit" > 1 AND "ss_net_paid" > 0 AND "ss_quantity" > 0) AS "t"
INNER JOIN (SELECT "sr_item_sk", "sr_ticket_number", CAST("sr_returned_date_sk" AS INTEGER) AS "CAST", CAST("sr_return_time_sk" AS INTEGER) AS "CAST3", CAST("sr_item_sk" AS INTEGER) AS "CAST4", CAST("sr_customer_sk" AS INTEGER) AS "CAST5", CAST("sr_cdemo_sk" AS INTEGER) AS "CAST6", CAST("sr_hdemo_sk" AS INTEGER) AS "CAST7", CAST("sr_addr_sk" AS INTEGER) AS "CAST8", CAST("sr_store_sk" AS INTEGER) AS "CAST9", CAST("sr_reason_sk" AS INTEGER) AS "CAST10", CAST("sr_ticket_number" AS INTEGER) AS "CAST11", CAST("sr_return_quantity" AS INTEGER) AS "CAST12", CAST("sr_return_amt" AS DECIMAL(19, 0)) AS "CAST13", CAST("sr_return_tax" AS DECIMAL(19, 0)) AS "CAST14", CAST("sr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST15", CAST("sr_fee" AS DECIMAL(19, 0)) AS "CAST16", CAST("sr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST17", CAST("sr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST18", CAST("sr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST19", CAST("sr_store_credit" AS DECIMAL(19, 0)) AS "CAST20", CAST("sr_net_loss" AS DECIMAL(19, 0)) AS "CAST21"
FROM '/mnt/disks/tpcds/parquet/store_returns.parquet' AS store_returns
WHERE "sr_return_amt" > 10000) AS "t1" ON "t"."ss_ticket_number" = "t1"."sr_ticket_number" AND "t"."ss_item_sk" = "t1"."sr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ss_sold_date_sk" = "t7"."d_date_sk"

2290.766193455
12991
12991
finished query
STARTING QRY: SELECT *
FROM (SELECT *
FROM (SELECT 'web' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t9"."item", CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t9"."$f1" AS DECIMAL(15, 4)) / CAST("t9"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t9"."$f3" AS DECIMAL(15, 4)) / CAST("t9"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t4"."ws_item_sk" AS "item", SUM("t4"."CASE") AS "$f1", SUM("t4"."ws_quantity") AS "$f2", SUM("t4"."CASE5") AS "$f3", SUM("t4"."ws_net_paid") AS "$f4"
FROM (SELECT "t"."ws_sold_date_sk", "t"."ws_item_sk", "t"."ws_quantity", "t"."ws_net_paid", CASE WHEN "t1"."CAST16" IS NOT NULL THEN CAST("t1"."CAST16" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t1"."CAST17" IS NOT NULL THEN CAST("t1"."CAST17" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/web_sales.parquet' AS web_sales
WHERE "ws_net_profit" > 1 AND "ws_net_paid" > 0 AND "ws_quantity" > 0) AS "t"
INNER JOIN (SELECT "wr_item_sk", "wr_order_number", CAST("wr_returned_date_sk" AS INTEGER) AS "CAST", CAST("wr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("wr_item_sk" AS INTEGER) AS "CAST4", CAST("wr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("wr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("wr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("wr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("wr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("wr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("wr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("wr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("wr_web_page_sk" AS INTEGER) AS "CAST13", CAST("wr_reason_sk" AS INTEGER) AS "CAST14", CAST("wr_order_number" AS INTEGER) AS "CAST15", CAST("wr_return_quantity" AS INTEGER) AS "CAST16", CAST("wr_return_amt" AS DECIMAL(19, 0)) AS "CAST17", CAST("wr_return_tax" AS DECIMAL(19, 0)) AS "CAST18", CAST("wr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST19", CAST("wr_fee" AS DECIMAL(19, 0)) AS "CAST20", CAST("wr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST21", CAST("wr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST22", CAST("wr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST23", CAST("wr_account_credit" AS DECIMAL(19, 0)) AS "CAST24", CAST("wr_net_loss" AS DECIMAL(19, 0)) AS "CAST25"
FROM '/mnt/disks/tpcds/parquet/web_returns.parquet' AS web_returns
WHERE "wr_return_amt" > 10000) AS "t1" ON "t"."ws_order_number" = "t1"."wr_order_number" AND "t"."ws_item_sk" = "t1"."wr_item_sk") AS "t4"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t7" ON "t4"."ws_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."ws_item_sk") AS "t9") AS "t10"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10
UNION
SELECT 'catalog' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "t24"."item", CAST("t24"."$f1" AS DECIMAL(15, 4)) / CAST("t24"."$f2" AS DECIMAL(15, 4)) AS "return_ratio", CAST("t24"."$f3" AS DECIMAL(15, 4)) / CAST("t24"."$f4" AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST("t24"."$f1" AS DECIMAL(15, 4)) / CAST("t24"."$f2" AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST("t24"."$f3" AS DECIMAL(15, 4)) / CAST("t24"."$f4" AS DECIMAL(15, 4))) AS "currency_rank"
FROM (SELECT "t19"."cs_item_sk" AS "item", SUM("t19"."CASE") AS "$f1", SUM("t19"."cs_quantity") AS "$f2", SUM("t19"."CASE5") AS "$f3", SUM("t19"."cs_net_paid") AS "$f4"
FROM (SELECT "t14"."cs_sold_date_sk", "t14"."cs_item_sk", "t14"."cs_quantity", "t14"."cs_net_paid", CASE WHEN "t16"."CAST19" IS NOT NULL THEN CAST("t16"."CAST19" AS INTEGER) ELSE 0 END AS "CASE", CASE WHEN "t16"."CAST20" IS NOT NULL THEN CAST("t16"."CAST20" AS DECIMAL(19, 0)) ELSE 0 END AS "CASE5"
FROM (SELECT *
FROM '/mnt/disks/tpcds/parquet/catalog_sales.parquet' AS catalog_sales
WHERE "cs_net_profit" > 1 AND "cs_net_paid" > 0 AND "cs_quantity" > 0) AS "t14"
INNER JOIN (SELECT "cr_item_sk", "cr_order_number", CAST("cr_returned_date_sk" AS INTEGER) AS "CAST", CAST("cr_returned_time_sk" AS INTEGER) AS "CAST3", CAST("cr_item_sk" AS INTEGER) AS "CAST4", CAST("cr_refunded_customer_sk" AS INTEGER) AS "CAST5", CAST("cr_refunded_cdemo_sk" AS INTEGER) AS "CAST6", CAST("cr_refunded_hdemo_sk" AS INTEGER) AS "CAST7", CAST("cr_refunded_addr_sk" AS INTEGER) AS "CAST8", CAST("cr_returning_customer_sk" AS INTEGER) AS "CAST9", CAST("cr_returning_cdemo_sk" AS INTEGER) AS "CAST10", CAST("cr_returning_hdemo_sk" AS INTEGER) AS "CAST11", CAST("cr_returning_addr_sk" AS INTEGER) AS "CAST12", CAST("cr_call_center_sk" AS INTEGER) AS "CAST13", CAST("cr_catalog_page_sk" AS INTEGER) AS "CAST14", CAST("cr_ship_mode_sk" AS INTEGER) AS "CAST15", CAST("cr_warehouse_sk" AS INTEGER) AS "CAST16", CAST("cr_reason_sk" AS INTEGER) AS "CAST17", CAST("cr_order_number" AS INTEGER) AS "CAST18", CAST("cr_return_quantity" AS INTEGER) AS "CAST19", CAST("cr_return_amount" AS DECIMAL(19, 0)) AS "CAST20", CAST("cr_return_tax" AS DECIMAL(19, 0)) AS "CAST21", CAST("cr_return_amt_inc_tax" AS DECIMAL(19, 0)) AS "CAST22", CAST("cr_fee" AS DECIMAL(19, 0)) AS "CAST23", CAST("cr_return_ship_cost" AS DECIMAL(19, 0)) AS "CAST24", CAST("cr_refunded_cash" AS DECIMAL(19, 0)) AS "CAST25", CAST("cr_reversed_charge" AS DECIMAL(19, 0)) AS "CAST26", CAST("cr_store_credit" AS DECIMAL(19, 0)) AS "CAST27", CAST("cr_net_loss" AS DECIMAL(19, 0)) AS "CAST28"
FROM '/mnt/disks/tpcds/parquet/catalog_returns.parquet' AS catalog_returns
WHERE "cr_return_amount" > 10000) AS "t16" ON "t14"."cs_order_number" = "t16"."cr_order_number" AND "t14"."cs_item_sk" = "t16"."cr_item_sk") AS "t19"
INNER JOIN (SELECT "d_date_sk"
FROM '/mnt/disks/tpcds/parquet/date_dim.parquet' AS date_dim
WHERE "d_year" = 2001 AND "d_moy" = 12) AS "t22" ON "t19"."cs_sold_date_sk" = "t22"."d_date_sk"
GROUP BY "t19"."cs_item_sk") AS "t24") AS "t25"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t"
UNION
SELECT 'store' AS "channel", "item", "return_ratio", "return_rank", "currency_rank"
FROM (SELECT "item", CAST(SUM("$f1") AS DECIMAL(15, 4)) / CAST(SUM("$f2") AS DECIMAL(15, 4)) AS "return_ratio", CAST(SUM("$f3") AS DECIMAL(15, 4)) / CAST(SUM("$f4") AS DECIMAL(15, 4)) AS "currency_ratio", RANK() OVER (ORDER BY CAST(SUM("$f1") AS DECIMAL(15, 4)) / CAST(SUM("$f2") AS DECIMAL(15, 4))) AS "return_rank", RANK() OVER (ORDER BY CAST(SUM("$f3") AS DECIMAL(15, 4)) / CAST(SUM("$f4") AS DECIMAL(15, 4))) AS "currency_rank"
FROM "duck_table_49_0"
GROUP BY "item") AS "t31"
WHERE "return_rank" <= 10 OR "currency_rank" <= 10) AS "t35"
ORDER BY "channel" NULLS FIRST, "return_rank" NULLS FIRST, "currency_rank" NULLS FIRST, "item" NULLS FIRST
FETCH NEXT 100 ROWS ONLY

1906.514518911
finished query
FINISHED PROFILING FOR TRIAL 3
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.766193455 CARDINALITY: 12991 COST: 0.9417594350870556
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1906.514518911 CARDINALITY: -1 COST: 0.7837893022189667
2
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.766193455 CARDINALITY: 12991 COST: 0.9417594350870556
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1906.514518911 CARDINALITY: -1 COST: 0.7837893022189667
BEGUN PROCESSING
missing column name: d_month_seq
missing column name: item
missing column name: $f1
missing column name: $f2
missing column name: $f3
missing column name: $f4
CTAS: duck_table_49_1 SRC: GCP DEST: GCP NUM INPUTS: 1 RUNTIME: 1906.514518911 CARDINALITY: -1 COST: 0.7837893022189667
CTAS: duck_table_49_0 SRC: GCP DEST: GCP NUM INPUTS: 0 RUNTIME: 2290.766193455 CARDINALITY: 12991 COST: 0.9417594350870556
rowSize: 20
{"bqSize":316.22887553500004,"compressed":221.30222372380953,"mvmtCost":0.0,"runtime":2290.766193455,"runCost":0.9417594350870556,"bqCost":1.5811443776750003,"cutNoHybrid":4197.280712366}
baseline runtime: 1162.0166726112366 baselineBQ read size: 2.53469130752E11
arachneCost: 2.5229038127620558, baselineCost2: 0.4777179654068417, baseline: 1.26734565376, cutNoHybrid: 1.7255487373060225
FINISHED PROCESSING FOR TRIAL 3 plan not found. repeating...
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  06:16 h
[[1;34mINFO[m] Finished at: 2022-03-30T11:13:24Z
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
