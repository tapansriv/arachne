Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_address
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.693131960855723, BigQuery Total: $95.28049826622009
01: $0.037222000787258146
02: $0.1979243566441536
03: $0.4866440628564358
04: $3.61400268015186
05: $1.5044740550923348
07: $1.3374056270329158
09: $4.248445393978358
11: $1.651202303194205
12: $0.12269529073079427
14: $15.676966815438668
17: $1.0243916837350526
20: $0.24317620974938076
21: $0.1387422318736712
22: $0.6777517994610468
23: $1.3768837107972303
25: $1.2151110610580445
26: $0.6627730558645726
27: $4.039140143409967
28: $5.05564576346914
29: $1.008115198913018
32: $0.5059927403712272
34: $0.6207235123666127
36: $2.580908335088094
37: $0.1680234264612198
38: $0.3558731983145078
39: $0.27729525789340337
40: $0.41494580126245817
41: $-0.0020452812047799434
42: $0.4939140515724818
43: $0.4999059917163849
44: $0.9402832753022512
47: $0.533098953530391
49: $1.8524754285796483
50: $0.636143891582489
51: $0.5666715289783477
52: $0.49561849385698636
53: $0.6177303631850084
55: $0.4950001102173328
57: $0.2881193407158057
58: $0.8547409833705425
59: $0.46271400184750555
62: $0.15670985938986143
63: $0.6185007683968544
65: $0.5998246012810866
66: $0.8397971375628313
67: $6.3270267018338044
70: $1.96793873002251
71: $1.1012624587861697
72: $0.44518852136810616
73: $0.6243884922528267
74: $1.1435399415040015
75: $2.824817998680671
76: $1.0871748799737295
77: $1.4439764900155863
78: $1.7110126293476422
79: $1.227616963657538
80: $2.012618472306331
82: $0.23054074777682623
83: $0.05543757183273633
86: $0.3798482982075214
87: $0.3817145547032356
88: $2.9330518760355315
89: $0.6237626295518875
90: $0.19219698321262996
92: $0.25097833294153216
93: $0.7894184744238854
96: $0.36783203990538915
97: $0.5135906607317925
98: $0.5017486539173126
99: $0.2590039864985148
!!!!!!: 89.58941158656914
Excluding table customer_address and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'89': 166016, '97': 131208, '05': 14909582, '72': 531916, '52': 133248, '90': 5505280, '66': 4997256, '88': 426240, '74': 4325520, '07': 137408, '11': 4325520, '28': 131072, '04': 4325528, '51': 4325504, '42': 133248, '96': 426240, '75': 6490252, '62': 13123712, '17': 231560, '23': 4327576, '73': 164240, '77': 7569548, '47': 166016, '32': 2184, '44': 133120, '93': 204800, '55': 133248, '37': 3208, '92': 4196480, '09': 139264, '83': 2164868, '53': 166016, '40': 526476, '03': 133248, '21': 527488, '39': 527488, '25': 231560, '76': 4327560, '26': 6344, '50': 229504, '59': 163968, '34': 164240, '87': 4325528, '80': 14915726, '57': 2185, '12': 4196480, '43': 163968, '65': 166016, '14': 4327560, '22': 527488, '63': 166016, '38': 4325528, '78': 6488204, '99': 540809, '86': 4196480, '58': 4327560, '01': 98448, '67': 166016, '36': 166016, '20': 2184, '27': 166080, '98': 133248, '70': 163968, '79': 164240, '49': 6488204, '71': 4589704, '29': 231560, '02': 4194440, '82': 134272}
call_center: 0.00024082747577485215, 0.5468824997385457
catalog_page: 0.0005952943150542173, 3.5164972330836117
catalog_returns: 0.13330459279420562, 12.13164237569131
catalog_sales: 1.4917937452386738, 42.09235379125564
customer: 0.010675029876988417, 11.022492327852284
customer_demographics: 0.001549616508394211, 6.482957731167168
date_dim: 0.0009392528174904685, 75.06159852742448
household_demographics: 0.0008263372529158846, 6.410172051545718
income_band: 0.0006905004179773097, -0.0006905004179773097
income_band had no query dependencies
inventory: 0.1279094576849197, 1.8096325271493539
item: 0.001819689398835827, 53.73237897120373
promotion: 0.0017639681051290293, 4.456221708466797
reason: 0.0005364609530936714, 5.037327407449149
ship_mode: 0.0007108840661993181, 1.2548000993850081
store: 0.0008100604872119491, 33.525406897084295
store_returns: 0.2586172722912812, 15.856597684063416
store_sales: 2.2020493822648066, 81.07354000147564
time_dim: 0.0007269328513087372, 5.433413562651244
warehouse: 0.0009695899267800945, 3.208465005383113
web_page: 0.0017170942167554777, 1.6344563790114608
web_returns: 0.0709351292126868, 11.333877516642264
web_sales: 0.8913874160390236, 40.408170971885
web_site: 0.000846306595636919, 3.6729560801928907
['income_band']
1
call_center: 0.00024082556929682766, 0.5468825016450237
catalog_page: 0.0005950107361750019, 3.5164975166624908
catalog_returns: 0.131302091948641, 12.133644876536875
customer: 0.010546585964647063, 11.022620771764625
promotion: 0.0017639559491569032, 4.45622172062277
ship_mode: 0.0007108837911565701, 1.254800099660051
store_returns: 0.25546647411605056, 15.859748482238649
web_page: 0.0017170827283827992, 1.6344563904998335
web_returns: 0.06996316488146359, 11.334849480973489
web_site: 0.0008463045811346295, 3.672956082207393
[]
0
{'88': 426240, '28': 131072, '09': 139264, '21': 527488, '39': 527488, '14': 4327560, '22': 527488, '67': 166016, '36': 166016, '27': 166080, '89': 0, '97': 0, '05': 10551302, '72': 4100, '52': 0, '90': 1048576, '66': 16384, '74': 16, '07': 4096, '11': 16, '04': 16, '51': 0, '42': 0, '96': 0, '75': 2162692, '62': 8404992, '17': 65536, '23': 16, '73': 16, '77': 3211268, '47': 0, '32': 0, '44': 0, '93': 65536, '55': 0, '37': 0, '92': 0, '53': 0, '40': 4, '03': 0, '25': 65536, '76': 0, '26': 4096, '50': 65536, '59': 0, '34': 16, '87': 16, '80': 10555398, '57': 1, '12': 0, '43': 0, '65': 0, '63': 0, '38': 16, '78': 2162692, '99': 16385, '86': 0, '58': 0, '20': 0, '98': 0, '70': 0, '79': 16, '49': 2162692, '71': 0, '29': 65536, '02': 0, '82': 0}
{}
{'88': 426240, '28': 131072, '09': 139264, '21': 527488, '39': 527488, '14': 4327560, '22': 527488, '67': 166016, '36': 166016, '27': 166080, '89': 0, '97': 0, '05': 10551302, '72': 4100, '52': 0, '90': 1048576, '66': 16384, '74': 16, '07': 4096, '11': 16, '04': 16, '51': 0, '42': 0, '96': 0, '75': 2162692, '62': 8404992, '17': 65536, '23': 16, '73': 16, '77': 3211268, '47': 0, '32': 0, '44': 0, '93': 65536, '55': 0, '37': 0, '92': 0, '53': 0, '40': 4, '03': 0, '25': 65536, '76': 0, '26': 4096, '50': 65536, '59': 0, '34': 16, '87': 16, '80': 10555398, '57': 1, '12': 0, '43': 0, '65': 0, '63': 0, '38': 16, '78': 2162692, '99': 16385, '86': 0, '58': 0, '20': 0, '98': 0, '70': 0, '79': 16, '49': 2162692, '71': 0, '29': 65536, '02': 0, '82': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 11.230758225882484, 5.6909376680390045, 0.00014901161193847656, 0.33895418862940274, 5.059624401539166, 0.11031402538723688, 0.030778930675736064
{11.230758225882484: []}
Best Cost: $11.230758225882484;
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 12, 14, 16, 20, 21, 23]
{'89': 166016, '97': 131208, '05': 14909582, '72': 531916, '52': 133248, '90': 5505280, '66': 4997256, '88': 426240, '74': 4325520, '07': 137408, '11': 4325520, '28': 131072, '04': 4325528, '51': 4325504, '42': 133248, '96': 426240, '75': 6490252, '62': 13123712, '17': 231560, '23': 4327576, '73': 164240, '77': 7569548, '47': 166016, '32': 2184, '44': 133120, '93': 204800, '55': 133248, '37': 3208, '92': 4196480, '09': 139264, '83': 2164868, '53': 166016, '40': 526476, '03': 133248, '21': 527488, '39': 527488, '25': 231560, '76': 4327560, '26': 6344, '50': 229504, '59': 163968, '34': 164240, '87': 4325528, '80': 14915726, '57': 2185, '12': 4196480, '43': 163968, '65': 166016, '14': 4327560, '22': 527488, '63': 166016, '38': 4325528, '78': 6488204, '99': 540809, '86': 4196480, '58': 4327560, '01': 98448, '67': 166016, '36': 166016, '20': 2184, '27': 166080, '98': 133248, '70': 163968, '79': 164240, '49': 6488204, '71': 4589704, '29': 231560, '02': 4194440, '82': 134272}
['41']
Excluding table customer_address and any queries that depend on it
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 12, 14, 16, 20, 21, 23]
dict_keys(['89', '97', '05', '72', '52', '90', '66', '88', '74', '07', '11', '28', '04', '51', '42', '96', '75', '62', '17', '23', '73', '77', '47', '32', '44', '93', '55', '37', '92', '09', '83', '53', '40', '03', '21', '39', '25', '76', '26', '50', '59', '34', '87', '80', '57', '12', '43', '65', '14', '22', '63', '38', '78', '99', '86', '58', '01', '67', '36', '20', '27', '98', '70', '79', '49', '71', '29', '02', '82'])
22
Optimal Subset: 0b111111111111110111011111
dict_keys(['89', '97', '05', '72', '52', '90', '66', '88', '74', '07', '11', '28', '04', '51', '42', '96', '75', '62', '17', '23', '73', '77', '47', '32', '44', '93', '55', '37', '92', '09', '83', '53', '40', '03', '21', '39', '25', '76', '26', '50', '59', '34', '87', '80', '57', '12', '43', '65', '14', '22', '63', '38', '78', '99', '86', '58', '01', '67', '36', '20', '27', '98', '70', '79', '49', '71', '29', '02', '82'])
Function: 11.230758225882484, 5.6909376680390045, 0.00014901161193847656, 0.33895418862940274, 5.059624401539166, 0.11031402538723688, 0.030778930675736064
Real: 11.230758225882484, 5.6909376680390045, 0.00014901161193847656, 0.33895418862940274, 5.059624401539166, 0.11031402538723688, 0.030778930675736064
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $5.6909376680390045; Stayed Qs: $0.00014901161193847656; Migration Cost: $5.539671546231542
Movement Cost: $0.33895418862940274, Load Cost: $5.059624401539166, Storage Cost: $0.11031402538723688, API Cost: $0.030778930675736064
Final cost: $11.230758225882484, Baseline: $95.28049826622009, Diff: $84.04974004033761, %: 88.2129518314409%
