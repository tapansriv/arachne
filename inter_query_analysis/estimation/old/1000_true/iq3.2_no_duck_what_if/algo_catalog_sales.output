Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $2.707089112255971, BigQuery Total: $61.903661489486694
01: $0.037222000787258146
03: $0.4866440628564358
06: $0.37089640181660655
07: $1.3374056270329158
08: $0.4827552439717452
09: $4.248445393978358
11: $1.651202303194205
12: $0.12269529073079427
13: $1.6977783234190942
19: $0.7141877862731616
21: $0.1387422318736712
22: $0.6777517994610468
24: $1.5006963644893965
27: $4.039140143409967
28: $5.05564576346914
30: $0.009960597354968388
31: $1.8245650356054306
34: $0.6207235123666127
36: $2.580908335088094
39: $0.27729525789340337
41: $-0.0020452812047799434
42: $0.4939140515724818
43: $0.4999059917163849
44: $0.9402832753022512
45: $0.1519291462512811
46: $1.2265638447797298
47: $0.533098953530391
48: $1.1001106623999277
50: $0.636143891582489
51: $0.5666715289783477
52: $0.49561849385698636
53: $0.6177303631850084
55: $0.4950001102173328
59: $0.46271400184750555
61: $1.6410273874457677
62: $0.15670985938986143
63: $0.6185007683968544
65: $0.5998246012810866
67: $6.3270267018338044
68: $1.4742584558578333
70: $1.96793873002251
73: $0.6243884922528267
74: $1.1435399415040015
79: $1.227616963657538
81: $0.019239308624267575
82: $0.23054074777682623
83: $0.05543757183273633
84: $0.012719620297749836
85: $0.31475607653776805
86: $0.3798482982075214
88: $2.9330518760355315
89: $0.6237626295518875
90: $0.19219698321262996
91: $0.03197660856405894
92: $0.25097833294153216
93: $0.7894184744238854
94: $0.3066015665193399
95: $0.3133311781525612
96: $0.36783203990538915
98: $0.5017486539173126
!!!!!!: 59.1986176584355
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'53': 166016, '84': 66416, '74': 4325520, '82': 134272, '21': 527488, '09': 139264, '43': 163968, '06': 133296, '88': 426240, '55': 133248, '34': 164240, '22': 527488, '98': 133248, '62': 13123712, '61': 170160, '59': 163968, '81': 180, '47': 166016, '51': 4325504, '48': 164064, '94': 14680224, '27': 166080, '85': 7348448, '90': 5505280, '93': 204800, '28': 131072, '45': 4196528, '01': 98448, '39': 527488, '86': 4196480, '89': 166016, '50': 229504, '65': 166016, '91': 501, '92': 4196480, '63': 166016, '52': 133248, '44': 133120, '95': 14680224, '42': 133248, '08': 164016, '70': 163968, '03': 133248, '31': 4325536, '24': 231472, '13': 164320, '46': 164272, '96': 426240, '36': 166016, '79': 164240, '30': 2097328, '07': 137408, '11': 4325520, '19': 166064, '73': 164240, '67': 166016, '12': 4196480, '83': 2164868, '68': 164272}
call_center: 0.00024082603339058614, 0.031735782530668354
catalog_page: 0.0005950797677537508, -0.0005950797677537508
catalog_page had no query dependencies
catalog_returns: 0.1317895605330352, -0.02513607151197235
customer: 0.01057785305362821, 12.930326126435384
customer_address: 0.005355054891995677, 13.187998553468692
customer_demographics: 0.0015484529685731812, 8.532338608692909
date_dim: 0.0009390266244986197, 43.15738884069667
household_demographics: 0.0008263332034944523, 10.408280387145501
income_band: 0.0006905003388819058, 0.01202911995886793
inventory: 0.12724869267845246, 1.1970813443264952
item: 0.0018157571108761118, 27.200817630915676
promotion: 0.0017639589082840054, 2.9766690555703996
reason: 0.0005364607421327073, 5.352083484197879
ship_mode: 0.0007108838581101993, 0.15599897553175124
store: 0.0008100483040068682, 35.15409801678379
store_returns: 0.2562334726067595, 2.7754044508067555
store_sales: 2.1833154789200235, 53.56591045088304
time_dim: 0.0007267922906389312, 3.4923541068629116
warehouse: 0.0009695894675241784, 1.2495295591504587
web_page: 0.0017170855249962333, 0.5052359742254017
web_returns: 0.07019977006326536, 0.9298872203341083
web_sales: 0.8842177261969759, 6.4908078150282975
web_site: 0.0008463050715247242, 0.7757962989902377
['catalog_page', 'catalog_returns']
2
call_center: 0.00024082488622272687, -0.00024082488622272687
call_center had no query dependencies
customer: 0.010500565654527758, 12.879187496646153
customer_address: 0.005338748875502647, 13.136798942296858
income_band: 0.0006905002759751565, 0.01202912002177468
promotion: 0.001763951593780328, 2.9766690628849033
ship_mode: 0.0007108836926112025, 0.15599897569725021
store_returns: 0.2543375711847688, 2.72186278039601
web_page: 0.0017170786122011616, 0.5052359811381968
web_returns: 0.06961491871601733, 0.8750344998486201
web_sales: 0.8785154747640926, 6.49651006646118
web_site: 0.0008463038593563964, 0.7757963002024061
['call_center']
1
income_band: 0.0006905002319595926, 0.012029120065790244
ship_mode: 0.0007108835768123135, 0.1559989758130491
web_page: 0.0017170737753501558, 0.5052359859750478
web_returns: 0.06920570091078501, 0.8754437176538524
web_site: 0.0008463030112077771, 0.7757963010505546
[]
0
{'21': 527488, '09': 139264, '88': 426240, '22': 527488, '27': 166080, '28': 131072, '39': 527488, '36': 166016, '67': 166016, '53': 0, '74': 4194320, '82': 0, '43': 0, '06': 48, '55': 0, '34': 16, '98': 0, '61': 4144, '59': 0, '47': 0, '48': 32, '93': 65536, '89': 0, '50': 65536, '65': 0, '63': 0, '52': 0, '44': 0, '42': 0, '08': 48, '70': 0, '03': 0, '31': 4194336, '24': 65584, '13': 32, '46': 48, '96': 0, '79': 16, '07': 4096, '11': 4194320, '19': 48, '73': 16, '68': 48, '84': 512, '62': 8404992, '51': 0, '94': 10485760, '85': 3145728, '90': 1048576, '45': 0, '01': 0, '86': 0, '92': 0, '95': 10485760, '12': 0}
{}
{'21': 527488, '09': 139264, '88': 426240, '22': 527488, '27': 166080, '28': 131072, '39': 527488, '36': 166016, '67': 166016, '53': 0, '74': 4194320, '82': 0, '43': 0, '06': 48, '55': 0, '34': 16, '98': 0, '61': 4144, '59': 0, '47': 0, '48': 32, '93': 65536, '89': 0, '50': 65536, '65': 0, '63': 0, '52': 0, '44': 0, '42': 0, '08': 48, '70': 0, '03': 0, '31': 4194336, '24': 65584, '13': 32, '46': 48, '96': 0, '79': 16, '07': 4096, '11': 4194320, '19': 48, '73': 16, '68': 48, '84': 512, '62': 8404992, '51': 0, '94': 10485760, '85': 3145728, '90': 1048576, '45': 0, '01': 0, '86': 0, '92': 0, '95': 10485760, '12': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 6.583949768418446, 2.6682050982399788, 0.1434922218322754, 0.22232114129036198, 3.488252333635887, 0.04143527261212967, 0.02024370080781281
{6.583949768418446: []}
Best Cost: $6.583949768418446;
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
{'53': 166016, '84': 66416, '74': 4325520, '82': 134272, '21': 527488, '09': 139264, '43': 163968, '06': 133296, '88': 426240, '55': 133248, '34': 164240, '22': 527488, '98': 133248, '62': 13123712, '61': 170160, '59': 163968, '47': 166016, '51': 4325504, '48': 164064, '94': 14680224, '27': 166080, '85': 7348448, '90': 5505280, '93': 204800, '28': 131072, '45': 4196528, '01': 98448, '39': 527488, '86': 4196480, '89': 166016, '50': 229504, '65': 166016, '92': 4196480, '63': 166016, '52': 133248, '44': 133120, '95': 14680224, '42': 133248, '08': 164016, '70': 163968, '03': 133248, '31': 4325536, '24': 231472, '13': 164320, '46': 164272, '96': 426240, '36': 166016, '79': 164240, '30': 2097328, '07': 137408, '11': 4325520, '19': 166064, '73': 164240, '67': 166016, '12': 4196480, '68': 164272}
['41', '81', '91', '83']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
dict_keys(['53', '84', '74', '82', '21', '09', '43', '06', '88', '55', '34', '22', '98', '62', '61', '59', '47', '51', '48', '94', '27', '85', '90', '93', '28', '45', '01', '39', '86', '89', '50', '65', '92', '63', '52', '44', '95', '42', '08', '70', '03', '31', '24', '13', '46', '96', '36', '79', '30', '07', '11', '19', '73', '67', '12', '68'])
20
Optimal Subset: 0b111111111111111111110000
dict_keys(['53', '84', '74', '82', '21', '09', '43', '06', '88', '55', '34', '22', '98', '62', '61', '59', '47', '51', '48', '94', '27', '85', '90', '93', '28', '45', '01', '39', '86', '89', '50', '65', '92', '63', '52', '44', '95', '42', '08', '70', '03', '31', '24', '13', '46', '96', '36', '79', '30', '07', '11', '19', '73', '67', '12', '68'])
Function: 6.583949768418446, 2.6682050982399788, 0.1434922218322754, 0.22232114129036198, 3.488252333635887, 0.04143527261212967, 0.02024370080781281
Real: 6.583949768418446, 2.6682050982399788, 0.1434922218322754, 0.22232114129036198, 3.488252333635887, 0.04143527261212967, 0.02024370080781281
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 56; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $2.6682050982399788; Stayed Qs: $0.1434922218322754; Migration Cost: $3.7722524483461917
Movement Cost: $0.22232114129036198, Load Cost: $3.488252333635887, Storage Cost: $0.04143527261212967, API Cost: $0.02024370080781281
Final cost: $6.583949768418446, Baseline: $61.903661489486694, Diff: $55.319711721068245, %: 89.36419977429506%
