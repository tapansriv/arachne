Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_address
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $9.847816345621744, BigQuery Total: $95.28049826622009
01: $0.04251913135846455
02: $0.25014779800891873
03: $0.47502096817970274
04: $3.8661244323968886
05: $1.4304585849189757
07: $1.2739325496244431
09: $4.166115921802521
11: $1.6160064807542165
12: $0.1233327794043223
14: $15.638491943470637
17: $0.9640249739869435
20: $0.25383286993821463
21: $0.13902823099136352
22: $0.6999924237171808
23: $0.1203815823284784
25: $1.1788075348933538
26: $0.6572775177415212
27: $3.8892385180123648
28: $4.860953305471738
29: $0.954251956636111
32: $0.5117330439758301
34: $0.6075768459717432
36: $2.4807855692911147
37: $0.16629489990234375
38: $0.3463533362611135
39: $0.27900081528663634
40: $0.41604152888298035
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
47: $0.48158571960449215
49: $1.8010069972499212
50: $0.661454455537796
51: $0.5829390027141571
52: $0.4759971203915278
53: $0.5979665479230881
55: $0.4760878943316142
57: $0.27304382418314616
58: $0.8539149026123682
59: $0.4287443129523595
62: $0.1538115687449773
63: $0.597844746427536
65: $0.5961180507278443
66: $0.8382468031756083
67: $6.203618795018196
70: $1.8907469585673014
71: $1.0642372519636154
72: $0.3371178349939982
73: $0.6095429498179754
74: $0.779892116077741
75: $2.7449614957491555
76: $1.0597011683511735
77: $1.3902296223608652
78: $1.1057289998229343
79: $1.1831403943077723
80: $1.7595691417249042
82: $0.22990267293135325
83: $0.06329148495833078
86: $0.3697533963696162
87: $0.32961105404376984
88: $2.8978831026617686
89: $0.5970417350339889
90: $0.18988620407740275
92: $0.24658876627922058
93: $0.7705190082454682
96: $0.361907244758606
97: $0.4646914958365758
98: $0.4751735880470276
99: $0.22156503650188447
!!!!!!: 85.43412104916253
Excluding table customer_address and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'38': 4325528, '04': 4325528, '65': 166016, '90': 5505280, '86': 4196480, '96': 426240, '67': 166016, '40': 526476, '53': 166016, '09': 139264, '37': 3208, '28': 131072, '32': 2184, '50': 229504, '55': 133248, '49': 6488204, '42': 133248, '73': 164240, '66': 4997256, '83': 2164868, '12': 4196480, '22': 527488, '51': 4325504, '58': 4327560, '36': 166016, '93': 204800, '97': 131208, '88': 426240, '34': 164240, '98': 133248, '80': 14915726, '01': 98448, '39': 527488, '74': 4325520, '25': 231560, '29': 231560, '72': 531916, '62': 13123712, '52': 133248, '89': 166016, '21': 527488, '79': 164240, '99': 540809, '75': 6490252, '07': 137408, '76': 4327560, '82': 134272, '03': 133248, '57': 2185, '23': 4327576, '77': 7569548, '27': 166080, '92': 4196480, '78': 6488204, '63': 166016, '47': 166016, '11': 4325520, '43': 163968, '05': 14909582, '20': 2184, '71': 4589704, '44': 133120, '14': 4327560, '70': 163968, '59': 163968, '17': 231560, '87': 4325528, '02': 4194440, '26': 6344}
call_center: 0.0015696647167856039, 0.493039195968245
catalog_page: 0.0022854507184081954, 3.187742275925472
catalog_returns: 0.1356610751156663, 10.9127446155464
catalog_sales: 1.7807507737452177, 39.217096858167004
customer: 0.014301938665408891, 9.486846384652758
customer_demographics: 0.0036804417378930553, 6.153885978634435
date_dim: 0.0028494756063666554, 71.29663976684402
household_demographics: 0.0020465231027924627, 6.185008053486475
income_band: 0.0019052423283297103, -0.0019052423283297103
income_band had no query dependencies
inventory: 0.12975694061447754, 1.7215799372083984
item: 0.005764667583588476, 51.08182368219426
promotion: 0.005425073005000792, 4.022471971079866
reason: 0.0019628792781503242, 4.934672050769839
ship_mode: 0.0022938378513944094, 1.2113295705710756
store: 0.0024364892070643436, 32.301349938271734
store_returns: 0.33660900466576704, 14.530214382777455
store_sales: 2.772227586552785, 76.42938750411777
time_dim: 0.002535812091761361, 5.34962479454524
warehouse: 0.0023640721488866626, 3.0824401701457433
web_page: 0.0039587225922908045, 1.5761571038459772
web_returns: 0.07204697245709712, 10.22319935432799
web_sales: 1.0806339085121655, 37.580741520348816
web_site: 0.003012177471265911, 3.3408271179175917
['income_band']
1
call_center: 0.0015696641047383384, 0.49303919658029227
catalog_page: 0.0022853596795001357, 3.18774236696438
catalog_returns: 0.135018201108709, 10.913387489553356
customer: 0.01426070360037556, 9.48688761971779
promotion: 0.0054250691025013115, 4.022471974982365
ship_mode: 0.0022938377630959033, 1.211329570659374
store_returns: 0.3355974863672801, 14.531225901075942
web_page: 0.003958718904114495, 1.5761571075341534
web_returns: 0.07173493733081139, 10.223511389454275
web_site: 0.0030121768245390135, 3.3408271185643184
[]
0
{'67': 166016, '09': 139264, '28': 131072, '22': 527488, '88': 426240, '39': 527488, '27': 166080, '14': 4327560, '38': 16, '04': 16, '65': 0, '90': 1048576, '86': 0, '96': 0, '40': 4, '53': 0, '37': 0, '32': 0, '50': 65536, '55': 0, '49': 2162692, '42': 0, '73': 16, '66': 16384, '12': 0, '51': 0, '58': 0, '36': 0, '93': 65536, '97': 0, '34': 16, '98': 0, '80': 10555398, '74': 16, '25': 65536, '29': 65536, '72': 4100, '62': 8404992, '52': 0, '89': 0, '21': 0, '79': 16, '99': 16385, '75': 2162692, '07': 4096, '76': 0, '82': 0, '03': 0, '57': 1, '23': 16, '77': 3211268, '92': 0, '78': 2162692, '63': 0, '47': 0, '11': 16, '43': 0, '05': 10551302, '20': 0, '71': 0, '44': 0, '70': 0, '59': 0, '17': 65536, '87': 16, '02': 0, '26': 4096}
{}
{'67': 166016, '09': 139264, '28': 131072, '22': 527488, '88': 426240, '39': 527488, '27': 166080, '14': 4327560, '38': 16, '04': 16, '65': 0, '90': 1048576, '86': 0, '96': 0, '40': 4, '53': 0, '37': 0, '32': 0, '50': 65536, '55': 0, '49': 2162692, '42': 0, '73': 16, '66': 16384, '12': 0, '51': 0, '58': 0, '36': 0, '93': 65536, '97': 0, '34': 16, '98': 0, '80': 10555398, '74': 16, '25': 65536, '29': 65536, '72': 4100, '62': 8404992, '52': 0, '89': 0, '21': 0, '79': 16, '99': 16385, '75': 2162692, '07': 4096, '76': 0, '82': 0, '03': 0, '57': 1, '23': 16, '77': 3211268, '92': 0, '78': 2162692, '63': 0, '47': 0, '11': 16, '43': 0, '05': 10551302, '20': 0, '71': 0, '44': 0, '70': 0, '59': 0, '17': 65536, '87': 16, '02': 0, '26': 4096}
STARTING PHASE 2: 0b0
----
[]
Function: 16.549500031246588, 9.846228205445609, 0.00014901161193847656, 0.33895418862940274, 6.29199018892924, 0.04139950595466154, 0.030778930675736064
{16.549500031246588: []}
Best Cost: $16.549500031246588;
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 12, 14, 16, 20, 21, 23]
{'38': 4325528, '04': 4325528, '65': 166016, '90': 5505280, '86': 4196480, '96': 426240, '67': 166016, '40': 526476, '53': 166016, '09': 139264, '37': 3208, '28': 131072, '32': 2184, '50': 229504, '55': 133248, '49': 6488204, '42': 133248, '73': 164240, '66': 4997256, '83': 2164868, '12': 4196480, '22': 527488, '51': 4325504, '58': 4327560, '36': 166016, '93': 204800, '97': 131208, '88': 426240, '34': 164240, '98': 133248, '80': 14915726, '01': 98448, '39': 527488, '74': 4325520, '25': 231560, '29': 231560, '72': 531916, '62': 13123712, '52': 133248, '89': 166016, '21': 527488, '79': 164240, '99': 540809, '75': 6490252, '07': 137408, '76': 4327560, '82': 134272, '03': 133248, '57': 2185, '23': 4327576, '77': 7569548, '27': 166080, '92': 4196480, '78': 6488204, '63': 166016, '47': 166016, '11': 4325520, '43': 163968, '05': 14909582, '20': 2184, '71': 4589704, '44': 133120, '14': 4327560, '70': 163968, '59': 163968, '17': 231560, '87': 4325528, '02': 4194440, '26': 6344}
['41']
Excluding table customer_address and any queries that depend on it
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 12, 14, 16, 20, 21, 23]
dict_keys(['38', '04', '65', '90', '86', '96', '67', '40', '53', '09', '37', '28', '32', '50', '55', '49', '42', '73', '66', '83', '12', '22', '51', '58', '36', '93', '97', '88', '34', '98', '80', '01', '39', '74', '25', '29', '72', '62', '52', '89', '21', '79', '99', '75', '07', '76', '82', '03', '57', '23', '77', '27', '92', '78', '63', '47', '11', '43', '05', '20', '71', '44', '14', '70', '59', '17', '87', '02', '26'])
22
Optimal Subset: 0b111111111111110111011111
dict_keys(['38', '04', '65', '90', '86', '96', '67', '40', '53', '09', '37', '28', '32', '50', '55', '49', '42', '73', '66', '83', '12', '22', '51', '58', '36', '93', '97', '88', '34', '98', '80', '01', '39', '74', '25', '29', '72', '62', '52', '89', '21', '79', '99', '75', '07', '76', '82', '03', '57', '23', '77', '27', '92', '78', '63', '47', '11', '43', '05', '20', '71', '44', '14', '70', '59', '17', '87', '02', '26'])
Function: 16.549500031246588, 9.846228205445609, 0.00014901161193847656, 0.33895418862940274, 6.29199018892924, 0.04139950595466154, 0.030778930675736064
Real: 16.549500031246588, 9.846228205445609, 0.00014901161193847656, 0.33895418862940274, 6.29199018892924, 0.04139950595466154, 0.030778930675736064
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $9.846228205445609; Stayed Qs: $0.00014901161193847656; Migration Cost: $6.70312281418904
Movement Cost: $0.33895418862940274, Load Cost: $6.29199018892924, Storage Cost: $0.04139950595466154, API Cost: $0.030778930675736064
Final cost: $16.549500031246588, Baseline: $95.28049826622009, Diff: $78.7309982349735, %: 82.63075830585375%
