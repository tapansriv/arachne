Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: household_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $10.299309774322511, BigQuery Total: $108.41442346572876
01: $0.04251913135846455
02: $0.25014779800891873
03: $0.47502096817970274
04: $3.8661244323968886
05: $1.4304585849189757
06: $0.3632350847975413
07: $1.2739325496244431
08: $0.4728430971686045
09: $4.166115921802521
10: $0.42586106104691823
11: $1.6160064807542165
12: $0.1233327794043223
14: $15.638491943470637
15: $0.25032848659515383
16: $0.7151701463317871
17: $0.9640249739869435
18: $3.9372784649689994
19: $0.7144547079753876
20: $0.25383286993821463
21: $0.13902823099136352
22: $0.6999924237171808
23: $0.1203815823284784
24: $1.4943556775426865
25: $1.1788075348933538
26: $0.6572775177415212
27: $3.8892385180123648
28: $4.860953305471738
29: $0.954251956636111
30: $0.012125212178230286
31: $1.7751692107454935
32: $0.5117330439758301
33: $1.1213197820679346
35: $0.4162435221449534
36: $2.4807855692911147
37: $0.16629489990234375
38: $0.3463533362611135
39: $0.27900081528663634
40: $0.41604152888298035
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
45: $0.15160362540721894
47: $0.48158571960449215
48: $1.0463716178750992
49: $1.8010069972499212
50: $0.661454455537796
51: $0.5829390027141571
52: $0.4759971203915278
53: $0.5979665479230881
54: $0.7558387576993306
55: $0.4760878943316142
56: $1.1214404756466547
57: $0.27304382418314616
58: $0.8539149026123682
59: $0.4287443129523595
60: $1.1220686246951421
61: $1.6324246692927677
62: $0.1538115687449773
63: $0.597844746427536
65: $0.5961180507278443
66: $0.8382468031756083
67: $6.203618795018196
69: $0.39829635841369626
70: $1.8907469585673014
71: $1.0642372519636154
74: $0.779892116077741
75: $2.7449614957491555
76: $1.0597011683511735
77: $1.3902296223608652
78: $1.1057289998229343
80: $1.7595691417249042
81: $0.022080078539848325
82: $0.22990267293135325
83: $0.06329148495833078
85: $0.3001966362142563
86: $0.3697533963696162
87: $0.32961105404376984
89: $0.5970417350339889
92: $0.24658876627922058
93: $0.7705190082454682
94: $0.3080027531592051
95: $0.31277829689025877
97: $0.4646914958365758
98: $0.4751735880470276
99: $0.22156503650188447
!!!!!!: 98.11655281997041
Excluding table household_demographics and any queries that depend on it
Total Keys: 86, Keys Considered: 85
[0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'85': 7348448, '20': 2184, '67': 166016, '80': 14915726, '98': 133248, '97': 131208, '61': 170160, '40': 526476, '57': 2185, '95': 14680224, '66': 4997256, '69': 4325624, '75': 6490252, '27': 166080, '05': 14909582, '58': 4327560, '16': 173, '38': 4325528, '83': 2164868, '82': 134272, '55': 133248, '08': 164016, '02': 4194440, '14': 4327560, '44': 133120, '31': 4325536, '74': 4325520, '10': 4325624, '53': 166016, '42': 133248, '25': 231560, '86': 4196480, '99': 540809, '94': 14680224, '22': 527488, '60': 4327592, '77': 7569548, '71': 4589704, '15': 184, '23': 4327576, '48': 164064, '01': 98448, '36': 166016, '07': 137408, '39': 527488, '28': 131072, '92': 4196480, '19': 166064, '06': 133296, '56': 4327592, '52': 133248, '65': 166016, '81': 180, '04': 4325528, '12': 4196480, '30': 2097328, '11': 4325520, '45': 4196528, '87': 4325528, '76': 4327560, '33': 4327592, '50': 229504, '26': 6344, '78': 6488204, '47': 166016, '54': 4360376, '93': 204800, '89': 166016, '37': 3208, '09': 139264, '03': 133248, '59': 163968, '24': 231472, '43': 163968, '18': 2296, '63': 166016, '51': 4325504, '35': 4325624, '29': 231560, '62': 13123712, '70': 163968, '32': 2184, '17': 231560, '49': 6488204, '21': 527488}
call_center: 0.0015696647548489584, 1.2082093422619689
catalog_page: 0.0022854563801379575, 3.187742270263742
catalog_returns: 0.13570105559188286, 11.312837024947822
catalog_sales: 1.7811239775835188, 49.143451498945296
customer: 0.014304503083193733, 18.133552433908815
customer_address: 0.018063454693873434, 18.85142289270329
customer_demographics: 0.0036804724427680164, 12.341015773599482
date_dim: 0.0028494815754167954, 85.93439240563796
income_band: 0.001905242330416974, -0.001905242330416974
income_band had no query dependencies
inventory: 0.12977437766865974, 1.384444665160218
item: 0.005764771353487823, 63.15872561352403
promotion: 0.005425073247698095, 5.317778805135938
reason: 0.0019628792837174136, 5.234868686978528
ship_mode: 0.002293837856885713, 1.2113295705655842
store: 0.0024364895285692734, 32.757587927986236
store_returns: 0.33667191121174284, 16.02450715377417
store_sales: 2.772721959112575, 83.62876524115234
time_dim: 0.0025358158010437702, 1.89994823933818
warehouse: 0.002364072161006055, 2.745322335139625
web_page: 0.003958722821659302, 1.6864675357534622
web_returns: 0.0720663779903901, 11.156282847236648
web_sales: 1.0808231108292097, 45.59948521808544
web_site: 0.003012177511485999, 3.9616081679268356
['income_band']
1
call_center: 0.0015696641227666405, 1.208209342894051
catalog_page: 0.0022853623611180803, 3.187742364282762
catalog_returns: 0.1350371374350565, 11.313500943104648
promotion: 0.005425069217452302, 5.317778809166184
ship_mode: 0.0022938377656968006, 1.2113295706567733
store_returns: 0.33562728138216524, 16.025551783603746
time_dim: 0.00253575420448031, 1.8999483009347433
web_page: 0.003958719012752439, 1.6864675395623692
web_returns: 0.07174412855478263, 11.156605096672255
web_site: 0.0030121768435888295, 3.961608168594733
[]
0
{'67': 166016, '27': 166080, '14': 4327560, '22': 527488, '39': 527488, '28': 131072, '09': 139264, '18': 2296, '85': 3145728, '20': 0, '80': 10555398, '98': 0, '97': 0, '61': 4096, '40': 4, '57': 1, '95': 10485760, '66': 278528, '69': 0, '75': 2162692, '05': 10551302, '58': 0, '16': 5, '38': 0, '82': 0, '55': 0, '08': 0, '02': 0, '44': 0, '31': 0, '74': 0, '10': 0, '53': 0, '42': 0, '25': 65536, '86': 0, '99': 16385, '94': 10485760, '60': 0, '77': 3211268, '71': 262144, '15': 0, '23': 0, '48': 0, '36': 0, '07': 4096, '92': 0, '19': 0, '06': 0, '56': 0, '52': 0, '65': 0, '04': 0, '12': 0, '11': 0, '45': 0, '87': 0, '76': 0, '33': 0, '50': 65536, '26': 4096, '78': 2162692, '47': 0, '54': 0, '93': 65536, '89': 0, '37': 0, '03': 0, '59': 0, '24': 65536, '43': 0, '63': 0, '51': 0, '35': 0, '29': 65536, '62': 8404992, '70': 0, '32': 0, '17': 65536, '49': 2162692, '21': 0}
{}
{'67': 166016, '27': 166080, '14': 4327560, '22': 527488, '39': 527488, '28': 131072, '09': 139264, '18': 2296, '85': 3145728, '20': 0, '80': 10555398, '98': 0, '97': 0, '61': 4096, '40': 4, '57': 1, '95': 10485760, '66': 278528, '69': 0, '75': 2162692, '05': 10551302, '58': 0, '16': 5, '38': 0, '82': 0, '55': 0, '08': 0, '02': 0, '44': 0, '31': 0, '74': 0, '10': 0, '53': 0, '42': 0, '25': 65536, '86': 0, '99': 16385, '94': 10485760, '60': 0, '77': 3211268, '71': 262144, '15': 0, '23': 0, '48': 0, '36': 0, '07': 4096, '92': 0, '19': 0, '06': 0, '56': 0, '52': 0, '65': 0, '04': 0, '12': 0, '11': 0, '45': 0, '87': 0, '76': 0, '33': 0, '50': 65536, '26': 4096, '78': 2162692, '47': 0, '54': 0, '93': 65536, '89': 0, '37': 0, '03': 0, '59': 0, '24': 65536, '43': 0, '63': 0, '51': 0, '35': 0, '29': 65536, '62': 8404992, '70': 0, '32': 0, '17': 65536, '49': 2162692, '21': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 17.01836250418881, 10.297721634146374, 0.00014901161193847656, 0.33910708002035966, 6.307974119140308, 0.042617944438080174, 0.030792714831748603
{17.01836250418881: []}
Best Cost: $17.01836250418881;
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 12, 14, 16, 18, 20, 21, 23]
{'85': 7348448, '20': 2184, '67': 166016, '80': 14915726, '98': 133248, '97': 131208, '61': 170160, '40': 526476, '57': 2185, '95': 14680224, '66': 4997256, '69': 4325624, '75': 6490252, '27': 166080, '05': 14909582, '58': 4327560, '16': 173, '38': 4325528, '83': 2164868, '82': 134272, '55': 133248, '08': 164016, '02': 4194440, '14': 4327560, '44': 133120, '31': 4325536, '74': 4325520, '10': 4325624, '53': 166016, '42': 133248, '25': 231560, '86': 4196480, '99': 540809, '94': 14680224, '22': 527488, '60': 4327592, '77': 7569548, '71': 4589704, '15': 184, '23': 4327576, '48': 164064, '01': 98448, '36': 166016, '07': 137408, '39': 527488, '28': 131072, '92': 4196480, '19': 166064, '06': 133296, '56': 4327592, '52': 133248, '65': 166016, '81': 180, '04': 4325528, '12': 4196480, '30': 2097328, '11': 4325520, '45': 4196528, '87': 4325528, '76': 4327560, '33': 4327592, '50': 229504, '26': 6344, '78': 6488204, '47': 166016, '54': 4360376, '93': 204800, '89': 166016, '37': 3208, '09': 139264, '03': 133248, '59': 163968, '24': 231472, '43': 163968, '18': 2296, '63': 166016, '51': 4325504, '35': 4325624, '29': 231560, '62': 13123712, '70': 163968, '32': 2184, '17': 231560, '49': 6488204, '21': 527488}
['41']
Excluding table household_demographics and any queries that depend on it
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['85', '20', '67', '80', '98', '97', '61', '40', '57', '95', '66', '69', '75', '27', '05', '58', '16', '38', '83', '82', '55', '08', '02', '14', '44', '31', '74', '10', '53', '42', '25', '86', '99', '94', '22', '60', '77', '71', '15', '23', '48', '01', '36', '07', '39', '28', '92', '19', '06', '56', '52', '65', '81', '04', '12', '30', '11', '45', '87', '76', '33', '50', '26', '78', '47', '54', '93', '89', '37', '09', '03', '59', '24', '43', '18', '63', '51', '35', '29', '62', '70', '32', '17', '49', '21'])
22
Optimal Subset: 0b111111111111110011111111
dict_keys(['85', '20', '67', '80', '98', '97', '61', '40', '57', '95', '66', '69', '75', '27', '05', '58', '16', '38', '83', '82', '55', '08', '02', '14', '44', '31', '74', '10', '53', '42', '25', '86', '99', '94', '22', '60', '77', '71', '15', '23', '48', '01', '36', '07', '39', '28', '92', '19', '06', '56', '52', '65', '81', '04', '12', '30', '11', '45', '87', '76', '33', '50', '26', '78', '47', '54', '93', '89', '37', '09', '03', '59', '24', '43', '18', '63', '51', '35', '29', '62', '70', '32', '17', '49', '21'])
Function: 17.01836250418881, 10.297721634146374, 0.00014901161193847656, 0.33910708002035966, 6.307974119140308, 0.042617944438080174, 0.030792714831748603
Real: 17.01836250418881, 10.297721634146374, 0.00014901161193847656, 0.33910708002035966, 6.307974119140308, 0.042617944438080174, 0.030792714831748603
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 85; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $10.297721634146374; Stayed Qs: $0.00014901161193847656; Migration Cost: $6.7204918584304965
Movement Cost: $0.33910708002035966, Load Cost: $6.307974119140308, Storage Cost: $0.042617944438080174, API Cost: $0.030792714831748603
Final cost: $17.01836250418881, Baseline: $108.41442346572876, Diff: $91.39606096153994, %: 84.30249226979605%
