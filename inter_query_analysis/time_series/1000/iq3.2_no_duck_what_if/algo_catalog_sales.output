Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $4.581111900491715, BigQuery Total: $61.903661489486694
01: $0.04251913135846455
03: $0.47502096817970274
06: $0.3632350847975413
07: $1.2739325496244431
08: $0.4728430971686045
09: $4.166115921802521
11: $1.6160064807542165
12: $0.1233327794043223
13: $1.633325179608663
19: $0.7144547079753876
21: $0.13902823099136352
22: $0.6999924237171808
24: $1.4943556775426865
27: $3.8892385180123648
28: $4.860953305471738
30: $0.012125212178230286
31: $1.7751692107454935
34: $0.6075768459717432
36: $2.4807855692911147
39: $0.27900081528663634
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
45: $0.15160362540721894
46: $1.1849251066462199
47: $0.48158571960449215
48: $1.0463716178750992
50: $0.661454455537796
51: $0.5829390027141571
52: $0.4759971203915278
53: $0.5979665479230881
55: $0.4760878943316142
59: $0.4287443129523595
61: $1.6324246692927677
62: $0.1538115687449773
63: $0.597844746427536
65: $0.5961180507278443
67: $6.203618795018196
68: $1.4156545792627335
70: $1.8907469585673014
73: $0.6095429498179754
74: $0.779892116077741
79: $1.1831403943077723
81: $0.022080078539848325
82: $0.22990267293135325
83: $0.06329148495833078
84: $0.014300001715024312
85: $0.3001966362142563
86: $0.3697533963696162
88: $2.8978831026617686
89: $0.5970417350339889
90: $0.18988620407740275
91: $0.03386976528962453
92: $0.24658876627922058
93: $0.7705190082454682
94: $0.3080027531592051
95: $0.31277829689025877
96: $0.361907244758606
98: $0.4751735880470276
!!!!!!: 57.32398871755916
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'36': 166016, '84': 66416, '52': 133248, '68': 164272, '59': 163968, '55': 133248, '94': 14680224, '03': 133248, '91': 501, '07': 137408, '11': 4325520, '27': 166080, '81': 180, '88': 426240, '61': 170160, '31': 4325536, '98': 133248, '34': 164240, '74': 4325520, '50': 229504, '08': 164016, '30': 2097328, '93': 204800, '95': 14680224, '82': 134272, '67': 166016, '89': 166016, '46': 164272, '63': 166016, '51': 4325504, '79': 164240, '96': 426240, '43': 163968, '45': 4196528, '48': 164064, '19': 166064, '53': 166016, '65': 166016, '73': 164240, '22': 527488, '09': 139264, '83': 2164868, '24': 231472, '86': 4196480, '62': 13123712, '47': 166016, '21': 527488, '28': 131072, '39': 527488, '44': 133120, '85': 7348448, '92': 4196480, '12': 4196480, '01': 98448, '06': 133296, '13': 164320, '42': 133248, '70': 163968, '90': 5505280}
call_center: 0.0015696641462530625, 0.032300101143371465
catalog_page: 0.0022853658546035382, -0.0022853658546035382
catalog_page had no query dependencies
catalog_returns: 0.13506180678843943, -0.015820478000635796
customer: 0.014263500545064641, 12.336286023558733
customer_address: 0.018054804020273717, 12.86966049628859
customer_demographics: 0.0036799815017779037, 8.187554286837697
date_dim: 0.0028493861361294005, 41.67785184545319
household_demographics: 0.0020465215010509884, 10.129964852616483
income_band: 0.0019052422970436635, 0.012394759417980648
inventory: 0.12949557618662716, 1.2184285667399068
item: 0.005763112174051538, 26.48421553128464
promotion: 0.005425069367205034, 2.900932149550006
reason: 0.0019628791947050887, 5.23486868706754
ship_mode: 0.002293837769085127, 0.1515177309758922
store: 0.0024364843880191546, 34.21836276394178
store_returns: 0.3356660969231401, 2.7107736624346304
store_sales: 2.7648174242693857, 51.097010122708596
time_dim: 0.0025357564932374037, 3.44714079500454
warehouse: 0.0023640719672287985, 1.269468966772929
web_page: 0.0039587191542808315, 0.48612412113737824
web_returns: 0.07175610244813486, 0.9246382809521464
web_sales: 1.0777979503953, 5.832162886442786
web_site: 0.003012176868406032, 0.7715804419260351
['catalog_page', 'catalog_returns']
2
call_center: 0.0015696637693416407, -0.0015696637693416407
call_center had no query dependencies
customer: 0.014238107135336235, 12.280361573138988
customer_address: 0.01804944654463519, 12.813716009934755
income_band: 0.0019052422763751343, 0.012394759438649178
promotion: 0.005425066963964778, 2.900932151953246
ship_mode: 0.0022938377147090723, 0.15151773103026825
store_returns: 0.33504318294008956, 2.64810509145935
web_page: 0.003958716883025236, 0.4861241234086338
web_returns: 0.07156394473466883, 0.8615389537072816
web_sales: 1.0759244288549852, 5.834036407983101
web_site: 0.0030121764701381724, 0.771580442324303
['call_center']
1
income_band: 0.0019052422600462889, 0.012394759454978022
ship_mode: 0.002293837671750128, 0.1515177310732272
web_page: 0.003958715088655574, 0.48612412520300347
web_returns: 0.07141213356369662, 0.8616907648782539
web_site: 0.003012176155492931, 0.7715804426389482
[]
0
{'27': 166080, '88': 426240, '67': 166016, '22': 527488, '09': 139264, '28': 131072, '39': 527488, '36': 0, '52': 0, '68': 48, '59': 0, '55': 0, '03': 0, '07': 4096, '11': 4194320, '61': 4144, '31': 4194336, '98': 0, '34': 16, '50': 65536, '08': 48, '93': 65536, '82': 0, '89': 0, '46': 48, '63': 0, '79': 16, '96': 0, '43': 0, '48': 32, '19': 48, '53': 0, '65': 0, '73': 16, '24': 65584, '47': 0, '21': 0, '44': 0, '06': 48, '13': 32, '42': 0, '70': 0, '84': 512, '94': 10485760, '74': 0, '95': 10485760, '51': 0, '45': 0, '86': 0, '62': 8404992, '85': 3145728, '92': 0, '12': 0, '01': 0, '90': 1048576}
{}
{'27': 166080, '88': 426240, '67': 166016, '22': 527488, '09': 139264, '28': 131072, '39': 527488, '36': 0, '52': 0, '68': 48, '59': 0, '55': 0, '03': 0, '07': 4096, '11': 4194320, '61': 4144, '31': 4194336, '98': 0, '34': 16, '50': 65536, '08': 48, '93': 65536, '82': 0, '89': 0, '46': 48, '63': 0, '79': 16, '96': 0, '43': 0, '48': 32, '19': 48, '53': 0, '65': 0, '73': 16, '24': 65584, '47': 0, '21': 0, '44': 0, '06': 48, '13': 32, '42': 0, '70': 0, '84': 512, '94': 10485760, '74': 0, '95': 10485760, '51': 0, '45': 0, '86': 0, '62': 8404992, '85': 3145728, '92': 0, '12': 0, '01': 0, '90': 1048576}
STARTING PHASE 2: 0b0
----
[]
Function: 9.3730487206868, 4.5554218788830445, 0.1434922218322754, 0.22232114129036198, 4.4164737204360955, 0.01509605743721038, 0.02024370080781281
{9.3730487206868: []}
Best Cost: $9.3730487206868;
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
{'36': 166016, '84': 66416, '52': 133248, '68': 164272, '59': 163968, '55': 133248, '94': 14680224, '03': 133248, '07': 137408, '11': 4325520, '27': 166080, '88': 426240, '61': 170160, '31': 4325536, '98': 133248, '34': 164240, '74': 4325520, '50': 229504, '08': 164016, '30': 2097328, '93': 204800, '95': 14680224, '82': 134272, '67': 166016, '89': 166016, '46': 164272, '63': 166016, '51': 4325504, '79': 164240, '96': 426240, '43': 163968, '45': 4196528, '48': 164064, '19': 166064, '53': 166016, '65': 166016, '73': 164240, '22': 527488, '09': 139264, '24': 231472, '86': 4196480, '62': 13123712, '47': 166016, '21': 527488, '28': 131072, '39': 527488, '44': 133120, '85': 7348448, '92': 4196480, '12': 4196480, '01': 98448, '06': 133296, '13': 164320, '42': 133248, '70': 163968, '90': 5505280}
['91', '81', '41', '83']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
dict_keys(['36', '84', '52', '68', '59', '55', '94', '03', '07', '11', '27', '88', '61', '31', '98', '34', '74', '50', '08', '30', '93', '95', '82', '67', '89', '46', '63', '51', '79', '96', '43', '45', '48', '19', '53', '65', '73', '22', '09', '24', '86', '62', '47', '21', '28', '39', '44', '85', '92', '12', '01', '06', '13', '42', '70', '90'])
20
Optimal Subset: 0b111111111111111111110000
dict_keys(['36', '84', '52', '68', '59', '55', '94', '03', '07', '11', '27', '88', '61', '31', '98', '34', '74', '50', '08', '30', '93', '95', '82', '67', '89', '46', '63', '51', '79', '96', '43', '45', '48', '19', '53', '65', '73', '22', '09', '24', '86', '62', '47', '21', '28', '39', '44', '85', '92', '12', '01', '06', '13', '42', '70', '90'])
Function: 9.3730487206868, 4.5554218788830445, 0.1434922218322754, 0.22232114129036198, 4.4164737204360955, 0.01509605743721038, 0.02024370080781281
Real: 9.3730487206868, 4.5554218788830445, 0.1434922218322754, 0.22232114129036198, 4.4164737204360955, 0.01509605743721038, 0.02024370080781281
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 56; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $4.5554218788830445; Stayed Qs: $0.1434922218322754; Migration Cost: $4.67413461997148
Movement Cost: $0.22232114129036198, Load Cost: $4.4164737204360955, Storage Cost: $0.01509605743721038, API Cost: $0.02024370080781281
Final cost: $9.3730487206868, Baseline: $61.903661489486694, Diff: $52.5306127687999, %: 84.85865214567534%
