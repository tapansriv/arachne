Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.6403891919517495, BigQuery Total: $92.02776551246643
02: $0.25014779800891873
03: $0.47502096817970274
05: $1.4304585849189757
07: $1.2739325496244431
09: $4.166115921802521
12: $0.1233327794043223
13: $1.633325179608663
14: $15.638491943470637
16: $0.7151701463317871
17: $0.9640249739869435
20: $0.25383286993821463
21: $0.13902823099136352
22: $0.6999924237171808
25: $1.1788075348933538
26: $0.6572775177415212
27: $3.8892385180123648
28: $4.860953305471738
29: $0.954251956636111
31: $1.7751692107454935
32: $0.5117330439758301
33: $1.1213197820679346
36: $2.4807855692911147
37: $0.16629489990234375
39: $0.27900081528663634
40: $0.41604152888298035
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
47: $0.48158571960449215
48: $1.0463716178750992
49: $1.8010069972499212
50: $0.661454455537796
51: $0.5829390027141571
52: $0.4759971203915278
53: $0.5979665479230881
55: $0.4760878943316142
56: $1.1214404756466547
57: $0.27304382418314616
58: $0.8539149026123682
59: $0.4287443129523595
60: $1.1220686246951421
62: $0.1538115687449773
63: $0.597844746427536
65: $0.5961180507278443
66: $0.8382468031756083
67: $6.203618795018196
70: $1.8907469585673014
71: $1.0642372519636154
72: $0.3371178349939982
75: $2.7449614957491555
76: $1.0597011683511735
77: $1.3902296223608652
78: $1.1057289998229343
80: $1.7595691417249042
82: $0.22990267293135325
83: $0.06329148495833078
85: $0.3001966362142563
86: $0.3697533963696162
88: $2.8978831026617686
89: $0.5970417350339889
90: $0.18988620407740275
92: $0.24658876627922058
93: $0.7705190082454682
94: $0.3080027531592051
95: $0.31277829689025877
96: $0.361907244758606
97: $0.4646914958365758
98: $0.4751735880470276
99: $0.22156503650188447
!!!!!!: 85.38881544907886
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'70': 163968, '62': 13123712, '02': 4194440, '75': 6490252, '52': 133248, '12': 4196480, '25': 231560, '31': 4325536, '20': 2184, '53': 166016, '63': 166016, '57': 2185, '97': 131208, '33': 4327592, '66': 4997256, '51': 4325504, '48': 164064, '56': 4327592, '95': 14680224, '96': 426240, '65': 166016, '36': 166016, '37': 3208, '44': 133120, '03': 133248, '29': 231560, '94': 14680224, '67': 166016, '99': 540809, '55': 133248, '43': 163968, '88': 426240, '78': 6488204, '07': 137408, '21': 527488, '85': 7348448, '76': 4327560, '58': 4327560, '42': 133248, '98': 133248, '28': 131072, '72': 531916, '16': 173, '80': 14915726, '50': 229504, '14': 4327560, '22': 527488, '82': 134272, '17': 231560, '86': 4196480, '13': 164320, '90': 5505280, '40': 526476, '71': 4589704, '59': 163968, '83': 2164868, '05': 14909582, '89': 166016, '49': 6488204, '09': 139264, '77': 7569548, '93': 204800, '39': 527488, '60': 4327592, '47': 166016, '27': 166080, '32': 2184, '92': 4196480, '26': 6344}
call_center: 0.0015696644559437534, 1.208209342560874
catalog_page: 0.0022854119195137427, 3.187742314724366
catalog_returns: 0.13538709554721579, 11.628188741446635
catalog_sales: 1.7781932697773333, 38.63718298584616
customer_address: 0.018059206010332476, 9.437783517224162
customer_demographics: 0.00368023132248065, 9.133779622747864
date_dim: 0.0028494347014566533, 71.25133420766525
household_demographics: 0.002046522370492059, 5.4180730437299465
income_band: 0.0019052423140260384, -0.0019052423140260384
income_band had no query dependencies
inventory: 0.12963744737597763, 1.7216994304468984
item: 0.005763956465689645, 54.32627169339341
promotion: 0.005425071341836452, 4.0224719727430305
reason: 0.001962879239999986, 5.234868687022246
ship_mode: 0.0022938378137634173, 1.2113295706087066
store: 0.002436487003844415, 32.53826741650276
store_returns: 0.33617791654601104, 14.488126339538747
store_sales: 2.7688397334453985, 74.79384105590447
time_dim: 0.002535786672664592, 5.349624819964337
warehouse: 0.002364072065834479, 3.0824401702287947
web_page: 0.003958721020466555, 1.8763537416320577
web_returns: 0.07191398955793499, 11.144310023490872
web_sales: 1.0793373364330134, 36.58464486998471
web_site: 0.00301217719564432, 3.9616081682426767
['income_band']
1
call_center: 0.0015696638438964879, 1.2082093431729213
catalog_page: 0.0022853208806056825, 3.187742405763274
catalog_returns: 0.13474422154025847, 11.628831615453594
customer_address: 0.018050506278444088, 9.437792216956051
promotion: 0.005425067439336972, 4.02247197664553
ship_mode: 0.002293837725464911, 1.211329570697005
store_returns: 0.33516639824752403, 14.489137857837234
web_page: 0.003958717332290246, 1.8763537453202341
web_returns: 0.07160195443164925, 11.144622058617157
web_site: 0.003012176548917423, 3.961608168889404
[]
0
{'67': 166016, '88': 426240, '28': 131072, '14': 4327560, '22': 527488, '09': 139264, '39': 527488, '27': 166080, '70': 0, '62': 8404992, '02': 0, '75': 2162692, '52': 0, '12': 0, '25': 65536, '31': 32, '20': 0, '53': 0, '63': 0, '57': 1, '97': 0, '33': 32, '66': 16384, '51': 0, '48': 32, '56': 32, '95': 10485792, '96': 0, '65': 0, '36': 0, '37': 0, '44': 0, '03': 0, '29': 65536, '94': 10485792, '99': 16385, '55': 0, '43': 0, '78': 2162692, '07': 4096, '21': 0, '85': 3145760, '76': 0, '58': 0, '42': 0, '98': 0, '72': 4100, '16': 37, '80': 10555398, '50': 65536, '82': 0, '17': 65536, '86': 0, '13': 32, '90': 1048576, '40': 4, '71': 0, '59': 0, '05': 10551302, '89': 0, '49': 2162692, '77': 3211268, '93': 65536, '60': 32, '47': 0, '32': 0, '92': 0, '26': 4096}
{}
{'67': 166016, '88': 426240, '28': 131072, '14': 4327560, '22': 527488, '09': 139264, '39': 527488, '27': 166080, '70': 0, '62': 8404992, '02': 0, '75': 2162692, '52': 0, '12': 0, '25': 65536, '31': 32, '20': 0, '53': 0, '63': 0, '57': 1, '97': 0, '33': 32, '66': 16384, '51': 0, '48': 32, '56': 32, '95': 10485792, '96': 0, '65': 0, '36': 0, '37': 0, '44': 0, '03': 0, '29': 65536, '94': 10485792, '99': 16385, '55': 0, '43': 0, '78': 2162692, '07': 4096, '21': 0, '85': 3145760, '76': 0, '58': 0, '42': 0, '98': 0, '72': 4100, '16': 37, '80': 10555398, '50': 65536, '82': 0, '17': 65536, '86': 0, '13': 32, '90': 1048576, '40': 4, '71': 0, '59': 0, '05': 10551302, '89': 0, '49': 2162692, '77': 3211268, '93': 65536, '60': 32, '47': 0, '32': 0, '92': 0, '26': 4096}
STARTING PHASE 2: 0b0
----
[]
Function: 13.337057749109835, 6.638801051775612, 0.00014901161193847656, 0.33838229111686813, 6.295872583370209, 0.03312544084999314, 0.030727370385214683
{13.337057749109835: []}
Best Cost: $13.337057749109835;
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
{'70': 163968, '62': 13123712, '02': 4194440, '75': 6490252, '52': 133248, '12': 4196480, '25': 231560, '31': 4325536, '20': 2184, '53': 166016, '63': 166016, '57': 2185, '97': 131208, '33': 4327592, '66': 4997256, '51': 4325504, '48': 164064, '56': 4327592, '95': 14680224, '96': 426240, '65': 166016, '36': 166016, '37': 3208, '44': 133120, '03': 133248, '29': 231560, '94': 14680224, '67': 166016, '99': 540809, '55': 133248, '43': 163968, '88': 426240, '78': 6488204, '07': 137408, '21': 527488, '85': 7348448, '76': 4327560, '58': 4327560, '42': 133248, '98': 133248, '28': 131072, '72': 531916, '16': 173, '80': 14915726, '50': 229504, '14': 4327560, '22': 527488, '82': 134272, '17': 231560, '86': 4196480, '13': 164320, '90': 5505280, '40': 526476, '71': 4589704, '59': 163968, '83': 2164868, '05': 14909582, '89': 166016, '49': 6488204, '09': 139264, '77': 7569548, '93': 204800, '39': 527488, '60': 4327592, '47': 166016, '27': 166080, '32': 2184, '92': 4196480, '26': 6344}
['41']
Excluding table customer and any queries that depend on it
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
dict_keys(['70', '62', '02', '75', '52', '12', '25', '31', '20', '53', '63', '57', '97', '33', '66', '51', '48', '56', '95', '96', '65', '36', '37', '44', '03', '29', '94', '67', '99', '55', '43', '88', '78', '07', '21', '85', '76', '58', '42', '98', '28', '72', '16', '80', '50', '14', '22', '82', '17', '86', '13', '90', '40', '71', '59', '83', '05', '89', '49', '09', '77', '93', '39', '60', '47', '27', '32', '92', '26'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['70', '62', '02', '75', '52', '12', '25', '31', '20', '53', '63', '57', '97', '33', '66', '51', '48', '56', '95', '96', '65', '36', '37', '44', '03', '29', '94', '67', '99', '55', '43', '88', '78', '07', '21', '85', '76', '58', '42', '98', '28', '72', '16', '80', '50', '14', '22', '82', '17', '86', '13', '90', '40', '71', '59', '83', '05', '89', '49', '09', '77', '93', '39', '60', '47', '27', '32', '92', '26'])
Function: 13.337057749109835, 6.638801051775612, 0.00014901161193847656, 0.33838229111686813, 6.295872583370209, 0.03312544084999314, 0.030727370385214683
Real: 13.337057749109835, 6.638801051775612, 0.00014901161193847656, 0.33838229111686813, 6.295872583370209, 0.03312544084999314, 0.030727370385214683
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $6.638801051775612; Stayed Qs: $0.00014901161193847656; Migration Cost: $6.6981076857222845
Movement Cost: $0.33838229111686813, Load Cost: $6.295872583370209, Storage Cost: $0.03312544084999314, API Cost: $0.030727370385214683
Final cost: $13.337057749109835, Baseline: $92.02776551246643, Diff: $78.6907077633566, %: 85.50757189980546%
