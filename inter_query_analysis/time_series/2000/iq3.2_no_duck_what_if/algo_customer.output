Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.905622279383342, BigQuery Total: $181.02735877037048
02: $0.5465954839340845
03: $0.9802722319348653
05: $2.9974008215141295
07: $2.6465265779876708
09: $8.54214733932495
12: $0.23884099586963653
13: $3.376772032376925
14: $31.446340173446337
16: $1.3307490620040894
17: $2.038808402964274
20: $0.5148479410235087
21: $0.00520494754632314
22: $0.030213471749623615
25: $2.4896319906806945
26: $1.3754505428679784
27: $8.013910150156022
28: $10.11496771024545
29: $2.030406800688108
31: $3.666085393134753
32: $1.0331779216305415
33: $2.241665090312958
36: $5.124345130489667
37: $0.13233230803489685
39: $0.011899112901687622
40: $0.8335138906304042
41: $-0.001560076328913371
42: $0.9816244987551371
43: $0.9920641914002101
44: $1.8940231076749166
47: $1.1026310430765152
48: $2.1636873310550055
49: $3.7103639075326917
50: $1.2578326120678585
51: $1.2191740658871333
52: $0.9817617565568288
53: $1.2288573868672052
55: $0.9814906522480646
56: $2.241733239223162
57: $0.5912433275572458
58: $1.6821158746655782
59: $0.9201084773588181
60: $2.2423039103364943
62: $0.31730496872584024
63: $1.2287701210403443
65: $1.227671975200971
66: $1.7192268790578842
67: $13.016806929626465
70: $3.8910612282657624
71: $2.183981887954076
72: $0.9901497989145914
75: $5.665022974378268
76: $2.1740629166094463
77: $2.8618988512357078
78: $3.0076532274945578
80: $3.888387317752838
82: $0.2606608459568024
83: $0.125806760931015
85: $0.6193626808309555
86: $0.7661172444391251
88: $5.909832486608823
89: $1.2288063448842366
90: $0.3863231610997518
92: $0.5084705054950714
93: $1.5836714638996123
94: $0.670769666852951
95: $0.6354947167984645
96: $0.7369839549954732
97: $1.0412967393541337
98: $0.9812050623512268
99: $0.5433749508492152
!!!!!!: 174.123296567316
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'63': 166016, '17': 231560, '16': 173, '85': 7348448, '07': 137408, '93': 204800, '94': 14680224, '92': 4196480, '62': 13123712, '55': 133248, '27': 166080, '60': 4327592, '26': 6344, '52': 133248, '28': 131072, '39': 527488, '29': 231560, '42': 133248, '82': 134272, '05': 14909582, '96': 426240, '37': 3208, '44': 133120, '56': 4327592, '83': 2164868, '51': 4325504, '14': 4327560, '98': 133248, '78': 6488204, '12': 4196480, '70': 163968, '95': 14680224, '67': 166016, '53': 166016, '25': 231560, '88': 426240, '89': 166016, '80': 14915726, '58': 4327560, '57': 2185, '13': 164320, '43': 163968, '65': 166016, '47': 166016, '50': 229504, '90': 5505280, '22': 527488, '21': 527488, '71': 4589704, '49': 6488204, '72': 531916, '59': 163968, '48': 164064, '31': 4325536, '99': 540809, '03': 133248, '32': 2184, '66': 4997256, '76': 4327560, '33': 4327592, '02': 4194440, '09': 139264, '97': 131208, '75': 6490252, '77': 7569548, '20': 2184, '36': 166016, '86': 4196480, '40': 526476}
call_center: 0.001437339113720957, 2.4639300012968293
catalog_page: 0.002048509993885062, 6.883739629273083
catalog_returns: 0.32691577823660867, 25.084030834151683
catalog_sales: 3.545216314222112, 80.00851991842576
customer_address: 0.01566384618290692, 19.17295927674285
customer_demographics: 0.0036127568870319106, 19.182246357302116
date_dim: 0.0033594330224386024, 144.95198791044461
household_demographics: 0.003043144973277677, 11.397018289022286
income_band: 0.001764134715615144, -0.001764134715615144
income_band had no query dependencies
inventory: 0.021699350823507792, 1.4087611342804174
item: 0.0032577406431628605, 109.35783542276766
promotion: 0.0052208141302550574, 8.895293423392824
reason: 0.0016772709355649831, 10.743504213119953
ship_mode: 0.001843948113511699, 2.578062850519428
store: 0.0023051567399181403, 67.72437042356613
store_returns: 0.6486906685954131, 31.00819446254434
store_sales: 5.644270251000986, 154.55255597657015
time_dim: 0.0029987592801392236, 10.933349610435869
warehouse: 0.0021780985120641743, 4.448709921863506
web_page: 0.0020416051671636234, 3.865543087999251
web_returns: 0.1392532123039856, 24.042907713017595
web_sales: 1.9765796303551901, 75.66011632422672
web_site: 0.0026735800178935734, 8.50668391162633
['income_band']
1
call_center: 0.001437338546435109, 2.463930001864115
catalog_page: 0.0020484489668281896, 6.883739690300139
catalog_returns: 0.3247323501876563, 25.086214262200635
customer_address: 0.01565252925711723, 19.17297059366864
inventory: 0.021676280556583938, 1.408784204547341
promotion: 0.005220811798350717, 8.895293425724727
ship_mode: 0.0018439479621368195, 2.5780628506708028
store_returns: 0.6452443113944509, 31.011640819745303
warehouse: 0.002178098290703439, 4.448709922084866
web_page: 0.002041604231581562, 3.8655430889348334
web_returns: 0.13819475560037303, 24.043966169721205
web_site: 0.0026735791697067844, 8.506683912474516
[]
0
{'27': 166080, '28': 131072, '14': 4327560, '67': 166016, '88': 426240, '09': 139264, '63': 0, '17': 65536, '16': 37, '85': 3145760, '07': 4096, '93': 65536, '94': 10485792, '92': 0, '62': 8929280, '55': 0, '60': 32, '26': 4096, '52': 0, '29': 65536, '42': 0, '82': 1024, '05': 10551302, '96': 0, '37': 1024, '44': 0, '56': 32, '51': 0, '98': 0, '78': 2162692, '12': 0, '70': 0, '95': 10485792, '53': 0, '25': 65536, '89': 0, '80': 10555398, '58': 0, '57': 1, '13': 32, '43': 0, '65': 0, '47': 0, '50': 65536, '90': 1048576, '22': 525312, '71': 0, '49': 2162692, '72': 529412, '59': 0, '48': 32, '31': 32, '99': 540673, '03': 0, '32': 0, '66': 540672, '76': 0, '33': 32, '02': 0, '97': 0, '75': 2162692, '77': 3211268, '20': 0, '36': 0, '86': 0, '40': 524292}
{}
{'27': 166080, '28': 131072, '14': 4327560, '67': 166016, '88': 426240, '09': 139264, '63': 0, '17': 65536, '16': 37, '85': 3145760, '07': 4096, '93': 65536, '94': 10485792, '92': 0, '62': 8929280, '55': 0, '60': 32, '26': 4096, '52': 0, '29': 65536, '42': 0, '82': 1024, '05': 10551302, '96': 0, '37': 1024, '44': 0, '56': 32, '51': 0, '98': 0, '78': 2162692, '12': 0, '70': 0, '95': 10485792, '53': 0, '25': 65536, '89': 0, '80': 10555398, '58': 0, '57': 1, '13': 32, '43': 0, '65': 0, '47': 0, '50': 65536, '90': 1048576, '22': 525312, '71': 0, '49': 2162692, '72': 529412, '59': 0, '48': 32, '31': 32, '99': 540673, '03': 0, '32': 0, '66': 540672, '76': 0, '33': 32, '02': 0, '97': 0, '75': 2162692, '77': 3211268, '20': 0, '36': 0, '86': 0, '40': 524292}
STARTING PHASE 2: 0b0
----
[]
Function: 19.918505455184096, 6.904002598409654, 5.9604644775390625e-05, 0.6584647845412837, 12.20118361061096, 0.09520996231547614, 0.05958489466194809
{19.918505455184096: []}
Best Cost: $19.918505455184096;
[3, 6, 7, 8, 11, 13, 15, 17, 18, 22, 0, 1, 2, 5, 10, 12, 14, 16, 19, 20, 21, 23]
{'63': 166016, '17': 231560, '16': 173, '85': 7348448, '07': 137408, '93': 204800, '94': 14680224, '92': 4196480, '62': 13123712, '55': 133248, '27': 166080, '60': 4327592, '26': 6344, '52': 133248, '28': 131072, '39': 527488, '29': 231560, '42': 133248, '82': 134272, '05': 14909582, '96': 426240, '37': 3208, '44': 133120, '56': 4327592, '83': 2164868, '51': 4325504, '14': 4327560, '98': 133248, '78': 6488204, '12': 4196480, '70': 163968, '95': 14680224, '67': 166016, '53': 166016, '25': 231560, '88': 426240, '89': 166016, '80': 14915726, '58': 4327560, '57': 2185, '13': 164320, '43': 163968, '65': 166016, '47': 166016, '50': 229504, '90': 5505280, '22': 527488, '21': 527488, '71': 4589704, '49': 6488204, '72': 531916, '59': 163968, '48': 164064, '31': 4325536, '99': 540809, '03': 133248, '32': 2184, '66': 4997256, '76': 4327560, '33': 4327592, '02': 4194440, '09': 139264, '97': 131208, '75': 6490252, '77': 7569548, '20': 2184, '36': 166016, '86': 4196480, '40': 526476}
['41']
Excluding table customer and any queries that depend on it
[3, 6, 7, 8, 11, 13, 15, 17, 18, 22, 0, 1, 2, 5, 10, 12, 14, 16, 19, 20, 21, 23]
dict_keys(['63', '17', '16', '85', '07', '93', '94', '92', '62', '55', '27', '60', '26', '52', '28', '39', '29', '42', '82', '05', '96', '37', '44', '56', '83', '51', '14', '98', '78', '12', '70', '95', '67', '53', '25', '88', '89', '80', '58', '57', '13', '43', '65', '47', '50', '90', '22', '21', '71', '49', '72', '59', '48', '31', '99', '03', '32', '66', '76', '33', '02', '09', '97', '75', '77', '20', '36', '86', '40'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['63', '17', '16', '85', '07', '93', '94', '92', '62', '55', '27', '60', '26', '52', '28', '39', '29', '42', '82', '05', '96', '37', '44', '56', '83', '51', '14', '98', '78', '12', '70', '95', '67', '53', '25', '88', '89', '80', '58', '57', '13', '43', '65', '47', '50', '90', '22', '21', '71', '49', '72', '59', '48', '31', '99', '03', '32', '66', '76', '33', '02', '09', '97', '75', '77', '20', '36', '86', '40'])
Function: 19.918505455184096, 6.904002598409654, 5.9604644775390625e-05, 0.6584647845412837, 12.20118361061096, 0.09520996231547614, 0.05958489466194809
Real: 19.918505455184096, 6.904002598409654, 5.9604644775390625e-05, 0.6584647845412837, 12.20118361061096, 0.09520996231547614, 0.05958489466194809
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $6.904002598409654; Stayed Qs: $5.9604644775390625e-05; Migration Cost: $13.014443252129666
Movement Cost: $0.6584647845412837, Load Cost: $12.20118361061096, Storage Cost: $0.09520996231547614, API Cost: $0.05958489466194809
Final cost: $19.918505455184096, Baseline: $181.02735877037048, Diff: $161.1088533151864, %: 88.99696400009331%
