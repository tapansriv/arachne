Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_address
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $10.260481943772634, BigQuery Total: $187.55235075950623
01: $0.11105679145654043
02: $0.5465954839340845
03: $0.9802722319348653
04: $8.223923111081124
05: $2.9974008215141295
07: $2.6465265779876708
09: $8.54214733932495
11: $3.4012307220792772
12: $0.23884099586963653
14: $31.446340173446337
17: $2.038808402964274
20: $0.5148479410235087
21: $0.00520494754632314
22: $0.030213471749623615
23: $2.1557423163016636
25: $2.4896319906806945
26: $1.3754505428679784
27: $8.013910150156022
28: $10.11496771024545
29: $2.030406800688108
32: $1.0331779216305415
34: $1.161714003645579
36: $5.124345130489667
37: $0.13233230803489685
38: $0.7932188757864634
39: $0.011899112901687622
40: $0.8335138906304042
41: $-0.001560076328913371
42: $0.9816244987551371
43: $0.9920641914002101
44: $1.8940231076749166
47: $1.1026310430765152
49: $3.7103639075326917
50: $1.2578326120678585
51: $1.2191740658871333
52: $0.9817617565568288
53: $1.2288573868672052
55: $0.9814906522480646
57: $0.5912433275572458
58: $1.6821158746655782
59: $0.9201084773588181
62: $0.31730496872584024
63: $1.2287701210403443
65: $1.227671975200971
66: $1.7192268790578842
67: $13.016806929626465
70: $3.8910612282657624
71: $2.183981887954076
72: $0.9901497989145914
73: $1.2395015475352604
74: $2.045917281182607
75: $5.665022974378268
76: $2.1740629166094463
77: $2.8618988512357078
78: $3.0076532274945578
79: $2.4385065128835044
80: $3.888387317752838
82: $0.2606608459568024
83: $0.125806760931015
86: $0.7661172444391251
87: $0.7879442857201894
88: $5.909832486608823
89: $1.2288063448842366
90: $0.3863231610997518
92: $0.5084705054950714
93: $1.5836714638996123
96: $0.7369839549954732
97: $1.0412967393541337
98: $0.9812050623512268
99: $0.5433749508492152
!!!!!!: 177.29342889206245
Excluding table customer_address and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'42': 133248, '43': 163968, '83': 2164868, '92': 4196480, '74': 4325520, '58': 4327560, '12': 4196480, '65': 166016, '99': 540809, '29': 231560, '66': 4997256, '17': 231560, '87': 4325528, '51': 4325504, '14': 4327560, '36': 166016, '88': 426240, '07': 137408, '79': 164240, '40': 526476, '86': 4196480, '75': 6490252, '89': 166016, '53': 166016, '50': 229504, '38': 4325528, '93': 204800, '11': 4325520, '96': 426240, '01': 98448, '28': 131072, '47': 166016, '09': 139264, '49': 6488204, '34': 164240, '02': 4194440, '26': 6344, '80': 14915726, '57': 2185, '98': 133248, '21': 527488, '37': 3208, '39': 527488, '22': 527488, '77': 7569548, '05': 14909582, '97': 131208, '27': 166080, '23': 4327576, '52': 133248, '62': 13123712, '25': 231560, '59': 163968, '90': 5505280, '70': 163968, '44': 133120, '78': 6488204, '04': 4325528, '32': 2184, '73': 164240, '71': 4589704, '72': 531916, '03': 133248, '67': 166016, '55': 133248, '63': 166016, '76': 4327560, '82': 134272, '20': 2184}
call_center: 0.001437339261315928, 1.1331809391451453
catalog_page: 0.0020485258717475585, 6.88373961339522
catalog_returns: 0.3274838569235014, 23.752713693460702
catalog_sales: 3.5504939809849865, 83.90761953867565
customer: 0.013726873563452742, 22.345028574108756
customer_demographics: 0.0036129771062930294, 13.02242409281997
date_dim: 0.0033594758332239614, 148.1221201923803
household_demographics: 0.003043145739698026, 12.859968319943286
income_band: 0.0017641347305852647, -0.0017641347305852647
income_band had no query dependencies
inventory: 0.021705353186144225, 1.408755131917781
item: 0.0032578583681911466, 104.78787538147166
promotion: 0.005220814736963923, 8.895293422786114
reason: 0.001677270965822292, 10.12414153225874
ship_mode: 0.0018439481528960253, 2.5780628504800434
store: 0.00230515729813831, 67.13468991509686
store_returns: 0.6495873329367113, 31.118354589659585
store_sales: 5.651293063385288, 160.86098482396227
time_dim: 0.0029987858835835474, 10.933349583832424
warehouse: 0.0021780985696572405, 4.4487099218059125
web_page: 0.002041605410580955, 3.2461804069248785
web_returns: 0.13952859884333574, 22.117005261995875
web_sales: 1.9792382337995964, 80.74801961544388
web_site: 0.002673580238572628, 7.200419527754235
['income_band']
1
call_center: 0.00143733869403008, 1.133180939712431
catalog_page: 0.0020484648446906866, 6.8837396744222765
catalog_returns: 0.325300428874549, 23.754897121509654
customer: 0.013673272127565892, 22.345082175544643
inventory: 0.02168228291922037, 1.4087782021847046
promotion: 0.005220812405059583, 8.895293425118018
ship_mode: 0.0018439480015211458, 2.5780628506314183
store_returns: 0.6461409757357491, 31.121800946860546
warehouse: 0.002178098348296505, 4.448709922027273
web_page: 0.002041604474998893, 3.246180407860461
web_returns: 0.13847014213972317, 22.118063718699485
web_site: 0.002673579390385839, 7.2004195286024215
[]
0
{'14': 4327560, '88': 426240, '28': 131072, '09': 139264, '27': 166080, '67': 166016, '42': 0, '43': 0, '92': 0, '74': 16, '58': 0, '12': 0, '65': 0, '99': 540673, '29': 65536, '66': 540672, '17': 65536, '87': 16, '51': 0, '36': 0, '07': 4096, '79': 16, '40': 524292, '86': 0, '75': 2162692, '89': 0, '53': 0, '50': 65536, '38': 16, '93': 65536, '11': 16, '96': 0, '47': 0, '49': 2162692, '34': 16, '02': 0, '26': 4096, '80': 10555398, '57': 1, '98': 0, '37': 1024, '22': 525312, '77': 3211268, '05': 10551302, '97': 0, '23': 16, '52': 0, '62': 8929280, '25': 65536, '59': 0, '90': 1048576, '70': 0, '44': 0, '78': 2162692, '04': 16, '32': 0, '73': 16, '71': 0, '72': 529412, '03': 0, '55': 0, '63': 0, '76': 0, '82': 1024, '20': 0}
{}
{'14': 4327560, '88': 426240, '28': 131072, '09': 139264, '27': 166080, '67': 166016, '42': 0, '43': 0, '92': 0, '74': 16, '58': 0, '12': 0, '65': 0, '99': 540673, '29': 65536, '66': 540672, '17': 65536, '87': 16, '51': 0, '36': 0, '07': 4096, '79': 16, '40': 524292, '86': 0, '75': 2162692, '89': 0, '53': 0, '50': 65536, '38': 16, '93': 65536, '11': 16, '96': 0, '47': 0, '49': 2162692, '34': 16, '02': 0, '26': 4096, '80': 10555398, '57': 1, '98': 0, '37': 1024, '22': 525312, '77': 3211268, '05': 10551302, '97': 0, '23': 16, '52': 0, '62': 8929280, '25': 65536, '59': 0, '90': 1048576, '70': 0, '44': 0, '78': 2162692, '04': 16, '32': 0, '73': 16, '71': 0, '72': 529412, '03': 0, '55': 0, '63': 0, '76': 0, '82': 1024, '20': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 23.288567336227324, 10.258862262798944, 5.9604644775390625e-05, 0.6588983391420528, 12.199130909245808, 0.11199223795900892, 0.05962398243673743
{23.288567336227324: []}
Best Cost: $23.288567336227324;
[3, 6, 7, 8, 11, 13, 15, 17, 18, 22, 0, 1, 2, 4, 10, 12, 14, 16, 19, 20, 21, 23]
{'42': 133248, '43': 163968, '83': 2164868, '92': 4196480, '74': 4325520, '58': 4327560, '12': 4196480, '65': 166016, '99': 540809, '29': 231560, '66': 4997256, '17': 231560, '87': 4325528, '51': 4325504, '14': 4327560, '36': 166016, '88': 426240, '07': 137408, '79': 164240, '40': 526476, '86': 4196480, '75': 6490252, '89': 166016, '53': 166016, '50': 229504, '38': 4325528, '93': 204800, '11': 4325520, '96': 426240, '01': 98448, '28': 131072, '47': 166016, '09': 139264, '49': 6488204, '34': 164240, '02': 4194440, '26': 6344, '80': 14915726, '57': 2185, '98': 133248, '21': 527488, '37': 3208, '39': 527488, '22': 527488, '77': 7569548, '05': 14909582, '97': 131208, '27': 166080, '23': 4327576, '52': 133248, '62': 13123712, '25': 231560, '59': 163968, '90': 5505280, '70': 163968, '44': 133120, '78': 6488204, '04': 4325528, '32': 2184, '73': 164240, '71': 4589704, '72': 531916, '03': 133248, '67': 166016, '55': 133248, '63': 166016, '76': 4327560, '82': 134272, '20': 2184}
['41']
Excluding table customer_address and any queries that depend on it
[3, 6, 7, 8, 11, 13, 15, 17, 18, 22, 0, 1, 2, 4, 10, 12, 14, 16, 19, 20, 21, 23]
dict_keys(['42', '43', '83', '92', '74', '58', '12', '65', '99', '29', '66', '17', '87', '51', '14', '36', '88', '07', '79', '40', '86', '75', '89', '53', '50', '38', '93', '11', '96', '01', '28', '47', '09', '49', '34', '02', '26', '80', '57', '98', '21', '37', '39', '22', '77', '05', '97', '27', '23', '52', '62', '25', '59', '90', '70', '44', '78', '04', '32', '73', '71', '72', '03', '67', '55', '63', '76', '82', '20'])
22
Optimal Subset: 0b111111111111110111011111
dict_keys(['42', '43', '83', '92', '74', '58', '12', '65', '99', '29', '66', '17', '87', '51', '14', '36', '88', '07', '79', '40', '86', '75', '89', '53', '50', '38', '93', '11', '96', '01', '28', '47', '09', '49', '34', '02', '26', '80', '57', '98', '21', '37', '39', '22', '77', '05', '97', '27', '23', '52', '62', '25', '59', '90', '70', '44', '78', '04', '32', '73', '71', '72', '03', '67', '55', '63', '76', '82', '20'])
Function: 23.288567336227324, 10.258862262798944, 5.9604644775390625e-05, 0.6588983391420528, 12.199130909245808, 0.11199223795900892, 0.05962398243673743
Real: 23.288567336227324, 10.258862262798944, 5.9604644775390625e-05, 0.6588983391420528, 12.199130909245808, 0.11199223795900892, 0.05962398243673743
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $10.258862262798944; Stayed Qs: $5.9604644775390625e-05; Migration Cost: $13.029645468783606
Movement Cost: $0.6588983391420528, Load Cost: $12.199130909245808, Storage Cost: $0.11199223795900892, API Cost: $0.05962398243673743
Final cost: $23.288567336227324, Baseline: $187.55235075950623, Diff: $164.2637834232789, %: 87.58289765928357%
