Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: store_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $1.1043627106142044, BigQuery Total: $24.244660139083862
01: $0.11105679145654043
02: $0.5465954839340845
12: $0.23884099586963653
15: $0.5003002914301554
16: $1.3307490620040894
18: $8.152078640653292
20: $0.5148479410235087
21: $0.00520494754632314
22: $0.030213471749623615
26: $1.3754505428679784
30: $0.013956845604578653
32: $1.0331779216305415
37: $0.13233230803489685
39: $0.011899112901687622
40: $0.8335138906304042
41: $-0.001560076328913371
45: $0.30204580492655436
57: $0.5912433275572458
62: $0.31730496872584024
66: $1.7192268790578842
72: $0.9901497989145914
81: $0.045473998131752014
83: $0.125806760931015
84: $0.025848369385401408
85: $0.6193626808309555
86: $0.7661172444391251
90: $0.3863231610997518
91: $0.06462642346541086
92: $0.5084705054950714
94: $0.670769666852951
95: $0.6354947167984645
99: $0.5433749508492152
!!!!!!: 23.14185750479857
Excluding table store_sales and any queries that depend on it
Total Keys: 32, Keys Considered: 31
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23]
{'92': 4196480, '18': 2296, '95': 14680224, '26': 6344, '20': 2184, '81': 180, '30': 2097328, '86': 4196480, '90': 5505280, '37': 3208, '12': 4196480, '99': 540809, '45': 4196528, '21': 527488, '57': 2185, '39': 527488, '85': 7348448, '01': 98448, '40': 526476, '22': 527488, '94': 14680224, '91': 501, '83': 2164868, '16': 173, '84': 66416, '32': 2184, '15': 184, '72': 531916, '66': 4997256, '02': 4194440, '62': 13123712}
call_center: 0.0014373386133318755, 2.5285564252626296
catalog_page: 0.0020484561633990063, -0.0020484561633990063
catalog_page had no query dependencies
catalog_returns: 0.32498982933515075, 3.065330104742112
catalog_sales: 3.527323517434017, 14.735717521153873
customer: 0.013665647153935307, 9.20172151789975
customer_address: 0.015653863797271177, 12.345052636286335
customer_demographics: 0.0036120102808771338, 11.223904445836753
date_dim: 0.0033592878816562847, 22.726326686431758
household_demographics: 0.0030431423748939258, 1.4639046104902615
income_band: 0.0017641346648621622, 0.024084234720539246
inventory: 0.021679001100850498, 1.148120638046272
item: 0.003257341521713431, 15.608135873649783
promotion: 0.005220812073338822, 2.360379529709231
reason: 0.0016772708329840698, 0.6176854099979714
ship_mode: 0.001843947979987591, 2.578062850652952
store: 0.0023051548473924256, 0.10875163660914801
store_returns: 0.6456507205337358, -0.382938798760779
time_dim: 0.002998669086869256, 2.1025513710707666
warehouse: 0.002178098316807241, 4.448709922058763
web_page: 0.0020416043419093886, 1.003644237588798
web_returns: 0.138319573329007, 1.9270710976889576
web_sales: 1.9675662058044932, 4.7429859022258265
web_site: 0.0026735792697285877, 1.6208957731075273
['catalog_page', 'store_returns']
2
call_center: 0.0014373384130119235, 2.5285564254629493
catalog_returns: 0.32421881732466773, 2.9402943558215804
household_demographics: 0.0030431413346871587, 1.4380562421450669
income_band: 0.001764134644544303, -0.001764134644544303
income_band had no query dependencies
inventory: 0.02167085452927381, 1.1481287846178487
promotion: 0.005220811249896871, 2.360379530532673
reason: 0.0016772707919180184, 0.6176854100390374
ship_mode: 0.0018439479265341006, 2.5780628507064054
store: 0.0023051540897606657, -0.0023051540897606657
store had no query dependencies
time_dim: 0.0029986329799432843, 2.1025514071776925
warehouse: 0.0021780982386403486, 4.4487099221369295
web_page: 0.0020416040115366946, 1.0036442379191706
web_returns: 0.13794581114735274, 1.8016380989395968
web_sales: 1.9639578761240386, 4.746594231906281
web_site: 0.002673578970216909, 1.620895773407039
['income_band', 'store']
2
reason: 0.0016772707852866335, 0.6176854100456688
time_dim: 0.0029986271493626254, 2.1025514130082734
web_page: 0.0020416039581877985, 1.0036442379725194
web_returns: 0.13788545567568608, 1.8016984544112635
web_sales: 1.9633751996241617, 4.747176908406158
web_site: 0.0026735789218514786, 1.6208957734554044
[]
0
reason: 0.0016772707850104417, 0.617685410045945
time_dim: 0.0029986269065235805, 2.1025514132511125
web_page: 0.0020416039559658598, 1.0036442379747414
web_returns: 0.13788294191831948, 1.8017009681686302
web_sales: 1.963350931611611, 4.7472011764187085
web_site: 0.002673578919837097, 1.6208957734574188
[]
0
{'18': 2296, '26': 4096, '20': 0, '37': 1024, '99': 540673, '57': 1, '40': 524292, '22': 525312, '16': 5, '32': 0, '15': 0, '72': 529668, '81': 0, '21': 0, '39': 0, '91': 0}
{}
{'18': 2296, '26': 4096, '20': 0, '37': 1024, '99': 540673, '57': 1, '40': 524292, '22': 525312, '16': 5, '32': 0, '15': 0, '72': 529668, '81': 0, '21': 0, '39': 0, '91': 0}
STARTING PHASE 2: 0b111101000010000000000000
----
[13, 18, 20, 21, 22, 23]
Function: 7.753199387242744, 1.0740120803197226, 0.2915024757385254, 0.346916886502644, 5.9907520748011285, 0.01854905006107627, 0.03146681981964708
reason: 0.0016772707850104417, 0.617685410045945
time_dim: 0.0029986269065235805, 2.1025514132511125
web_page: 0.0020416039559658598, 1.0036442379747414
web_returns: 0.13788294191831948, 1.8017009681686302
web_sales: 1.963350931611611, 4.7472011764187085
web_site: 0.002673578919837097, 1.6208957734574188
time_dim: 0.0029986266218631893, 2.102551413535773
web_page: 0.002041603953361262, 0.3842815571463905
web_returns: 0.1378799952457365, 1.1823412340102577
web_sales: 1.9633224842013013, 4.127866942998063
web_site: 0.0026735789174758017, 1.62089577345978
[]
0
Function: 8.370790602382508, 1.0398038707240422, 0.9450733661651611, 0.3469168853102407, 5.989084804145497, 0.018454856325423184, 0.031456819712144146
hiya: 0b111101000000000000000000, 8.370790602382508
time_dim: 0.0029986266218631893, 2.102551413535773
web_page: 0.002041603953361262, 0.3842815571463905
web_returns: 0.1378799952457365, 1.1823412340102577
web_sales: 1.9633224842013013, 4.127866942998063
web_site: 0.0026735789174758017, 1.62089577345978
time_dim: 0.0029986265542523336, 1.7162282525036319
web_returns: 0.13787929536946025, 1.182341933886534
web_sales: 1.9633157275403437, 3.741550538559269
web_site: 0.002673578916914961, 1.6208957734603409
[]
0
Function: 8.755049777274941, 1.0333145413605374, 1.337885856628418, 0.34691687571746294, 5.987053201230369, 0.01843248349085972, 0.03144681884729267
hiya: 0b111001000000000000000000, 8.755049777274941
time_dim: 0.0029986265542523336, 1.7162282525036319
web_returns: 0.13787929536946025, 1.182341933886534
web_sales: 1.9633157275403437, 3.741550538559269
web_site: 0.002673578916914961, 1.6208957734603409
time_dim: 0.00299862462155305, 1.7162282544363312
web_sales: 1.9631225840920872, 2.4354792983561095
web_site: 0.002673578900882967, 0.31463138982495725
[]
0
Function: 9.925538372729685, 0.9264336816883089, 2.7649879455566406, 0.3360642308006451, 5.850357795499167, 0.017236337055001712, 0.03045838212992251
hiya: 0b110001000000000000000000, 9.925538372729685
time_dim: 0.00299862462155305, 1.7162282544363312
web_sales: 1.9631225840920872, 2.4354792983561095
web_site: 0.002673578900882967, 0.31463138982495725
time_dim: 0.002998624520819157, 1.716228254537065
web_sales: 1.9631125172950117, 2.1181843964273446
[]
0
Function: 10.2401374636194, 0.9164018622366589, 3.092324733734131, 0.33606422210395487, 5.847694217522941, 0.01720404667585575, 0.030448381345859168
hiya: 0b10001000000000000000000, 10.2401374636194
time_dim: 0.002998624520819157, 1.716228254537065
web_sales: 1.9631125172950117, 2.1181843964273446
web_sales: 1.963076176537379, 0.39899385812709287
[]
0
Function: 11.956248067848021, 0.8735604696575802, 4.854393005371094, 0.3360631736949241, 5.844705704371136, 0.017087427928338342, 0.030438286824947595
hiya: 0b10000000000000000000000, 11.956248067848021
web_sales: 1.963076176537379, 0.39899385812709287
Function: 12.243153102977892, 0.7480127732276917, 7.342010736465454, 0.23129088081213797, 3.8927328002977366, 0.008123530850872073, 0.020982381324002146
hiya: 0b0, 12.243153102977892
{7.753199387242744: [13, 18, 20, 21, 22, 23], 8.370790602382508: [18, 20, 21, 22, 23], 8.755049777274941: [18, 21, 22, 23], 9.925538372729685: [18, 22, 23], 10.2401374636194: [18, 22], 11.956248067848021: [22], 12.243153102977892: []}
Best Cost: $7.753199387242744;
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 11, 0, 2, 8, 10, 12, 14, 19]
{'92': 4196480, '18': 2296, '95': 14680224, '26': 6344, '20': 2184, '81': 180, '30': 2097328, '86': 4196480, '90': 5505280, '37': 3208, '12': 4196480, '99': 540809, '45': 4196528, '21': 527488, '57': 2185, '39': 527488, '85': 7348448, '40': 526476, '22': 527488, '94': 14680224, '91': 501, '16': 173, '32': 2184, '15': 184, '72': 531916, '66': 4997256, '02': 4194440, '62': 13123712}
['01', '83', '84', '41']
Excluding table store_sales and any queries that depend on it
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 11, 0, 2, 8, 10, 12, 14, 19]
dict_keys(['92', '18', '95', '26', '20', '81', '30', '86', '90', '37', '12', '99', '45', '21', '57', '39', '85', '40', '22', '94', '91', '16', '32', '15', '72', '66', '02', '62'])
19
Optimal Subset: 0b111111000111110111111101
dict_keys(['92', '18', '95', '26', '20', '81', '30', '86', '90', '37', '12', '99', '45', '21', '57', '39', '85', '40', '22', '94', '91', '16', '32', '15', '72', '66', '02', '62'])
Function: 7.753199387242744, 1.0740120803197226, 0.2915024757385254, 0.346916886502644, 5.9907520748011285, 0.01854905006107627, 0.03146681981964708
Real: 7.753199387242744, 1.0740120803197226, 0.2915024757385254, 0.346916886502644, 5.9907520748011285, 0.01854905006107627, 0.03146681981964708
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 28; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $1.0740120803197226; Stayed Qs: $0.2915024757385254; Migration Cost: $6.387684831184496
Movement Cost: $0.346916886502644, Load Cost: $5.9907520748011285, Storage Cost: $0.01854905006107627, API Cost: $0.03146681981964708
Final cost: $7.753199387242744, Baseline: $24.244660139083862, Diff: $16.491460751841117, %: 68.02100197418682%
