Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.042574521314304, BigQuery Total: $121.27009630203247
01: $0.11105679145654043
03: $0.9802722319348653
06: $0.7435586870272954
07: $2.6465265779876708
08: $0.9724738453769683
09: $8.54214733932495
11: $3.4012307220792772
12: $0.23884099586963653
13: $3.376772032376925
19: $1.4556771116956075
21: $0.00520494754632314
22: $0.030213471749623615
24: $3.0622594185733796
27: $8.013910150156022
28: $10.11496771024545
30: $0.013956845604578653
31: $3.666085393134753
34: $1.161714003645579
36: $5.124345130489667
39: $0.011899112901687622
41: $-0.001560076328913371
42: $0.9816244987551371
43: $0.9920641914002101
44: $1.8940231076749166
45: $0.30204580492655436
46: $2.395647247627576
47: $1.1026310430765152
48: $2.1636873310550055
50: $1.2578326120678585
51: $1.2191740658871333
52: $0.9817617565568288
53: $1.2288573868672052
55: $0.9814906522480646
59: $0.9201084773588181
61: $3.2690254377031325
62: $0.31730496872584024
63: $1.2287701210403443
65: $1.227671975200971
67: $13.016806929626465
68: $2.911001474078496
70: $3.8910612282657624
73: $1.2395015475352604
74: $2.045917281182607
79: $2.4385065128835044
81: $0.045473998131752014
82: $0.2606608459568024
83: $0.125806760931015
84: $0.025848369385401408
85: $0.6193626808309555
86: $0.7661172444391251
88: $5.909832486608823
89: $1.2288063448842366
90: $0.3863231610997518
91: $0.06462642346541086
92: $0.5084705054950714
93: $1.5836714638996123
94: $0.670769666852951
95: $0.6354947167984645
96: $0.7369839549954732
98: $0.9812050623512268
!!!!!!: 116.22908185704708
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'31': 4325536, '50': 229504, '83': 2164868, '95': 14680224, '34': 164240, '67': 166016, '55': 133248, '09': 139264, '24': 231472, '98': 133248, '48': 164064, '22': 527488, '27': 166080, '46': 164272, '44': 133120, '06': 133296, '19': 166064, '62': 13123712, '90': 5505280, '30': 2097328, '84': 66416, '45': 4196528, '53': 166016, '07': 137408, '52': 133248, '89': 166016, '82': 134272, '08': 164016, '92': 4196480, '81': 180, '13': 164320, '21': 527488, '47': 166016, '39': 527488, '12': 4196480, '94': 14680224, '73': 164240, '59': 163968, '86': 4196480, '42': 133248, '85': 7348448, '01': 98448, '43': 163968, '51': 4325504, '70': 163968, '91': 501, '11': 4325520, '65': 166016, '74': 4325520, '61': 170160, '96': 426240, '68': 164272, '03': 133248, '63': 166016, '79': 164240, '93': 204800, '28': 131072, '88': 426240, '36': 166016}
call_center: 0.0014373388783894994, 0.06318908458702137
catalog_page: 0.00204848467757179, -0.00204848467757179
catalog_page had no query dependencies
catalog_returns: 0.3260100103472952, -0.09010282781911733
customer: 0.013690691792865214, 25.645830830586053
customer_address: 0.015659151497414096, 26.378107333147796
customer_demographics: 0.0036124057604363666, 16.907121159496956
date_dim: 0.003359364763171727, 83.96966548047617
household_demographics: 0.0030431437512657305, 20.643714069950935
income_band: 0.0017641346917461717, 0.024084234693655237
inventory: 0.021689780411060476, 0.2862885977433763
item: 0.0032575529375635293, 52.39522576072781
promotion: 0.00522081316289363, 5.910331202527909
reason: 0.0016772708873214926, 10.743504213168196
ship_mode: 0.0018439480507157185, 0.31546102067512455
store: 0.0023051558498690737, 70.43469963019648
store_returns: 0.647260990301579, 5.519214426012228
store_sales: 5.633072791745531, 105.71719259909086
time_dim: 0.0029987168625196766, 7.030140885841529
warehouse: 0.0021780984202354344, 0.36244440250323917
web_page: 0.002041604779049076, 1.0036442371516583
web_returns: 0.13881412474402646, 1.9265765462739382
web_sales: 1.9723406443028653, 12.804796563019256
web_site: 0.0026735796660338645, 1.6208957727112219
['catalog_page', 'catalog_returns']
2
call_center: 0.0014373385468224242, -0.0014373385468224242
call_center had no query dependencies
customer: 0.013659362840463053, 25.535761737941293
customer_address: 0.01565253698376277, 26.26801352606428
income_band: 0.0017641346581163057, 0.024084234727285103
inventory: 0.02167629630783816, 0.28630208184659856
promotion: 0.005220811799942828, 5.91033120389086
ship_mode: 0.0018439479622401709, 0.31546102076360005
store_returns: 0.6452466643992336, 5.395421990983558
warehouse: 0.0021780982908545733, 0.36244440263262
web_page: 0.0020416042322203318, 1.0036442376984869
web_returns: 0.1381954782630399, 1.8013884318239097
web_sales: 1.9663681822170205, 12.810769025105099
web_site: 0.002673579170285885, 1.6208957732069698
['call_center']
1
income_band: 0.0017641346323810328, 0.024084234753020375
ship_mode: 0.001843947894534211, 0.315461020831306
web_page: 0.0020416038137593445, 1.003644238116948
web_returns: 0.13772205871465149, 1.8018618513722982
web_site: 0.00267357879091448, 1.6208957735863412
[]
0
{'67': 166016, '09': 139264, '27': 166080, '28': 131072, '88': 426240, '31': 4194336, '50': 65536, '34': 16, '55': 0, '24': 65584, '98': 0, '48': 32, '22': 525312, '46': 48, '44': 0, '06': 48, '19': 48, '53': 0, '07': 4096, '52': 0, '89': 0, '82': 1024, '08': 48, '13': 32, '47': 0, '73': 16, '59': 0, '42': 0, '43': 0, '70': 0, '11': 4194320, '65': 0, '74': 4194320, '61': 4144, '96': 0, '68': 48, '03': 0, '63': 0, '79': 16, '93': 65536, '36': 0, '95': 10485760, '62': 8404992, '90': 1048576, '84': 512, '45': 0, '92': 0, '21': 0, '39': 0, '12': 0, '94': 10485760, '86': 0, '85': 3145728, '01': 0, '51': 0}
{}
{'67': 166016, '09': 139264, '27': 166080, '28': 131072, '88': 426240, '31': 4194336, '50': 65536, '34': 16, '55': 0, '24': 65584, '98': 0, '48': 32, '22': 525312, '46': 48, '44': 0, '06': 48, '19': 48, '53': 0, '07': 4096, '52': 0, '89': 0, '82': 1024, '08': 48, '13': 32, '47': 0, '73': 16, '59': 0, '42': 0, '43': 0, '70': 0, '11': 4194320, '65': 0, '74': 4194320, '61': 4144, '96': 0, '68': 48, '03': 0, '63': 0, '79': 16, '93': 65536, '36': 0, '95': 10485760, '62': 8404992, '90': 1048576, '84': 512, '45': 0, '92': 0, '21': 0, '39': 0, '12': 0, '94': 10485760, '86': 0, '85': 3145728, '01': 0, '51': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 14.182892533664667, 5.004438993922871, 0.27248263359069824, 0.42864010311830014, 8.39501721335729, 0.043468888900459496, 0.03884470077504814
{14.182892533664667: []}
Best Cost: $14.182892533664667;
[6, 7, 8, 11, 13, 15, 17, 18, 4, 5, 10, 12, 16, 19, 22, 9, 14, 20, 21, 23]
{'31': 4325536, '50': 229504, '95': 14680224, '34': 164240, '67': 166016, '55': 133248, '09': 139264, '24': 231472, '98': 133248, '48': 164064, '22': 527488, '27': 166080, '46': 164272, '44': 133120, '06': 133296, '19': 166064, '62': 13123712, '90': 5505280, '30': 2097328, '84': 66416, '45': 4196528, '53': 166016, '07': 137408, '52': 133248, '89': 166016, '82': 134272, '08': 164016, '92': 4196480, '13': 164320, '21': 527488, '47': 166016, '39': 527488, '12': 4196480, '94': 14680224, '73': 164240, '59': 163968, '86': 4196480, '42': 133248, '85': 7348448, '01': 98448, '43': 163968, '51': 4325504, '70': 163968, '11': 4325520, '65': 166016, '74': 4325520, '61': 170160, '96': 426240, '68': 164272, '03': 133248, '63': 166016, '79': 164240, '93': 204800, '28': 131072, '88': 426240, '36': 166016}
['83', '81', '41', '91']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 8, 11, 13, 15, 17, 18, 4, 5, 10, 12, 16, 19, 22, 9, 14, 20, 21, 23]
dict_keys(['31', '50', '95', '34', '67', '55', '09', '24', '98', '48', '22', '27', '46', '44', '06', '19', '62', '90', '30', '84', '45', '53', '07', '52', '89', '82', '08', '92', '13', '21', '47', '39', '12', '94', '73', '59', '86', '42', '85', '01', '43', '51', '70', '11', '65', '74', '61', '96', '68', '03', '63', '79', '93', '28', '88', '36'])
20
Optimal Subset: 0b111111111111111111110000
dict_keys(['31', '50', '95', '34', '67', '55', '09', '24', '98', '48', '22', '27', '46', '44', '06', '19', '62', '90', '30', '84', '45', '53', '07', '52', '89', '82', '08', '92', '13', '21', '47', '39', '12', '94', '73', '59', '86', '42', '85', '01', '43', '51', '70', '11', '65', '74', '61', '96', '68', '03', '63', '79', '93', '28', '88', '36'])
Function: 14.182892533664667, 5.004438993922871, 0.27248263359069824, 0.42864010311830014, 8.39501721335729, 0.043468888900459496, 0.03884470077504814
Real: 14.182892533664667, 5.004438993922871, 0.27248263359069824, 0.42864010311830014, 8.39501721335729, 0.043468888900459496, 0.03884470077504814
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 56; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $5.004438993922871; Stayed Qs: $0.27248263359069824; Migration Cost: $8.905970906151097
Movement Cost: $0.42864010311830014, Load Cost: $8.39501721335729, Storage Cost: $0.043468888900459496, API Cost: $0.03884470077504814
Final cost: $14.182892533664667, Baseline: $121.27009630203247, Diff: $107.0872037683678, %: 88.30470745373114%
