Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.617907492651941, BigQuery Total: $138.291597366333
01: $0.11105679145654043
03: $0.9802722319348653
06: $0.7435586870272954
07: $2.6465265779876708
08: $0.9724738453769683
09: $8.54214733932495
13: $3.376772032376925
15: $0.5003002914301554
16: $1.3307490620040894
17: $2.038808402964274
18: $8.152078640653292
19: $1.4556771116956075
20: $0.5148479410235087
21: $0.00520494754632314
22: $0.030213471749623615
24: $3.0622594185733796
25: $2.4896319906806945
26: $1.3754505428679784
27: $8.013910150156022
28: $10.11496771024545
29: $2.030406800688108
30: $0.013956845604578653
32: $1.0331779216305415
34: $1.161714003645579
36: $5.124345130489667
37: $0.13233230803489685
39: $0.011899112901687622
40: $0.8335138906304042
41: $-0.001560076328913371
42: $0.9816244987551371
43: $0.9920641914002101
44: $1.8940231076749166
46: $2.395647247627576
47: $1.1026310430765152
48: $2.1636873310550055
50: $1.2578326120678585
52: $0.9817617565568288
53: $1.2288573868672052
55: $0.9814906522480646
57: $0.5912433275572458
59: $0.9201084773588181
61: $3.2690254377031325
63: $1.2287701210403443
64: $6.625942691001892
65: $1.227671975200971
67: $13.016806929626465
68: $2.911001474078496
70: $3.8910612282657624
72: $0.9901497989145914
73: $1.2395015475352604
79: $2.4385065128835044
81: $0.045473998131752014
82: $0.2606608459568024
83: $0.125806760931015
84: $0.025848369385401408
88: $5.909832486608823
89: $1.2288063448842366
91: $0.06462642346541086
93: $1.5836714638996123
96: $0.7369839549954732
97: $1.0412967393541337
98: $0.9812050623512268
99: $0.5433749508492152
!!!!!!: 131.67524995000997
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 62
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23]
{'64': 236540, '53': 166016, '82': 134272, '06': 133296, '27': 166080, '29': 231560, '15': 184, '03': 133248, '26': 6344, '63': 166016, '97': 131208, '47': 166016, '96': 426240, '20': 2184, '08': 164016, '83': 2164868, '40': 526476, '01': 98448, '89': 166016, '57': 2185, '84': 66416, '81': 180, '48': 164064, '50': 229504, '30': 2097328, '39': 527488, '44': 133120, '65': 166016, '55': 133248, '18': 2296, '79': 164240, '16': 173, '61': 170160, '21': 527488, '91': 501, '07': 137408, '24': 231472, '22': 527488, '68': 164272, '88': 426240, '17': 231560, '93': 204800, '70': 163968, '25': 231560, '19': 166064, '46': 164272, '52': 133248, '32': 2184, '13': 164320, '42': 133248, '72': 531916, '09': 139264, '99': 540809, '34': 164240, '73': 164240, '59': 163968, '37': 3208, '36': 166016, '28': 131072, '67': 166016, '43': 163968, '98': 133248}
call_center: 0.001437339015724501, 2.5285564248602364
catalog_page: 0.0020484994516948908, -0.0020484994516948908
catalog_page had no query dependencies
catalog_returns: 0.3265385994097665, 9.689724025669388
catalog_sales: 3.541712179664673, 26.681593120620356
customer: 0.013703668237294485, 35.17494566903853
customer_address: 0.015661891227352114, 37.09341701596361
customer_demographics: 0.003612610671297236, 33.431379947192895
date_dim: 0.003359404597992886, 99.80215669470398
household_demographics: 0.003043144464408862, 27.87348339805452
income_band: 0.0017641347056756539, 6.650026925681618
inventory: 0.021695365523320114, 1.4087651195806048
item: 0.003257662479012218, 77.38733535710341
promotion: 0.0052208137274275205, 14.90187423474784
reason: 0.001677270915475484, 10.124141532309087
ship_mode: 0.0018439480873622689, 0.5415310027618528
store: 0.0023051563692849273, 83.61948951501203
store_returns: 0.6480953235980994, 18.70316997805068
store_sales: 5.639607417845366, 109.60433713539638
time_dim: 0.0029987416166426845, 6.643817699987654
warehouse: 0.0021780984738249557, 2.4121780741180205
web_page: 0.002041605005545408, -0.002041605005545408
web_page had no query dependencies
web_returns: 0.13907036796527544, 0.000693238570318222
web_site: 0.0026735798713725563, -0.0026735798713725563
web_site had no query dependencies
['catalog_page', 'web_page', 'web_site']
3
call_center: 0.0014373385293916722, 2.528556425346569
catalog_returns: 0.32466675165775777, 9.691595873421399
income_band: 0.0017641346563483562, 6.650026925730946
inventory: 0.021675587437524988, 1.4087848976664
promotion: 0.005220811728291391, 14.901874236746977
ship_mode: 0.0018439479575889392, 0.5415310028916263
store_returns: 0.645140769642298, 18.70612453200648
warehouse: 0.002178098284052916, 2.4121780743077923
web_returns: 0.13816295551254712, 0.0016006510230465454
[]
0
web_returns: 0.13770195651435604, 0.002061650021237621
[]
0
web_returns: 0.13769783103311564, 0.0020657755024780233
[]
0
{'27': 166080, '18': 2296, '88': 426240, '09': 139264, '28': 131072, '67': 166016, '64': 70148, '53': 0, '82': 1024, '06': 0, '29': 65536, '15': 0, '03': 0, '26': 4096, '63': 0, '97': 0, '47': 0, '96': 0, '20': 0, '08': 0, '40': 524292, '89': 0, '57': 1, '48': 0, '50': 65536, '44': 0, '65': 0, '55': 0, '79': 0, '16': 5, '61': 4096, '07': 4096, '24': 65536, '22': 525312, '68': 0, '17': 65536, '93': 65536, '70': 0, '25': 65536, '19': 0, '46': 0, '52': 0, '32': 0, '13': 0, '42': 0, '72': 529412, '99': 540673, '34': 0, '73': 0, '59': 0, '37': 1024, '36': 0, '43': 0, '98': 0, '01': 0, '84': 0, '81': 0, '39': 0, '21': 0, '91': 0}
{}
{'27': 166080, '18': 2296, '88': 426240, '09': 139264, '28': 131072, '67': 166016, '64': 70148, '53': 0, '82': 1024, '06': 0, '29': 65536, '15': 0, '03': 0, '26': 4096, '63': 0, '97': 0, '47': 0, '96': 0, '20': 0, '08': 0, '40': 524292, '89': 0, '57': 1, '48': 0, '50': 65536, '44': 0, '65': 0, '55': 0, '79': 0, '16': 5, '61': 4096, '07': 4096, '24': 65536, '22': 525312, '68': 0, '17': 65536, '93': 65536, '70': 0, '25': 65536, '19': 0, '46': 0, '52': 0, '32': 0, '13': 0, '42': 0, '72': 529412, '99': 540673, '34': 0, '73': 0, '59': 0, '37': 1024, '36': 0, '43': 0, '98': 0, '01': 0, '84': 0, '81': 0, '39': 0, '21': 0, '91': 0}
STARTING PHASE 2: 0b1000000000000000000000
----
[21]
Function: 17.54934374829476, 6.616287811678252, 5.9604644775390625e-05, 0.5542414383556848, 10.257805201021826, 0.07078121230838194, 0.050168480285841234
web_returns: 0.13769783103311564, 0.0020657755024780233
Function: 17.538484490631433, 6.58267342749119, 0.17343759536743164, 0.543388793438867, 10.121109795290627, 0.06869483547484903, 0.04918004356847109
hiya: 0b0, 17.538484490631433
{17.54934374829476: [21], 17.538484490631433: []}
Best Cost: $17.538484490631433;
[3, 4, 5, 6, 7, 8, 11, 13, 15, 17, 18, 0, 2, 9, 10, 12, 14, 16, 19]
{'64': 236540, '53': 166016, '82': 134272, '06': 133296, '27': 166080, '29': 231560, '15': 184, '03': 133248, '26': 6344, '63': 166016, '97': 131208, '47': 166016, '96': 426240, '20': 2184, '08': 164016, '40': 526476, '01': 98448, '89': 166016, '57': 2185, '84': 66416, '81': 180, '48': 164064, '50': 229504, '39': 527488, '44': 133120, '65': 166016, '55': 133248, '18': 2296, '79': 164240, '16': 173, '61': 170160, '21': 527488, '91': 501, '07': 137408, '24': 231472, '22': 527488, '68': 164272, '88': 426240, '17': 231560, '93': 204800, '70': 163968, '25': 231560, '19': 166064, '46': 164272, '52': 133248, '32': 2184, '13': 164320, '42': 133248, '72': 531916, '09': 139264, '99': 540809, '34': 164240, '73': 164240, '59': 163968, '37': 3208, '36': 166016, '28': 131072, '67': 166016, '43': 163968, '98': 133248}
['83', '30', '41']
Excluding table web_sales and any queries that depend on it
[3, 4, 5, 6, 7, 8, 11, 13, 15, 17, 18, 0, 2, 9, 10, 12, 14, 16, 19]
dict_keys(['64', '53', '82', '06', '27', '29', '15', '03', '26', '63', '97', '47', '96', '20', '08', '40', '01', '89', '57', '84', '81', '48', '50', '39', '44', '65', '55', '18', '79', '16', '61', '21', '91', '07', '24', '22', '68', '88', '17', '93', '70', '25', '19', '46', '52', '32', '13', '42', '72', '09', '99', '34', '73', '59', '37', '36', '28', '67', '43', '98'])
19
Optimal Subset: 0b11111111111111111101
dict_keys(['64', '53', '82', '06', '27', '29', '15', '03', '26', '63', '97', '47', '96', '20', '08', '40', '01', '89', '57', '84', '81', '48', '50', '39', '44', '65', '55', '18', '79', '16', '61', '21', '91', '07', '24', '22', '68', '88', '17', '93', '70', '25', '19', '46', '52', '32', '13', '42', '72', '09', '99', '34', '73', '59', '37', '36', '28', '67', '43', '98'])
Function: 17.538484490631433, 6.58267342749119, 0.17343759536743164, 0.543388793438867, 10.121109795290627, 0.06869483547484903, 0.04918004356847109
Real: 17.538484490631433, 6.58267342749119, 0.17343759536743164, 0.543388793438867, 10.121109795290627, 0.06869483547484903, 0.04918004356847109
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 60; Num Redshift Qs: 3
PLAN TYPE IS: multi
Moved Qs: $6.58267342749119; Stayed Qs: $0.17343759536743164; Migration Cost: $10.782373467772814
Movement Cost: $0.543388793438867, Load Cost: $10.121109795290627, Storage Cost: $0.06869483547484903, API Cost: $0.04918004356847109
Final cost: $17.538484490631433, Baseline: $138.291597366333, Diff: $120.75311287570158, %: 87.31775116880588%
