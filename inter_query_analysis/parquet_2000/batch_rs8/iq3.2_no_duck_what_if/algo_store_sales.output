Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: store_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $2.0097952249558766, BigQuery Total: $24.244660139083862
01: $0.09135617610295613
02: $0.5439178594080607
12: $0.2389854053338369
15: $0.4801401446024577
16: $1.3080162305323282
18: $8.042140771875381
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
26: $1.3674889662106833
30: $-0.014764147567749034
32: $1.0034308623027801
37: $0.13002236076037088
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
45: $0.2881769174448649
57: $0.48211799839019776
62: $0.2687723776404063
66: $1.7073755603122711
72: $0.6461190176963806
81: $0.007207273232142125
83: $0.10952350557645162
84: $0.022878762760162354
85: $0.6016115298080444
86: $0.7629906395339966
90: $0.3841438028653463
91: $0.06383098655382792
92: $0.5124131259028117
94: $0.6810611327139536
95: $0.6406015023072561
99: $0.5382787955506643
!!!!!!: 22.272640848054884
Excluding table store_sales and any queries that depend on it
Total Keys: 32, Keys Considered: 28
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23]
{'40': 526476, '37': 3208, '20': 2184, '15': 184, '26': 6344, '57': 2185, '83': 2164868, '94': 14680224, '91': 501, '01': 98448, '81': 180, '92': 4196480, '99': 540809, '86': 4196480, '45': 4196528, '16': 173, '95': 14680224, '66': 4997256, '32': 2184, '85': 7348448, '62': 13123712, '90': 5505280, '12': 4196480, '72': 531916, '84': 66416, '18': 2296, '21': 527488, '02': 4194440}
call_center: 0.007384595027735696, 2.3848594159992826
catalog_page: 0.006788411198313866, -0.006788411198313866
catalog_page had no query dependencies
catalog_returns: 0.363754800834856, 2.602759873679279
catalog_sales: 4.110705443254809, 13.4847074054721
customer: 0.02725154172181579, 8.968479490849976
customer_address: 0.03293412316949694, 12.10273112866092
customer_demographics: 0.009294075684214283, 10.734775959220265
date_dim: 0.007482268266407631, 21.85813601416297
household_demographics: 0.006404560078788095, 1.110568009796929
income_band: 0.005611237083141475, 0.01726752567702088
inventory: 0.044871347334488686, 0.7349448926741833
item: 0.008128642854473012, 14.925320070810535
promotion: 0.00783476300819145, 2.005773220898872
reason: 0.005305682627097517, 0.5963058471809469
ship_mode: 0.005743803839275214, 2.5086829296640665
store: 0.006274751361317278, 0.08508142474163885
store_returns: 0.8007752371346994, -0.5770167926951294
time_dim: 0.00715692755675833, 2.084362435620859
warehouse: 0.0065405587584434705, 3.9894977149162036
web_page: 0.006232711682292152, 0.9795226209910987
web_returns: 0.16391271215620337, 1.8688849582495022
web_sales: 2.4483898339559893, 4.18166001931486
web_site: 0.007700362410486709, 1.5827346502511292
['catalog_page', 'store_returns']
2
call_center: 0.007384594906824039, 2.3848594161201944
catalog_returns: 0.3632894236280662, 2.4937017453096164
household_demographics: 0.006404559450926903, 1.0876892476646278
income_band: 0.005611237070877764, -0.005611237070877764
income_band had no query dependencies
inventory: 0.04486643012350659, 0.7349498098851655
promotion: 0.007834762511167916, 2.005773221395896
reason: 0.005305682602310349, 0.5963058472057341
ship_mode: 0.005743803807011078, 2.508682929696331
store: 0.006274750904016292, -0.006274750904016292
store had no query dependencies
time_dim: 0.0071569057628820655, 2.084362457414735
warehouse: 0.0065405587112625065, 3.9894977149633846
web_page: 0.006232711482881612, 0.9795226211905091
web_returns: 0.16368711203877723, 1.759587052790477
web_sales: 2.4462118725688318, 4.183837980702018
web_site: 0.0077003622297036525, 1.5827346504319124
['income_band', 'store']
2
reason: 0.005305682596152133, 0.5963058472118923
time_dim: 0.007156900348330089, 2.084362462829287
web_page: 0.0062327114333393125, 0.9795226212400514
web_returns: 0.16363106310342046, 1.7596431017258336
web_sales: 2.445670771711301, 4.184379081559548
web_site: 0.007700362184789235, 1.5827346504768267
[]
0
reason: 0.005305682595838235, 0.5963058472122063
time_dim: 0.007156900072338645, 2.0843624631052786
web_page: 0.006232711430814035, 0.9795226212425767
web_returns: 0.1636282061677754, 1.7596459586614788
web_sales: 2.4456431906284917, 4.184406662642358
web_site: 0.007700362182499849, 1.5827346504791162
[]
0
{'18': 2296, '40': 524292, '37': 1024, '20': 0, '15': 0, '26': 4096, '57': 1, '99': 540673, '16': 5, '32': 0, '72': 529668, '91': 0, '81': 0, '21': 0}
{}
{'18': 2296, '40': 524292, '37': 1024, '20': 0, '15': 0, '26': 4096, '57': 1, '99': 540673, '16': 5, '32': 0, '72': 529668, '91': 0, '81': 0, '21': 0}
STARTING PHASE 2: 0b111101000010000000000000
----
[13, 18, 20, 21, 22, 23]
Function: 9.818564737497207, 1.8184326503245039, 0.37734508514404297, 0.346916886502644, 7.232521328045525, 0.011881967660844815, 0.03146681981964708
reason: 0.005305682595838235, 0.5963058472122063
time_dim: 0.007156900072338645, 2.0843624631052786
web_page: 0.006232711430814035, 0.9795226212425767
web_returns: 0.1636282061677754, 1.7596459586614788
web_sales: 2.4456431906284917, 4.184406662642358
web_site: 0.007700362182499849, 1.5827346504791162
time_dim: 0.007156899845188474, 2.084362463332429
web_page: 0.006232711428735646, 0.3779110914366106
web_returns: 0.16362585481436442, 1.1580367802068454
web_sales: 2.4456204904765806, 3.582817832986224
web_site: 0.007700362180615609, 1.5827346504810005
[]
0
Function: 10.414795419858391, 1.7664732897059123, 1.0309159755706787, 0.3469168853102407, 7.227225645570753, 0.011806803988663473, 0.031456819712144146
hiya: 0b111101000000000000000000, 10.414795419858391
time_dim: 0.007156899845188474, 2.084362463332429
web_page: 0.006232711428735646, 0.3779110914366106
web_returns: 0.16362585481436442, 1.1580367802068454
web_sales: 2.4456204904765806, 3.582817832986224
web_site: 0.007700362180615609, 1.5827346504810005
time_dim: 0.007156899786109248, 1.7002186605261618
web_returns: 0.1636252432535705, 1.1580373917676392
web_sales: 2.4456145864202785, 3.1986799341771794
web_site: 0.007700362180125539, 1.5827346504814905
[]
0
Function: 10.79268695226123, 1.7578046021080018, 1.4237284660339355, 0.34691687571746294, 7.221002935113905, 0.011787254440632076, 0.03144681884729267
hiya: 0b111001000000000000000000, 10.79268695226123
time_dim: 0.007156899786109248, 1.7002186605261618
web_returns: 0.1636252432535705, 1.1580373917676392
web_sales: 2.4456145864202785, 3.1986799341771794
web_site: 0.007700362180125539, 1.5827346504814905
time_dim: 0.007156898875633089, 1.700218661436638
web_sales: 2.445523598387841, 1.877108287188407
web_site: 0.00770036217257302, 0.26107201546783326
[]
0
Function: 11.939331588683615, 1.6908280254745485, 2.8123676776885986, 0.3360642308006451, 7.058486610616047, 0.011126661973853827, 0.03045838212992251
hiya: 0b110001000000000000000000, 11.939331588683615
time_dim: 0.007156898875633089, 1.700218661436638
web_sales: 2.445523598387841, 1.877108287188407
web_site: 0.00770036217257302, 0.26107201546783326
time_dim: 0.007156898612777942, 1.7002186616994932
web_sales: 2.4454973300749687, 1.6083621778608732
[]
0
Function: 12.200319337864014, 1.6322636149374645, 3.139704465866089, 0.33606422210395487, 7.050796249316532, 0.011042404294114102, 0.030448381345859168
hiya: 0b10001000000000000000000, 12.200319337864014
time_dim: 0.007156898612777942, 1.7002186616994932
web_sales: 2.4454973300749687, 1.6083621778608732
time_dim: 0.007156888175414824, -0.007156888175414824
time_dim had no query dependencies
['time_dim']
1
Function: 13.692045673308225, 1.4364371201419832, 7.389390468597412, 0.23129088081213797, 4.608653917903898, 0.005290904528794347, 0.020982381324002146
hiya: 0b0, 13.692045673308225
{9.818564737497207: [13, 18, 20, 21, 22, 23], 10.414795419858391: [18, 20, 21, 22, 23], 10.79268695226123: [18, 21, 22, 23], 11.939331588683615: [18, 22, 23], 12.200319337864014: [18, 22], 13.692045673308225: []}
Best Cost: $9.818564737497207;
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 11, 0, 2, 8, 10, 12, 14, 19]
{'40': 526476, '37': 3208, '20': 2184, '15': 184, '26': 6344, '57': 2185, '94': 14680224, '91': 501, '81': 180, '92': 4196480, '99': 540809, '86': 4196480, '45': 4196528, '16': 173, '95': 14680224, '66': 4997256, '32': 2184, '85': 7348448, '62': 13123712, '90': 5505280, '12': 4196480, '72': 531916, '18': 2296, '21': 527488, '02': 4194440}
['83', '01', '22', '39', '30', '41', '84']
Excluding table store_sales and any queries that depend on it
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 11, 0, 2, 8, 10, 12, 14, 19]
dict_keys(['40', '37', '20', '15', '26', '57', '94', '91', '81', '92', '99', '86', '45', '16', '95', '66', '32', '85', '62', '90', '12', '72', '18', '21', '02'])
19
Optimal Subset: 0b111111000111110111111101
dict_keys(['40', '37', '20', '15', '26', '57', '94', '91', '81', '92', '99', '86', '45', '16', '95', '66', '32', '85', '62', '90', '12', '72', '18', '21', '02'])
Function: 9.818564737497207, 1.8184326503245039, 0.37734508514404297, 0.346916886502644, 7.232521328045525, 0.011881967660844815, 0.03146681981964708
Real: 9.818564737497207, 1.8184326503245039, 0.37734508514404297, 0.346916886502644, 7.232521328045525, 0.011881967660844815, 0.03146681981964708
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 25; Num Redshift Qs: 7
PLAN TYPE IS: multi
Moved Qs: $1.8184326503245039; Stayed Qs: $0.37734508514404297; Migration Cost: $7.6227870020286606
Movement Cost: $0.346916886502644, Load Cost: $7.232521328045525, Storage Cost: $0.011881967660844815, API Cost: $0.03146681981964708
Final cost: $9.818564737497207, Baseline: $24.244660139083862, Diff: $14.426095401586656, %: 59.50215560386807%
