Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: store
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $8.767809166202548, BigQuery Total: $144.31394934654236
02: $0.5439178594080607
03: $0.9788349722735087
04: $8.444030512132645
06: $0.7141929688707988
07: $2.6221228846041362
09: $8.541056930046082
10: $0.8703867371749878
11: $3.593498433939616
12: $0.2389854053338369
14: $31.470830434716543
15: $0.4801401446024577
16: $1.3080162305323282
18: $8.042140771875381
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
23: $2.513639189500809
26: $1.3674889662106833
28: $10.119274417511622
30: $-0.014764147567749034
31: $3.6576817435773212
32: $1.0034308623027801
33: $2.2238480685234068
35: $0.8586125310675303
37: $0.13002236076037088
38: $0.8137931013806661
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
44: $1.9030214290301004
45: $0.2881769174448649
49: $3.6732972191556295
51: $1.218067363761266
52: $0.9827531170177459
55: $0.9864775767421723
56: $2.2392421195062
57: $0.48211799839019776
58: $1.739850949859619
60: $2.2406149949042002
62: $0.2687723776404063
66: $1.7073755603122711
69: $0.7339706393369039
71: $2.182429477367401
72: $0.6461190176963806
74: $1.5683838714059193
75: $5.634023525533676
76: $2.168916556510925
78: $3.059550409294764
81: $0.007207273232142125
82: $0.25799143071492514
83: $0.10952350557645162
84: $0.022878762760162354
85: $0.6016115298080444
86: $0.7629906395339966
87: $0.8081602010186513
90: $0.3841438028653463
91: $0.06383098655382792
92: $0.5124131259028117
93: $1.581067689558665
94: $0.6810611327139536
95: $0.6406015023072561
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 135.58391611426669
Excluding table store and any queries that depend on it
Total Keys: 65, Keys Considered: 61
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23]
{'18': 2296, '66': 4997256, '86': 4196480, '83': 2164868, '69': 4325624, '23': 4327576, '74': 4325520, '04': 4325528, '56': 4327592, '90': 5505280, '35': 4325624, '40': 526476, '51': 4325504, '99': 540809, '92': 4196480, '94': 14680224, '87': 4325528, '07': 137408, '44': 133120, '37': 3208, '11': 4325520, '55': 133248, '85': 7348448, '76': 4327560, '21': 527488, '78': 6488204, '32': 2184, '02': 4194440, '91': 501, '20': 2184, '33': 4327592, '45': 4196528, '49': 6488204, '06': 133296, '09': 139264, '71': 4589704, '38': 4325528, '03': 133248, '58': 4327560, '82': 134272, '93': 204800, '75': 6490252, '16': 173, '28': 131072, '52': 133248, '84': 66416, '97': 131208, '10': 4325624, '42': 133248, '62': 13123712, '12': 4196480, '60': 4327592, '98': 133248, '57': 2185, '81': 180, '14': 4327560, '95': 14680224, '31': 4325536, '26': 6344, '72': 531916, '15': 184}
call_center: 0.007384595317540427, 2.384859415709478
catalog_page: 0.00678844237471261, -0.00678844237471261
catalog_page had no query dependencies
catalog_returns: 0.36487023105504834, 14.968515597443155
catalog_sales: 4.12106821365131, 86.1865591625713
customer: 0.027278924653652073, 29.795764117643714
customer_address: 0.03293990455580438, 25.641275150235963
customer_demographics: 0.009294508087725606, 15.819868319000314
date_dim: 0.007482352325966353, 113.0249907301688
household_demographics: 0.006404561583664863, 1.1105680082920524
income_band: 0.00561123711253551, 0.017267525647626843
inventory: 0.04488313305507935, 0.9929245376685176
item: 0.008128874009165581, 77.75010162109722
promotion: 0.007834764199472552, 4.627896104311728
reason: 0.005305682686508154, 10.718430466726284
ship_mode: 0.005743803916606874, 2.508682929586735
store_returns: 0.8025358497518064, 13.277805262127544
store_sales: 6.463969426818672, 106.93866201549613
time_dim: 0.00715697979298272, 4.266791860752035
warehouse: 0.006540558871528238, 3.989497714803119
web_page: 0.0062327121602453895, 0.9795226205131454
web_returns: 0.16445343736789106, 14.235215387021885
web_sales: 2.453610037941495, 85.88926789499804
web_site: 0.007700362843793032, 1.582734649817823
['catalog_page']
1
call_center: 0.007384595002224618, 2.384859416024794
catalog_returns: 0.36365661117761355, 14.96972921732059
household_demographics: 0.006404559946316039, 1.110568009929401
income_band: 0.005611237080553963, 0.01726752567960839
inventory: 0.04487030985509804, 0.992937360868499
promotion: 0.007834762903324754, 4.627896105607876
ship_mode: 0.005743803832467823, 2.508682929670874
store_returns: 0.8006202530341425, 13.279720858845206
time_dim: 0.007156922958481472, 4.266791917586537
warehouse: 0.006540558748488788, 3.989497714926159
web_page: 0.006232711640218642, 0.9795226210331721
web_returns: 0.16386511292297762, 14.235803711466799
web_site: 0.007700362372343401, 1.5827346502892725
[]
0
income_band: 0.005611237061202791, 0.017267525698959563
[]
0
{'18': 2296, '09': 139264, '28': 131072, '14': 4327560, '66': 802816, '86': 0, '69': 0, '23': 0, '74': 0, '04': 0, '56': 0, '90': 1310976, '35': 0, '40': 524292, '51': 0, '99': 540673, '92': 0, '94': 10485760, '87': 0, '07': 4096, '44': 0, '37': 1024, '11': 0, '55': 0, '85': 3145728, '76': 0, '78': 2162692, '32': 0, '02': 0, '20': 0, '33': 0, '45': 0, '49': 2162692, '06': 0, '71': 262144, '38': 0, '03': 0, '58': 0, '82': 1024, '93': 65536, '75': 2162692, '16': 5, '52': 0, '97': 0, '10': 0, '42': 0, '62': 8929280, '12': 0, '60': 0, '98': 0, '57': 1, '95': 10485760, '31': 0, '26': 4096, '72': 529668, '15': 0, '83': 0, '21': 0, '91': 0, '84': 512, '81': 0}
{}
{'18': 2296, '09': 139264, '28': 131072, '14': 4327560, '66': 802816, '86': 0, '69': 0, '23': 0, '74': 0, '04': 0, '56': 0, '90': 1310976, '35': 0, '40': 524292, '51': 0, '99': 540673, '92': 0, '94': 10485760, '87': 0, '07': 4096, '44': 0, '37': 1024, '11': 0, '55': 0, '85': 3145728, '76': 0, '78': 2162692, '32': 0, '02': 0, '20': 0, '33': 0, '45': 0, '49': 2162692, '06': 0, '71': 262144, '38': 0, '03': 0, '58': 0, '82': 1024, '93': 65536, '75': 2162692, '16': 5, '52': 0, '97': 0, '10': 0, '42': 0, '62': 8929280, '12': 0, '60': 0, '98': 0, '57': 1, '95': 10485760, '31': 0, '26': 4096, '72': 529668, '15': 0, '83': 0, '21': 0, '91': 0, '84': 512, '81': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 23.955460207705926, 8.644131018225352, 0.08590221405029297, 0.6590137275291684, 14.449188555126192, 0.05759030732254865, 0.05963438545236886
{23.955460207705926: []}
Best Cost: $23.955460207705926;
[3, 4, 5, 6, 7, 11, 13, 17, 22, 0, 2, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23, 9]
{'18': 2296, '66': 4997256, '86': 4196480, '83': 2164868, '69': 4325624, '23': 4327576, '74': 4325520, '04': 4325528, '56': 4327592, '90': 5505280, '35': 4325624, '40': 526476, '51': 4325504, '99': 540809, '92': 4196480, '94': 14680224, '87': 4325528, '07': 137408, '44': 133120, '37': 3208, '11': 4325520, '55': 133248, '85': 7348448, '76': 4327560, '21': 527488, '78': 6488204, '32': 2184, '02': 4194440, '91': 501, '20': 2184, '33': 4327592, '45': 4196528, '49': 6488204, '06': 133296, '09': 139264, '71': 4589704, '38': 4325528, '03': 133248, '58': 4327560, '82': 134272, '93': 204800, '75': 6490252, '16': 173, '28': 131072, '52': 133248, '84': 66416, '97': 131208, '10': 4325624, '42': 133248, '62': 13123712, '12': 4196480, '60': 4327592, '98': 133248, '57': 2185, '81': 180, '14': 4327560, '95': 14680224, '31': 4325536, '26': 6344, '72': 531916, '15': 184}
['22', '41', '30', '39']
Excluding table store and any queries that depend on it
[3, 4, 5, 6, 7, 11, 13, 17, 22, 0, 2, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23, 9]
dict_keys(['18', '66', '86', '83', '69', '23', '74', '04', '56', '90', '35', '40', '51', '99', '92', '94', '87', '07', '44', '37', '11', '55', '85', '76', '21', '78', '32', '02', '91', '20', '33', '45', '49', '06', '09', '71', '38', '03', '58', '82', '93', '75', '16', '28', '52', '84', '97', '10', '42', '62', '12', '60', '98', '57', '81', '14', '95', '31', '26', '72', '15'])
22
Optimal Subset: 0b111111110111111111111101
dict_keys(['18', '66', '86', '83', '69', '23', '74', '04', '56', '90', '35', '40', '51', '99', '92', '94', '87', '07', '44', '37', '11', '55', '85', '76', '21', '78', '32', '02', '91', '20', '33', '45', '49', '06', '09', '71', '38', '03', '58', '82', '93', '75', '16', '28', '52', '84', '97', '10', '42', '62', '12', '60', '98', '57', '81', '14', '95', '31', '26', '72', '15'])
Function: 23.955460207705926, 8.644131018225352, 0.08590221405029297, 0.6590137275291684, 14.449188555126192, 0.05759030732254865, 0.05963438545236886
Real: 23.955460207705926, 8.644131018225352, 0.08590221405029297, 0.6590137275291684, 14.449188555126192, 0.05759030732254865, 0.05963438545236886
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 61; Num Redshift Qs: 4
PLAN TYPE IS: move
Moved Qs: $8.644131018225352; Stayed Qs: $0.08590221405029297; Migration Cost: $15.22542697543028
Movement Cost: $0.6590137275291684, Load Cost: $14.449188555126192, Storage Cost: $0.05759030732254865, API Cost: $0.05963438545236886
Final cost: $23.955460207705926, Baseline: $144.31394934654236, Diff: $120.35848913883643, %: 83.40045413754046%
