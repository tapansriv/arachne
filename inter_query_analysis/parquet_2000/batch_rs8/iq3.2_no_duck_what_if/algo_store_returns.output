Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: store_returns
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $9.87251151275317, BigQuery Total: $198.7019956111908
02: $0.5439178594080607
03: $0.9788349722735087
04: $8.444030512132645
06: $0.7141929688707988
07: $2.6221228846041362
08: $0.9579996981779735
09: $8.541056930046082
10: $0.8703867371749878
11: $3.593498433939616
12: $0.2389854053338369
13: $3.3642222308540344
14: $31.470830434716543
15: $0.4801401446024577
16: $1.3080162305323282
18: $8.042140771875381
19: $1.417793015387853
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
23: $2.513639189500809
26: $1.3674889662106833
27: $8.007735689058304
28: $10.119274417511622
30: $-0.014764147567749034
31: $3.6576817435773212
32: $1.0034308623027801
33: $2.2238480685234068
34: $1.1522493207263946
35: $0.8586125310675303
36: $5.126866803070704
37: $0.13002236076037088
38: $0.8137931013806661
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
45: $0.2881769174448649
46: $2.359196290372213
47: $1.1105599638430277
48: $2.1419420219484966
51: $1.218067363761266
52: $0.9827531170177459
53: $1.2302071810436248
54: $1.5285631408659617
55: $0.9864775767421723
56: $2.2392421195062
57: $0.48211799839019776
58: $1.739850949859619
59: $0.9182437569491069
60: $2.2406149949042002
61: $3.2601225111929577
62: $0.2687723776404063
63: $1.230120708958308
65: $1.2133188222344717
66: $1.7073755603122711
67: $13.014583652944564
68: $2.898014662167231
69: $0.7339706393369039
70: $3.9032720463371278
71: $2.182429477367401
72: $0.6461190176963806
73: $1.240141652765274
74: $1.5683838714059193
76: $2.168916556510925
79: $2.3994553823248546
81: $0.007207273232142125
82: $0.25799143071492514
85: $0.6016115298080444
86: $0.7629906395339966
87: $0.8081602010186513
88: $5.922236060743332
89: $1.2316483820819855
90: $0.3841438028653463
91: $0.06383098655382792
92: $0.5124131259028117
94: $0.6810611327139536
95: $0.6406015023072561
96: $0.7377381561851502
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 188.86726003236453
Excluding table store_returns and any queries that depend on it
Total Keys: 83, Keys Considered: 79
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23]
{'56': 4327592, '58': 4327560, '40': 526476, '68': 164272, '37': 3208, '72': 531916, '47': 166016, '20': 2184, '27': 166080, '61': 170160, '16': 173, '98': 133248, '13': 164320, '51': 4325504, '70': 163968, '74': 4325520, '91': 501, '76': 4327560, '67': 166016, '32': 2184, '69': 4325624, '82': 134272, '97': 131208, '09': 139264, '43': 163968, '57': 2185, '48': 164064, '04': 4325528, '53': 166016, '11': 4325520, '26': 6344, '79': 164240, '92': 4196480, '71': 4589704, '81': 180, '90': 5505280, '89': 166016, '07': 137408, '35': 4325624, '73': 164240, '52': 133248, '36': 166016, '94': 14680224, '28': 131072, '14': 4327560, '88': 426240, '10': 4325624, '46': 164272, '95': 14680224, '54': 4360376, '63': 166016, '60': 4327592, '19': 166064, '59': 163968, '44': 133120, '66': 4997256, '45': 4196528, '96': 426240, '02': 4194440, '85': 7348448, '99': 540809, '12': 4196480, '06': 133296, '21': 527488, '31': 4325536, '23': 4327576, '15': 184, '87': 4325528, '33': 4327592, '86': 4196480, '03': 133248, '42': 133248, '08': 164016, '55': 133248, '65': 166016, '34': 164240, '38': 4325528, '18': 2296, '62': 13123712}
call_center: 0.007384595324467533, 2.3848594157025507
catalog_page: 0.006788443119911614, -0.006788443119911614
catalog_page had no query dependencies
catalog_returns: 0.3648968928095486, 2.4920942761281344
catalog_sales: 4.121315911477003, 75.34800345162752
customer: 0.02727957917868905, 46.98642037433923
customer_address: 0.03294004274634253, 43.54624982025199
customer_demographics: 0.009294518423321733, 29.310889487765387
date_dim: 0.007482354335213797, 161.25230688164766
household_demographics: 0.0064045616196354285, 21.1609430016344
income_band: 0.005611237113238106, -0.005611237113238106
income_band had no query dependencies
inventory: 0.04488341476520635, 0.9929242559583908
item: 0.008128879534378682, 110.37807445514363
promotion: 0.007834764227947344, 7.888018615476211
reason: 0.0053056826879282265, 9.1373627771662
ship_mode: 0.005743803918455307, 2.5086829295848867
store: 0.006274752483589228, 67.35741027749357
store_sales: 6.464299029924741, 160.3540785988245
time_dim: 0.007156981041567674, 10.926766076431933
warehouse: 0.006540558874231266, 3.989497714800416
web_page: 0.006232712171669745, 0.979522620501721
web_returns: 0.164466362141297, 1.7588078026879572
web_sales: 2.4537348147267957, 75.0508351050946
web_site: 0.007700362854150208, 1.582734649807466
['catalog_page', 'income_band']
2
call_center: 0.007384594989458381, 2.38485941603756
catalog_returns: 0.36360747517152125, 2.4933836937661615
household_demographics: 0.006404559880024457, 21.160943003374012
inventory: 0.04486979068031842, 0.9929378800432789
promotion: 0.007834762850847428, 7.888018616853311
ship_mode: 0.005743803829061273, 2.5086829296742805
time_dim: 0.007156920657414678, 10.926766136816086
warehouse: 0.006540558743507271, 3.9894977149311397
web_page: 0.006232711619164243, 0.9795226210542265
web_returns: 0.1638412933448321, 1.759432871484422
web_site: 0.007700362353255751, 1.5827346503083604
[]
0
{'27': 166080, '67': 166016, '09': 139264, '28': 131072, '14': 4327560, '18': 2296, '56': 0, '58': 0, '40': 524292, '68': 256, '37': 1024, '72': 529668, '47': 0, '20': 0, '61': 4096, '16': 5, '98': 0, '13': 256, '51': 0, '70': 0, '74': 0, '76': 0, '32': 0, '69': 0, '82': 1024, '97': 0, '43': 0, '57': 1, '48': 0, '04': 0, '53': 0, '11': 0, '26': 4096, '79': 256, '92': 0, '71': 262144, '90': 1310976, '89': 0, '07': 4096, '35': 0, '73': 256, '52': 0, '36': 0, '94': 10485760, '88': 262400, '10': 0, '46': 256, '95': 10485760, '54': 0, '63': 0, '60': 0, '19': 0, '59': 0, '44': 0, '66': 802816, '45': 0, '96': 262400, '02': 0, '85': 3145728, '99': 540673, '12': 0, '06': 0, '31': 0, '23': 0, '15': 0, '87': 0, '33': 0, '86': 0, '03': 0, '42': 0, '08': 0, '55': 0, '65': 0, '34': 256, '38': 0, '62': 8929280}
{}
{'27': 166080, '67': 166016, '09': 139264, '28': 131072, '14': 4327560, '18': 2296, '56': 0, '58': 0, '40': 524292, '68': 256, '37': 1024, '72': 529668, '47': 0, '20': 0, '61': 4096, '16': 5, '98': 0, '13': 256, '51': 0, '70': 0, '74': 0, '76': 0, '32': 0, '69': 0, '82': 1024, '97': 0, '43': 0, '57': 1, '48': 0, '04': 0, '53': 0, '11': 0, '26': 4096, '79': 256, '92': 0, '71': 262144, '90': 1310976, '89': 0, '07': 4096, '35': 0, '73': 256, '52': 0, '36': 0, '94': 10485760, '88': 262400, '10': 0, '46': 256, '95': 10485760, '54': 0, '63': 0, '60': 0, '19': 0, '59': 0, '44': 0, '66': 802816, '45': 0, '96': 262400, '02': 0, '85': 3145728, '99': 540673, '12': 0, '06': 0, '31': 0, '23': 0, '15': 0, '87': 0, '33': 0, '86': 0, '03': 0, '42': 0, '08': 0, '55': 0, '65': 0, '34': 256, '38': 0, '62': 8929280}
STARTING PHASE 2: 0b0
----
[]
Function: 24.223684246933388, 9.748833364775976, 0.08590221405029297, 0.6236773097327677, 13.653600936794282, 0.055231844646943085, 0.056438576933124665
{24.223684246933388: []}
Best Cost: $24.223684246933388;
[3, 4, 5, 6, 7, 11, 13, 15, 17, 22, 0, 2, 8, 10, 12, 14, 18, 19, 20, 21, 23]
{'56': 4327592, '58': 4327560, '40': 526476, '68': 164272, '37': 3208, '72': 531916, '47': 166016, '20': 2184, '27': 166080, '61': 170160, '16': 173, '98': 133248, '13': 164320, '51': 4325504, '70': 163968, '74': 4325520, '91': 501, '76': 4327560, '67': 166016, '32': 2184, '69': 4325624, '82': 134272, '97': 131208, '09': 139264, '43': 163968, '57': 2185, '48': 164064, '04': 4325528, '53': 166016, '11': 4325520, '26': 6344, '79': 164240, '92': 4196480, '71': 4589704, '81': 180, '90': 5505280, '89': 166016, '07': 137408, '35': 4325624, '73': 164240, '52': 133248, '36': 166016, '94': 14680224, '28': 131072, '14': 4327560, '88': 426240, '10': 4325624, '46': 164272, '95': 14680224, '54': 4360376, '63': 166016, '60': 4327592, '19': 166064, '59': 163968, '44': 133120, '66': 4997256, '45': 4196528, '96': 426240, '02': 4194440, '85': 7348448, '99': 540809, '12': 4196480, '06': 133296, '21': 527488, '31': 4325536, '23': 4327576, '15': 184, '87': 4325528, '33': 4327592, '86': 4196480, '03': 133248, '42': 133248, '08': 164016, '55': 133248, '65': 166016, '34': 164240, '38': 4325528, '18': 2296, '62': 13123712}
['41', '30', '22', '39']
Excluding table store_returns and any queries that depend on it
[3, 4, 5, 6, 7, 11, 13, 15, 17, 22, 0, 2, 8, 10, 12, 14, 18, 19, 20, 21, 23]
dict_keys(['56', '58', '40', '68', '37', '72', '47', '20', '27', '61', '16', '98', '13', '51', '70', '74', '91', '76', '67', '32', '69', '82', '97', '09', '43', '57', '48', '04', '53', '11', '26', '79', '92', '71', '81', '90', '89', '07', '35', '73', '52', '36', '94', '28', '14', '88', '10', '46', '95', '54', '63', '60', '19', '59', '44', '66', '45', '96', '02', '85', '99', '12', '06', '21', '31', '23', '15', '87', '33', '86', '03', '42', '08', '55', '65', '34', '38', '18', '62'])
21
Optimal Subset: 0b111111101111110111111101
dict_keys(['56', '58', '40', '68', '37', '72', '47', '20', '27', '61', '16', '98', '13', '51', '70', '74', '91', '76', '67', '32', '69', '82', '97', '09', '43', '57', '48', '04', '53', '11', '26', '79', '92', '71', '81', '90', '89', '07', '35', '73', '52', '36', '94', '28', '14', '88', '10', '46', '95', '54', '63', '60', '19', '59', '44', '66', '45', '96', '02', '85', '99', '12', '06', '21', '31', '23', '15', '87', '33', '86', '03', '42', '08', '55', '65', '34', '38', '18', '62'])
Function: 24.223684246933388, 9.748833364775976, 0.08590221405029297, 0.6236773097327677, 13.653600936794282, 0.055231844646943085, 0.056438576933124665
Real: 24.223684246933388, 9.748833364775976, 0.08590221405029297, 0.6236773097327677, 13.653600936794282, 0.055231844646943085, 0.056438576933124665
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 79; Num Redshift Qs: 4
PLAN TYPE IS: move
Moved Qs: $9.748833364775976; Stayed Qs: $0.08590221405029297; Migration Cost: $14.388948668107119
Movement Cost: $0.6236773097327677, Load Cost: $13.653600936794282, Storage Cost: $0.055231844646943085, API Cost: $0.056438576933124665
Final cost: $24.223684246933388, Baseline: $198.7019956111908, Diff: $174.47831136425742, %: 87.80903826736952%
