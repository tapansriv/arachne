Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_address
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $11.047924749104187, BigQuery Total: $187.55235075950623
01: $0.09135617610295613
02: $0.5439178594080607
03: $0.9788349722735087
04: $8.444030512132645
05: $3.0146482326221467
07: $2.6221228846041362
09: $8.541056930046082
11: $3.593498433939616
12: $0.2389854053338369
14: $31.470830434716543
17: $2.0638121649551393
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
23: $2.513639189500809
25: $2.42890007768631
26: $1.3674889662106833
27: $8.007735689058304
28: $10.119274417511622
29: $2.0609908128611245
32: $1.0034308623027801
34: $1.1522493207263946
36: $5.126866803070704
37: $0.13002236076037088
38: $0.8137931013806661
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
47: $1.1105599638430277
49: $3.6732972191556295
50: $1.2361908173306784
51: $1.218067363761266
52: $0.9827531170177459
53: $1.2302071810436248
55: $0.9864775767421723
57: $0.48211799839019776
58: $1.739850949859619
59: $0.9182437569491069
62: $0.2687723776404063
63: $1.230120708958308
65: $1.2133188222344717
66: $1.7073755603122711
67: $13.014583652944564
70: $3.9032720463371278
71: $2.182429477367401
72: $0.6461190176963806
73: $1.240141652765274
74: $1.5683838714059193
75: $5.634023525533676
76: $2.168916556510925
77: $2.858893439645767
78: $3.059550409294764
79: $2.3994553823248546
80: $3.427113557071686
82: $0.25799143071492514
83: $0.10952350557645162
86: $0.7629906395339966
87: $0.8081602010186513
88: $5.922236060743332
89: $1.2316483820819855
90: $0.3841438028653463
92: $0.5124131259028117
93: $1.581067689558665
96: $0.7377381561851502
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 176.5274377967612
Excluding table customer_address and any queries that depend on it
Total Keys: 70, Keys Considered: 67
[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'04': 4325528, '26': 6344, '66': 4997256, '90': 5505280, '40': 526476, '44': 133120, '63': 166016, '14': 4327560, '88': 426240, '43': 163968, '82': 134272, '96': 426240, '87': 4325528, '58': 4327560, '76': 4327560, '36': 166016, '75': 6490252, '97': 131208, '93': 204800, '53': 166016, '47': 166016, '49': 6488204, '12': 4196480, '27': 166080, '34': 164240, '38': 4325528, '57': 2185, '73': 164240, '51': 4325504, '37': 3208, '28': 131072, '65': 166016, '52': 133248, '25': 231560, '01': 98448, '71': 4589704, '02': 4194440, '77': 7569548, '80': 14915726, '29': 231560, '05': 14909582, '09': 139264, '78': 6488204, '72': 531916, '42': 133248, '67': 166016, '03': 133248, '17': 231560, '74': 4325520, '70': 163968, '20': 2184, '83': 2164868, '79': 164240, '23': 4327576, '21': 527488, '98': 133248, '99': 540809, '07': 137408, '32': 2184, '11': 4325520, '62': 13123712, '86': 4196480, '55': 133248, '92': 4196480, '50': 229504, '89': 166016, '59': 163968}
call_center: 0.007384595368312368, 1.0130121985725498
catalog_page: 0.006788447836618852, 6.434973341857214
catalog_returns: 0.36506564731630486, 22.889920920203206
catalog_sales: 4.122883704939321, 83.04212971860206
customer: 0.027283721968683367, 22.5974241193291
customer_demographics: 0.009294583842063267, 12.63417197372744
date_dim: 0.007482367052664977, 147.33141694376826
household_demographics: 0.006404561847309677, 12.475678831459422
income_band: 0.005611237117685158, -0.005611237117685158
income_band had no query dependencies
inventory: 0.04488519783816694, 0.9929224728854303
item: 0.0081289145059936, 104.14774355528479
promotion: 0.007834764408177404, 8.05500966117471
reason: 0.005305682696916518, 10.116818936907832
ship_mode: 0.005743803930154888, 2.508682929573187
store: 0.0062747526494151456, 66.61146198463683
store_returns: 0.8028442978545453, 30.436523329540446
store_sales: 6.466385239577204, 159.92407696095958
time_dim: 0.007156988944436112, 10.926766068529066
warehouse: 0.006540558891339968, 3.989497714783307
web_page: 0.006232712243979748, 3.2368045302671336
web_returns: 0.1645481689766661, 21.612501719923458
web_sales: 2.4545245843894725, 80.15320066152498
web_site: 0.007700362919705536, 6.702833804414533
['income_band']
1
call_center: 0.007384595044757315, 1.0130121988961047
catalog_page: 0.006788413029452951, 6.43497337666438
catalog_returns: 0.3638203153892951, 22.891166252130215
customer: 0.02725315005243658, 22.597454691245346
household_demographics: 0.006404560167176708, 12.475678833139556
inventory: 0.04487203956625654, 0.9929356311573407
promotion: 0.00783476307816109, 8.055009662504725
ship_mode: 0.005743803843817273, 2.5086829296595248
store_returns: 0.8008786463386653, 30.438488981056324
time_dim: 0.007156930624841751, 10.92676612684866
warehouse: 0.00654055876508548, 3.9894977149095614
web_page: 0.006232711710364633, 3.2368045308007485
web_returns: 0.16394447153538852, 21.613105417364736
web_site: 0.0077003624359368635, 6.702833804898302
[]
0
{'14': 4327560, '27': 166080, '28': 131072, '09': 139264, '67': 166016, '04': 16, '26': 4096, '66': 802816, '90': 1310976, '40': 524292, '44': 0, '63': 0, '88': 262400, '43': 0, '82': 1024, '96': 262400, '87': 16, '58': 0, '76': 0, '36': 0, '75': 2162692, '97': 0, '93': 65536, '53': 0, '47': 0, '49': 2162692, '12': 0, '34': 272, '38': 16, '57': 1, '73': 272, '51': 0, '37': 1024, '65': 0, '52': 0, '25': 65536, '71': 262144, '02': 0, '77': 3211268, '80': 10555398, '29': 65536, '05': 10551302, '78': 2162692, '72': 529668, '42': 0, '03': 0, '17': 65536, '74': 16, '70': 0, '20': 0, '79': 272, '23': 16, '98': 0, '99': 540673, '07': 4096, '32': 0, '11': 16, '62': 8929280, '86': 0, '55': 0, '92': 0, '50': 65536, '89': 0, '59': 0}
{}
{'14': 4327560, '27': 166080, '28': 131072, '09': 139264, '67': 166016, '04': 16, '26': 4096, '66': 802816, '90': 1310976, '40': 524292, '44': 0, '63': 0, '88': 262400, '43': 0, '82': 1024, '96': 262400, '87': 16, '58': 0, '76': 0, '36': 0, '75': 2162692, '97': 0, '93': 65536, '53': 0, '47': 0, '49': 2162692, '12': 0, '34': 272, '38': 16, '57': 1, '73': 272, '51': 0, '37': 1024, '65': 0, '52': 0, '25': 65536, '71': 262144, '02': 0, '77': 3211268, '80': 10555398, '29': 65536, '05': 10551302, '78': 2162692, '72': 529668, '42': 0, '03': 0, '17': 65536, '74': 16, '70': 0, '20': 0, '79': 272, '23': 16, '98': 0, '99': 540673, '07': 4096, '32': 0, '11': 16, '62': 8929280, '86': 0, '55': 0, '92': 0, '50': 65536, '89': 0, '59': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 26.230490995920107, 10.977473625968303, 0.0474393367767334, 0.6588983391420528, 14.423721097898484, 0.06333461369779647, 0.05962398243673743
{26.230490995920107: []}
Best Cost: $26.230490995920107;
[3, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 4, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23]
{'04': 4325528, '26': 6344, '66': 4997256, '90': 5505280, '40': 526476, '44': 133120, '63': 166016, '14': 4327560, '88': 426240, '43': 163968, '82': 134272, '96': 426240, '87': 4325528, '58': 4327560, '76': 4327560, '36': 166016, '75': 6490252, '97': 131208, '93': 204800, '53': 166016, '47': 166016, '49': 6488204, '12': 4196480, '27': 166080, '34': 164240, '38': 4325528, '57': 2185, '73': 164240, '51': 4325504, '37': 3208, '28': 131072, '65': 166016, '52': 133248, '25': 231560, '01': 98448, '71': 4589704, '02': 4194440, '77': 7569548, '80': 14915726, '29': 231560, '05': 14909582, '09': 139264, '78': 6488204, '72': 531916, '42': 133248, '67': 166016, '03': 133248, '17': 231560, '74': 4325520, '70': 163968, '20': 2184, '83': 2164868, '79': 164240, '23': 4327576, '21': 527488, '98': 133248, '99': 540809, '07': 137408, '32': 2184, '11': 4325520, '62': 13123712, '86': 4196480, '55': 133248, '92': 4196480, '50': 229504, '89': 166016, '59': 163968}
['41', '39', '22']
Excluding table customer_address and any queries that depend on it
[3, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 4, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23]
dict_keys(['04', '26', '66', '90', '40', '44', '63', '14', '88', '43', '82', '96', '87', '58', '76', '36', '75', '97', '93', '53', '47', '49', '12', '27', '34', '38', '57', '73', '51', '37', '28', '65', '52', '25', '01', '71', '02', '77', '80', '29', '05', '09', '78', '72', '42', '67', '03', '17', '74', '70', '20', '83', '79', '23', '21', '98', '99', '07', '32', '11', '62', '86', '55', '92', '50', '89', '59'])
22
Optimal Subset: 0b111111111111110111011111
dict_keys(['04', '26', '66', '90', '40', '44', '63', '14', '88', '43', '82', '96', '87', '58', '76', '36', '75', '97', '93', '53', '47', '49', '12', '27', '34', '38', '57', '73', '51', '37', '28', '65', '52', '25', '01', '71', '02', '77', '80', '29', '05', '09', '78', '72', '42', '67', '03', '17', '74', '70', '20', '83', '79', '23', '21', '98', '99', '07', '32', '11', '62', '86', '55', '92', '50', '89', '59'])
Function: 26.230490995920107, 10.977473625968303, 0.0474393367767334, 0.6588983391420528, 14.423721097898484, 0.06333461369779647, 0.05962398243673743
Real: 26.230490995920107, 10.977473625968303, 0.0474393367767334, 0.6588983391420528, 14.423721097898484, 0.06333461369779647, 0.05962398243673743
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 67; Num Redshift Qs: 3
PLAN TYPE IS: move
Moved Qs: $10.977473625968303; Stayed Qs: $0.0474393367767334; Migration Cost: $15.205578033175069
Movement Cost: $0.6588983391420528, Load Cost: $14.423721097898484, Storage Cost: $0.06333461369779647, API Cost: $0.05962398243673743
Final cost: $26.230490995920107, Baseline: $187.55235075950623, Diff: $161.32185976358613, %: 86.01430966356972%
