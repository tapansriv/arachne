Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: household_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $11.920777554302221, BigQuery Total: $213.88927102088928
01: $0.09135617610295613
02: $0.5439178594080607
03: $0.9788349722735087
04: $8.444030512132645
05: $3.0146482326221467
06: $0.7141929688707988
07: $2.6221228846041362
08: $0.9579996981779735
09: $8.541056930046082
10: $0.8703867371749878
11: $3.593498433939616
12: $0.2389854053338369
14: $31.470830434716543
15: $0.4801401446024577
16: $1.3080162305323282
17: $2.0638121649551393
18: $8.042140771875381
19: $1.417793015387853
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
23: $2.513639189500809
24: $3.0669893040084837
25: $2.42890007768631
26: $1.3674889662106833
27: $8.007735689058304
28: $10.119274417511622
29: $2.0609908128611245
30: $-0.014764147567749034
31: $3.6576817435773212
32: $1.0034308623027801
33: $2.2238480685234068
35: $0.8586125310675303
36: $5.126866803070704
37: $0.13002236076037088
38: $0.8137931013806661
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
45: $0.2881769174448649
47: $1.1105599638430277
48: $2.1419420219484966
49: $3.6732972191556295
50: $1.2361908173306784
51: $1.218067363761266
52: $0.9827531170177459
53: $1.2302071810436248
54: $1.5285631408659617
55: $0.9864775767421723
56: $2.2392421195062
57: $0.48211799839019776
58: $1.739850949859619
59: $0.9182437569491069
60: $2.2406149949042002
61: $3.2601225111929577
62: $0.2687723776404063
63: $1.230120708958308
65: $1.2133188222344717
66: $1.7073755603122711
67: $13.014583652944564
69: $0.7339706393369039
70: $3.9032720463371278
71: $2.182429477367401
74: $1.5683838714059193
75: $5.634023525533676
76: $2.168916556510925
77: $2.858893439645767
78: $3.059550409294764
80: $3.427113557071686
81: $0.007207273232142125
82: $0.25799143071492514
83: $0.10952350557645162
85: $0.6016115298080444
86: $0.7629906395339966
87: $0.8081602010186513
89: $1.2316483820819855
92: $0.5124131259028117
93: $1.581067689558665
94: $0.6810611327139536
95: $0.6406015023072561
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 202.00626940051396
Excluding table household_demographics and any queries that depend on it
Total Keys: 86, Keys Considered: 82
[0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'27': 166080, '35': 4325624, '45': 4196528, '56': 4327592, '75': 6490252, '74': 4325520, '51': 4325504, '18': 2296, '94': 14680224, '40': 526476, '33': 4327592, '05': 14909582, '83': 2164868, '93': 204800, '82': 134272, '06': 133296, '95': 14680224, '55': 133248, '16': 173, '42': 133248, '29': 231560, '62': 13123712, '11': 4325520, '14': 4327560, '81': 180, '57': 2185, '36': 166016, '37': 3208, '09': 139264, '03': 133248, '07': 137408, '78': 6488204, '47': 166016, '85': 7348448, '67': 166016, '19': 166064, '32': 2184, '60': 4327592, '08': 164016, '58': 4327560, '04': 4325528, '49': 6488204, '26': 6344, '15': 184, '87': 4325528, '10': 4325624, '89': 166016, '24': 231472, '44': 133120, '20': 2184, '53': 166016, '23': 4327576, '50': 229504, '80': 14915726, '12': 4196480, '63': 166016, '21': 527488, '77': 7569548, '01': 98448, '43': 163968, '38': 4325528, '59': 163968, '52': 133248, '92': 4196480, '97': 131208, '70': 163968, '25': 231560, '66': 4997256, '61': 170160, '28': 131072, '99': 540809, '71': 4589704, '02': 4194440, '69': 4325624, '54': 4360376, '86': 4196480, '98': 133248, '31': 4325536, '65': 166016, '17': 231560, '48': 164064, '76': 4327560}
call_center: 0.0073845953869364775, 2.3210284290862533
catalog_page: 0.006788449840149482, 6.434973339853683
catalog_returns: 0.36513732970112434, 23.55895372388647
catalog_sales: 4.12354966151994, 102.92088012271442
customer: 0.027285481714673605, 40.0318716570049
customer_address: 0.03294128895478085, 37.92797370810472
customer_demographics: 0.009294611630188722, 25.23671715945428
date_dim: 0.007482372454696881, 176.78737725790432
income_band: 0.005611237119574146, -0.005611237119574146
income_band had no query dependencies
inventory: 0.04488595523969996, 0.34680269778751666
item: 0.008128929360996922, 128.52330833531352
promotion: 0.007834764484734295, 10.66901315459473
reason: 0.005305682700734504, 10.718430466712057
ship_mode: 0.0057438039351245555, 2.5086829295682174
store: 0.006274752719853545, 67.53305110340312
store_returns: 0.802957442459069, 33.5033994889444
store_sales: 6.467271405440247, 174.3833297168946
time_dim: 0.007156992301362498, 3.8826480453783097
warehouse: 0.006540558898607286, 3.3433786970796597
web_page: 0.006232712274695097, 3.4542722571791167
web_returns: 0.1645829183244999, 23.535741135404876
web_sales: 2.4548600573434514, 96.33309244293629
web_site: 0.00770036294755168, 8.024496439407898
['income_band']
1
call_center: 0.007384595052076521, 2.3210284294211134
catalog_page: 0.0067884138168330995, 6.434973375876999
catalog_returns: 0.3638484863021698, 23.560242567285425
inventory: 0.044872337222265773, 0.34681631580495087
promotion: 0.007834763108247666, 10.669013155971216
ship_mode: 0.0057438038457703336, 2.5086829296575717
store_returns: 0.8009231117509742, 33.505433819652495
time_dim: 0.007156931944101441, 3.8826481057355706
warehouse: 0.006540558767941509, 3.3433786972103254
web_page: 0.006232711722435651, 3.4542722577313762
web_returns: 0.1639581279009342, 23.53636592582844
web_site: 0.0077003624468802954, 8.02449643990857
[]
0
{'27': 166080, '18': 2296, '14': 4327560, '09': 139264, '67': 166016, '28': 131072, '35': 0, '45': 0, '56': 0, '75': 2162692, '74': 0, '51': 0, '94': 10485760, '40': 524292, '33': 0, '05': 10551302, '93': 65536, '82': 1024, '06': 0, '95': 10485760, '55': 0, '16': 5, '42': 0, '29': 65536, '62': 8929280, '11': 0, '57': 1, '36': 0, '37': 1024, '03': 0, '07': 4096, '78': 2162692, '47': 0, '85': 3145728, '19': 0, '32': 0, '60': 0, '08': 0, '58': 0, '04': 0, '49': 2162692, '26': 4096, '15': 0, '87': 0, '10': 0, '89': 0, '24': 65536, '44': 0, '20': 0, '53': 0, '23': 0, '50': 65536, '80': 10555398, '12': 0, '63': 0, '77': 3211268, '43': 0, '38': 0, '59': 0, '52': 0, '92': 0, '97': 0, '70': 0, '25': 65536, '66': 802816, '61': 4096, '99': 540673, '71': 262144, '02': 0, '69': 0, '54': 0, '86': 0, '98': 0, '31': 0, '65': 0, '17': 65536, '48': 0, '76': 0}
{}
{'27': 166080, '18': 2296, '14': 4327560, '09': 139264, '67': 166016, '28': 131072, '35': 0, '45': 0, '56': 0, '75': 2162692, '74': 0, '51': 0, '94': 10485760, '40': 524292, '33': 0, '05': 10551302, '93': 65536, '82': 1024, '06': 0, '95': 10485760, '55': 0, '16': 5, '42': 0, '29': 65536, '62': 8929280, '11': 0, '57': 1, '36': 0, '37': 1024, '03': 0, '07': 4096, '78': 2162692, '47': 0, '85': 3145728, '19': 0, '32': 0, '60': 0, '08': 0, '58': 0, '04': 0, '49': 2162692, '26': 4096, '15': 0, '87': 0, '10': 0, '89': 0, '24': 65536, '44': 0, '20': 0, '53': 0, '23': 0, '50': 65536, '80': 10555398, '12': 0, '63': 0, '77': 3211268, '43': 0, '38': 0, '59': 0, '52': 0, '92': 0, '97': 0, '70': 0, '25': 65536, '66': 802816, '61': 4096, '99': 540673, '71': 262144, '02': 0, '69': 0, '54': 0, '86': 0, '98': 0, '31': 0, '65': 0, '17': 65536, '48': 0, '76': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 27.117342126046502, 11.797099406325026, 0.08590221405029297, 0.6590143444613398, 14.450235841712951, 0.06545587842406253, 0.05963444107282759
{27.117342126046502: []}
Best Cost: $27.117342126046502;
[3, 4, 5, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 10, 12, 14, 16, 18, 19, 20, 21, 23]
{'27': 166080, '35': 4325624, '45': 4196528, '56': 4327592, '75': 6490252, '74': 4325520, '51': 4325504, '18': 2296, '94': 14680224, '40': 526476, '33': 4327592, '05': 14909582, '83': 2164868, '93': 204800, '82': 134272, '06': 133296, '95': 14680224, '55': 133248, '16': 173, '42': 133248, '29': 231560, '62': 13123712, '11': 4325520, '14': 4327560, '81': 180, '57': 2185, '36': 166016, '37': 3208, '09': 139264, '03': 133248, '07': 137408, '78': 6488204, '47': 166016, '85': 7348448, '67': 166016, '19': 166064, '32': 2184, '60': 4327592, '08': 164016, '58': 4327560, '04': 4325528, '49': 6488204, '26': 6344, '15': 184, '87': 4325528, '10': 4325624, '89': 166016, '24': 231472, '44': 133120, '20': 2184, '53': 166016, '23': 4327576, '50': 229504, '80': 14915726, '12': 4196480, '63': 166016, '21': 527488, '77': 7569548, '01': 98448, '43': 163968, '38': 4325528, '59': 163968, '52': 133248, '92': 4196480, '97': 131208, '70': 163968, '25': 231560, '66': 4997256, '61': 170160, '28': 131072, '99': 540809, '71': 4589704, '02': 4194440, '69': 4325624, '54': 4360376, '86': 4196480, '98': 133248, '31': 4325536, '65': 166016, '17': 231560, '48': 164064, '76': 4327560}
['41', '39', '22', '30']
Excluding table household_demographics and any queries that depend on it
[3, 4, 5, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 10, 12, 14, 16, 18, 19, 20, 21, 23]
dict_keys(['27', '35', '45', '56', '75', '74', '51', '18', '94', '40', '33', '05', '83', '93', '82', '06', '95', '55', '16', '42', '29', '62', '11', '14', '81', '57', '36', '37', '09', '03', '07', '78', '47', '85', '67', '19', '32', '60', '08', '58', '04', '49', '26', '15', '87', '10', '89', '24', '44', '20', '53', '23', '50', '80', '12', '63', '21', '77', '01', '43', '38', '59', '52', '92', '97', '70', '25', '66', '61', '28', '99', '71', '02', '69', '54', '86', '98', '31', '65', '17', '48', '76'])
22
Optimal Subset: 0b111111111111110011111111
dict_keys(['27', '35', '45', '56', '75', '74', '51', '18', '94', '40', '33', '05', '83', '93', '82', '06', '95', '55', '16', '42', '29', '62', '11', '14', '81', '57', '36', '37', '09', '03', '07', '78', '47', '85', '67', '19', '32', '60', '08', '58', '04', '49', '26', '15', '87', '10', '89', '24', '44', '20', '53', '23', '50', '80', '12', '63', '21', '77', '01', '43', '38', '59', '52', '92', '97', '70', '25', '66', '61', '28', '99', '71', '02', '69', '54', '86', '98', '31', '65', '17', '48', '76'])
Function: 27.117342126046502, 11.797099406325026, 0.08590221405029297, 0.6590143444613398, 14.450235841712951, 0.06545587842406253, 0.05963444107282759
Real: 27.117342126046502, 11.797099406325026, 0.08590221405029297, 0.6590143444613398, 14.450235841712951, 0.06545587842406253, 0.05963444107282759
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 82; Num Redshift Qs: 4
PLAN TYPE IS: move
Moved Qs: $11.797099406325026; Stayed Qs: $0.08590221405029297; Migration Cost: $15.234340505671181
Movement Cost: $0.6590143444613398, Load Cost: $14.450235841712951, Storage Cost: $0.06545587842406253, API Cost: $0.05963444107282759
Final cost: $27.117342126046502, Baseline: $213.88927102088928, Diff: $186.77192889484277, %: 87.32178477367472%
