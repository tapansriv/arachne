Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $7.859437085720701, BigQuery Total: $138.291597366333
01: $0.09135617610295613
03: $0.9788349722735087
06: $0.7141929688707988
07: $2.6221228846041362
08: $0.9579996981779735
09: $8.541056930046082
13: $3.3642222308540344
15: $0.4801401446024577
16: $1.3080162305323282
17: $2.0638121649551393
18: $8.042140771875381
19: $1.417793015387853
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
24: $3.0669893040084837
25: $2.42890007768631
26: $1.3674889662106833
27: $8.007735689058304
28: $10.119274417511622
29: $2.0609908128611245
30: $-0.014764147567749034
32: $1.0034308623027801
34: $1.1522493207263946
36: $5.126866803070704
37: $0.13002236076037088
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
46: $2.359196290372213
47: $1.1105599638430277
48: $2.1419420219484966
50: $1.2361908173306784
52: $0.9827531170177459
53: $1.2302071810436248
55: $0.9864775767421723
57: $0.48211799839019776
59: $0.9182437569491069
61: $3.2601225111929577
63: $1.230120708958308
64: $6.445536791156133
65: $1.2133188222344717
67: $13.014583652944564
68: $2.898014662167231
70: $3.9032720463371278
72: $0.6461190176963806
73: $1.240141652765274
79: $2.3994553823248546
81: $0.007207273232142125
82: $0.25799143071492514
83: $0.10952350557645162
84: $0.022878762760162354
88: $5.922236060743332
89: $1.2316483820819855
91: $0.06383098655382792
93: $1.581067689558665
96: $0.7377381561851502
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 130.4699362145392
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 59
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23]
{'83': 2164868, '34': 164240, '16': 173, '18': 2296, '67': 166016, '47': 166016, '06': 133296, '79': 164240, '81': 180, '44': 133120, '15': 184, '46': 164272, '48': 164064, '72': 531916, '91': 501, '29': 231560, '19': 166064, '70': 163968, '08': 164016, '28': 131072, '55': 133248, '13': 164320, '50': 229504, '99': 540809, '73': 164240, '37': 3208, '82': 134272, '52': 133248, '07': 137408, '17': 231560, '09': 139264, '98': 133248, '27': 166080, '03': 133248, '97': 131208, '59': 163968, '24': 231472, '53': 166016, '42': 133248, '21': 527488, '88': 426240, '93': 204800, '84': 66416, '96': 426240, '61': 170160, '25': 231560, '65': 166016, '26': 6344, '01': 98448, '43': 163968, '68': 164272, '40': 526476, '63': 166016, '32': 2184, '57': 2185, '20': 2184, '36': 166016, '64': 236540, '89': 166016}
call_center: 0.007384595244088599, 2.3848594157829295
catalog_page: 0.006788434472966239, -0.006788434472966239
catalog_page had no query dependencies
catalog_returns: 0.3645875221133822, 9.047463943556885
catalog_sales: 4.11844174020771, 25.261935395968717
customer: 0.027271984372190257, 34.5919737279049
customer_address: 0.032938439247105766, 36.517285224445374
customer_demographics: 0.009294398493833629, 32.7147237242237
date_dim: 0.007482331020833631, 98.56819113367477
household_demographics: 0.006404561202249593, 27.24521475310274
income_band: 0.0056112371050855096, 6.4628043168112095
inventory: 0.044880145930887586, 0.9929275247927096
item: 0.008128815422355475, 76.44332615552872
promotion: 0.007834763897538989, 14.33355540696275
reason: 0.0053056826714503605, 10.116818936933297
ship_mode: 0.005743803897006947, 0.5325349916536574
store: 0.006274752179587394, 83.22262328103245
store_returns: 0.8020896175082685, 18.305156484487835
store_sales: 6.460474467577117, 108.36687075217806
time_dim: 0.007156966553564022, 6.652817250374918
warehouse: 0.006540558842866584, 2.013349776879103
web_page: 0.00623271203910679, -0.00623271203910679
web_page had no query dependencies
web_returns: 0.16431638903482537, -0.054792883458373756
web_site: 0.00770036273397032, -0.00770036273397032
web_site had no query dependencies
['catalog_page', 'web_page', 'web_returns', 'web_site']
4
call_center: 0.007384594963644637, 2.3848594160633736
catalog_returns: 0.3635081205802166, 8.939019839513598
household_demographics: 0.006404559745980737, 27.245214754559008
income_band: 0.005611237076640909, 6.462804316839654
inventory: 0.04486874089214583, 0.9929389298314514
promotion: 0.007834762744736578, 14.333555408115554
ship_mode: 0.005743803822173119, 0.5325349917284912
store_returns: 0.8003858731378781, 18.197336723281776
time_dim: 0.007156916004583303, 6.652817300923899
warehouse: 0.006540558733434484, 2.013349776988535
[]
0
{'18': 2296, '67': 166016, '28': 131072, '09': 139264, '27': 166080, '34': 256, '16': 5, '47': 0, '06': 0, '79': 256, '44': 0, '15': 0, '46': 256, '48': 0, '72': 529668, '29': 65536, '19': 0, '70': 0, '08': 0, '55': 0, '13': 256, '50': 65536, '99': 540673, '73': 256, '37': 1024, '82': 1024, '52': 0, '07': 4096, '17': 65536, '98': 0, '03': 0, '97': 0, '59': 0, '24': 65536, '53': 0, '42': 0, '88': 262400, '93': 65536, '96': 262400, '61': 4096, '25': 65536, '65': 0, '26': 4096, '43': 0, '68': 256, '40': 524292, '63': 0, '32': 0, '57': 1, '20': 0, '36': 0, '64': 70404, '89': 0}
{}
{'18': 2296, '67': 166016, '28': 131072, '09': 139264, '27': 166080, '34': 256, '16': 5, '47': 0, '06': 0, '79': 256, '44': 0, '15': 0, '46': 256, '48': 0, '72': 529668, '29': 65536, '19': 0, '70': 0, '08': 0, '55': 0, '13': 256, '50': 65536, '99': 540673, '73': 256, '37': 1024, '82': 1024, '52': 0, '07': 4096, '17': 65536, '98': 0, '03': 0, '97': 0, '59': 0, '24': 65536, '53': 0, '42': 0, '88': 262400, '93': 65536, '96': 262400, '61': 4096, '25': 65536, '65': 0, '26': 4096, '43': 0, '68': 256, '40': 524292, '63': 0, '32': 0, '57': 1, '20': 0, '36': 0, '64': 70404, '89': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 20.407990898622398, 7.710367329870863, 0.22081732749938965, 0.543388793438867, 11.844028369636536, 0.04020903460827024, 0.049180043568471075
{20.407990898622398: []}
Best Cost: $20.407990898622398;
[3, 4, 5, 6, 7, 11, 13, 15, 17, 0, 2, 8, 9, 10, 12, 14, 16, 18, 19]
{'34': 164240, '16': 173, '18': 2296, '67': 166016, '47': 166016, '06': 133296, '79': 164240, '81': 180, '44': 133120, '15': 184, '46': 164272, '48': 164064, '72': 531916, '91': 501, '29': 231560, '19': 166064, '70': 163968, '08': 164016, '28': 131072, '55': 133248, '13': 164320, '50': 229504, '99': 540809, '73': 164240, '37': 3208, '82': 134272, '52': 133248, '07': 137408, '17': 231560, '09': 139264, '98': 133248, '27': 166080, '03': 133248, '97': 131208, '59': 163968, '24': 231472, '53': 166016, '42': 133248, '21': 527488, '88': 426240, '93': 204800, '84': 66416, '96': 426240, '61': 170160, '25': 231560, '65': 166016, '26': 6344, '01': 98448, '43': 163968, '68': 164272, '40': 526476, '63': 166016, '32': 2184, '57': 2185, '20': 2184, '36': 166016, '64': 236540, '89': 166016}
['83', '41', '30', '22', '39']
Excluding table web_sales and any queries that depend on it
[3, 4, 5, 6, 7, 11, 13, 15, 17, 0, 2, 8, 9, 10, 12, 14, 16, 18, 19]
dict_keys(['34', '16', '18', '67', '47', '06', '79', '81', '44', '15', '46', '48', '72', '91', '29', '19', '70', '08', '28', '55', '13', '50', '99', '73', '37', '82', '52', '07', '17', '09', '98', '27', '03', '97', '59', '24', '53', '42', '21', '88', '93', '84', '96', '61', '25', '65', '26', '01', '43', '68', '40', '63', '32', '57', '20', '36', '64', '89'])
19
Optimal Subset: 0b11111111111111111101
dict_keys(['34', '16', '18', '67', '47', '06', '79', '81', '44', '15', '46', '48', '72', '91', '29', '19', '70', '08', '28', '55', '13', '50', '99', '73', '37', '82', '52', '07', '17', '09', '98', '27', '03', '97', '59', '24', '53', '42', '21', '88', '93', '84', '96', '61', '25', '65', '26', '01', '43', '68', '40', '63', '32', '57', '20', '36', '64', '89'])
Function: 20.407990898622398, 7.710367329870863, 0.22081732749938965, 0.543388793438867, 11.844028369636536, 0.04020903460827024, 0.049180043568471075
Real: 20.407990898622398, 7.710367329870863, 0.22081732749938965, 0.543388793438867, 11.844028369636536, 0.04020903460827024, 0.049180043568471075
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 58; Num Redshift Qs: 5
PLAN TYPE IS: multi
Moved Qs: $7.710367329870863; Stayed Qs: $0.22081732749938965; Migration Cost: $12.476806241252145
Movement Cost: $0.543388793438867, Load Cost: $11.844028369636536, Storage Cost: $0.04020903460827024, API Cost: $0.049180043568471075
Final cost: $20.407990898622398, Baseline: $138.291597366333, Diff: $117.8836064677106, %: 85.24278315727177%
