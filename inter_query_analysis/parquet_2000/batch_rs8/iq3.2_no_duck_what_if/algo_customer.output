Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $8.048799026590983, BigQuery Total: $181.02735877037048
02: $0.5439178594080607
03: $0.9788349722735087
05: $3.0146482326221467
07: $2.6221228846041362
09: $8.541056930046082
12: $0.2389854053338369
13: $3.3642222308540344
14: $31.470830434716543
16: $1.3080162305323282
17: $2.0638121649551393
20: $0.5145466201623281
21: $0.0036748615519205724
22: $-0.0009164847183227506
25: $2.42890007768631
26: $1.3674889662106833
27: $8.007735689058304
28: $10.119274417511622
29: $2.0609908128611245
31: $3.6576817435773212
32: $1.0034308623027801
33: $2.2238480685234068
36: $5.126866803070704
37: $0.13002236076037088
39: $-0.003884168135325116
40: $0.8318176609230041
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
47: $1.1105599638430277
48: $2.1419420219484966
49: $3.6732972191556295
50: $1.2361908173306784
51: $1.218067363761266
52: $0.9827531170177459
53: $1.2302071810436248
55: $0.9864775767421723
56: $2.2392421195062
57: $0.48211799839019776
58: $1.739850949859619
59: $0.9182437569491069
60: $2.2406149949042002
62: $0.2687723776404063
63: $1.230120708958308
65: $1.2133188222344717
66: $1.7073755603122711
67: $13.014583652944564
70: $3.9032720463371278
71: $2.182429477367401
72: $0.6461190176963806
75: $5.634023525533676
76: $2.168916556510925
77: $2.858893439645767
78: $3.059550409294764
80: $3.427113557071686
82: $0.25799143071492514
83: $0.10952350557645162
85: $0.6016115298080444
86: $0.7629906395339966
88: $5.922236060743332
89: $1.2316483820819855
90: $0.3841438028653463
92: $0.5124131259028117
93: $1.581067689558665
94: $0.6810611327139536
95: $0.6406015023072561
96: $0.7377381561851502
97: $1.037017860511144
98: $0.9815802054913839
99: $0.5382787955506643
!!!!!!: 173.00157153013868
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 67
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'83': 2164868, '09': 139264, '14': 4327560, '37': 3208, '56': 4327592, '78': 6488204, '82': 134272, '25': 231560, '17': 231560, '58': 4327560, '92': 4196480, '51': 4325504, '44': 133120, '66': 4997256, '20': 2184, '21': 527488, '07': 137408, '65': 166016, '60': 4327592, '27': 166080, '50': 229504, '72': 531916, '71': 4589704, '88': 426240, '94': 14680224, '63': 166016, '89': 166016, '05': 14909582, '26': 6344, '67': 166016, '85': 7348448, '43': 163968, '32': 2184, '36': 166016, '55': 133248, '47': 166016, '99': 540809, '59': 163968, '13': 164320, '49': 6488204, '75': 6490252, '90': 5505280, '02': 4194440, '93': 204800, '97': 131208, '40': 526476, '86': 4196480, '03': 133248, '77': 7569548, '33': 4327592, '52': 133248, '95': 14680224, '31': 4325536, '96': 426240, '76': 4327560, '16': 173, '12': 4196480, '80': 14915726, '53': 166016, '28': 131072, '62': 13123712, '98': 133248, '57': 2185, '70': 163968, '42': 133248, '48': 164064, '29': 231560}
call_center: 0.007384595302425936, 2.321028429170764
catalog_page: 0.00678844074873701, 6.434973348945095
catalog_returns: 0.36481205684650936, 24.19819074120532
catalog_sales: 4.12052775315887, 78.47658407981588
customer_address: 0.03293960303306759, 19.065901971642173
customer_demographics: 0.009294485536129294, 18.741947854643946
date_dim: 0.007482347941919543, 143.80555069625643
household_demographics: 0.006404561505179439, 11.048054706839064
income_band: 0.005611237111002493, -0.005611237111002493
income_band had no query dependencies
inventory: 0.04488251838196487, 0.9929251523416324
item: 0.008128861953511137, 108.33780960127027
promotion: 0.007834764137342413, 8.055009661445542
reason: 0.005305682683409648, 10.718430466729382
ship_mode: 0.005743803912573714, 2.508682929590768
store: 0.006274752400225521, 67.23442370576907
store_returns: 0.8024440266653506, 30.345567424626687
store_sales: 6.463250254349081, 153.2614114603065
time_dim: 0.007156977068651824, 10.926766080404848
warehouse: 0.006540558865630409, 3.9894977148090165
web_page: 0.00623271213531819, 3.8384160601838397
web_returns: 0.16442523635570977, 23.535898817373663
web_sales: 2.453337783138127, 74.69754324473841
web_site: 0.00770036282119435, 8.024496439534254
['income_band']
1
call_center: 0.007384594978870882, 2.3210284294943193
catalog_page: 0.0067884059415711075, 6.434973383752261
catalog_returns: 0.3635667249194996, 24.19943607313233
customer_address: 0.03293314835323132, 19.06590842632201
household_demographics: 0.006404559825046471, 11.048054708519198
inventory: 0.04486936011005447, 0.9929383106135428
promotion: 0.007834762807326099, 8.055009662775559
ship_mode: 0.005743803826236099, 2.508682929677106
store_returns: 0.8004783751494707, 30.347533076142568
time_dim: 0.007156918749057464, 10.926766138724442
warehouse: 0.006540558739375921, 3.989497714935271
web_page: 0.006232711601703074, 3.8384160607174547
web_returns: 0.1638215389144322, 23.53650251481494
web_site: 0.007700362337425677, 8.024496440018023
[]
0
{'09': 139264, '14': 4327560, '27': 166080, '67': 166016, '28': 131072, '37': 1024, '56': 32, '78': 2162692, '82': 1024, '25': 65536, '17': 65536, '58': 0, '92': 0, '51': 0, '44': 0, '66': 802816, '20': 0, '07': 4096, '65': 0, '60': 32, '50': 65536, '72': 529668, '71': 262144, '88': 262400, '94': 10485792, '63': 0, '89': 0, '05': 10551302, '26': 4096, '85': 3145760, '43': 0, '32': 0, '36': 0, '55': 0, '47': 0, '99': 540673, '59': 0, '13': 288, '49': 2162692, '75': 2162692, '90': 1310976, '02': 0, '93': 65536, '97': 0, '40': 524292, '86': 0, '03': 0, '77': 3211268, '33': 32, '52': 0, '95': 10485792, '31': 32, '96': 262400, '76': 0, '16': 37, '12': 0, '80': 10555398, '53': 0, '62': 8929280, '98': 0, '57': 1, '70': 0, '42': 0, '48': 32, '29': 65536}
{}
{'09': 139264, '14': 4327560, '27': 166080, '67': 166016, '28': 131072, '37': 1024, '56': 32, '78': 2162692, '82': 1024, '25': 65536, '17': 65536, '58': 0, '92': 0, '51': 0, '44': 0, '66': 802816, '20': 0, '07': 4096, '65': 0, '60': 32, '50': 65536, '72': 529668, '71': 262144, '88': 262400, '94': 10485792, '63': 0, '89': 0, '05': 10551302, '26': 4096, '85': 3145760, '43': 0, '32': 0, '36': 0, '55': 0, '47': 0, '99': 540673, '59': 0, '13': 288, '49': 2162692, '75': 2162692, '90': 1310976, '02': 0, '93': 65536, '97': 0, '40': 524292, '86': 0, '03': 0, '77': 3211268, '33': 32, '52': 0, '95': 10485792, '31': 32, '96': 262400, '76': 0, '16': 37, '12': 0, '80': 10555398, '53': 0, '62': 8929280, '98': 0, '57': 1, '70': 0, '42': 0, '48': 32, '29': 65536}
STARTING PHASE 2: 0b0
----
[]
Function: 23.229130206939203, 7.978347903455097, 0.0474393367767334, 0.6584647845412837, 14.42945906443914, 0.055834223065000965, 0.05958489466194809
{23.229130206939203: []}
Best Cost: $23.229130206939203;
[3, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 5, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23]
{'83': 2164868, '09': 139264, '14': 4327560, '37': 3208, '56': 4327592, '78': 6488204, '82': 134272, '25': 231560, '17': 231560, '58': 4327560, '92': 4196480, '51': 4325504, '44': 133120, '66': 4997256, '20': 2184, '21': 527488, '07': 137408, '65': 166016, '60': 4327592, '27': 166080, '50': 229504, '72': 531916, '71': 4589704, '88': 426240, '94': 14680224, '63': 166016, '89': 166016, '05': 14909582, '26': 6344, '67': 166016, '85': 7348448, '43': 163968, '32': 2184, '36': 166016, '55': 133248, '47': 166016, '99': 540809, '59': 163968, '13': 164320, '49': 6488204, '75': 6490252, '90': 5505280, '02': 4194440, '93': 204800, '97': 131208, '40': 526476, '86': 4196480, '03': 133248, '77': 7569548, '33': 4327592, '52': 133248, '95': 14680224, '31': 4325536, '96': 426240, '76': 4327560, '16': 173, '12': 4196480, '80': 14915726, '53': 166016, '28': 131072, '62': 13123712, '98': 133248, '57': 2185, '70': 163968, '42': 133248, '48': 164064, '29': 231560}
['41', '22', '39']
Excluding table customer and any queries that depend on it
[3, 6, 7, 11, 13, 15, 17, 22, 0, 1, 2, 5, 8, 10, 12, 14, 16, 18, 19, 20, 21, 23]
dict_keys(['83', '09', '14', '37', '56', '78', '82', '25', '17', '58', '92', '51', '44', '66', '20', '21', '07', '65', '60', '27', '50', '72', '71', '88', '94', '63', '89', '05', '26', '67', '85', '43', '32', '36', '55', '47', '99', '59', '13', '49', '75', '90', '02', '93', '97', '40', '86', '03', '77', '33', '52', '95', '31', '96', '76', '16', '12', '80', '53', '28', '62', '98', '57', '70', '42', '48', '29'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['83', '09', '14', '37', '56', '78', '82', '25', '17', '58', '92', '51', '44', '66', '20', '21', '07', '65', '60', '27', '50', '72', '71', '88', '94', '63', '89', '05', '26', '67', '85', '43', '32', '36', '55', '47', '99', '59', '13', '49', '75', '90', '02', '93', '97', '40', '86', '03', '77', '33', '52', '95', '31', '96', '76', '16', '12', '80', '53', '28', '62', '98', '57', '70', '42', '48', '29'])
Function: 23.229130206939203, 7.978347903455097, 0.0474393367767334, 0.6584647845412837, 14.42945906443914, 0.055834223065000965, 0.05958489466194809
Real: 23.229130206939203, 7.978347903455097, 0.0474393367767334, 0.6584647845412837, 14.42945906443914, 0.055834223065000965, 0.05958489466194809
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 67; Num Redshift Qs: 3
PLAN TYPE IS: move
Moved Qs: $7.978347903455097; Stayed Qs: $0.0474393367767334; Migration Cost: $15.203342966707371
Movement Cost: $0.6584647845412837, Load Cost: $14.42945906443914, Storage Cost: $0.055834223065000965, API Cost: $0.05958489466194809
Final cost: $23.229130206939203, Baseline: $181.02735877037048, Diff: $157.79822856343128, %: 87.1681659806986%
