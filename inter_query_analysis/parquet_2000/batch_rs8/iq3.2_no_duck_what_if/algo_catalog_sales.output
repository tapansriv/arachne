Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.801925311361948, BigQuery Total: $121.27009630203247
01: $0.09135617610295613
03: $0.9788349722735087
06: $0.7141929688707988
07: $2.6221228846041362
08: $0.9579996981779735
09: $8.541056930046082
11: $3.593498433939616
12: $0.2389854053338369
13: $3.3642222308540344
19: $1.417793015387853
21: $0.0036748615519205724
22: $-0.0009164847183227506
24: $3.0669893040084837
27: $8.007735689058304
28: $10.119274417511622
30: $-0.014764147567749034
31: $3.6576817435773212
34: $1.1522493207263946
36: $5.126866803070704
39: $-0.003884168135325116
41: $-0.018211133505503338
42: $0.984411880273819
43: $0.9974538797442118
44: $1.9030214290301004
45: $0.2881769174448649
46: $2.359196290372213
47: $1.1105599638430277
48: $2.1419420219484966
50: $1.2361908173306784
51: $1.218067363761266
52: $0.9827531170177459
53: $1.2302071810436248
55: $0.9864775767421723
59: $0.9182437569491069
61: $3.2601225111929577
62: $0.2687723776404063
63: $1.230120708958308
65: $1.2133188222344717
67: $13.014583652944564
68: $2.898014662167231
70: $3.9032720463371278
73: $1.240141652765274
74: $1.5683838714059193
79: $2.3994553823248546
81: $0.007207273232142125
82: $0.25799143071492514
83: $0.10952350557645162
84: $0.022878762760162354
85: $0.6016115298080444
86: $0.7629906395339966
88: $5.922236060743332
89: $1.2316483820819855
90: $0.3841438028653463
91: $0.06383098655382792
92: $0.5124131259028117
93: $1.581067689558665
94: $0.6810611327139536
95: $0.6406015023072561
96: $0.7377381561851502
98: $0.9815802054913839
!!!!!!: 115.50594692459742
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 56
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'59': 163968, '91': 501, '48': 164064, '62': 13123712, '34': 164240, '79': 164240, '86': 4196480, '24': 231472, '61': 170160, '96': 426240, '50': 229504, '98': 133248, '08': 164016, '89': 166016, '52': 133248, '68': 164272, '47': 166016, '07': 137408, '31': 4325536, '82': 134272, '65': 166016, '45': 4196528, '11': 4325520, '95': 14680224, '28': 131072, '03': 133248, '51': 4325504, '83': 2164868, '21': 527488, '73': 164240, '42': 133248, '53': 166016, '81': 180, '09': 139264, '43': 163968, '92': 4196480, '46': 164272, '01': 98448, '90': 5505280, '94': 14680224, '13': 164320, '27': 166080, '84': 66416, '44': 133120, '06': 133296, '19': 166064, '85': 7348448, '55': 133248, '12': 4196480, '63': 166016, '36': 166016, '88': 426240, '93': 204800, '70': 163968, '74': 4325520, '67': 166016}
call_center: 0.007384595162502968, 0.05644639139132495
catalog_page: 0.006788425696207696, -0.006788425696207696
catalog_page had no query dependencies
catalog_returns: 0.36427350695740796, -0.1837117415949863
customer: 0.027264275547867638, 25.07422295188566
customer_address: 0.03293681167516965, 26.11058573970244
customer_demographics: 0.009294276763891591, 16.81504982882311
date_dim: 0.0074823073564439044, 83.22005806453203
household_demographics: 0.006404560778597711, 20.53770274753922
income_band: 0.00561123709681052, 0.017267525663351834
inventory: 0.044876828022853046, 0.2167894642439927
item: 0.008128750347843841, 52.22896820383892
promotion: 0.007834763562170345, 5.874410632234923
reason: 0.005305682654725118, 10.718430466758067
ship_mode: 0.00574380387523659, 0.2630285737651697
store: 0.006274751871021701, 70.2233834346823
store_returns: 0.8015939710432877, 5.306412284294109
store_sales: 6.4565924885887895, 104.37212643668067
time_dim: 0.007156951848057705, 7.036961067945771
warehouse: 0.006540558811031038, 0.26590668038129583
web_page: 0.00623271190455372, 0.979522620768837
web_returns: 0.164164164441468, 1.8686335059642376
web_sales: 2.450817374217347, 11.965570472017292
web_site: 0.007700362611986219, 1.5827346500496298
['catalog_page', 'catalog_returns']
2
call_center: 0.007384594977735177, -0.007384594977735177
call_center had no query dependencies
customer: 0.027246817296541194, 25.003202150351015
customer_address: 0.03293312569677355, 26.039551165894867
household_demographics: 0.006404559819149065, 20.473871761944842
income_band: 0.005611237078070071, 0.017267525682092284
inventory: 0.044869313923436474, 0.21679697834340927
promotion: 0.007834762802657632, 5.8744106329944366
ship_mode: 0.005743803825933047, 0.26302857381447325
store_returns: 0.8004714755507769, 5.1980112742101685
time_dim: 0.007156918544350885, 7.036961101249477
warehouse: 0.006540558738932757, 0.2659066804533941
web_page: 0.006232711599830041, 0.9795226210735607
web_returns: 0.16381941988669835, 1.759454744942556
web_sales: 2.4474891830032313, 11.968898663231409
web_site: 0.007700362335727609, 1.5827346503258883
['call_center']
1
income_band: 0.005611237064413917, 0.017267525695748437
ship_mode: 0.005743803790005586, 0.2630285738504007
warehouse: 0.006540558686394785, 0.2659066805059321
web_page: 0.006232711377778085, 0.9795226212956127
web_returns: 0.16356820474399156, 1.7597059600852627
web_site: 0.007700362134418133, 1.582734650527198
[]
0
{'28': 131072, '09': 139264, '27': 166080, '67': 166016, '59': 0, '48': 32, '34': 272, '79': 272, '24': 65584, '61': 4144, '96': 262400, '50': 65536, '98': 0, '08': 48, '89': 0, '52': 0, '68': 304, '47': 0, '07': 4096, '31': 4194336, '82': 1024, '65': 0, '11': 4194320, '03': 0, '73': 272, '42': 0, '53': 0, '43': 0, '46': 304, '13': 288, '44': 0, '06': 48, '19': 48, '55': 0, '63': 0, '36': 0, '88': 262400, '93': 65536, '70': 0, '62': 8929280, '86': 0, '45': 0, '95': 10485760, '51': 0, '92': 0, '01': 0, '90': 1048576, '94': 10485760, '84': 512, '85': 3145728, '12': 0, '74': 0}
{}
{'28': 131072, '09': 139264, '27': 166080, '67': 166016, '59': 0, '48': 32, '34': 272, '79': 272, '24': 65584, '61': 4144, '96': 262400, '50': 65536, '98': 0, '08': 48, '89': 0, '52': 0, '68': 304, '47': 0, '07': 4096, '31': 4194336, '82': 1024, '65': 0, '11': 4194320, '03': 0, '73': 272, '42': 0, '53': 0, '43': 0, '46': 304, '13': 288, '44': 0, '06': 48, '19': 48, '55': 0, '63': 0, '36': 0, '88': 262400, '93': 65536, '70': 0, '62': 8929280, '86': 0, '45': 0, '95': 10485760, '51': 0, '92': 0, '01': 0, '90': 1048576, '94': 10485760, '84': 512, '85': 3145728, '12': 0, '74': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 16.440550550261896, 5.586385899801255, 0.3583252429962158, 0.42864010311830014, 10.003067896982829, 0.02528670658825212, 0.03884470077504815
{16.440550550261896: []}
Best Cost: $16.440550550261896;
[6, 7, 11, 13, 15, 17, 4, 5, 8, 10, 12, 16, 18, 22, 9, 14, 19, 20, 21, 23]
{'59': 163968, '48': 164064, '62': 13123712, '34': 164240, '79': 164240, '86': 4196480, '24': 231472, '61': 170160, '96': 426240, '50': 229504, '98': 133248, '08': 164016, '89': 166016, '52': 133248, '68': 164272, '47': 166016, '07': 137408, '31': 4325536, '82': 134272, '65': 166016, '45': 4196528, '11': 4325520, '95': 14680224, '28': 131072, '03': 133248, '51': 4325504, '21': 527488, '73': 164240, '42': 133248, '53': 166016, '09': 139264, '43': 163968, '92': 4196480, '46': 164272, '01': 98448, '90': 5505280, '94': 14680224, '13': 164320, '27': 166080, '84': 66416, '44': 133120, '06': 133296, '19': 166064, '85': 7348448, '55': 133248, '12': 4196480, '63': 166016, '36': 166016, '88': 426240, '93': 204800, '70': 163968, '74': 4325520, '67': 166016}
['91', '30', '39', '41', '22', '83', '81']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 11, 13, 15, 17, 4, 5, 8, 10, 12, 16, 18, 22, 9, 14, 19, 20, 21, 23]
dict_keys(['59', '48', '62', '34', '79', '86', '24', '61', '96', '50', '98', '08', '89', '52', '68', '47', '07', '31', '82', '65', '45', '11', '95', '28', '03', '51', '21', '73', '42', '53', '09', '43', '92', '46', '01', '90', '94', '13', '27', '84', '44', '06', '19', '85', '55', '12', '63', '36', '88', '93', '70', '74', '67'])
20
Optimal Subset: 0b111111111111111111110000
dict_keys(['59', '48', '62', '34', '79', '86', '24', '61', '96', '50', '98', '08', '89', '52', '68', '47', '07', '31', '82', '65', '45', '11', '95', '28', '03', '51', '21', '73', '42', '53', '09', '43', '92', '46', '01', '90', '94', '13', '27', '84', '44', '06', '19', '85', '55', '12', '63', '36', '88', '93', '70', '74', '67'])
Function: 16.440550550261896, 5.586385899801255, 0.3583252429962158, 0.42864010311830014, 10.003067896982829, 0.02528670658825212, 0.03884470077504815
Real: 16.440550550261896, 5.586385899801255, 0.3583252429962158, 0.42864010311830014, 10.003067896982829, 0.02528670658825212, 0.03884470077504815
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 53; Num Redshift Qs: 7
PLAN TYPE IS: multi
Moved Qs: $5.586385899801255; Stayed Qs: $0.3583252429962158; Migration Cost: $10.495839407464429
Movement Cost: $0.42864010311830014, Load Cost: $10.003067896982829, Storage Cost: $0.02528670658825212, API Cost: $0.03884470077504815
Final cost: $16.440550550261896, Baseline: $121.27009630203247, Diff: $104.82954575177058, %: 86.44303002010038%
