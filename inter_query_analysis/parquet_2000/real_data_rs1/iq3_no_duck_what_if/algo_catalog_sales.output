Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_2000/real_data_rs1
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $7.278996289246479, Redshift-Calcite Total: $6.158634711249669, BigQuery Total: $104.23612117767334
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
-0.054142961694191055
call_center: 5.735084414482117e-06, 0.005377375949431077, 0.04802111370820938
catalog_page: 0.0006659524515271187, 0.005151209925860539, -0.005151209925860539
catalog_page had no query dependencies
catalog_returns: 23.366260116919875, 5.857530576416132, -5.623291236841159
customer: 0.6484093563631177, 0.1691830522885853, 20.85786017596772
customer_address: 0.18544994108378887, 0.05347152221617917, 20.752033527519924
customer_demographics: 0.012168197892606258, 0.00855341137076587, 13.351940755186627
date_dim: 0.0019952356815338135, 0.005807011082860035, 71.15184280103615
household_demographics: 3.512948751449585e-05, 0.0043939295775536754, 16.483485328006463
income_band: 6.137415766716003e-07, 0.003414495061624337, 0.01860755693039468
inventory: 0.24701470416039228, 0.06725726772714165, 0.18297037758262452
item: 0.005464168265461922, 0.006833321675715788, 44.87847339550509
promotion: 2.6027671992778778e-05, 0.004810794114747981, 4.728619255403997
reason: 1.2423843145370483e-06, 0.0047349656581673295, 8.488909487468025
ship_mode: 1.5795230865478516e-06, 0.004709353405526835, 0.24642613503149
store: 2.3781321942806244e-05, 0.005285213132068211, 60.02914105020666
store_returns: 36.877127600833774, 9.240828317811232, -4.295489408501129
store_sales: 288.85508783441037, 73.87819243910033, 20.416366450629653
time_dim: 0.0012104213237762451, 0.0020877087690697156, 5.58866183604059
warehouse: 2.3292377591133118e-06, 0.0004460372085918429, 0.2928204384359172
web_page: 1.0661780834197998e-05, 0.001555651813912405, 0.7837426918266535
web_returns: 11.326140539720654, 2.8475304329658684, -1.2649287415350612
web_sales: 109.34904180746526, 27.737882424072115, -15.788904827956445
web_site: 8.863396942615509e-06, 0.0006172473221630429, 1.2084115792400032
-0.05411753153494759
call_center: 5.735084414482117e-06, 0.00537737537631668, -0.00537737537631668
call_center had no query dependencies
customer: 0.6484093563631177, 0.16911825590366536, 13.139429596202033
customer_address: 0.18544994108378887, 0.05345298996390995, 13.653598286747314
customer_demographics: 0.012168197892606258, 0.008552195387025514, 12.799165611502191
date_dim: 0.0019952356815338135, 0.005806811696379938, 58.036607439628746
household_demographics: 3.512948751449585e-05, 0.00439392606701859, 16.100122264245293
income_band: 6.137415766716003e-07, 0.003414495000292348, -0.003414495000292348
income_band had no query dependencies
inventory: 0.24701470416039228, 0.06723258322853812, 0.18299506208122804
item: 0.005464168265461922, 0.006832775634319683, 40.957843899329305
promotion: 2.6027671992778778e-05, 0.004810791513769083, 4.728619258004976
reason: 1.2423843145370483e-06, 0.004734965534014259, 6.749746442616579
ship_mode: 1.5795230865478516e-06, 0.0047093532476830515, -0.0047093532476830515
ship_mode had no query dependencies
store: 2.3781321942806244e-05, 0.005285210755569977, 56.46658977934569
store_sales: 288.85508783441037, 73.84932677688599, 7.304187281155606
time_dim: 0.0012104213237762451, 0.002087587810102605, 5.280719431377507
warehouse: 2.3292377591133118e-06, 0.00044603697582810357, 0.041684950231664096
web_page: 1.0661780834197998e-05, 0.0015556507484668681, -0.0015556507484668681
web_page had no query dependencies
web_site: 8.863396942615509e-06, 0.0006172464364323322, -0.0006172464364323322
web_site had no query dependencies
-0.05411741623347334
customer: 0.6484093563631177, 0.1691179621139712, 13.139429889991728
customer_address: 0.18544994108378887, 0.05345290593785305, 13.653598370773372
customer_demographics: 0.012168197892606258, 0.008552189873701098, 12.799165617015516
date_dim: 0.0019952356815338135, 0.005806810792352761, 58.03660744053278
household_demographics: 3.512948751449585e-05, 0.004393926051101667, 16.10012226426121
inventory: 0.24701470416039228, 0.06723247130792241, 0.18299517400184373
item: 0.005464168265461922, 0.006832773158543681, 40.957843901805084
promotion: 2.6027671992778778e-05, 0.004810791501976129, 4.728619258016769
reason: 1.2423843145370483e-06, 0.004734965533451344, 6.749746442617142
store: 2.3781321942806244e-05, 0.0052852107447948285, 56.46658977935646
store_sales: 288.85508783441037, 73.84919589868832, 7.304318159353272
time_dim: 0.0012104213237762451, 0.0020875872616692623, 5.280719431925941
warehouse: 2.3292377591133118e-06, 0.0004460369747727424, 0.04168495023271945
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 97.5003010137186, 4.70414190390865, 18.336334228515625, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
-0.05411741623347334
customer: 0.6484093563631177, 0.1691179621139712, 13.139429889991728
customer_address: 0.18544994108378887, 0.05345290593785305, 13.653598370773372
customer_demographics: 0.012168197892606258, 0.008552189873701098, 12.799165617015516
date_dim: 0.0019952356815338135, 0.005806810792352761, 58.03660744053278
household_demographics: 3.512948751449585e-05, 0.004393926051101667, 16.10012226426121
inventory: 0.24701470416039228, 0.06723247130792241, 0.18299517400184373
item: 0.005464168265461922, 0.006832773158543681, 40.957843901805084
promotion: 2.6027671992778778e-05, 0.004810791501976129, 4.728619258016769
reason: 1.2423843145370483e-06, 0.004734965533451344, 6.749746442617142
store: 2.3781321942806244e-05, 0.0052852107447948285, 56.46658977935646
store_sales: 288.85508783441037, 73.84919589868832, 7.304318159353272
time_dim: 0.0012104213237762451, 0.0020875872616692623, 5.280719431925941
warehouse: 2.3292377591133118e-06, 0.0004460369747727424, 0.04168495023271945
customer: 0.6484093563631177, 0.16911793154247176, 13.139429920563227
customer_address: 0.18544994108378887, 0.05345289719417482, 13.65359837951705
customer_demographics: 0.012168197892606258, 0.008552189299989365, 12.799165617589228
date_dim: 0.0019952356815338135, 0.00580681069828048, 57.99447645341936
household_demographics: 3.512948751449585e-05, 0.0043939260494453665, 16.100122264262865
inventory: 0.24701470416039228, 0.06723245966156072, 0.1408641984407132
item: 0.005464168265461922, 0.00683277290091659, 40.91571291485522
promotion: 2.6027671992778778e-05, 0.004810791500748965, 4.7286192580179955
reason: 1.2423843145370483e-06, 0.004734965533392767, 6.749746442617201
store: 2.3781321942806244e-05, 0.005285210743673575, 56.466589779357584
store_sales: 288.85508783441037, 73.84918227961717, 7.304331778424427
time_dim: 0.0012104213237762451, 0.002087587204599767, 5.28071943198301
Function: 97.54197229069992, 4.702952235293388, 18.37965488433838, 69.86752799873295, 4.489337696172396, 0.07732720120893206, 0.025172274953860048
hiya: 0b1101011110111110000, 97.54197229069992
customer: 0.6484093563631177, 0.16911793154247176, 13.139429920563227
customer_address: 0.18544994108378887, 0.05345289719417482, 13.65359837951705
customer_demographics: 0.012168197892606258, 0.008552189299989365, 12.799165617589228
date_dim: 0.0019952356815338135, 0.00580681069828048, 57.99447645341936
household_demographics: 3.512948751449585e-05, 0.0043939260494453665, 16.100122264262865
inventory: 0.24701470416039228, 0.06723245966156072, 0.1408641984407132
item: 0.005464168265461922, 0.00683277290091659, 40.91571291485522
promotion: 2.6027671992778778e-05, 0.004810791500748965, 4.7286192580179955
reason: 1.2423843145370483e-06, 0.004734965533392767, 6.749746442617201
store: 2.3781321942806244e-05, 0.005285210743673575, 56.466589779357584
store_sales: 288.85508783441037, 73.84918227961717, 7.304331778424427
time_dim: 0.0012104213237762451, 0.002087587204599767, 5.28071943198301
customer: 0.6484093563631177, 0.16911767996942495, 13.139430172136274
customer_address: 0.18544994108378887, 0.05345282524239582, 13.653598451468829
customer_demographics: 0.012168197892606258, 0.008552184578912181, 12.799165622310305
date_dim: 0.0019952356815338135, 0.005806809924159141, 57.786379796091204
household_demographics: 3.512948751449585e-05, 0.004393926035815655, 16.100122264276493
item: 0.005464168265461922, 0.006832770780901748, 40.70761625887296
promotion: 2.6027671992778778e-05, 0.004810791490650621, 4.728619258028094
reason: 1.2423843145370483e-06, 0.0047349655329107405, 6.749746442617683
store: 2.3781321942806244e-05, 0.005285210734446781, 56.46658977936681
store_sales: 288.85508783441037, 73.84907020820145, 7.096347191737863
time_dim: 0.0012104213237762451, 0.0020875867349745567, 5.280719432452635
Function: 97.68248736365695, 4.6974306148922444, 18.593273162841797, 69.80800774730962, 4.481485982737938, 0.07714892299194262, 0.02514093288342059
hiya: 0b1101011100111110000, 97.68248736365695
customer: 0.6484093563631177, 0.16911767996942495, 13.139430172136274
customer_address: 0.18544994108378887, 0.05345282524239582, 13.653598451468829
customer_demographics: 0.012168197892606258, 0.008552184578912181, 12.799165622310305
date_dim: 0.0019952356815338135, 0.005806809924159141, 57.786379796091204
household_demographics: 3.512948751449585e-05, 0.004393926035815655, 16.100122264276493
item: 0.005464168265461922, 0.006832770780901748, 40.70761625887296
promotion: 2.6027671992778778e-05, 0.004810791490650621, 4.728619258028094
reason: 1.2423843145370483e-06, 0.0047349655329107405, 6.749746442617683
store: 2.3781321942806244e-05, 0.005285210734446781, 56.46658977936681
store_sales: 288.85508783441037, 73.84907020820145, 7.096347191737863
time_dim: 0.0012104213237762451, 0.0020875867349745567, 5.280719432452635
customer: 0.6484093563631177, 0.16911570465320602, 10.518136562501645
customer_address: 0.18544994108378887, 0.05345226028713596, 11.032303431473245
customer_demographics: 0.012168197892606258, 0.00855214750967742, 10.68703119481164
date_dim: 0.0019952356815338135, 0.005806803845867143, 53.052949752650754
household_demographics: 3.512948751449585e-05, 0.004393925928797079, 16.10012226438351
item: 0.005464168265461922, 0.006832754134843063, 35.97418622600028
reason: 1.2423843145370483e-06, 0.004734965529125937, 6.7497464426214675
store: 2.3781321942806244e-05, 0.005285210661999291, 53.84529419448841
store_sales: 288.85508783441037, 73.84819023919064, 2.363797111229914
time_dim: 0.0012104213237762451, 0.002087583047543385, 5.280719436140067
Function: 102.41022402379532, 4.597219612164895, 23.42691421508789, 69.80800147572516, 4.476691447068452, 0.07626634311429746, 0.02513093063462973
hiya: 0b1101010100111110000, 102.41022402379532
customer: 0.6484093563631177, 0.16911570465320602, 10.518136562501645
customer_address: 0.18544994108378887, 0.05345226028713596, 11.032303431473245
customer_demographics: 0.012168197892606258, 0.00855214750967742, 10.68703119481164
date_dim: 0.0019952356815338135, 0.005806803845867143, 53.052949752650754
household_demographics: 3.512948751449585e-05, 0.004393925928797079, 16.10012226438351
item: 0.005464168265461922, 0.006832754134843063, 35.97418622600028
reason: 1.2423843145370483e-06, 0.004734965529125937, 6.7497464426214675
store: 2.3781321942806244e-05, 0.005285210661999291, 53.84529419448841
store_sales: 288.85508783441037, 73.84819023919064, 2.363797111229914
time_dim: 0.0012104213237762451, 0.002087583047543385, 5.280719436140067
customer: 0.6484093563631177, 0.16894603995240806, -0.16894603995240806
customer had no query dependencies
customer_address: 0.18544994108378887, 0.05340373490967463, -0.05340373490967463
customer_address had no query dependencies
customer_demographics: 0.012168197892606258, 0.008548963543199393, -0.008548963543199393
customer_demographics had no query dependencies
date_dim: 0.0019952356815338135, 0.005806281766625678, -0.005806281766625678
date_dim had no query dependencies
household_demographics: 3.512948751449585e-05, 0.004393916736711971, -0.004393916736711971
household_demographics had no query dependencies
item: 0.005464168265461922, 0.006831324364490783, -0.006831324364490783
item had no query dependencies
reason: 1.2423843145370483e-06, 0.004734965204040001, -0.004734965204040001
reason had no query dependencies
store: 2.3781321942806244e-05, 0.00528520443930859, -0.00528520443930859
store had no query dependencies
time_dim: 0.0012104213237762451, 0.0020872663251368952, -0.0020872663251368952
time_dim had no query dependencies
Function: 104.23612117767334, 0, 104.23612117767334, 0.0, 0, 0.0, 0
hiya: 0b0, 104.23612117767334
{97.5003010137186: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 97.54197229069992: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18], 97.68248736365695: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 102.41022402379532: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 104.23612117767334: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'55': 133248, '09': 139264, '43': 163968, '44': 133120, '67': 166016, '89': 166016, '53': 166016, '59': 163968, '70': 163968, '65': 166016, '52': 133248, '34': 164240, '61': 170160, '79': 164240, '68': 164272, '47': 166016, '22': 527488, '63': 166016, '98': 133248, '46': 164272, '03': 133248, '42': 133248, '19': 166064, '48': 164064, '27': 166080, '96': 426240, '88': 426240, '21': 527488, '39': 527488, '08': 164016, '36': 166016, '13': 164320, '82': 134272, '28': 131072, '07': 137408, '06': 133296, '73': 164240}
Best Cost: $97.5003010137186;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'55': 133248, '09': 139264, '43': 163968, '44': 133120, '67': 166016, '89': 166016, '53': 166016, '59': 163968, '70': 163968, '65': 166016, '52': 133248, '34': 164240, '61': 170160, '79': 164240, '68': 164272, '47': 166016, '22': 527488, '63': 166016, '98': 133248, '46': 164272, '03': 133248, '42': 133248, '19': 166064, '48': 164064, '27': 166080, '96': 426240, '88': 426240, '21': 527488, '39': 527488, '08': 164016, '36': 166016, '13': 164320, '82': 134272, '28': 131072, '07': 137408, '06': 133296, '73': 164240}
{'55': 133248, '09': 139264, '43': 163968, '44': 133120, '67': 166016, '89': 166016, '53': 166016, '59': 163968, '70': 163968, '65': 166016, '52': 133248, '34': 164240, '61': 170160, '79': 164240, '68': 164272, '47': 166016, '22': 527488, '63': 166016, '98': 133248, '46': 164272, '03': 133248, '42': 133248, '19': 166064, '48': 164064, '27': 166080, '96': 426240, '88': 426240, '21': 527488, '39': 527488, '08': 164016, '36': 166016, '13': 164320, '82': 134272, '28': 131072, '07': 137408, '06': 133296, '73': 164240}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 97.5003010137186, 4.70414190390865, 18.336334228515625, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
97.5003010137186
Real: 97.5003010137186, 4.70414190390865, 18.336334228515625, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
Num Redshift Qs: 37; Num GCP Qs: 23
Redshift Qs: $4.70414190390865; GCP Qs: $18.336334228515625; Movement Cost: $69.86752855998219
Load Cost: $4.489773173307578, Storage Cost: $0.07734087284944696, API Cost: $0.02518227515510619
Final cost: $97.5003010137186, BQ Baseline: $104.23612117767334, Diff: $6.735820163954742, %: 6.462078680454112%
