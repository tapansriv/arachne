Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_2000/real_data_rs1
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $8.219016847785312, Redshift-Calcite Total: $7.747829310599168, BigQuery Total: $119.39703941345215
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 62
-0.054161816973461334
call_center: 5.735084414482117e-06, 0.005377376374368723, 3.1445413847848127
catalog_page: 0.0006659524515271187, 0.00515125926920873, -0.00515125926920873
catalog_page had no query dependencies
catalog_returns: 23.366260116919875, 5.859261885470138, 3.589805639415596
catalog_sales: 217.0907397372648, 55.37435132075854, -29.104879331296964
customer: 0.6484093563631177, 0.16923109579164297, 29.554798848076672
customer_address: 0.18544994108378887, 0.053485263018535074, 30.951689607565473
customer_demographics: 0.012168197892606258, 0.008554312966103634, 28.047660471463765
date_dim: 0.0019952356815338135, 0.005807158918653312, 85.78027957216833
household_demographics: 3.512948751449585e-05, 0.00439393218045202, 23.65247396336948
income_band: 6.137415766716003e-07, 0.0034144951070991516, 6.689584567978218
inventory: 0.24701470416039228, 0.06727557013375894, 1.095118121202555
item: 0.005464168265461922, 0.006833726539992025, 66.93802197281879
promotion: 2.6027671992778778e-05, 0.004810796043252755, 13.314533580370966
reason: 1.2423843145370483e-06, 0.004734965750221051, 8.011553669357456
ship_mode: 1.5795230865478516e-06, 0.004709353522560652, 0.4999728864954892
store: 2.3781321942806244e-05, 0.005285214894131023, 71.50292400622416
store_returns: 36.877127600833774, 9.243560706502514, 7.175561160587154
store_sales: 288.85508783441037, 73.89959498389616, 24.156034244464877
time_dim: 0.0012104213237762451, 0.002087798454513023, 5.280719220733097
warehouse: 2.3292377591133118e-06, 0.00044603738117532013, 2.020300151950436
web_page: 1.0661780834197998e-05, 0.0015556526038906727, -0.0015556526038906727
web_page had no query dependencies
web_returns: 11.326140539720654, 2.848369636568209, -2.7010171012810673
web_site: 8.863396942615509e-06, 0.0006172479788911328, -0.0006172479788911328
web_site had no query dependencies
-0.05412453301839567
call_center: 5.735084414482117e-06, 0.005377375534107708, 0.04802111412353275
catalog_returns: 23.366260116919875, 5.8558384384848665, -5.720557456033427
customer: 0.6484093563631177, 0.16913609577687141, 15.854975801449307
customer_address: 0.18544994108378887, 0.053458092301503536, 16.18188051952897
customer_demographics: 0.012168197892606258, 0.00855253017415562, 12.87458581836472
date_dim: 0.0019952356815338135, 0.005806866591873388, 59.363455339746366
household_demographics: 3.512948751449585e-05, 0.004393927033546289, 16.17554280492842
income_band: 6.137415766716003e-07, 0.0034144950171783968, 0.01860755697484062
inventory: 0.24701470416039228, 0.06723937941517392, 0.18298826589459216
item: 0.005464168265461922, 0.006832925971553524, 43.32882804966787
promotion: 2.6027671992778778e-05, 0.004810792229875912, 4.728619257288869
reason: 1.2423843145370483e-06, 0.004734965568196336, 8.01155366953948
ship_mode: 1.5795230865478516e-06, 0.004709353291140924, -0.004709353291140924
ship_mode had no query dependencies
store: 2.3781321942806244e-05, 0.005285211409872331, 60.02914105192886
store_returns: 36.877127600833774, 9.238157749817155, -4.391777197630587
store_sales: 288.85508783441037, 73.8572741300377, 11.933321718197178
time_dim: 0.0012104213237762451, 0.0020876211127727933, 5.280719398074837
warehouse: 2.3292377591133118e-06, 0.0004460370399130923, 0.0416849501675791
-0.05411748098341408
call_center: 5.735084414482117e-06, 0.005377375375177411, -0.005377375375177411
call_center had no query dependencies
customer: 0.6484093563631177, 0.16911812709768376, 13.139429725008013
customer_address: 0.18544994108378887, 0.05345295312443275, 13.653598323586793
customer_demographics: 0.012168197892606258, 0.008552192969823081, 12.799165613919394
date_dim: 0.0019952356815338135, 0.0058068113000280235, 58.03660744002511
household_demographics: 3.512948751449585e-05, 0.004393926060040147, 16.100122264252267
income_band: 6.137415766716003e-07, 0.003414495000170429, -0.003414495000170429
income_band had no query dependencies
inventory: 0.24701470416039228, 0.06723253415927173, 0.18299511115049438
item: 0.005464168265461922, 0.006832774548867182, 40.957843900414765
promotion: 2.6027671992778778e-05, 0.0048107915085987074, 4.728619258010146
reason: 1.2423843145370483e-06, 0.004734965533767461, 6.749746442616826
store: 2.3781321942806244e-05, 0.005285210750845837, 56.46658977935042
store_sales: 288.85508783441037, 73.84926939606204, 7.304244661979524
time_dim: 0.0012104213237762451, 0.0020875875696534114, 5.280719431617956
warehouse: 2.3292377591133118e-06, 0.0004460369753654024, 0.04168495023212679
-0.05411741623347334
customer: 0.6484093563631177, 0.1691179621139712, 13.139429889991726
customer_address: 0.18544994108378887, 0.05345290593785305, 13.653598370773373
customer_demographics: 0.012168197892606258, 0.008552189873701098, 12.799165617015516
date_dim: 0.0019952356815338135, 0.005806810792352761, 58.036607440532784
household_demographics: 3.512948751449585e-05, 0.004393926051101667, 16.100122264261206
inventory: 0.24701470416039228, 0.06723247130792241, 0.18299517400184367
item: 0.005464168265461922, 0.006832773158543681, 40.95784390180509
promotion: 2.6027671992778778e-05, 0.004810791501976129, 4.728619258016769
reason: 1.2423843145370483e-06, 0.004734965533451344, 6.749746442617142
store: 2.3781321942806244e-05, 0.0052852107447948285, 56.466589779356475
store_sales: 288.85508783441037, 73.84919589868832, 7.304318159353244
time_dim: 0.0012104213237762451, 0.0020875872616692623, 5.280719431925941
warehouse: 2.3292377591133118e-06, 0.0004460369747727424, 0.041684950232719446
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 112.6612192494974, 4.704141903908649, 33.497252464294434, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
-0.05411741623347334
customer: 0.6484093563631177, 0.1691179621139712, 13.139429889991726
customer_address: 0.18544994108378887, 0.05345290593785305, 13.653598370773373
customer_demographics: 0.012168197892606258, 0.008552189873701098, 12.799165617015516
date_dim: 0.0019952356815338135, 0.005806810792352761, 58.036607440532784
household_demographics: 3.512948751449585e-05, 0.004393926051101667, 16.100122264261206
inventory: 0.24701470416039228, 0.06723247130792241, 0.18299517400184367
item: 0.005464168265461922, 0.006832773158543681, 40.95784390180509
promotion: 2.6027671992778778e-05, 0.004810791501976129, 4.728619258016769
reason: 1.2423843145370483e-06, 0.004734965533451344, 6.749746442617142
store: 2.3781321942806244e-05, 0.0052852107447948285, 56.466589779356475
store_sales: 288.85508783441037, 73.84919589868832, 7.304318159353244
time_dim: 0.0012104213237762451, 0.0020875872616692623, 5.280719431925941
warehouse: 2.3292377591133118e-06, 0.0004460369747727424, 0.041684950232719446
customer: 0.6484093563631177, 0.16911793154247176, 13.139429920563225
customer_address: 0.18544994108378887, 0.05345289719417482, 13.653598379517051
customer_demographics: 0.012168197892606258, 0.008552189299989365, 12.799165617589228
date_dim: 0.0019952356815338135, 0.00580681069828048, 57.99447645341935
household_demographics: 3.512948751449585e-05, 0.0043939260494453665, 16.10012226426286
inventory: 0.24701470416039228, 0.06723245966156072, 0.1408641984407132
item: 0.005464168265461922, 0.00683277290091659, 40.91571291485523
promotion: 2.6027671992778778e-05, 0.004810791500748965, 4.7286192580179955
reason: 1.2423843145370483e-06, 0.004734965533392767, 6.749746442617201
store: 2.3781321942806244e-05, 0.005285210743673575, 56.4665897793576
store_sales: 288.85508783441037, 73.84918227961717, 7.304331778424398
time_dim: 0.0012104213237762451, 0.002087587204599767, 5.28071943198301
Function: 112.70289052647873, 4.702952235293387, 33.54057312011719, 69.86752799873295, 4.489337696172396, 0.07732720120893206, 0.025172274953860048
hiya: 0b1101011110111110000, 112.70289052647873
customer: 0.6484093563631177, 0.16911793154247176, 13.139429920563225
customer_address: 0.18544994108378887, 0.05345289719417482, 13.653598379517051
customer_demographics: 0.012168197892606258, 0.008552189299989365, 12.799165617589228
date_dim: 0.0019952356815338135, 0.00580681069828048, 57.99447645341935
household_demographics: 3.512948751449585e-05, 0.0043939260494453665, 16.10012226426286
inventory: 0.24701470416039228, 0.06723245966156072, 0.1408641984407132
item: 0.005464168265461922, 0.00683277290091659, 40.91571291485523
promotion: 2.6027671992778778e-05, 0.004810791500748965, 4.7286192580179955
reason: 1.2423843145370483e-06, 0.004734965533392767, 6.749746442617201
store: 2.3781321942806244e-05, 0.005285210743673575, 56.4665897793576
store_sales: 288.85508783441037, 73.84918227961717, 7.304331778424398
time_dim: 0.0012104213237762451, 0.002087587204599767, 5.28071943198301
customer: 0.6484093563631177, 0.16911767996942495, 13.139430172136272
customer_address: 0.18544994108378887, 0.05345282524239582, 13.65359845146883
customer_demographics: 0.012168197892606258, 0.008552184578912181, 12.799165622310305
date_dim: 0.0019952356815338135, 0.005806809924159141, 57.786379796091204
household_demographics: 3.512948751449585e-05, 0.004393926035815655, 16.10012226427649
item: 0.005464168265461922, 0.006832770780901748, 40.70761625887297
promotion: 2.6027671992778778e-05, 0.004810791490650621, 4.728619258028094
reason: 1.2423843145370483e-06, 0.0047349655329107405, 6.749746442617683
store: 2.3781321942806244e-05, 0.005285210734446781, 56.46658977936682
store_sales: 288.85508783441037, 73.84907020820145, 7.096347191737834
time_dim: 0.0012104213237762451, 0.0020875867349745567, 5.280719432452635
Function: 112.84340559943575, 4.697430614892244, 33.754191398620605, 69.80800774730962, 4.481485982737938, 0.07714892299194262, 0.02514093288342059
hiya: 0b1101011100111110000, 112.84340559943575
customer: 0.6484093563631177, 0.16911767996942495, 13.139430172136272
customer_address: 0.18544994108378887, 0.05345282524239582, 13.65359845146883
customer_demographics: 0.012168197892606258, 0.008552184578912181, 12.799165622310305
date_dim: 0.0019952356815338135, 0.005806809924159141, 57.786379796091204
household_demographics: 3.512948751449585e-05, 0.004393926035815655, 16.10012226427649
item: 0.005464168265461922, 0.006832770780901748, 40.70761625887297
promotion: 2.6027671992778778e-05, 0.004810791490650621, 4.728619258028094
reason: 1.2423843145370483e-06, 0.0047349655329107405, 6.749746442617683
store: 2.3781321942806244e-05, 0.005285210734446781, 56.46658977936682
store_sales: 288.85508783441037, 73.84907020820145, 7.096347191737834
time_dim: 0.0012104213237762451, 0.0020875867349745567, 5.280719432452635
customer: 0.6484093563631177, 0.16911570465320602, 10.518136562501645
customer_address: 0.18544994108378887, 0.05345226028713596, 11.032303431473245
customer_demographics: 0.012168197892606258, 0.00855214750967742, 10.68703119481164
date_dim: 0.0019952356815338135, 0.005806803845867143, 53.052949752650754
household_demographics: 3.512948751449585e-05, 0.004393925928797079, 16.100122264383508
item: 0.005464168265461922, 0.006832754134843063, 35.974186226000285
reason: 1.2423843145370483e-06, 0.004734965529125937, 6.7497464426214675
store: 2.3781321942806244e-05, 0.005285210661999291, 53.845294194488424
store_sales: 288.85508783441037, 73.84819023919064, 2.3637971112299
time_dim: 0.0012104213237762451, 0.002087583047543385, 5.280719436140067
Function: 117.57114225957413, 4.597219612164895, 38.5878324508667, 69.80800147572516, 4.476691447068452, 0.07626634311429746, 0.02513093063462973
hiya: 0b1101010100111110000, 117.57114225957413
customer: 0.6484093563631177, 0.16911570465320602, 10.518136562501645
customer_address: 0.18544994108378887, 0.05345226028713596, 11.032303431473245
customer_demographics: 0.012168197892606258, 0.00855214750967742, 10.68703119481164
date_dim: 0.0019952356815338135, 0.005806803845867143, 53.052949752650754
household_demographics: 3.512948751449585e-05, 0.004393925928797079, 16.100122264383508
item: 0.005464168265461922, 0.006832754134843063, 35.974186226000285
reason: 1.2423843145370483e-06, 0.004734965529125937, 6.7497464426214675
store: 2.3781321942806244e-05, 0.005285210661999291, 53.845294194488424
store_sales: 288.85508783441037, 73.84819023919064, 2.3637971112299
time_dim: 0.0012104213237762451, 0.002087583047543385, 5.280719436140067
customer: 0.6484093563631177, 0.16894603995240806, -0.16894603995240806
customer had no query dependencies
customer_address: 0.18544994108378887, 0.05340373490967463, -0.05340373490967463
customer_address had no query dependencies
customer_demographics: 0.012168197892606258, 0.008548963543199393, -0.008548963543199393
customer_demographics had no query dependencies
date_dim: 0.0019952356815338135, 0.005806281766625678, -0.005806281766625678
date_dim had no query dependencies
household_demographics: 3.512948751449585e-05, 0.004393916736711971, -0.004393916736711971
household_demographics had no query dependencies
item: 0.005464168265461922, 0.006831324364490783, -0.006831324364490783
item had no query dependencies
reason: 1.2423843145370483e-06, 0.004734965204040001, -0.004734965204040001
reason had no query dependencies
store: 2.3781321942806244e-05, 0.00528520443930859, -0.00528520443930859
store had no query dependencies
time_dim: 0.0012104213237762451, 0.0020872663251368952, -0.0020872663251368952
time_dim had no query dependencies
Function: 119.39703941345215, 0, 119.39703941345215, 0.0, 0, 0.0, 0
hiya: 0b0, 119.39703941345215
{112.6612192494974: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 112.70289052647873: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18], 112.84340559943575: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 117.57114225957413: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 119.39703941345215: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'63': 166016, '48': 164064, '28': 131072, '13': 164320, '44': 133120, '96': 426240, '68': 164272, '09': 139264, '53': 166016, '70': 163968, '43': 163968, '65': 166016, '59': 163968, '42': 133248, '55': 133248, '88': 426240, '79': 164240, '89': 166016, '39': 527488, '36': 166016, '27': 166080, '03': 133248, '06': 133296, '22': 527488, '46': 164272, '52': 133248, '21': 527488, '07': 137408, '67': 166016, '08': 164016, '98': 133248, '19': 166064, '73': 164240, '34': 164240, '82': 134272, '61': 170160, '47': 166016}
Best Cost: $112.6612192494974;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'63': 166016, '48': 164064, '28': 131072, '13': 164320, '44': 133120, '96': 426240, '68': 164272, '09': 139264, '53': 166016, '70': 163968, '43': 163968, '65': 166016, '59': 163968, '42': 133248, '55': 133248, '88': 426240, '79': 164240, '89': 166016, '39': 527488, '36': 166016, '27': 166080, '03': 133248, '06': 133296, '22': 527488, '46': 164272, '52': 133248, '21': 527488, '07': 137408, '67': 166016, '08': 164016, '98': 133248, '19': 166064, '73': 164240, '34': 164240, '82': 134272, '61': 170160, '47': 166016}
{'63': 166016, '48': 164064, '28': 131072, '13': 164320, '44': 133120, '96': 426240, '68': 164272, '09': 139264, '53': 166016, '70': 163968, '43': 163968, '65': 166016, '59': 163968, '42': 133248, '55': 133248, '88': 426240, '79': 164240, '89': 166016, '39': 527488, '36': 166016, '27': 166080, '03': 133248, '06': 133296, '22': 527488, '46': 164272, '52': 133248, '21': 527488, '07': 137408, '67': 166016, '08': 164016, '98': 133248, '19': 166064, '73': 164240, '34': 164240, '82': 134272, '61': 170160, '47': 166016}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 112.6612192494974, 4.704141903908649, 33.497252464294434, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
112.6612192494974
Real: 112.6612192494974, 4.704141903908649, 33.497252464294434, 69.86752855998219, 4.489773173307578, 0.07734087284944696, 0.02518227515510619
Num Redshift Qs: 37; Num GCP Qs: 26
Redshift Qs: $4.704141903908649; GCP Qs: $33.497252464294434; Movement Cost: $69.86752855998219
Load Cost: $4.489773173307578, Storage Cost: $0.07734087284944696, API Cost: $0.02518227515510619
Final cost: $112.6612192494974, BQ Baseline: $119.39703941345215, Diff: $6.735820163954742, %: 5.6415303068191776%
