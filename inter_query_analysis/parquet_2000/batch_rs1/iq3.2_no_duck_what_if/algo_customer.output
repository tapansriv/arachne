Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.6473944143366825, BigQuery Total: $181.02735877037048
02: $0.5495952197253704
03: $0.9817064178975423
05: $3.0163300886742275
07: $2.6774225909308593
09: $8.502832263594867
12: $0.2538029509019852
13: $3.394577400420904
14: $31.540535032206773
16: $1.3385510518030326
17: $2.066575102887948
20: $0.517343595050176
21: $0.006171314786275228
22: $0.03202358495632807
25: $2.2840587642157075
26: $1.3857572804141045
27: $8.012742426739534
28: $10.114393916885456
29: $2.0361562881326676
31: $3.6661184598493577
32: $1.0352094285285474
33: $2.2431871054748695
36: $5.124758544688225
37: $0.13300605406840643
39: $0.012872356765667597
40: $0.8344885978384813
41: $-0.0003614868239561717
42: $0.9816911180237929
43: $1.0001751001433532
44: $1.8902832064553101
47: $1.1304790044124922
48: $2.1824029066793122
49: $3.7093276532773176
50: $1.3518296918110053
51: $1.2288152922884623
52: $0.9818565818440914
53: $1.1858592124962806
55: $0.9816606972050667
56: $2.2433921766714255
57: $0.6084608910775184
58: $1.7545572148915132
59: $0.9410491335642338
60: $2.2435616981732847
62: $0.3182683006020387
63: $1.2286756509804726
65: $1.2266821705770492
66: $1.72760548030138
67: $13.026949843046268
70: $3.8897113580667972
71: $2.187141222111384
72: $1.013263541170756
75: $5.626694524134398
76: $2.1805352026100953
77: $2.862357419302066
78: $3.2823005809446175
80: $4.131975552931229
82: $0.26085304001410803
83: $0.13029855892936387
85: $0.6295003655250867
86: $0.7619529788974921
88: $5.3449820168169335
89: $1.2267761427402497
90: $0.38121824163158735
92: $0.5006231746848424
93: $1.585086236135165
94: $0.6488971478617191
95: $0.6439432561226686
96: $0.7368130428636074
97: $1.0421291252366702
98: $0.9812976681685448
99: $0.6281765839993954
!!!!!!: 174.3803258428578
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'70': 163968, '12': 4196480, '98': 133248, '43': 163968, '14': 4327560, '25': 231560, '62': 13123712, '66': 4997256, '60': 4327592, '90': 5505280, '42': 133248, '09': 139264, '48': 164064, '53': 166016, '97': 131208, '07': 137408, '36': 166016, '77': 7569548, '13': 164320, '94': 14680224, '76': 4327560, '89': 166016, '20': 2184, '80': 14915726, '85': 7348448, '49': 6488204, '93': 204800, '27': 166080, '95': 14680224, '83': 2164868, '22': 527488, '33': 4327592, '31': 4325536, '44': 133120, '63': 166016, '86': 4196480, '52': 133248, '59': 163968, '50': 229504, '75': 6490252, '92': 4196480, '03': 133248, '28': 131072, '71': 4589704, '39': 527488, '78': 6488204, '58': 4327560, '17': 231560, '51': 4325504, '72': 531916, '32': 2184, '88': 426240, '40': 526476, '56': 4327592, '05': 14909582, '96': 426240, '55': 133248, '21': 527488, '99': 540809, '82': 134272, '37': 3208, '16': 173, '65': 166016, '47': 166016, '57': 2185, '29': 231560, '67': 166016, '26': 6344, '02': 4194440}
call_center: 0.0009758253223883515, 2.5742127015575584
catalog_page: 0.000878481867363215, 7.147427159738094
catalog_returns: 0.28940340223823374, 25.656184166767257
catalog_sales: 3.2538296389440093, 80.96844283690938
customer_address: 0.00561102580002304, 19.228520542781638
customer_demographics: 0.0012333966735900903, 19.294433115206964
date_dim: 0.001100190165204338, 145.82361672830967
household_demographics: 0.0008382221789975052, 10.87001602072479
income_band: 0.0008170081542952774, -0.0008170081542952774
income_band had no query dependencies
inventory: 0.006139983473329855, 1.4520499082882115
item: 0.0011017129067671628, 109.66223679582438
promotion: 0.0011452328445258166, 9.207273732602424
reason: 0.0007875126295461168, 10.716631352625571
ship_mode: 0.0008675222221743672, 2.6731828426806397
store: 0.0009451587038059302, 67.40097170348677
store_returns: 0.4903353619833027, 31.592655099392406
store_sales: 4.710233619297093, 155.57906226791843
time_dim: 0.0014380065876643485, 10.376321997137229
warehouse: 0.0009679562010481668, 4.571901804219274
web_page: 0.0008523512128353288, 3.872223675245905
web_returns: 0.13212385511033056, 24.549501292592364
web_sales: 1.5950159631249583, 76.73722037667022
web_site: 0.0013117803807802442, 8.758102565811104
['income_band']
1
call_center: 0.0009758232574592632, 2.574212703622487
catalog_page: 0.000878259727950886, 7.147427381877506
catalog_returns: 0.2814556910341379, 25.66413187797135
customer_address: 0.005569832018557324, 19.2285617365631
promotion: 0.001145224356358662, 9.20727374109059
ship_mode: 0.0008675216711675107, 2.6731828432316465
store_returns: 0.4777905695169125, 31.605199891858796
web_page: 0.0008523478073024392, 3.8722236786514377
web_returns: 0.12827105666048552, 24.55335409104221
web_site: 0.0013117772933674719, 8.758102568898517
[]
0
{'14': 4327560, '09': 139264, '36': 166016, '27': 166080, '22': 527488, '28': 131072, '39': 527488, '88': 426240, '67': 166016, '70': 0, '12': 0, '98': 0, '43': 0, '25': 65536, '62': 8404992, '66': 16384, '60': 32, '90': 1048576, '42': 0, '48': 32, '53': 0, '97': 0, '07': 4096, '77': 3211268, '13': 32, '94': 10485792, '76': 0, '89': 0, '20': 0, '80': 10555398, '85': 3145760, '49': 2162692, '93': 65536, '95': 10485792, '33': 32, '31': 32, '44': 0, '63': 0, '86': 0, '52': 0, '59': 0, '50': 65536, '75': 2162692, '92': 0, '03': 0, '71': 0, '78': 2162692, '58': 0, '17': 65536, '51': 0, '72': 4100, '32': 0, '40': 4, '56': 32, '05': 10551302, '96': 0, '55': 0, '21': 0, '99': 16385, '82': 0, '37': 0, '16': 37, '65': 0, '47': 0, '57': 1, '29': 65536, '26': 4096, '02': 0}
{}
{'14': 4327560, '09': 139264, '36': 166016, '27': 166080, '22': 527488, '28': 131072, '39': 527488, '88': 426240, '67': 166016, '70': 0, '12': 0, '98': 0, '43': 0, '25': 65536, '62': 8404992, '66': 16384, '60': 32, '90': 1048576, '42': 0, '48': 32, '53': 0, '97': 0, '07': 4096, '77': 3211268, '13': 32, '94': 10485792, '76': 0, '89': 0, '20': 0, '80': 10555398, '85': 3145760, '49': 2162692, '93': 65536, '95': 10485792, '33': 32, '31': 32, '44': 0, '63': 0, '86': 0, '52': 0, '59': 0, '50': 65536, '75': 2162692, '92': 0, '03': 0, '71': 0, '78': 2162692, '58': 0, '17': 65536, '51': 0, '72': 4100, '32': 0, '40': 4, '56': 32, '05': 10551302, '96': 0, '55': 0, '21': 0, '99': 16385, '82': 0, '37': 0, '16': 37, '65': 0, '47': 0, '57': 1, '29': 65536, '26': 4096, '02': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 17.802617825152332, 6.64697332286795, 5.9604644775390625e-05, 0.6584647845412837, 10.103631238316297, 0.33390398012007655, 0.05958489466194809
{17.802617825152332: []}
Best Cost: $17.802617825152332;
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
{'70': 163968, '12': 4196480, '98': 133248, '43': 163968, '14': 4327560, '25': 231560, '62': 13123712, '66': 4997256, '60': 4327592, '90': 5505280, '42': 133248, '09': 139264, '48': 164064, '53': 166016, '97': 131208, '07': 137408, '36': 166016, '77': 7569548, '13': 164320, '94': 14680224, '76': 4327560, '89': 166016, '20': 2184, '80': 14915726, '85': 7348448, '49': 6488204, '93': 204800, '27': 166080, '95': 14680224, '83': 2164868, '22': 527488, '33': 4327592, '31': 4325536, '44': 133120, '63': 166016, '86': 4196480, '52': 133248, '59': 163968, '50': 229504, '75': 6490252, '92': 4196480, '03': 133248, '28': 131072, '71': 4589704, '39': 527488, '78': 6488204, '58': 4327560, '17': 231560, '51': 4325504, '72': 531916, '32': 2184, '88': 426240, '40': 526476, '56': 4327592, '05': 14909582, '96': 426240, '55': 133248, '21': 527488, '99': 540809, '82': 134272, '37': 3208, '16': 173, '65': 166016, '47': 166016, '57': 2185, '29': 231560, '67': 166016, '26': 6344, '02': 4194440}
['41']
Excluding table customer and any queries that depend on it
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
dict_keys(['70', '12', '98', '43', '14', '25', '62', '66', '60', '90', '42', '09', '48', '53', '97', '07', '36', '77', '13', '94', '76', '89', '20', '80', '85', '49', '93', '27', '95', '83', '22', '33', '31', '44', '63', '86', '52', '59', '50', '75', '92', '03', '28', '71', '39', '78', '58', '17', '51', '72', '32', '88', '40', '56', '05', '96', '55', '21', '99', '82', '37', '16', '65', '47', '57', '29', '67', '26', '02'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['70', '12', '98', '43', '14', '25', '62', '66', '60', '90', '42', '09', '48', '53', '97', '07', '36', '77', '13', '94', '76', '89', '20', '80', '85', '49', '93', '27', '95', '83', '22', '33', '31', '44', '63', '86', '52', '59', '50', '75', '92', '03', '28', '71', '39', '78', '58', '17', '51', '72', '32', '88', '40', '56', '05', '96', '55', '21', '99', '82', '37', '16', '65', '47', '57', '29', '67', '26', '02'])
Function: 17.802617825152332, 6.64697332286795, 5.9604644775390625e-05, 0.6584647845412837, 10.103631238316297, 0.33390398012007655, 0.05958489466194809
Real: 17.802617825152332, 6.64697332286795, 5.9604644775390625e-05, 0.6584647845412837, 10.103631238316297, 0.33390398012007655, 0.05958489466194809
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $6.64697332286795; Stayed Qs: $5.9604644775390625e-05; Migration Cost: $11.155584897639605
Movement Cost: $0.6584647845412837, Load Cost: $10.103631238316297, Storage Cost: $0.33390398012007655, API Cost: $0.05958489466194809
Final cost: $17.802617825152332, Baseline: $181.02735877037048, Diff: $163.22474094521814, %: 90.1657860192643%
