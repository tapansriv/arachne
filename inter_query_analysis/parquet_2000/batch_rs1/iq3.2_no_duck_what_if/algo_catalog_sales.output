Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_2000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $4.828850482972463, BigQuery Total: $121.27009630203247
01: $0.09967636585156123
03: $0.9817064178975423
06: $0.7444704184389115
07: $2.6774225909308593
08: $0.972982664633592
09: $8.502832263594867
11: $3.5903131648023923
12: $0.2538029509019852
13: $3.394577400420904
19: $1.471469503786564
21: $0.006171314786275228
22: $0.03202358495632807
24: $3.035313518322309
27: $8.012742426739534
28: $10.114393916885456
30: $0.03152027308424314
31: $3.6661184598493577
34: $1.23890101380229
36: $5.124758544688225
39: $0.012872356765667597
41: $-0.0003614868239561717
42: $0.9816911180237929
43: $1.0001751001433532
44: $1.8902832064553101
45: $0.31676777951041857
46: $2.443653135098616
47: $1.1304790044124922
48: $2.1824029066793122
50: $1.3518296918110053
51: $1.2288152922884623
52: $0.9818565818440914
53: $1.1858592124962806
55: $0.9816606972050667
59: $0.9410491335642338
61: $3.2763913384465377
62: $0.3182683006020387
63: $1.2286756509804726
65: $1.2266821705770492
67: $13.026949843046268
68: $2.9235895582393807
70: $3.8897113580667972
73: $1.2419288503889243
74: $2.380220405413707
79: $2.3912809487974642
81: $0.03853527842839559
82: $0.26085304001410803
83: $0.13029855892936387
84: $0.022277391700347263
85: $0.6295003655250867
86: $0.7619529788974921
88: $5.3449820168169335
89: $1.2267761427402497
90: $0.38121824163158735
91: $0.06426233013391494
92: $0.5006231746848424
93: $1.585086236135165
94: $0.6488971478617191
95: $0.6439432561226686
96: $0.7368130428636074
98: $0.9812976681685448
!!!!!!: 116.44160730588399
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'13': 164320, '83': 2164868, '65': 166016, '94': 14680224, '47': 166016, '51': 4325504, '34': 164240, '19': 166064, '21': 527488, '52': 133248, '24': 231472, '90': 5505280, '28': 131072, '07': 137408, '27': 166080, '81': 180, '43': 163968, '48': 164064, '50': 229504, '44': 133120, '03': 133248, '70': 163968, '22': 527488, '79': 164240, '96': 426240, '73': 164240, '11': 4325520, '84': 66416, '30': 2097328, '01': 98448, '53': 166016, '12': 4196480, '39': 527488, '31': 4325536, '95': 14680224, '09': 139264, '36': 166016, '55': 133248, '61': 170160, '74': 4325520, '93': 204800, '08': 164016, '45': 4196528, '85': 7348448, '68': 164272, '88': 426240, '89': 166016, '06': 133296, '92': 4196480, '98': 133248, '86': 4196480, '91': 501, '67': 166016, '63': 166016, '82': 134272, '62': 13123712, '42': 133248, '46': 164272, '59': 163968}
call_center: 0.0009758244524942286, 0.06328650568142072
catalog_page: 0.0008783882865374408, -0.0008783882865374408
catalog_page had no query dependencies
catalog_returns: 0.28605526437428636, -0.05295909688261194
customer: 0.00820737855345823, 26.275346560326113
customer_address: 0.005593672066861038, 26.501079054215413
customer_demographics: 0.0012320987469761641, 16.98195331338298
date_dim: 0.0010999378473217027, 84.82730753363107
household_demographics: 0.0008382176618750543, 20.18264571223209
income_band: 0.0008170080660644941, 0.021460383634282768
inventory: 0.006104606793866479, 0.3058156897285125
item: 0.0011010190598867314, 52.44075077558668
promotion: 0.001145229268709696, 5.952668700108687
reason: 0.0007875124512158195, 10.716631352803901
ship_mode: 0.0008675219900513229, 0.3174007786119874
store: 0.0009451554137721199, 70.09870538800018
store_returns: 0.4850506084771062, 5.739431154272646
store_sales: 4.668842620835432, 106.88015303467462
time_dim: 0.001437849792485606, 6.461575451519643
warehouse: 0.0009679558616065903, 0.36836760124870305
web_page: 0.0008523497781841038, 1.00986625737849
web_returns: 0.13050078400962975, 1.953658817513452
web_sales: 1.5793467062723097, 13.741094811819448
web_site: 0.0013117790801437036, 1.6097969255062825
['catalog_page', 'catalog_returns']
2
call_center: 0.0009758231829716775, -0.0009758231829716775
call_center had no query dependencies
customer: 0.008087424509367724, 26.172668905807893
customer_address: 0.0055683460472743355, 26.39830677167269
income_band: 0.0008170079373005834, 0.02146038376304668
promotion: 0.00114522405016748, 5.95266870532723
ship_mode: 0.0008675216512912008, 0.3174007789507475
store_returns: 0.47733804487137516, 5.616845158949013
web_page: 0.000852347684455643, 1.0098662594722183
web_returns: 0.12813207578395736, 1.8257289668097605
web_sales: 1.5564790096070085, 13.763962508484749
web_site: 0.00131177718199613, 1.6097969274044301
['call_center']
1
income_band: 0.0008170078626917031, 0.02146038383765556
ship_mode: 0.0008675214550055083, 0.3174007791470332
web_page: 0.0008523464712994483, 1.0098662606853746
web_returns: 0.12675958975656734, 1.8271014528371503
web_site: 0.0013117760821641648, 1.6097969285042621
[]
0
{'28': 131072, '27': 166080, '22': 527488, '39': 527488, '09': 139264, '36': 166016, '88': 426240, '67': 166016, '13': 32, '65': 0, '47': 0, '34': 16, '19': 48, '21': 0, '52': 0, '24': 65584, '07': 4096, '43': 0, '48': 32, '50': 65536, '44': 0, '03': 0, '70': 0, '79': 16, '96': 0, '73': 16, '11': 4194320, '53': 0, '31': 4194336, '55': 0, '61': 4144, '74': 4194320, '93': 65536, '08': 48, '68': 48, '89': 0, '06': 48, '98': 0, '63': 0, '82': 0, '42': 0, '46': 48, '59': 0, '94': 10485760, '51': 0, '90': 1048576, '84': 512, '01': 0, '12': 0, '95': 10485760, '45': 0, '85': 3145728, '92': 0, '86': 0, '62': 8404992}
{}
{'28': 131072, '27': 166080, '22': 527488, '39': 527488, '09': 139264, '36': 166016, '88': 426240, '67': 166016, '13': 32, '65': 0, '47': 0, '34': 16, '19': 48, '21': 0, '52': 0, '24': 65584, '07': 4096, '43': 0, '48': 32, '50': 65536, '44': 0, '03': 0, '70': 0, '79': 16, '96': 0, '73': 16, '11': 4194320, '53': 0, '31': 4194336, '55': 0, '61': 4144, '74': 4194320, '93': 65536, '08': 48, '68': 48, '89': 0, '06': 48, '98': 0, '63': 0, '82': 0, '42': 0, '46': 48, '59': 0, '94': 10485760, '51': 0, '90': 1048576, '84': 512, '01': 0, '12': 0, '95': 10485760, '45': 0, '85': 3145728, '92': 0, '86': 0, '62': 8404992}
STARTING PHASE 2: 0b0
----
[]
Function: 12.383159414869667, 4.789102530049483, 0.27248263359069824, 0.42864010311830014, 6.704939149574836, 0.14915029776130198, 0.03884470077504814
{12.383159414869667: []}
Best Cost: $12.383159414869667;
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
{'13': 164320, '65': 166016, '94': 14680224, '47': 166016, '51': 4325504, '34': 164240, '19': 166064, '21': 527488, '52': 133248, '24': 231472, '90': 5505280, '28': 131072, '07': 137408, '27': 166080, '43': 163968, '48': 164064, '50': 229504, '44': 133120, '03': 133248, '70': 163968, '22': 527488, '79': 164240, '96': 426240, '73': 164240, '11': 4325520, '84': 66416, '30': 2097328, '01': 98448, '53': 166016, '12': 4196480, '39': 527488, '31': 4325536, '95': 14680224, '09': 139264, '36': 166016, '55': 133248, '61': 170160, '74': 4325520, '93': 204800, '08': 164016, '45': 4196528, '85': 7348448, '68': 164272, '88': 426240, '89': 166016, '06': 133296, '92': 4196480, '98': 133248, '86': 4196480, '67': 166016, '63': 166016, '82': 134272, '62': 13123712, '42': 133248, '46': 164272, '59': 163968}
['83', '41', '81', '91']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 4, 5, 12, 16, 22, 9, 14, 20, 21, 23]
dict_keys(['13', '65', '94', '47', '51', '34', '19', '21', '52', '24', '90', '28', '07', '27', '43', '48', '50', '44', '03', '70', '22', '79', '96', '73', '11', '84', '30', '01', '53', '12', '39', '31', '95', '09', '36', '55', '61', '74', '93', '08', '45', '85', '68', '88', '89', '06', '92', '98', '86', '67', '63', '82', '62', '42', '46', '59'])
20
Optimal Subset: 0b111111111111111111110000
dict_keys(['13', '65', '94', '47', '51', '34', '19', '21', '52', '24', '90', '28', '07', '27', '43', '48', '50', '44', '03', '70', '22', '79', '96', '73', '11', '84', '30', '01', '53', '12', '39', '31', '95', '09', '36', '55', '61', '74', '93', '08', '45', '85', '68', '88', '89', '06', '92', '98', '86', '67', '63', '82', '62', '42', '46', '59'])
Function: 12.383159414869667, 4.789102530049483, 0.27248263359069824, 0.42864010311830014, 6.704939149574836, 0.14915029776130198, 0.03884470077504814
Real: 12.383159414869667, 4.789102530049483, 0.27248263359069824, 0.42864010311830014, 6.704939149574836, 0.14915029776130198, 0.03884470077504814
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 56; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $4.789102530049483; Stayed Qs: $0.27248263359069824; Migration Cost: $7.321574251229486
Movement Cost: $0.42864010311830014, Load Cost: $6.704939149574836, Storage Cost: $0.14915029776130198, API Cost: $0.03884470077504814
Final cost: $12.383159414869667, Baseline: $121.27009630203247, Diff: $108.8869368871628, %: 89.78877745423038%
