Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_2000/real_data_rs4
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.6193208298810315, Redshift-Calcite Total: $7.362914636219343, BigQuery Total: $119.39703941345215
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 62
-0.0889872997197651
call_center: 5.735084414482117e-06, 0.001664666947563172, 3.099180469226003
catalog_page: 0.0006659524515271187, 0.0017313863969415052, -0.0017313863969415052
catalog_page had no query dependencies
catalog_returns: 23.366260116919875, 5.864147401452858, 3.276029044264952
catalog_sales: 217.0907397372648, 55.16214888870006, -28.84400487230385
customer: 0.6484093563631177, 0.1710467218323207, 29.234024855554537
customer_address: 0.18544994108378887, 0.061446207455734266, 30.69745363950656
customer_demographics: 0.012168197892606258, 0.010121561831549884, 27.651216132819737
date_dim: 0.0019952356815338135, 0.0057986586275581295, 86.47098244891417
household_demographics: 3.512948751449585e-05, 0.0015053393580549007, 23.440766223079955
income_band: 6.137415766716003e-07, 0.0014422930701186117, 6.645524009017984
inventory: 0.24701470416039228, 0.08349434489354977, 0.8541344250763903
item: 0.005464168265461922, 0.007288623319211388, 67.61620927233008
promotion: 2.6027671992778778e-05, 0.0015151947780553674, 13.045903349582742
reason: 1.2423843145370483e-06, 0.0015800171117379119, 8.039353951737443
ship_mode: 1.5795230865478516e-06, 0.0017058449908553316, 0.4968623142428737
store: 2.3781321942806244e-05, 0.0015327234099410674, 72.8594758972798
store_returns: 36.877127600833774, 9.285278358368199, 7.643762866599438
store_sales: 288.85508783441037, 74.32231169884267, 25.13605294994771
time_dim: 0.0012104213237762451, 0.014831640716326542, 5.38323489304152
warehouse: 2.3292377591133118e-06, 0.01770648547195222, 1.7641701354326524
web_page: 1.0661780834197998e-05, 0.014097540562361139, -0.014097540562361139
web_page had no query dependencies
web_returns: 11.326140539720654, 2.8758682844276775, -2.7781383032230087
web_site: 8.863396942615509e-06, 0.01844952893526779, -0.01844952893526779
web_site had no query dependencies
-0.08897812769656754
call_center: 5.735084414482117e-06, 0.0016646667408551253, 0.04649839381142403
catalog_returns: 23.366260116919875, 5.863305217861841, -5.757343373395313
customer: 0.6484093563631177, 0.17102335139488406, 15.752175368666098
customer_address: 0.18544994108378887, 0.06143952333527364, 16.154466687227114
customer_demographics: 0.012168197892606258, 0.01012112325658983, 12.877369980346456
date_dim: 0.0019952356815338135, 0.005798586713835403, 60.05510852322703
household_demographics: 3.512948751449585e-05, 0.001505338091892588, 16.222411662510194
income_band: 6.137415766716003e-07, 0.0014422930479976955, 0.012374079934663232
inventory: 0.24701470416039228, 0.08348544181151855, 0.16303544688578775
item: 0.005464168265461922, 0.007288426375719846, 43.96097628092415
promotion: 2.6027671992778778e-05, 0.001515193839947251, 4.726604526385388
reason: 1.2423843145370483e-06, 0.0015800170669590008, 8.039353951782223
ship_mode: 1.5795230865478516e-06, 0.0017058449339250217, -0.0017058449339250217
ship_mode had no query dependencies
store: 2.3781321942806244e-05, 0.001532722552797519, 60.91957389964087
store_returns: 36.877127600833774, 9.283949206351837, -4.388228574401141
store_sales: 288.85508783441037, 74.31190057554186, 12.399785365116415
time_dim: 0.0012104213237762451, 0.014831597089448641, 5.383234936668397
warehouse: 2.3292377591133118e-06, 0.017706485388000154, 0.01907667773195173
-0.08897628412861272
call_center: 5.735084414482117e-06, 0.0016646666993070042, -0.0016646666993070042
call_center had no query dependencies
customer: 0.6484093563631177, 0.17101865395914703, 13.07186955848643
customer_address: 0.18544994108378887, 0.061438179833406915, 13.629216813978836
customer_demographics: 0.012168197892606258, 0.010121035103439239, 12.815390634964666
date_dim: 0.0019952356815338135, 0.005798572259245409, 58.724277950235724
household_demographics: 3.512948751449585e-05, 0.0015053378373951654, 16.16043222922975
income_band: 6.137415766716003e-07, 0.0014422930435514124, -0.0014422930435514124
income_band had no query dependencies
inventory: 0.24701470416039228, 0.08348365230048281, 0.1630372363968235
item: 0.005464168265461922, 0.007288386790265023, 41.555503321208654
promotion: 2.6027671992778778e-05, 0.0015151936513884104, 4.726604526573946
reason: 1.2423843145370483e-06, 0.0015800170579584822, 6.787791435103513
store: 2.3781321942806244e-05, 0.0015327223805124794, 57.28923215753283
store_sales: 288.85508783441037, 74.30980794964266, 7.675033022912842
time_dim: 0.0012104213237762451, 0.014831588320487603, 5.3832349454373585
warehouse: 2.3292377591133118e-06, 0.01770648537112587, 0.019076677748826012
-0.08897627843380393
customer: 0.6484093563631177, 0.1710186394486983, 13.071869572996878
customer_address: 0.18544994108378887, 0.061438175683309705, 13.629216818128933
customer_demographics: 0.012168197892606258, 0.010121034831132848, 12.815390635236973
date_dim: 0.0019952356815338135, 0.005798572214594966, 58.724277950280374
household_demographics: 3.512948751449585e-05, 0.001505337836609019, 16.160432229230537
inventory: 0.24701470416039228, 0.08348364677265666, 0.16303724192464966
item: 0.005464168265461922, 0.007288386667984965, 41.55550332133093
promotion: 2.6027671992778778e-05, 0.0015151936508059492, 4.726604526574529
reason: 1.2423843145370483e-06, 0.0015800170579306798, 6.78779143510354
store: 2.3781321942806244e-05, 0.0015327223799802884, 57.28923215753336
store_sales: 288.85508783441037, 74.30980148549018, 7.67503948706532
time_dim: 0.0012104213237762451, 0.014831588293400151, 5.383234945464446
warehouse: 2.3292377591133118e-06, 0.017706485371073746, 0.019076677748878137
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 112.34091191482898, 3.8781628134822843, 33.497252464294434, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
-0.08897627843380393
customer: 0.6484093563631177, 0.1710186394486983, 13.071869572996878
customer_address: 0.18544994108378887, 0.061438175683309705, 13.629216818128933
customer_demographics: 0.012168197892606258, 0.010121034831132848, 12.815390635236973
date_dim: 0.0019952356815338135, 0.005798572214594966, 58.724277950280374
household_demographics: 3.512948751449585e-05, 0.001505337836609019, 16.160432229230537
inventory: 0.24701470416039228, 0.08348364677265666, 0.16303724192464966
item: 0.005464168265461922, 0.007288386667984965, 41.55550332133093
promotion: 2.6027671992778778e-05, 0.0015151936508059492, 4.726604526574529
reason: 1.2423843145370483e-06, 0.0015800170579306798, 6.78779143510354
store: 2.3781321942806244e-05, 0.0015327223799802884, 57.28923215753336
store_sales: 288.85508783441037, 74.30980148549018, 7.67503948706532
time_dim: 0.0012104213237762451, 0.014831588293400151, 5.383234945464446
warehouse: 2.3292377591133118e-06, 0.017706485371073746, 0.019076677748878137
customer: 0.6484093563631177, 0.17101852548169777, 13.071869686963879
customer_address: 0.18544994108378887, 0.06143814308789242, 13.629216850724351
customer_demographics: 0.012168197892606258, 0.010121032692402119, 12.815390637375705
date_dim: 0.0019952356815338135, 0.005798571863904429, 58.68749478751111
household_demographics: 3.512948751449585e-05, 0.0015053378304345209, 16.16043222923671
inventory: 0.24701470416039228, 0.08348360335637241, 0.12625412222098203
item: 0.005464168265461922, 0.007288385707581075, 41.51872015917138
promotion: 2.6027671992778778e-05, 0.0015151936462312224, 4.726604526579104
reason: 1.2423843145370483e-06, 0.0015800170577123132, 6.787791435103759
store: 2.3781321942806244e-05, 0.0015327223758003889, 57.28923215753754
store_sales: 288.85508783441037, 74.30975071517413, 7.67509025738137
time_dim: 0.0012104213237762451, 0.014831588080651699, 5.383234945677194
Function: 112.35993762637322, 3.871625320779482, 33.54057312011719, 69.86752799873295, 5.036305132295291, 0.01873377949443789, 0.025172274953860048
hiya: 0b1101011110111110000, 112.35993762637322
customer: 0.6484093563631177, 0.17101852548169777, 13.071869686963879
customer_address: 0.18544994108378887, 0.06143814308789242, 13.629216850724351
customer_demographics: 0.012168197892606258, 0.010121032692402119, 12.815390637375705
date_dim: 0.0019952356815338135, 0.005798571863904429, 58.68749478751111
household_demographics: 3.512948751449585e-05, 0.0015053378304345209, 16.16043222923671
inventory: 0.24701470416039228, 0.08348360335637241, 0.12625412222098203
item: 0.005464168265461922, 0.007288385707581075, 41.51872015917138
promotion: 2.6027671992778778e-05, 0.0015151936462312224, 4.726604526579104
reason: 1.2423843145370483e-06, 0.0015800170577123132, 6.787791435103759
store: 2.3781321942806244e-05, 0.0015327223758003889, 57.28923215753754
store_sales: 288.85508783441037, 74.30975071517413, 7.67509025738137
time_dim: 0.0012104213237762451, 0.014831588080651699, 5.383234945677194
customer: 0.6484093563631177, 0.17101839364416777, 13.071869818801408
customer_address: 0.18544994108378887, 0.06143810538136964, 13.629216888430873
customer_demographics: 0.012168197892606258, 0.010121030218308956, 12.815390639849797
date_dim: 0.0019952356815338135, 0.005798571458224064, 58.47775706233944
household_demographics: 3.512948751449585e-05, 0.0015053378232918343, 16.160432229243852
item: 0.005464168265461922, 0.007288384596581611, 41.30898243470502
promotion: 2.6027671992778778e-05, 0.001515193640939158, 4.726604526584396
reason: 1.2423843145370483e-06, 0.0015800170574597062, 6.787791435104011
store: 2.3781321942806244e-05, 0.0015327223709650627, 57.28923215754237
store_sales: 288.85508783441037, 74.30969198384811, 7.4654112631300364
time_dim: 0.0012104213237762451, 0.014831587834543348, 5.383234945923302
Function: 112.48589612104486, 3.8677447678534187, 33.754191398620605, 69.80800774730962, 5.012152359342576, 0.018658915035225647, 0.02514093288342059
hiya: 0b1101011100111110000, 112.48589612104486
customer: 0.6484093563631177, 0.17101839364416777, 13.071869818801408
customer_address: 0.18544994108378887, 0.06143810538136964, 13.629216888430873
customer_demographics: 0.012168197892606258, 0.010121030218308956, 12.815390639849797
date_dim: 0.0019952356815338135, 0.005798571458224064, 58.47775706233944
household_demographics: 3.512948751449585e-05, 0.0015053378232918343, 16.160432229243852
item: 0.005464168265461922, 0.007288384596581611, 41.30898243470502
promotion: 2.6027671992778778e-05, 0.001515193640939158, 4.726604526584396
reason: 1.2423843145370483e-06, 0.0015800170574597062, 6.787791435104011
store: 2.3781321942806244e-05, 0.0015327223709650627, 57.28923215754237
store_sales: 288.85508783441037, 74.30969198384811, 7.4654112631300364
time_dim: 0.0012104213237762451, 0.014831587834543348, 5.383234945923302
customer: 0.6484093563631177, 0.17101789034003642, 10.457311094839227
customer_address: 0.18544994108378887, 0.06143796143261167, 11.01465780511332
customer_demographics: 0.012168197892606258, 0.010121020773188816, 10.701830156335893
date_dim: 0.0019952356815338135, 0.005798569909495083, 53.74963734366283
household_demographics: 3.512948751449585e-05, 0.00150533779602385, 16.160432229271123
item: 0.005464168265461922, 0.007288380355220139, 36.58086271872105
reason: 1.2423843145370483e-06, 0.0015800170564953505, 6.7877914351049755
store: 2.3781321942806244e-05, 0.0015327223525056781, 54.67467293029452
store_sales: 288.85508783441037, 74.30946777061362, 2.7375157561391887
time_dim: 0.0012104213237762451, 0.01483158689499791, 5.383234946862848
Function: 117.21227574597727, 3.7622234358326594, 38.5878324508667, 69.80800147572516, 5.010653416268031, 0.018434036650077087, 0.02513093063462973
hiya: 0b1101010100111110000, 117.21227574597727
customer: 0.6484093563631177, 0.17101789034003642, 10.457311094839227
customer_address: 0.18544994108378887, 0.06143796143261167, 11.01465780511332
customer_demographics: 0.012168197892606258, 0.010121020773188816, 10.701830156335893
date_dim: 0.0019952356815338135, 0.005798569909495083, 53.74963734366283
household_demographics: 3.512948751449585e-05, 0.00150533779602385, 16.160432229271123
item: 0.005464168265461922, 0.007288380355220139, 36.58086271872105
reason: 1.2423843145370483e-06, 0.0015800170564953505, 6.7877914351049755
store: 2.3781321942806244e-05, 0.0015327223525056781, 54.67467293029452
store_sales: 288.85508783441037, 74.30946777061362, 2.7375157561391887
time_dim: 0.0012104213237762451, 0.01483158689499791, 5.383234946862848
customer: 0.6484093563631177, 0.170976960544654, -0.170976960544654
customer had no query dependencies
customer_address: 0.18544994108378887, 0.06142625520402667, -0.06142625520402667
customer_address had no query dependencies
customer_demographics: 0.012168197892606258, 0.010120252675312021, -0.010120252675312021
customer_demographics had no query dependencies
date_dim: 0.0019952356815338135, 0.005798443963459013, -0.005798443963459013
date_dim had no query dependencies
household_demographics: 3.512948751449585e-05, 0.0015053355785315794, -0.0015053355785315794
household_demographics had no query dependencies
item: 0.005464168265461922, 0.007288035438406638, -0.007288035438406638
item had no query dependencies
reason: 1.2423843145370483e-06, 0.0015800169780718432, -0.0015800169780718432
reason had no query dependencies
store: 2.3781321942806244e-05, 0.001532720851348066, -0.001532720851348066
store had no query dependencies
time_dim: 0.0012104213237762451, 0.014831510489103049, -0.014831510489103049
time_dim had no query dependencies
Function: 119.39703941345215, 0, 119.39703941345215, 0.0, 0, 0.0, 0
hiya: 0b0, 119.39703941345215
{112.34091191482898: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 112.35993762637322: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18], 112.48589612104486: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 117.21227574597727: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 119.39703941345215: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'65': 166016, '09': 139264, '48': 164064, '34': 164240, '21': 527488, '36': 166016, '68': 164272, '39': 527488, '08': 164016, '03': 133248, '53': 166016, '63': 166016, '89': 166016, '46': 164272, '28': 131072, '82': 134272, '13': 164320, '96': 426240, '98': 133248, '59': 163968, '47': 166016, '22': 527488, '67': 166016, '42': 133248, '73': 164240, '44': 133120, '61': 170160, '07': 137408, '52': 133248, '70': 163968, '06': 133296, '43': 163968, '19': 166064, '27': 166080, '55': 133248, '79': 164240, '88': 426240}
Best Cost: $112.34091191482898;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'65': 166016, '09': 139264, '48': 164064, '34': 164240, '21': 527488, '36': 166016, '68': 164272, '39': 527488, '08': 164016, '03': 133248, '53': 166016, '63': 166016, '89': 166016, '46': 164272, '28': 131072, '82': 134272, '13': 164320, '96': 426240, '98': 133248, '59': 163968, '47': 166016, '22': 527488, '67': 166016, '42': 133248, '73': 164240, '44': 133120, '61': 170160, '07': 137408, '52': 133248, '70': 163968, '06': 133296, '43': 163968, '19': 166064, '27': 166080, '55': 133248, '79': 164240, '88': 426240}
{'65': 166016, '09': 139264, '48': 164064, '34': 164240, '21': 527488, '36': 166016, '68': 164272, '39': 527488, '08': 164016, '03': 133248, '53': 166016, '63': 166016, '89': 166016, '46': 164272, '28': 131072, '82': 134272, '13': 164320, '96': 426240, '98': 133248, '59': 163968, '47': 166016, '22': 527488, '67': 166016, '42': 133248, '73': 164240, '44': 133120, '61': 170160, '07': 137408, '52': 133248, '70': 163968, '06': 133296, '43': 163968, '19': 166064, '27': 166080, '55': 133248, '79': 164240, '88': 426240}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 112.34091191482898, 3.8781628134822843, 33.497252464294434, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
112.34091191482898
Real: 112.34091191482898, 3.8781628134822843, 33.497252464294434, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
Num Redshift Qs: 37; Num GCP Qs: 26
Redshift Qs: $3.8781628134822843; GCP Qs: $33.497252464294434; Movement Cost: $69.86752855998219
Load Cost: $5.054001058297158, Storage Cost: $0.018784743617810518, API Cost: $0.02518227515510619
Final cost: $112.34091191482898, BQ Baseline: $119.39703941345215, Diff: $7.0561274986231695, %: 5.909801058122531%
