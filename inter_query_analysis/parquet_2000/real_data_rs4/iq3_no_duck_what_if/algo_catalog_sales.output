Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_2000/real_data_rs4
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $6.455748886092502, Redshift-Calcite Total: $5.79505153778394, BigQuery Total: $104.23612117767334
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
-0.08898381069267221
call_center: 5.735084414482117e-06, 0.0016646668689316683, 0.04649839368334749
catalog_page: 0.0006659524515271187, 0.001731377266327409, -0.001731377266327409
catalog_page had no query dependencies
catalog_returns: 23.366260116919875, 5.863827035781844, -5.66444659679443
customer: 0.6484093563631177, 0.1710378317447541, 20.270829784428674
customer_address: 0.18544994108378887, 0.061443664823985854, 20.758750791926566
customer_demographics: 0.012168197892606258, 0.010121394998138657, 13.34091647967348
date_dim: 0.0019952356815338135, 0.005798631271660577, 71.45354760591732
household_demographics: 3.512948751449585e-05, 0.0015053388764082107, 16.530042434783613
income_band: 6.137415766716003e-07, 0.0014422930617038407, 0.012374079920957086
inventory: 0.24701470416039228, 0.08349095817136776, 0.16302993052593853
item: 0.005464168265461922, 0.007288548402133339, 45.47395670733519
promotion: 2.6027671992778778e-05, 0.0015151944212001172, 4.7266045258041345
reason: 1.2423843145370483e-06, 0.0015800170947040657, 8.50290072282305
ship_mode: 1.5795230865478516e-06, 0.001705844969199107, 0.24900562034820914
store: 2.3781321942806244e-05, 0.0015327230838846457, 60.91957389910978
store_returns: 36.877127600833774, 9.284772750467328, -4.295633523995744
store_sales: 288.85508783441037, 74.31835131949326, 20.53871008148134
time_dim: 0.0012104213237762451, 0.014831624120712282, 5.690865682695071
warehouse: 2.3292377591133118e-06, 0.01770648544001695, 0.26978814299734316
web_page: 1.0661780834197998e-05, 0.014097540416181624, 0.757080003710329
web_returns: 11.326140539720654, 2.8757129961361043, -1.2929227484382741
web_sales: 109.34904180746526, 27.84245381769532, -16.23411389859392
web_site: 8.863396942615509e-06, 0.018449528813745213, 1.2537754319282515
-0.08897634728472573
call_center: 5.735084414482117e-06, 0.001664666700730341, -0.001664666700730341
call_center had no query dependencies
customer: 0.6484093563631177, 0.17101881488176537, 13.071869397563809
customer_address: 0.18544994108378887, 0.06143822585848319, 13.629216767953759
customer_demographics: 0.012168197892606258, 0.010121038123349803, 12.815390631944757
date_dim: 0.0019952356815338135, 0.005798572754424183, 58.72427794974054
household_demographics: 3.512948751449585e-05, 0.0015053378461136223, 16.16043222922103
income_band: 6.137415766716003e-07, 0.001442293043703731, -0.001442293043703731
income_band had no query dependencies
inventory: 0.24701470416039228, 0.08348371360473848, 0.16303717509256782
item: 0.005464168265461922, 0.007288388146365541, 41.55550331985256
promotion: 2.6027671992778778e-05, 0.0015151936578479733, 4.7266045265674865
reason: 1.2423843145370483e-06, 0.001580017058266818, 6.7877914351032045
ship_mode: 1.5795230865478516e-06, 0.0017058449228740905, -0.0017058449228740905
ship_mode had no query dependencies
store: 2.3781321942806244e-05, 0.0015327223864145419, 57.289232157526925
store_sales: 288.85508783441037, 74.30987963786954, 7.674961334685946
time_dim: 0.0012104213237762451, 0.014831588620890684, 5.383234945136955
warehouse: 2.3292377591133118e-06, 0.01770648537170394, 0.019076677748247943
web_page: 1.0661780834197998e-05, 0.014097540103487762, -0.014097540103487762
web_page had no query dependencies
web_site: 8.863396942615509e-06, 0.018449528553795225, -0.018449528553795225
web_site had no query dependencies
-0.08897627843380393
customer: 0.6484093563631177, 0.1710186394486983, 13.071869572996876
customer_address: 0.18544994108378887, 0.061438175683309705, 13.629216818128931
customer_demographics: 0.012168197892606258, 0.010121034831132848, 12.815390635236973
date_dim: 0.0019952356815338135, 0.005798572214594966, 58.72427795028037
household_demographics: 3.512948751449585e-05, 0.001505337836609019, 16.160432229230537
inventory: 0.24701470416039228, 0.08348364677265666, 0.16303724192464963
item: 0.005464168265461922, 0.007288386667984965, 41.55550332133094
promotion: 2.6027671992778778e-05, 0.0015151936508059492, 4.726604526574529
reason: 1.2423843145370483e-06, 0.0015800170579306798, 6.78779143510354
store: 2.3781321942806244e-05, 0.0015327223799802884, 57.28923215753336
store_sales: 288.85508783441037, 74.30980148549018, 7.675039487065305
time_dim: 0.0012104213237762451, 0.014831588293400151, 5.383234945464446
warehouse: 2.3292377591133118e-06, 0.017706485371073746, 0.019076677748878137
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 97.17999367905017, 3.8781628134822856, 18.336334228515625, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
-0.08897627843380393
customer: 0.6484093563631177, 0.1710186394486983, 13.071869572996876
customer_address: 0.18544994108378887, 0.061438175683309705, 13.629216818128931
customer_demographics: 0.012168197892606258, 0.010121034831132848, 12.815390635236973
date_dim: 0.0019952356815338135, 0.005798572214594966, 58.72427795028037
household_demographics: 3.512948751449585e-05, 0.001505337836609019, 16.160432229230537
inventory: 0.24701470416039228, 0.08348364677265666, 0.16303724192464963
item: 0.005464168265461922, 0.007288386667984965, 41.55550332133094
promotion: 2.6027671992778778e-05, 0.0015151936508059492, 4.726604526574529
reason: 1.2423843145370483e-06, 0.0015800170579306798, 6.78779143510354
store: 2.3781321942806244e-05, 0.0015327223799802884, 57.28923215753336
store_sales: 288.85508783441037, 74.30980148549018, 7.675039487065305
time_dim: 0.0012104213237762451, 0.014831588293400151, 5.383234945464446
warehouse: 2.3292377591133118e-06, 0.017706485371073746, 0.019076677748878137
customer: 0.6484093563631177, 0.17101852548169777, 13.071869686963877
customer_address: 0.18544994108378887, 0.06143814308789242, 13.62921685072435
customer_demographics: 0.012168197892606258, 0.010121032692402119, 12.815390637375705
date_dim: 0.0019952356815338135, 0.005798571863904429, 58.6874947875111
household_demographics: 3.512948751449585e-05, 0.0015053378304345209, 16.16043222923671
inventory: 0.24701470416039228, 0.08348360335637241, 0.12625412222098203
item: 0.005464168265461922, 0.007288385707581075, 41.51872015917139
promotion: 2.6027671992778778e-05, 0.0015151936462312224, 4.726604526579104
reason: 1.2423843145370483e-06, 0.0015800170577123132, 6.787791435103759
store: 2.3781321942806244e-05, 0.0015327223758003889, 57.28923215753754
store_sales: 288.85508783441037, 74.30975071517413, 7.675090257381356
time_dim: 0.0012104213237762451, 0.014831588080651699, 5.383234945677194
Function: 97.19901939059442, 3.871625320779483, 18.37965488433838, 69.86752799873295, 5.036305132295291, 0.01873377949443789, 0.025172274953860048
hiya: 0b1101011110111110000, 97.19901939059442
customer: 0.6484093563631177, 0.17101852548169777, 13.071869686963877
customer_address: 0.18544994108378887, 0.06143814308789242, 13.62921685072435
customer_demographics: 0.012168197892606258, 0.010121032692402119, 12.815390637375705
date_dim: 0.0019952356815338135, 0.005798571863904429, 58.6874947875111
household_demographics: 3.512948751449585e-05, 0.0015053378304345209, 16.16043222923671
inventory: 0.24701470416039228, 0.08348360335637241, 0.12625412222098203
item: 0.005464168265461922, 0.007288385707581075, 41.51872015917139
promotion: 2.6027671992778778e-05, 0.0015151936462312224, 4.726604526579104
reason: 1.2423843145370483e-06, 0.0015800170577123132, 6.787791435103759
store: 2.3781321942806244e-05, 0.0015327223758003889, 57.28923215753754
store_sales: 288.85508783441037, 74.30975071517413, 7.675090257381356
time_dim: 0.0012104213237762451, 0.014831588080651699, 5.383234945677194
customer: 0.6484093563631177, 0.17101839364416777, 13.071869818801407
customer_address: 0.18544994108378887, 0.06143810538136964, 13.629216888430872
customer_demographics: 0.012168197892606258, 0.010121030218308956, 12.815390639849797
date_dim: 0.0019952356815338135, 0.005798571458224064, 58.47775706233943
household_demographics: 3.512948751449585e-05, 0.0015053378232918343, 16.160432229243852
item: 0.005464168265461922, 0.007288384596581611, 41.30898243470503
promotion: 2.6027671992778778e-05, 0.001515193640939158, 4.726604526584396
reason: 1.2423843145370483e-06, 0.0015800170574597062, 6.787791435104011
store: 2.3781321942806244e-05, 0.0015327223709650627, 57.28923215754237
store_sales: 288.85508783441037, 74.30969198384811, 7.465411263130022
time_dim: 0.0012104213237762451, 0.014831587834543348, 5.383234945923302
Function: 97.32497788526607, 3.867744767853419, 18.593273162841797, 69.80800774730962, 5.012152359342576, 0.018658915035225647, 0.02514093288342059
hiya: 0b1101011100111110000, 97.32497788526607
customer: 0.6484093563631177, 0.17101839364416777, 13.071869818801407
customer_address: 0.18544994108378887, 0.06143810538136964, 13.629216888430872
customer_demographics: 0.012168197892606258, 0.010121030218308956, 12.815390639849797
date_dim: 0.0019952356815338135, 0.005798571458224064, 58.47775706233943
household_demographics: 3.512948751449585e-05, 0.0015053378232918343, 16.160432229243852
item: 0.005464168265461922, 0.007288384596581611, 41.30898243470503
promotion: 2.6027671992778778e-05, 0.001515193640939158, 4.726604526584396
reason: 1.2423843145370483e-06, 0.0015800170574597062, 6.787791435104011
store: 2.3781321942806244e-05, 0.0015327223709650627, 57.28923215754237
store_sales: 288.85508783441037, 74.30969198384811, 7.465411263130022
time_dim: 0.0012104213237762451, 0.014831587834543348, 5.383234945923302
customer: 0.6484093563631177, 0.17101789034003642, 10.457311094839229
customer_address: 0.18544994108378887, 0.06143796143261167, 11.014657805113321
customer_demographics: 0.012168197892606258, 0.010121020773188816, 10.701830156335893
date_dim: 0.0019952356815338135, 0.005798569909495083, 53.74963734366282
household_demographics: 3.512948751449585e-05, 0.00150533779602385, 16.160432229271123
item: 0.005464168265461922, 0.007288380355220139, 36.58086271872106
reason: 1.2423843145370483e-06, 0.0015800170564953505, 6.7877914351049755
store: 2.3781321942806244e-05, 0.0015327223525056781, 54.67467293029452
store_sales: 288.85508783441037, 74.30946777061362, 2.7375157561391745
time_dim: 0.0012104213237762451, 0.01483158689499791, 5.383234946862848
Function: 102.05135751019846, 3.76222343583266, 23.42691421508789, 69.80800147572516, 5.010653416268031, 0.018434036650077087, 0.02513093063462973
hiya: 0b1101010100111110000, 102.05135751019846
customer: 0.6484093563631177, 0.17101789034003642, 10.457311094839229
customer_address: 0.18544994108378887, 0.06143796143261167, 11.014657805113321
customer_demographics: 0.012168197892606258, 0.010121020773188816, 10.701830156335893
date_dim: 0.0019952356815338135, 0.005798569909495083, 53.74963734366282
household_demographics: 3.512948751449585e-05, 0.00150533779602385, 16.160432229271123
item: 0.005464168265461922, 0.007288380355220139, 36.58086271872106
reason: 1.2423843145370483e-06, 0.0015800170564953505, 6.7877914351049755
store: 2.3781321942806244e-05, 0.0015327223525056781, 54.67467293029452
store_sales: 288.85508783441037, 74.30946777061362, 2.7375157561391745
time_dim: 0.0012104213237762451, 0.01483158689499791, 5.383234946862848
customer: 0.6484093563631177, 0.170976960544654, -0.170976960544654
customer had no query dependencies
customer_address: 0.18544994108378887, 0.06142625520402667, -0.06142625520402667
customer_address had no query dependencies
customer_demographics: 0.012168197892606258, 0.010120252675312021, -0.010120252675312021
customer_demographics had no query dependencies
date_dim: 0.0019952356815338135, 0.005798443963459013, -0.005798443963459013
date_dim had no query dependencies
household_demographics: 3.512948751449585e-05, 0.0015053355785315794, -0.0015053355785315794
household_demographics had no query dependencies
item: 0.005464168265461922, 0.007288035438406638, -0.007288035438406638
item had no query dependencies
reason: 1.2423843145370483e-06, 0.0015800169780718432, -0.0015800169780718432
reason had no query dependencies
store: 2.3781321942806244e-05, 0.001532720851348066, -0.001532720851348066
store had no query dependencies
time_dim: 0.0012104213237762451, 0.014831510489103049, -0.014831510489103049
time_dim had no query dependencies
Function: 104.23612117767334, 0, 104.23612117767334, 0.0, 0, 0.0, 0
hiya: 0b0, 104.23612117767334
{97.17999367905017: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 97.19901939059442: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18], 97.32497788526607: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 102.05135751019846: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 104.23612117767334: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'07': 137408, '46': 164272, '98': 133248, '03': 133248, '79': 164240, '89': 166016, '59': 163968, '36': 166016, '42': 133248, '21': 527488, '22': 527488, '13': 164320, '53': 166016, '44': 133120, '88': 426240, '09': 139264, '96': 426240, '61': 170160, '19': 166064, '43': 163968, '73': 164240, '67': 166016, '48': 164064, '55': 133248, '47': 166016, '82': 134272, '06': 133296, '68': 164272, '63': 166016, '28': 131072, '39': 527488, '70': 163968, '34': 164240, '27': 166080, '08': 164016, '65': 166016, '52': 133248}
Best Cost: $97.17999367905017;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'07': 137408, '46': 164272, '98': 133248, '03': 133248, '79': 164240, '89': 166016, '59': 163968, '36': 166016, '42': 133248, '21': 527488, '22': 527488, '13': 164320, '53': 166016, '44': 133120, '88': 426240, '09': 139264, '96': 426240, '61': 170160, '19': 166064, '43': 163968, '73': 164240, '67': 166016, '48': 164064, '55': 133248, '47': 166016, '82': 134272, '06': 133296, '68': 164272, '63': 166016, '28': 131072, '39': 527488, '70': 163968, '34': 164240, '27': 166080, '08': 164016, '65': 166016, '52': 133248}
{'07': 137408, '46': 164272, '98': 133248, '03': 133248, '79': 164240, '89': 166016, '59': 163968, '36': 166016, '42': 133248, '21': 527488, '22': 527488, '13': 164320, '53': 166016, '44': 133120, '88': 426240, '09': 139264, '96': 426240, '61': 170160, '19': 166064, '43': 163968, '73': 164240, '67': 166016, '48': 164064, '55': 133248, '47': 166016, '82': 134272, '06': 133296, '68': 164272, '63': 166016, '28': 131072, '39': 527488, '70': 163968, '34': 164240, '27': 166080, '08': 164016, '65': 166016, '52': 133248}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 97.17999367905017, 3.8781628134822856, 18.336334228515625, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
97.17999367905017
Real: 97.17999367905017, 3.8781628134822856, 18.336334228515625, 69.86752855998219, 5.054001058297158, 0.018784743617810518, 0.02518227515510619
Num Redshift Qs: 37; Num GCP Qs: 23
Redshift Qs: $3.8781628134822856; GCP Qs: $18.336334228515625; Movement Cost: $69.86752855998219
Load Cost: $5.054001058297158, Storage Cost: $0.018784743617810518, API Cost: $0.02518227515510619
Final cost: $97.17999367905017, BQ Baseline: $104.23612117767334, Diff: $7.0561274986231695, %: 6.769368831938601%
