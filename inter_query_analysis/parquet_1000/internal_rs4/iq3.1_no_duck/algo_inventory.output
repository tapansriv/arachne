Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/internal_rs4
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: inventory
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $8.860194764690403, Redshift-Calcite Total: $7.9914974343967415, BigQuery Total: $43.536720275878906
!!!!!!: 36.19630311275166
Excluding table inventory and any queries that depend on it
Total Keys: 93, Keys Considered: 88
call_center: 9.615905582904816e-06, 0.0012366220538691235, 0.7070551468864207
catalog_page: 0.0017016949132084846, 0.004872640250290503, 1.8344491470657138
catalog_returns: 13.009788101539016, 1.701833603278327, 5.321456611635359
catalog_sales: 132.3057429259643, 17.496909723758176, 1.535395048796854
customer: 0.8535048151388764, 0.11669726661444697, 9.981745998324541
customer_address: 0.2449320713058114, 0.049770217095445206, 11.245585888221033
customer_demographics: 0.011580578982830048, 0.005958853060645739, 5.788483124979096
date_dim: 0.001992875710129738, 0.0019425767832639755, 33.83046061802412
household_demographics: 3.5176053643226624e-05, 0.0012819901935635658, 6.095575539863073
income_band: 5.122274160385132e-07, 0.0011215779167272428, 1.162288235692396
item: 0.03489831369370222, 0.008295701950380055, 19.291509624233257
promotion: 7.638614624738693e-05, 0.0048925859470369355, 3.96108826869297
reason: 1.4491379261016846e-06, 0.0013672037745610696, 0.8693249298285349
ship_mode: 1.3029202818870544e-06, 0.00132988322715814, 0.9034928530138646
store: 9.930133819580078e-05, 0.001420039532136136, 18.102185170872254
store_returns: 20.850121902301908, 2.839456238833012, 7.679995448588787
store_sales: 174.69669486396015, 23.527210845946964, 9.076372332962666
time_dim: 0.0012146271765232086, 0.0017928815995379075, 1.8300007643434681
warehouse: 2.907589077949524e-06, 0.0014493306291724663, 1.1175719215086475
web_page: 7.394980639219284e-05, 0.0014304082584505938, 0.9097149538898343
web_returns: 6.285572262480855, 0.814533173466995, 4.979788969407405
web_sales: 67.01082486007363, 8.830231099774947, 6.115272427956947
web_site: 1.0454095900058746e-05, 0.0017744646990215333, 2.2850099599047584
{}
{}
STARTING PHASE 2: 0b111111111111101111111111
----
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Function: 63.15523043601367, 6.749477641337711, 0.5909395217895508, 50.235070058057666, 5.506712213686308, 0.036918313828484574, 0.03611268731394709
call_center: 9.615905582904816e-06, 0.0012366220538691235, 0.7070551468864207
catalog_page: 0.0017016949132084846, 0.004872640250290503, 1.8344491470657138
catalog_returns: 13.009788101539016, 1.701833603278327, 5.321456611635359
catalog_sales: 132.3057429259643, 17.496909723758176, 1.535395048796854
customer: 0.8535048151388764, 0.11669726661444697, 9.981745998324541
customer_address: 0.2449320713058114, 0.049770217095445206, 11.245585888221033
customer_demographics: 0.011580578982830048, 0.005958853060645739, 5.788483124979096
date_dim: 0.001992875710129738, 0.0019425767832639755, 33.83046061802412
household_demographics: 3.5176053643226624e-05, 0.0012819901935635658, 6.095575539863073
income_band: 5.122274160385132e-07, 0.0011215779167272428, 1.162288235692396
item: 0.03489831369370222, 0.008295701950380055, 19.291509624233257
promotion: 7.638614624738693e-05, 0.0048925859470369355, 3.96108826869297
reason: 1.4491379261016846e-06, 0.0013672037745610696, 0.8693249298285349
ship_mode: 1.3029202818870544e-06, 0.00132988322715814, 0.9034928530138646
store: 9.930133819580078e-05, 0.001420039532136136, 18.102185170872254
store_returns: 20.850121902301908, 2.839456238833012, 7.679995448588787
store_sales: 174.69669486396015, 23.527210845946964, 9.076372332962666
time_dim: 0.0012146271765232086, 0.0017928815995379075, 1.8300007643434681
warehouse: 2.907589077949524e-06, 0.0014493306291724663, 1.1175719215086475
web_page: 7.394980639219284e-05, 0.0014304082584505938, 0.9097149538898343
web_returns: 6.285572262480855, 0.814533173466995, 4.979788969407405
web_sales: 67.01082486007363, 8.830231099774947, 6.115272427956947
web_site: 1.0454095900058746e-05, 0.0017744646990215333, 2.2850099599047584
catalog_page: 0.0017016949132084846, 0.004872638320716974, 1.8344491489952874
catalog_returns: 13.009788101539016, 1.70181885131395, 4.998064484686492
catalog_sales: 132.3057429259643, 17.496759700591674, 0.8453744702123451
customer: 0.8535048151388764, 0.11669629881446975, 9.963625798935238
customer_address: 0.2449320713058114, 0.04976993936385093, 10.922179287039384
customer_demographics: 0.011580578982830048, 0.00595883992927978, 5.770361970921182
date_dim: 0.001992875710129738, 0.0019425745235168333, 33.122168851343574
household_demographics: 3.5176053643226624e-05, 0.0012819901536769908, 6.077454372713679
income_band: 5.122274160385132e-07, 0.0011215779161464217, 1.162288235692977
item: 0.03489831369370222, 0.00829566237873781, 19.157061925221015
promotion: 7.638614624738693e-05, 0.004892585860421711, 3.961088268779585
reason: 1.4491379261016846e-06, 0.0013672037729178736, 0.8693249298301782
ship_mode: 1.3029202818870544e-06, 0.0013298832256807421, 0.6530557015721785
store: 9.930133819580078e-05, 0.0014200394195370844, 18.102185170984853
store_returns: 20.850121902301908, 2.8394325966143104, 7.680019090807489
store_sales: 174.69669486396015, 23.527012755140312, 9.076570423769319
time_dim: 0.0012146271765232086, 0.0017928802222566865, 1.8300007657207493
warehouse: 2.907589077949524e-06, 0.001449330625875514, 0.8671347700687809
web_page: 7.394980639219284e-05, 0.0014304081745979667, 0.909714953973687
web_returns: 6.285572262480855, 0.8145260461765749, 4.979796096697825
web_sales: 67.01082486007363, 8.830155115347416, 6.115348412384478
web_site: 1.0454095900058746e-05, 0.001774464687167501, 2.2850099599166125
Function: 63.861814649667664, 6.594365136291184, 1.4543437957763672, 50.235068894933754, 5.5054867472267155, 0.036447388956521096, 0.03610268648313284
hiya: 0b111111111111101111111110, 63.861814649667664
catalog_page: 0.0017016949132084846, 0.004872638320716974, 1.8344491489952874
catalog_returns: 13.009788101539016, 1.70181885131395, 4.998064484686492
catalog_sales: 132.3057429259643, 17.496759700591674, 0.8453744702123451
customer: 0.8535048151388764, 0.11669629881446975, 9.963625798935238
customer_address: 0.2449320713058114, 0.04976993936385093, 10.922179287039384
customer_demographics: 0.011580578982830048, 0.00595883992927978, 5.770361970921182
date_dim: 0.001992875710129738, 0.0019425745235168333, 33.122168851343574
household_demographics: 3.5176053643226624e-05, 0.0012819901536769908, 6.077454372713679
income_band: 5.122274160385132e-07, 0.0011215779161464217, 1.162288235692977
item: 0.03489831369370222, 0.00829566237873781, 19.157061925221015
promotion: 7.638614624738693e-05, 0.004892585860421711, 3.961088268779585
reason: 1.4491379261016846e-06, 0.0013672037729178736, 0.8693249298301782
ship_mode: 1.3029202818870544e-06, 0.0013298832256807421, 0.6530557015721785
store: 9.930133819580078e-05, 0.0014200394195370844, 18.102185170984853
store_returns: 20.850121902301908, 2.8394325966143104, 7.680019090807489
store_sales: 174.69669486396015, 23.527012755140312, 9.076570423769319
time_dim: 0.0012146271765232086, 0.0017928802222566865, 1.8300007657207493
warehouse: 2.907589077949524e-06, 0.001449330625875514, 0.8671347700687809
web_page: 7.394980639219284e-05, 0.0014304081745979667, 0.909714953973687
web_returns: 6.285572262480855, 0.8145260461765749, 4.979796096697825
web_sales: 67.01082486007363, 8.830155115347416, 6.115348412384478
web_site: 1.0454095900058746e-05, 0.001774464687167501, 2.2850099599166125
catalog_page: 0.0017016949132084846, 0.004872637998900406, 1.834449149317104
catalog_returns: 13.009788101539016, 1.7018163909637893, 4.998066945036653
catalog_sales: 132.3057429259643, 17.49673467954957, 0.3170338863356541
customer: 0.8535048151388764, 0.11669613740363871, 9.96362596034607
customer_address: 0.2449320713058114, 0.049769893043445375, 10.92217933335979
customer_demographics: 0.011580578982830048, 0.00595883773921495, 5.770361973111247
date_dim: 0.001992875710129738, 0.0019425741466335177, 32.467783266922595
household_demographics: 3.5176053643226624e-05, 0.0012819901470246602, 6.077454372720331
income_band: 5.122274160385132e-07, 0.0011215779160495514, 1.1622882356930737
item: 0.03489831369370222, 0.008295655778932263, 19.15706193182082
promotion: 7.638614624738693e-05, 0.004892585845975921, 3.9610882687940308
reason: 1.4491379261016846e-06, 0.0013672037726438194, 0.8693249298304523
store: 9.930133819580078e-05, 0.0014200394007576806, 18.102185171003633
store_returns: 20.850121902301908, 2.8394286535369617, 7.680023033884838
store_sales: 174.69669486396015, 23.526979717320025, 9.076603461589606
time_dim: 0.0012146271765232086, 0.0017928799925520868, 1.301635161031656
warehouse: 2.907589077949524e-06, 0.0014493306253256443, 0.21274918527147152
web_page: 7.394980639219284e-05, 0.0014304081606129257, 0.909714953987672
web_returns: 6.285572262480855, 0.8145248574786034, 4.979797285395797
web_sales: 67.01082486007363, 8.830142442574237, 5.460975500359796
web_site: 1.0454095900058746e-05, 0.0017744646851904713, 2.1589899800395282
Function: 64.51479180872388, 6.56961063014666, 2.13348388671875, 50.235068737334686, 5.504167020578385, 0.036368847574853314, 0.03609268637056053
hiya: 0b111111111011101111111110, 64.51479180872388
catalog_page: 0.0017016949132084846, 0.004872637998900406, 1.834449149317104
catalog_returns: 13.009788101539016, 1.7018163909637893, 4.998066945036653
catalog_sales: 132.3057429259643, 17.49673467954957, 0.3170338863356541
customer: 0.8535048151388764, 0.11669613740363871, 9.96362596034607
customer_address: 0.2449320713058114, 0.049769893043445375, 10.92217933335979
customer_demographics: 0.011580578982830048, 0.00595883773921495, 5.770361973111247
date_dim: 0.001992875710129738, 0.0019425741466335177, 32.467783266922595
household_demographics: 3.5176053643226624e-05, 0.0012819901470246602, 6.077454372720331
income_band: 5.122274160385132e-07, 0.0011215779160495514, 1.1622882356930737
item: 0.03489831369370222, 0.008295655778932263, 19.15706193182082
promotion: 7.638614624738693e-05, 0.004892585845975921, 3.9610882687940308
reason: 1.4491379261016846e-06, 0.0013672037726438194, 0.8693249298304523
store: 9.930133819580078e-05, 0.0014200394007576806, 18.102185171003633
store_returns: 20.850121902301908, 2.8394286535369617, 7.680023033884838
store_sales: 174.69669486396015, 23.526979717320025, 9.076603461589606
time_dim: 0.0012146271765232086, 0.0017928799925520868, 1.301635161031656
warehouse: 2.907589077949524e-06, 0.0014493306253256443, 0.21274918527147152
web_page: 7.394980639219284e-05, 0.0014304081606129257, 0.909714953987672
web_returns: 6.285572262480855, 0.8145248574786034, 4.979797285395797
web_sales: 67.01082486007363, 8.830142442574237, 5.460975500359796
web_site: 1.0454095900058746e-05, 0.0017744646851904713, 2.1589899800395282
catalog_page: 0.0017016949132084846, 0.004872637208384529, 1.8344491501076199
catalog_returns: 13.009788101539016, 1.7018103473163826, 4.783874472787263
catalog_sales: 132.3057429259643, 17.496673217421677, 0.1028968325667492
customer: 0.8535048151388764, 0.1166957409112345, 9.963626356838473
customer_address: 0.2449320713058114, 0.04976977926118651, 10.922179447142048
customer_demographics: 0.011580578982830048, 0.005958832359501185, 5.7703619784909606
date_dim: 0.001992875710129738, 0.001942573220850713, 32.25358475195158
household_demographics: 3.5176053643226624e-05, 0.001281990130683759, 6.077454372736672
income_band: 5.122274160385132e-07, 0.0011215779158115981, 1.1622882356933117
item: 0.03489831369370222, 0.008295639567053837, 18.942863432135905
promotion: 7.638614624738693e-05, 0.004892585810491029, 3.9610882688295157
reason: 1.4491379261016846e-06, 0.0013672037719706278, 0.8693249298311254
store: 9.930133819580078e-05, 0.001420039354627623, 18.10218517104976
store_returns: 20.850121902301908, 2.839418967692413, 7.680032719729386
store_sales: 174.69669486396015, 23.526898562637207, 9.076684616272424
time_dim: 0.0012146271765232086, 0.0017928794283016678, 1.3016351615959065
web_page: 7.394980639219284e-05, 0.0014304081262598255, 0.9097149540220251
web_returns: 6.285572262480855, 0.8145219375399996, 4.979800205334401
web_sales: 67.01082486007363, 8.830111312951315, 5.461006629982718
web_site: 1.0454095900058746e-05, 0.001774464680334061, 2.158989980044385
Function: 64.72734806105986, 6.507000407334961, 2.410292625427246, 50.235068385637554, 5.502728039369583, 0.03617591717116302, 0.036082686119344835
hiya: 0b111101111011101111111110, 64.72734806105986
catalog_page: 0.0017016949132084846, 0.004872637208384529, 1.8344491501076199
catalog_returns: 13.009788101539016, 1.7018103473163826, 4.783874472787263
catalog_sales: 132.3057429259643, 17.496673217421677, 0.1028968325667492
customer: 0.8535048151388764, 0.1166957409112345, 9.963626356838473
customer_address: 0.2449320713058114, 0.04976977926118651, 10.922179447142048
customer_demographics: 0.011580578982830048, 0.005958832359501185, 5.7703619784909606
date_dim: 0.001992875710129738, 0.001942573220850713, 32.25358475195158
household_demographics: 3.5176053643226624e-05, 0.001281990130683759, 6.077454372736672
income_band: 5.122274160385132e-07, 0.0011215779158115981, 1.1622882356933117
item: 0.03489831369370222, 0.008295639567053837, 18.942863432135905
promotion: 7.638614624738693e-05, 0.004892585810491029, 3.9610882688295157
reason: 1.4491379261016846e-06, 0.0013672037719706278, 0.8693249298311254
store: 9.930133819580078e-05, 0.001420039354627623, 18.10218517104976
store_returns: 20.850121902301908, 2.839418967692413, 7.680032719729386
store_sales: 174.69669486396015, 23.526898562637207, 9.076684616272424
time_dim: 0.0012146271765232086, 0.0017928794283016678, 1.3016351615959065
web_page: 7.394980639219284e-05, 0.0014304081262598255, 0.9097149540220251
web_returns: 6.285572262480855, 0.8145219375399996, 4.979800205334401
web_sales: 67.01082486007363, 8.830111312951315, 5.461006629982718
web_site: 1.0454095900058746e-05, 0.001774464680334061, 2.158989980044385
catalog_page: 0.0017016949132084846, 0.004872568847198803, -0.004872568847198803
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.7012877127749237, -1.6808172436736537
customer: 0.8535048151388764, 0.11666145356587487, 5.775017440068603
customer_address: 0.2449320713058114, 0.04975993974959905, 6.026299018208623
customer_demographics: 0.011580578982830048, 0.005958367139734399, 3.138531924017034
date_dim: 0.001992875710129738, 0.0019424931622306326, 14.65401478202176
household_demographics: 3.5176053643226624e-05, 0.0012819887175769102, 4.921693254075189
income_band: 5.122274160385132e-07, 0.0011215778952341886, 0.006527115639298994
item: 0.03489831369370222, 0.008294237617688278, 7.420606769395632
promotion: 7.638614624738693e-05, 0.004892582741875444, 1.3164486866447338
reason: 1.4491379261016846e-06, 0.001367203713755265, 0.8693249298893407
store: 9.930133819580078e-05, 0.0014200353654535527, 11.409267407860723
store_returns: 20.850121902301908, 2.838581368047075, -1.2884551362161603
store_sales: 174.69669486396015, 23.519880575387763, -7.324972888206929
time_dim: 0.0012146271765232086, 0.0017928306338007513, 0.6259132573353434
web_page: 7.394980639219284e-05, 0.0014304051555178846, 0.21123730377386188
web_returns: 6.285572262480855, 0.8142694309540685, -0.3294005190074539
web_sales: 67.01082486007363, 8.82741932662147, -7.010037065569339
web_site: 1.0454095900058746e-05, 0.0017744642603678344, 0.3196681931483465
customer: 0.8535048151388764, 0.11662176444818755, -0.11662176444818755
customer had no query dependencies
customer_address: 0.2449320713058114, 0.04974855008004941, -0.04974855008004941
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.005957828627292543, -0.005957828627292543
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0019424004908394552, -0.0019424004908394552
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0.0012819870818432764, -0.0012819870818432764
household_demographics had no query dependencies
income_band: 5.122274160385132e-07, 0.001121577871414927, -0.001121577871414927
income_band had no query dependencies
item: 0.03489831369370222, 0.008292614799334226, -0.008292614799334226
item had no query dependencies
promotion: 7.638614624738693e-05, 0.004892579189817278, -0.004892579189817278
promotion had no query dependencies
reason: 1.4491379261016846e-06, 0.0013672036463684095, -0.0013672036463684095
reason had no query dependencies
store: 9.930133819580078e-05, 0.0014200307478082527, -0.0014200307478082527
store had no query dependencies
time_dim: 0.0012146271765232086, 0.0017927741520093188, -0.0017927741520093188
time_dim had no query dependencies
web_page: 7.394980639219284e-05, 0.001430401716752787, -0.001430401716752787
web_page had no query dependencies
web_site: 1.0454095900058746e-05, 0.0017744637742383655, -0.0017744637742383655
web_site had no query dependencies
Function: 43.536720275878906, 0, 43.536720275878906, 0.0, 0, 0.0, 0
hiya: 0b0, 43.536720275878906
{63.15523043601367: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 63.861814649667664: [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 64.51479180872388: [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23], 64.72734806105986: [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23], 43.536720275878906: []}
[]
{}
Best Cost: $43.536720275878906;
[]
{}
{}
{}
[]
0
Optimal Subset: 0b0
Function: 43.536720275878906, 0, 43.536720275878906, 0.0, 0, 0.0, 0
43.536720275878906
Real: 43.536720275878906, 0, 43.536720275878906, 0.0, 0, 0.0, 0
Num Redshift Qs: 0; Num GCP Qs: 93
Redshift Qs: $0; GCP Qs: $43.536720275878906; Movement Cost: $0.0
Load Cost: $0, Storage Cost: $0.0, API Cost: $0
Final cost: $43.536720275878906, BQ Baseline: $43.536720275878906, Diff: $0.0, %: 0.0%
