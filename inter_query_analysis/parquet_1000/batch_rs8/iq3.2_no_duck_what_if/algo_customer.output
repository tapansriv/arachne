Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $8.062825276282629, BigQuery Total: $92.02776551246643
02: $-0.031875375076929724
03: $0.46225074385325116
05: $1.3774780998261769
07: $1.340530101292928
09: $4.267598117723465
12: $0.10837940103848775
13: $1.6847769363244374
14: $15.371164026819866
16: $0.5690129777526856
17: $1.0109230725765228
20: $0.23164465132395426
21: $0.13040914547920227
22: $0.7010737974611918
25: $1.1922297933006287
26: $0.6698881686592102
27: $4.0225541106828056
28: $5.065755438566208
29: $1.0155870588302611
31: $1.7965831590811412
32: $0.48596438729286195
33: $1.0948081830120087
36: $2.5501932117144266
37: $0.14639244778315225
39: $0.27702829706509907
40: $0.4028677000713348
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
47: $0.4219892735958099
48: $1.067886776456833
49: $1.7678878890864054
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
55: $0.49871100074450175
56: $1.0958423399066926
57: $0.2027771442572276
58: $0.8274850143432617
59: $0.4599690491803487
60: $1.1121361897977193
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
66: $0.7691510609022776
67: $5.390935244779587
70: $1.9079043164030711
71: $1.018561050154368
72: $0.2915280825424194
75: $2.740938346967697
76: $1.0589388700771332
77: $1.2807744638061522
78: $1.4438266993649802
80: $1.6337554561456045
82: $0.23191760928789776
83: $0.018545273780822748
85: $0.3062816962369283
86: $0.3294791894944509
88: $2.910070013548533
89: $0.5879451856454213
90: $0.15635354908943175
92: $0.21465586846033732
93: $0.7695970211982727
94: $0.29105015072186785
95: $0.2871878468354543
96: $0.3593499286079407
97: $0.4526963858763377
98: $0.4373975418567657
99: $0.24868929240544635
!!!!!!: 84.02806331426619
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 68
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'92': 4196480, '17': 231560, '16': 173, '39': 527488, '50': 229504, '70': 163968, '59': 163968, '75': 6490252, '82': 134272, '56': 4327592, '65': 166016, '43': 163968, '71': 4589704, '33': 4327592, '27': 166080, '28': 131072, '29': 231560, '48': 164064, '98': 133248, '58': 4327560, '89': 166016, '94': 14680224, '51': 4325504, '31': 4325536, '37': 3208, '07': 137408, '93': 204800, '55': 133248, '14': 4327560, '80': 14915726, '60': 4327592, '32': 2184, '09': 139264, '40': 526476, '13': 164320, '86': 4196480, '90': 5505280, '63': 166016, '76': 4327560, '25': 231560, '95': 14680224, '52': 133248, '83': 2164868, '26': 6344, '96': 426240, '36': 166016, '67': 166016, '99': 540809, '77': 7569548, '62': 13123712, '20': 2184, '88': 426240, '22': 527488, '85': 7348448, '97': 131208, '12': 4196480, '42': 133248, '47': 166016, '72': 531916, '21': 527488, '44': 133120, '57': 2185, '66': 4997256, '05': 14909582, '53': 166016, '49': 6488204, '03': 133248, '78': 6488204}
call_center: 0.006691021692103037, 1.0137883927232565
catalog_page: 0.007001459944590946, 3.00423209602719
catalog_returns: 0.18234854755809307, 11.344266441786186
catalog_sales: 2.101522679695642, 37.41142617318675
customer_address: 0.0337434666638437, 9.271822789461925
customer_demographics: 0.009095161897325572, 9.374350710298234
date_dim: 0.006898406045111455, 69.55941919630321
household_demographics: 0.0061234656983985, 5.395955044414364
income_band: 0.005805388750690989, -0.005805388750690989
income_band had no query dependencies
inventory: 0.15138257660739815, 1.6269668030115643
item: 0.01284667894032319, 52.96384580634131
promotion: 0.009100234610789517, 3.926601574029373
reason: 0.005482457205654114, 5.337994377953011
ship_mode: 0.00566583019914047, 1.1069085626504638
store: 0.007441961925661306, 31.765589091356762
store_returns: 0.3224065147021203, 14.585861733744665
store_sales: 3.282724870128711, 73.81224427594175
time_dim: 0.0072231157551754166, 5.206262486547376
warehouse: 0.006188463970996797, 2.9092929514978554
web_page: 0.0062289679503281375, 1.737180741182184
web_returns: 0.10014948441336118, 11.047576438358726
web_sales: 1.2431072103976173, 35.49497635662089
web_site: 0.006924482488157549, 3.6772811105828263
['income_band']
1
call_center: 0.006691021320918291, 1.0137883930944411
catalog_page: 0.007001404732753777, 3.0042321512390275
catalog_returns: 0.1819586674974836, 11.344656321846795
customer_address: 0.033738190588035344, 9.271828065537733
household_demographics: 0.006123464656315956, 5.395955045456446
promotion: 0.009100232244063351, 3.9266015763960995
ship_mode: 0.005665830145590588, 1.1069085627040138
store_returns: 0.32179306508173783, 14.586475183365046
time_dim: 0.007223079583138776, 5.206262522719412
web_page: 0.006228965713581299, 1.737180743418931
web_returns: 0.09996024628484458, 11.047765676487243
web_site: 0.006924482095940849, 3.677281110975043
[]
0
{'39': 527488, '27': 166080, '28': 131072, '14': 4327560, '09': 139264, '67': 166016, '22': 527488, '92': 0, '17': 65536, '16': 37, '50': 65536, '70': 0, '59': 0, '75': 2162692, '82': 0, '56': 32, '65': 0, '43': 0, '71': 262144, '33': 32, '29': 65536, '48': 32, '98': 0, '58': 0, '89': 0, '94': 10485792, '51': 0, '31': 32, '37': 0, '07': 4096, '93': 65536, '55': 0, '80': 10555398, '60': 32, '32': 0, '40': 4, '13': 288, '86': 0, '90': 1310976, '63': 0, '76': 0, '25': 65536, '95': 10485792, '52': 0, '26': 4096, '96': 262400, '36': 0, '99': 16385, '77': 3211268, '62': 8404992, '20': 0, '88': 262400, '85': 3145760, '97': 0, '12': 0, '42': 0, '47': 0, '72': 4356, '21': 0, '44': 0, '57': 1, '66': 278528, '05': 10551302, '53': 0, '49': 2162692, '03': 0, '78': 2162692}
{}
{'39': 527488, '27': 166080, '28': 131072, '14': 4327560, '09': 139264, '67': 166016, '22': 527488, '92': 0, '17': 65536, '16': 37, '50': 65536, '70': 0, '59': 0, '75': 2162692, '82': 0, '56': 32, '65': 0, '43': 0, '71': 262144, '33': 32, '29': 65536, '48': 32, '98': 0, '58': 0, '89': 0, '94': 10485792, '51': 0, '31': 32, '37': 0, '07': 4096, '93': 65536, '55': 0, '80': 10555398, '60': 32, '32': 0, '40': 4, '13': 288, '86': 0, '90': 1310976, '63': 0, '76': 0, '25': 65536, '95': 10485792, '52': 0, '26': 4096, '96': 262400, '36': 0, '99': 16385, '77': 3211268, '62': 8404992, '20': 0, '88': 262400, '85': 3145760, '97': 0, '12': 0, '42': 0, '47': 0, '72': 4356, '21': 0, '44': 0, '57': 1, '66': 278528, '05': 10551302, '53': 0, '49': 2162692, '03': 0, '78': 2162692}
STARTING PHASE 2: 0b0
----
[]
Function: 15.858374126870324, 7.705857259922028, 0.29384493827819824, 0.33838229111686813, 7.470129567581812, 0.019432699586203587, 0.030727370385214683
{15.858374126870324: []}
Best Cost: $15.858374126870324;
[3, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 5, 8, 12, 14, 16, 18, 20, 21, 23]
{'92': 4196480, '17': 231560, '16': 173, '39': 527488, '50': 229504, '70': 163968, '59': 163968, '75': 6490252, '82': 134272, '56': 4327592, '65': 166016, '43': 163968, '71': 4589704, '33': 4327592, '27': 166080, '28': 131072, '29': 231560, '48': 164064, '98': 133248, '58': 4327560, '89': 166016, '94': 14680224, '51': 4325504, '31': 4325536, '37': 3208, '07': 137408, '93': 204800, '55': 133248, '14': 4327560, '80': 14915726, '60': 4327592, '32': 2184, '09': 139264, '40': 526476, '13': 164320, '86': 4196480, '90': 5505280, '63': 166016, '76': 4327560, '25': 231560, '95': 14680224, '52': 133248, '83': 2164868, '26': 6344, '96': 426240, '36': 166016, '67': 166016, '99': 540809, '77': 7569548, '62': 13123712, '20': 2184, '88': 426240, '22': 527488, '85': 7348448, '97': 131208, '12': 4196480, '42': 133248, '47': 166016, '72': 531916, '21': 527488, '44': 133120, '57': 2185, '66': 4997256, '05': 14909582, '53': 166016, '49': 6488204, '03': 133248, '78': 6488204}
['02', '41']
Excluding table customer and any queries that depend on it
[3, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 5, 8, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['92', '17', '16', '39', '50', '70', '59', '75', '82', '56', '65', '43', '71', '33', '27', '28', '29', '48', '98', '58', '89', '94', '51', '31', '37', '07', '93', '55', '14', '80', '60', '32', '09', '40', '13', '86', '90', '63', '76', '25', '95', '52', '83', '26', '96', '36', '67', '99', '77', '62', '20', '88', '22', '85', '97', '12', '42', '47', '72', '21', '44', '57', '66', '05', '53', '49', '03', '78'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['92', '17', '16', '39', '50', '70', '59', '75', '82', '56', '65', '43', '71', '33', '27', '28', '29', '48', '98', '58', '89', '94', '51', '31', '37', '07', '93', '55', '14', '80', '60', '32', '09', '40', '13', '86', '90', '63', '76', '25', '95', '52', '83', '26', '96', '36', '67', '99', '77', '62', '20', '88', '22', '85', '97', '12', '42', '47', '72', '21', '44', '57', '66', '05', '53', '49', '03', '78'])
Function: 15.858374126870324, 7.705857259922028, 0.29384493827819824, 0.33838229111686813, 7.470129567581812, 0.019432699586203587, 0.030727370385214683
Real: 15.858374126870324, 7.705857259922028, 0.29384493827819824, 0.33838229111686813, 7.470129567581812, 0.019432699586203587, 0.030727370385214683
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 68; Num Redshift Qs: 2
PLAN TYPE IS: move
Moved Qs: $7.705857259922028; Stayed Qs: $0.29384493827819824; Migration Cost: $7.8586719286700975
Movement Cost: $0.33838229111686813, Load Cost: $7.470129567581812, Storage Cost: $0.019432699586203587, API Cost: $0.030727370385214683
Final cost: $15.858374126870324, Baseline: $92.02776551246643, Diff: $76.1693913855961, %: 82.76783746887553%
