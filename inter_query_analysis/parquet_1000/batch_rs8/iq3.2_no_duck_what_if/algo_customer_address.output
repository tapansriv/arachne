Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_address
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $9.933587279532748, BigQuery Total: $95.28049826622009
01: $-0.053216558179855364
02: $-0.031875375076929724
03: $0.46225074385325116
04: $4.086595410804748
05: $1.3774780998261769
07: $1.340530101292928
09: $4.267598117723465
11: $1.7474326745287576
12: $0.10837940103848775
14: $15.371164026819866
17: $1.0109230725765228
20: $0.23164465132395426
21: $0.13040914547920227
22: $0.7010737974611918
23: $0.9690291706689198
25: $1.1922297933006287
26: $0.6698881686592102
27: $4.0225541106828056
28: $5.065755438566208
29: $1.0155870588302611
32: $0.48596438729286195
34: $0.6039280316289266
36: $2.5501932117144266
37: $0.14639244778315225
38: $0.3879267294565837
39: $0.27702829706509907
40: $0.4028677000713348
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
47: $0.4219892735958099
49: $1.7678878890864054
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
55: $0.49871100074450175
57: $0.2027771442572276
58: $0.8274850143432617
59: $0.4599690491803487
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
66: $0.7691510609022776
67: $5.390935244779587
70: $1.9079043164030711
71: $1.018561050154368
72: $0.2915280825424194
73: $0.6070841459401448
74: $0.8040276591714223
75: $2.740938346967697
76: $1.0589388700771332
77: $1.2807744638061522
78: $1.4438266993649802
79: $1.2055793523947398
80: $1.6337554561456045
82: $0.23191760928789776
83: $0.018545273780822748
86: $0.3294791894944509
87: $0.32915039021492004
88: $2.910070013548533
89: $0.5879451856454213
90: $0.15635354908943175
92: $0.21465586846033732
93: $0.7695970211982727
96: $0.3593499286079407
97: $0.4526963858763377
98: $0.4373975418567657
99: $0.24868929240544635
!!!!!!: 85.46325062294963
Excluding table customer_address and any queries that depend on it
Total Keys: 70, Keys Considered: 67
[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'78': 6488204, '21': 527488, '49': 6488204, '99': 540809, '36': 166016, '57': 2185, '47': 166016, '96': 426240, '74': 4325520, '62': 13123712, '67': 166016, '66': 4997256, '03': 133248, '79': 164240, '12': 4196480, '73': 164240, '88': 426240, '20': 2184, '44': 133120, '72': 531916, '50': 229504, '83': 2164868, '42': 133248, '14': 4327560, '26': 6344, '82': 134272, '40': 526476, '76': 4327560, '59': 163968, '07': 137408, '09': 139264, '80': 14915726, '23': 4327576, '65': 166016, '87': 4325528, '43': 163968, '22': 527488, '86': 4196480, '37': 3208, '70': 163968, '28': 131072, '27': 166080, '38': 4325528, '11': 4325520, '52': 133248, '32': 2184, '04': 4325528, '51': 4325504, '71': 4589704, '77': 7569548, '34': 164240, '98': 133248, '97': 131208, '17': 231560, '05': 14909582, '89': 166016, '75': 6490252, '25': 231560, '39': 527488, '29': 231560, '55': 133248, '58': 4327560, '90': 5505280, '93': 204800, '63': 166016, '53': 166016, '92': 4196480}
call_center: 0.006691021763236242, 0.4447754148994377
catalog_page: 0.007001470525292175, 3.004232085446489
catalog_returns: 0.1824232635003225, 10.775178748091273
catalog_sales: 2.1022201270264658, 39.31163073653198
customer: 0.028515645197578682, 10.712237919611583
customer_demographics: 0.009095219278924814, 6.3154052438984385
date_dim: 0.006898417200136298, 70.99460649383161
household_demographics: 0.006123465898101401, 6.127769637854035
income_band: 0.00580538875459169, -0.00580538875459169
income_band had no query dependencies
inventory: 0.15141516316104178, 1.6269342164579206
item: 0.012846872866622686, 50.63008807036749
promotion: 0.009100235064344837, 3.926601573575817
reason: 0.00548245721605795, 5.03171268170568
ship_mode: 0.005665830209402677, 1.1069085626402018
store: 0.007441962526493163, 31.429516907938467
store_returns: 0.3225240751291027, 14.58574417331768
store_sales: 3.2836487588642282, 76.70004036743661
time_dim: 0.007223122687122118, 5.206262479615429
warehouse: 0.006188463993645647, 2.9092929514752064
web_page: 0.006228968378974443, 1.4308990445166094
web_returns: 0.10018574968185363, 10.163020479295986
web_sales: 1.2434607937144686, 37.83489524255758
web_site: 0.006924482563321281, 3.09904311295034
['income_band']
1
call_center: 0.0066910213920514956, 0.4447754152706224
catalog_page: 0.007001415313455006, 3.0042321406583263
catalog_returns: 0.18203338343971304, 10.775568628151882
customer: 0.028490637607474795, 10.712262927201689
household_demographics: 0.006123464856018857, 6.127769638896117
promotion: 0.009100232697618671, 3.926601575942543
ship_mode: 0.005665830155852795, 1.1069085626937516
store_returns: 0.32191062550872024, 14.586357622938063
time_dim: 0.007223086515085477, 5.206262515787466
web_page: 0.006228966142227604, 1.4308990467533562
web_returns: 0.09999651155333703, 10.163209717424502
web_site: 0.00692448217110458, 3.099043113342557
[]
0
{'67': 166016, '14': 4327560, '09': 139264, '22': 527488, '28': 131072, '27': 166080, '39': 527488, '78': 2162692, '21': 0, '49': 2162692, '99': 16385, '36': 0, '57': 1, '47': 0, '96': 262400, '74': 16, '62': 8404992, '66': 278528, '03': 0, '79': 272, '12': 0, '73': 272, '88': 262400, '20': 0, '44': 0, '72': 4356, '50': 65536, '42': 0, '26': 4096, '82': 0, '40': 4, '76': 0, '59': 0, '07': 4096, '80': 10555398, '23': 16, '65': 0, '87': 16, '43': 0, '86': 0, '37': 0, '70': 0, '38': 16, '11': 16, '52': 0, '32': 0, '04': 16, '51': 0, '71': 262144, '77': 3211268, '34': 272, '98': 0, '97': 0, '17': 65536, '05': 10551302, '89': 0, '75': 2162692, '25': 65536, '29': 65536, '55': 0, '58': 0, '90': 1310976, '93': 65536, '63': 0, '53': 0, '92': 0}
{}
{'67': 166016, '14': 4327560, '09': 139264, '22': 527488, '28': 131072, '27': 166080, '39': 527488, '78': 2162692, '21': 0, '49': 2162692, '99': 16385, '36': 0, '57': 1, '47': 0, '96': 262400, '74': 16, '62': 8404992, '66': 278528, '03': 0, '79': 272, '12': 0, '73': 272, '88': 262400, '20': 0, '44': 0, '72': 4356, '50': 65536, '42': 0, '26': 4096, '82': 0, '40': 4, '76': 0, '59': 0, '07': 4096, '80': 10555398, '23': 16, '65': 0, '87': 16, '43': 0, '86': 0, '37': 0, '70': 0, '38': 16, '11': 16, '52': 0, '32': 0, '04': 16, '51': 0, '71': 262144, '77': 3211268, '34': 272, '98': 0, '97': 0, '17': 65536, '05': 10551302, '89': 0, '75': 2162692, '25': 65536, '29': 65536, '55': 0, '58': 0, '90': 1310976, '93': 65536, '63': 0, '53': 0, '92': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 17.673499964867244, 9.458427681722638, 0.35881996154785156, 0.33895418862940274, 7.464812537803649, 0.021706664487966435, 0.030778930675736064
{17.673499964867244: []}
Best Cost: $17.673499964867244;
[3, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 4, 8, 12, 14, 16, 18, 20, 21, 23]
{'78': 6488204, '21': 527488, '49': 6488204, '99': 540809, '36': 166016, '57': 2185, '47': 166016, '96': 426240, '74': 4325520, '62': 13123712, '67': 166016, '66': 4997256, '03': 133248, '79': 164240, '12': 4196480, '73': 164240, '88': 426240, '20': 2184, '44': 133120, '72': 531916, '50': 229504, '83': 2164868, '42': 133248, '14': 4327560, '26': 6344, '82': 134272, '40': 526476, '76': 4327560, '59': 163968, '07': 137408, '09': 139264, '80': 14915726, '23': 4327576, '65': 166016, '87': 4325528, '43': 163968, '22': 527488, '86': 4196480, '37': 3208, '70': 163968, '28': 131072, '27': 166080, '38': 4325528, '11': 4325520, '52': 133248, '32': 2184, '04': 4325528, '51': 4325504, '71': 4589704, '77': 7569548, '34': 164240, '98': 133248, '97': 131208, '17': 231560, '05': 14909582, '89': 166016, '75': 6490252, '25': 231560, '39': 527488, '29': 231560, '55': 133248, '58': 4327560, '90': 5505280, '93': 204800, '63': 166016, '53': 166016, '92': 4196480}
['01', '02', '41']
Excluding table customer_address and any queries that depend on it
[3, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 4, 8, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['78', '21', '49', '99', '36', '57', '47', '96', '74', '62', '67', '66', '03', '79', '12', '73', '88', '20', '44', '72', '50', '83', '42', '14', '26', '82', '40', '76', '59', '07', '09', '80', '23', '65', '87', '43', '22', '86', '37', '70', '28', '27', '38', '11', '52', '32', '04', '51', '71', '77', '34', '98', '97', '17', '05', '89', '75', '25', '39', '29', '55', '58', '90', '93', '63', '53', '92'])
22
Optimal Subset: 0b111111111111110111011111
dict_keys(['78', '21', '49', '99', '36', '57', '47', '96', '74', '62', '67', '66', '03', '79', '12', '73', '88', '20', '44', '72', '50', '83', '42', '14', '26', '82', '40', '76', '59', '07', '09', '80', '23', '65', '87', '43', '22', '86', '37', '70', '28', '27', '38', '11', '52', '32', '04', '51', '71', '77', '34', '98', '97', '17', '05', '89', '75', '25', '39', '29', '55', '58', '90', '93', '63', '53', '92'])
Function: 17.673499964867244, 9.458427681722638, 0.35881996154785156, 0.33895418862940274, 7.464812537803649, 0.021706664487966435, 0.030778930675736064
Real: 17.673499964867244, 9.458427681722638, 0.35881996154785156, 0.33895418862940274, 7.464812537803649, 0.021706664487966435, 0.030778930675736064
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 67; Num Redshift Qs: 3
PLAN TYPE IS: move
Moved Qs: $9.458427681722638; Stayed Qs: $0.35881996154785156; Migration Cost: $7.856252321596755
Movement Cost: $0.33895418862940274, Load Cost: $7.464812537803649, Storage Cost: $0.021706664487966435, API Cost: $0.030778930675736064
Final cost: $17.673499964867244, Baseline: $95.28049826622009, Diff: $77.60699830135285, %: 81.45108360423735%
