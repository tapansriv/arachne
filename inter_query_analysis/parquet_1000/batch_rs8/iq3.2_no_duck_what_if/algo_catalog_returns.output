Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_returns
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $9.538821409371689, BigQuery Total: $105.70265054702759
01: $-0.053216558179855364
02: $-0.031875375076929724
03: $0.46225074385325116
04: $4.086595410804748
06: $0.3156157429854075
07: $1.340530101292928
08: $0.48762544854164125
09: $4.267598117723465
10: $0.31066071114857996
11: $1.7474326745287576
12: $0.10837940103848775
13: $1.6847769363244374
14: $15.371164026819866
15: $0.18220076550165812
17: $1.0109230725765228
18: $3.9880419502385456
19: $0.6867483040714264
20: $0.23164465132395426
21: $0.13040914547920227
22: $0.7010737974611918
23: $0.9690291706689198
24: $1.4329938850339254
25: $1.1922297933006287
26: $0.6698881686592102
27: $4.0225541106828056
28: $5.065755438566208
29: $1.0155870588302611
30: $-0.06070611572265626
31: $1.7965831590811412
32: $0.48596438729286195
33: $1.0948081830120087
34: $0.6039280316289266
35: $0.38853899744351705
36: $2.5501932117144266
37: $0.14639244778315225
38: $0.3879267294565837
39: $0.27702829706509907
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
45: $0.11165965701738993
46: $1.2257707875823975
47: $0.4219892735958099
48: $1.067886776456833
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
54: $0.7208397585646311
55: $0.49871100074450175
56: $1.0958423399066926
57: $0.2027771442572276
58: $0.8274850143432617
59: $0.4599690491803487
60: $1.1121361897977193
61: $1.6261143863296508
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
66: $0.7691510609022776
67: $5.390935244779587
68: $1.4640650397332509
69: $0.1580370307509104
70: $1.9079043164030711
71: $1.018561050154368
73: $0.6070841459401448
74: $0.8040276591714223
76: $1.0589388700771332
79: $1.2055793523947398
82: $0.23191760928789776
84: $-0.0002394650332132979
85: $0.3062816962369283
86: $0.3294791894944509
87: $0.32915039021492004
88: $2.910070013548533
89: $0.5879451856454213
90: $0.15635354908943175
92: $0.21465586846033732
93: $0.7695970211982727
94: $0.29105015072186785
95: $0.2871878468354543
96: $0.3593499286079407
97: $0.4526963858763377
98: $0.4373975418567657
99: $0.24868929240544635
!!!!!!: 96.34111435467408
Excluding table catalog_returns and any queries that depend on it
Total Keys: 86, Keys Considered: 81
[0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'60': 4327592, '85': 7348448, '79': 164240, '33': 4327592, '43': 163968, '03': 133248, '98': 133248, '69': 4325624, '56': 4327592, '63': 166016, '67': 166016, '47': 166016, '74': 4325520, '18': 2296, '24': 231472, '68': 164272, '31': 4325536, '62': 13123712, '55': 133248, '14': 4327560, '21': 527488, '06': 133296, '96': 426240, '65': 166016, '22': 527488, '27': 166080, '45': 4196528, '19': 166064, '51': 4325504, '17': 231560, '99': 540809, '97': 131208, '59': 163968, '54': 4360376, '46': 164272, '61': 170160, '20': 2184, '73': 164240, '39': 527488, '44': 133120, '93': 204800, '90': 5505280, '29': 231560, '76': 4327560, '52': 133248, '15': 184, '50': 229504, '66': 4997256, '08': 164016, '94': 14680224, '57': 2185, '04': 4325528, '11': 4325520, '58': 4327560, '25': 231560, '95': 14680224, '23': 4327576, '38': 4325528, '07': 137408, '92': 4196480, '13': 164320, '35': 4325624, '71': 4589704, '88': 426240, '37': 3208, '28': 131072, '09': 139264, '10': 4325624, '82': 134272, '42': 133248, '86': 4196480, '26': 6344, '53': 166016, '89': 166016, '48': 164064, '70': 163968, '87': 4325528, '36': 166016, '32': 2184, '12': 4196480, '34': 164240}
call_center: 0.006691021736976053, 0.4447754149256979
catalog_page: 0.007001466619223211, -0.007001466619223211
catalog_page had no query dependencies
catalog_sales: 2.1019626509562146, 37.42393740115571
customer: 0.028513875986906224, 23.811152153765185
customer_address: 0.033744104495649845, 21.80172163882037
customer_demographics: 0.009095198095405967, 13.928101281139288
date_dim: 0.006898413082044747, 80.43947634464023
household_demographics: 0.006123465824377242, 10.210854319025424
income_band: 0.005805388753151672, -0.005805388753151672
income_band had no query dependencies
inventory: 0.15140313320923843, 1.3354181638673046
item: 0.01284680127500665, 57.727253679408655
promotion: 0.009100234896906185, 3.6274324213848828
reason: 0.005482457212217174, 5.337994377946449
ship_mode: 0.0056658302056141864, 1.10690856264399
store: 0.007441962304684549, 37.53433021102054
store_returns: 0.3224806754408126, 5.755575229062056
store_sales: 3.2833076876027043, 83.1247641602653
time_dim: 0.007223120128060929, 5.20626248217449
warehouse: 0.006188463985284389, 2.214897168869813
web_page: 0.006228968220731431, 0.4564062771056286
web_returns: 0.10017236166184786, 0.7843473321324026
web_sales: 1.2433302616457291, 35.263990539946136
web_site: 0.006924482535573147, 0.6660475545636293
['catalog_page', 'income_band']
2
call_center: 0.006691021351917281, 0.44477541531075665
household_demographics: 0.006123464743344064, 10.210854320106456
promotion: 0.00910023244171727, 3.6274324238400717
ship_mode: 0.005665830150062734, 1.1069085626995416
store_returns: 0.32184429649316887, 5.756211608009699
time_dim: 0.0072230826039972615, 5.206262519698554
web_page: 0.006228965900380171, 0.45640627942597983
web_returns: 0.09997605024999241, 0.784543643544258
web_site: 0.006924482128696293, 0.666047554970506
[]
0
{'67': 166016, '18': 2296, '14': 4327560, '22': 527488, '27': 166080, '39': 527488, '28': 131072, '09': 139264, '60': 0, '85': 3145728, '79': 256, '33': 0, '43': 0, '03': 0, '98': 0, '69': 0, '56': 0, '63': 0, '47': 0, '74': 0, '24': 65536, '68': 256, '31': 0, '62': 8404992, '55': 0, '21': 0, '06': 0, '96': 262400, '65': 0, '45': 0, '19': 0, '51': 0, '17': 65536, '99': 16385, '97': 0, '59': 0, '54': 0, '46': 256, '61': 4096, '20': 0, '73': 256, '44': 0, '93': 65536, '90': 1310976, '29': 65536, '76': 0, '52': 0, '15': 0, '50': 65536, '66': 278528, '08': 0, '94': 10485760, '57': 1, '04': 0, '11': 0, '58': 0, '25': 65536, '95': 10485760, '23': 0, '38': 0, '07': 4096, '92': 0, '13': 256, '35': 0, '71': 262144, '88': 262400, '37': 0, '10': 0, '82': 0, '42': 0, '86': 0, '26': 4096, '53': 0, '89': 0, '48': 0, '70': 0, '87': 0, '36': 0, '32': 0, '12': 0, '34': 256}
{}
{'67': 166016, '18': 2296, '14': 4327560, '22': 527488, '27': 166080, '39': 527488, '28': 131072, '09': 139264, '60': 0, '85': 3145728, '79': 256, '33': 0, '43': 0, '03': 0, '98': 0, '69': 0, '56': 0, '63': 0, '47': 0, '74': 0, '24': 65536, '68': 256, '31': 0, '62': 8404992, '55': 0, '21': 0, '06': 0, '96': 262400, '65': 0, '45': 0, '19': 0, '51': 0, '17': 65536, '99': 16385, '97': 0, '59': 0, '54': 0, '46': 256, '61': 4096, '20': 0, '73': 256, '44': 0, '93': 65536, '90': 1310976, '29': 65536, '76': 0, '52': 0, '15': 0, '50': 65536, '66': 278528, '08': 0, '94': 10485760, '57': 1, '04': 0, '11': 0, '58': 0, '25': 65536, '95': 10485760, '23': 0, '38': 0, '07': 4096, '92': 0, '13': 256, '35': 0, '71': 262144, '88': 262400, '37': 0, '10': 0, '82': 0, '42': 0, '86': 0, '26': 4096, '53': 0, '89': 0, '48': 0, '70': 0, '87': 0, '36': 0, '32': 0, '12': 0, '34': 256}
STARTING PHASE 2: 0b0
----
[]
Function: 17.05015074158992, 8.960355209763842, 0.4011809825897217, 0.32780524007754863, 7.310861656389236, 0.020183872516321685, 0.029763780253252384
{17.05015074158992: []}
Best Cost: $17.05015074158992;
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 8, 12, 14, 16, 18, 20, 21, 23]
{'60': 4327592, '85': 7348448, '79': 164240, '33': 4327592, '43': 163968, '03': 133248, '98': 133248, '69': 4325624, '56': 4327592, '63': 166016, '67': 166016, '47': 166016, '74': 4325520, '18': 2296, '24': 231472, '68': 164272, '31': 4325536, '62': 13123712, '55': 133248, '14': 4327560, '21': 527488, '06': 133296, '96': 426240, '65': 166016, '22': 527488, '27': 166080, '45': 4196528, '19': 166064, '51': 4325504, '17': 231560, '99': 540809, '97': 131208, '59': 163968, '54': 4360376, '46': 164272, '61': 170160, '20': 2184, '73': 164240, '39': 527488, '44': 133120, '93': 204800, '90': 5505280, '29': 231560, '76': 4327560, '52': 133248, '15': 184, '50': 229504, '66': 4997256, '08': 164016, '94': 14680224, '57': 2185, '04': 4325528, '11': 4325520, '58': 4327560, '25': 231560, '95': 14680224, '23': 4327576, '38': 4325528, '07': 137408, '92': 4196480, '13': 164320, '35': 4325624, '71': 4589704, '88': 426240, '37': 3208, '28': 131072, '09': 139264, '10': 4325624, '82': 134272, '42': 133248, '86': 4196480, '26': 6344, '53': 166016, '89': 166016, '48': 164064, '70': 163968, '87': 4325528, '36': 166016, '32': 2184, '12': 4196480, '34': 164240}
['41', '30', '01', '02', '84']
Excluding table catalog_returns and any queries that depend on it
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 8, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['60', '85', '79', '33', '43', '03', '98', '69', '56', '63', '67', '47', '74', '18', '24', '68', '31', '62', '55', '14', '21', '06', '96', '65', '22', '27', '45', '19', '51', '17', '99', '97', '59', '54', '46', '61', '20', '73', '39', '44', '93', '90', '29', '76', '52', '15', '50', '66', '08', '94', '57', '04', '11', '58', '25', '95', '23', '38', '07', '92', '13', '35', '71', '88', '37', '28', '09', '10', '82', '42', '86', '26', '53', '89', '48', '70', '87', '36', '32', '12', '34'])
21
Optimal Subset: 0b111111111111110111111001
dict_keys(['60', '85', '79', '33', '43', '03', '98', '69', '56', '63', '67', '47', '74', '18', '24', '68', '31', '62', '55', '14', '21', '06', '96', '65', '22', '27', '45', '19', '51', '17', '99', '97', '59', '54', '46', '61', '20', '73', '39', '44', '93', '90', '29', '76', '52', '15', '50', '66', '08', '94', '57', '04', '11', '58', '25', '95', '23', '38', '07', '92', '13', '35', '71', '88', '37', '28', '09', '10', '82', '42', '86', '26', '53', '89', '48', '70', '87', '36', '32', '12', '34'])
Function: 17.05015074158992, 8.960355209763842, 0.4011809825897217, 0.32780524007754863, 7.310861656389236, 0.020183872516321685, 0.029763780253252384
Real: 17.05015074158992, 8.960355209763842, 0.4011809825897217, 0.32780524007754863, 7.310861656389236, 0.020183872516321685, 0.029763780253252384
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 81; Num Redshift Qs: 5
PLAN TYPE IS: move
Moved Qs: $8.960355209763842; Stayed Qs: $0.4011809825897217; Migration Cost: $7.688614549236359
Movement Cost: $0.32780524007754863, Load Cost: $7.310861656389236, Storage Cost: $0.020183872516321685, API Cost: $0.029763780253252384
Final cost: $17.05015074158992, Baseline: $105.70265054702759, Diff: $88.65249980543767, %: 83.86970368921428%
