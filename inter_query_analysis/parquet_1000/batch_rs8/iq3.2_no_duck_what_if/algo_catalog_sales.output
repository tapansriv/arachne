Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.2463111442756665, BigQuery Total: $61.903661489486694
01: $-0.053216558179855364
03: $0.46225074385325116
06: $0.3156157429854075
07: $1.340530101292928
08: $0.48762544854164125
09: $4.267598117723465
11: $1.7474326745287576
12: $0.10837940103848775
13: $1.6847769363244374
19: $0.6867483040714264
21: $0.13040914547920227
22: $0.7010737974611918
24: $1.4329938850339254
27: $4.0225541106828056
28: $5.065755438566208
30: $-0.06070611572265626
31: $1.7965831590811412
34: $0.6039280316289266
36: $2.5501932117144266
39: $0.27702829706509907
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
45: $0.11165965701738993
46: $1.2257707875823975
47: $0.4219892735958099
48: $1.067886776456833
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
55: $0.49871100074450175
59: $0.4599690491803487
61: $1.6261143863296508
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
67: $5.390935244779587
68: $1.4640650397332509
70: $1.9079043164030711
73: $0.6070841459401448
74: $0.8040276591714223
79: $1.2055793523947398
81: $-0.055518914477030445
82: $0.23191760928789776
83: $0.018545273780822748
84: $-0.0002394650332132979
85: $0.3062816962369283
86: $0.3294791894944509
88: $2.910070013548533
89: $0.5879451856454213
90: $0.15635354908943175
91: $0.024519525286356605
92: $0.21465586846033732
93: $0.7695970211982727
94: $0.29105015072186785
95: $0.2871878468354543
96: $0.3593499286079407
98: $0.4373975418567657
!!!!!!: 56.858279101629265
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 55
[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'27': 166080, '42': 133248, '85': 7348448, '12': 4196480, '45': 4196528, '47': 166016, '86': 4196480, '11': 4325520, '53': 166016, '89': 166016, '48': 164064, '88': 426240, '46': 164272, '67': 166016, '06': 133296, '08': 164016, '34': 164240, '36': 166016, '22': 527488, '43': 163968, '39': 527488, '55': 133248, '91': 501, '73': 164240, '07': 137408, '92': 4196480, '68': 164272, '13': 164320, '79': 164240, '19': 166064, '59': 163968, '21': 527488, '61': 170160, '51': 4325504, '70': 163968, '03': 133248, '44': 133120, '62': 13123712, '93': 204800, '98': 133248, '63': 166016, '90': 5505280, '65': 166016, '09': 139264, '74': 4325520, '28': 131072, '52': 133248, '82': 134272, '83': 2164868, '31': 4325536, '96': 426240, '95': 14680224, '50': 229504, '24': 231472, '94': 14680224}
call_center: 0.006691021494008523, 0.017828503792348082
catalog_page: 0.007001430479042621, -0.007001430479042621
catalog_page had no query dependencies
catalog_returns: 0.1821404756960396, -0.13907567662886025
customer: 0.028497506692406527, 12.31466713355303
customer_address: 0.033740650918621794, 12.775138691319487
customer_demographics: 0.0090950020988161, 8.437454144181473
date_dim: 0.006898374980164388, 40.95664112969729
household_demographics: 0.006123465142258094, 10.2353738449939
income_band: 0.0058053887398281665, -0.0058053887398281665
income_band had no query dependencies
inventory: 0.15129182830533283, 1.189137020988058
item: 0.01284613888682144, 25.533546337970677
promotion: 0.009100233347711022, 2.957544254274868
reason: 0.005482457176681107, 5.337994377981985
ship_mode: 0.005665830170561877, 0.0890682093713184
store: 0.00744196025244138, 33.59475052980073
store_returns: 0.3220791278524583, 2.55578212572382
store_sales: 3.280151988842693, 50.52676967527766
time_dim: 0.0072230964508206204, 3.4185503947950853
warehouse: 0.006188463907923398, 1.1970568156394499
web_page: 0.006228966756617233, 0.4564062785697428
web_returns: 0.10004849148309845, 0.8030164760919748
web_sales: 1.24212253782396, 5.566333329701777
web_site: 0.006924482278838665, 0.6660475548203638
['catalog_page', 'catalog_returns', 'income_band']
3
call_center: 0.006691021267707549, -0.006691021267707549
call_center had no query dependencies
customer: 0.02848226026312801, 12.290162854695954
customer_address: 0.0337374342425508, 12.7506223827092
household_demographics: 0.006123464506929469, 10.210854320342872
promotion: 0.009100231904784177, 2.9575442557177944
ship_mode: 0.005665830137914009, 0.08906820940396627
store_returns: 0.32170512475123025, 2.5376108550442256
time_dim: 0.007223074397740087, 3.4185504168481655
web_page: 0.006228965392935153, 0.45640627993342486
web_returns: 0.09993311828115292, 0.7845865755130976
web_sales: 1.2409976588111888, 5.567458208714548
web_site: 0.006924482039715097, 0.6660475550594874
['call_center']
1
ship_mode: 0.005665830116427424, 0.08906820942545286
web_page: 0.006228964495453227, 0.4564062808309068
web_returns: 0.09985718756020054, 0.78466250623405
web_site: 0.00692448188234038, 0.6660475552168621
[]
0
{'27': 166080, '67': 166016, '22': 527488, '39': 527488, '09': 139264, '28': 131072, '42': 0, '47': 0, '11': 4194320, '53': 0, '89': 0, '48': 32, '88': 262400, '46': 304, '06': 48, '08': 48, '34': 272, '36': 0, '43': 0, '55': 0, '73': 272, '07': 4096, '68': 304, '13': 288, '79': 272, '19': 48, '59': 0, '21': 0, '61': 4144, '70': 0, '03': 0, '44': 0, '93': 65536, '98': 0, '63': 0, '65': 0, '52': 0, '82': 0, '31': 4194336, '96': 262400, '50': 65536, '24': 65584, '85': 3145728, '12': 0, '45': 0, '86': 0, '92': 0, '51': 0, '62': 8404992, '90': 1048576, '74': 0, '95': 10485760, '94': 10485760}
{}
{'27': 166080, '67': 166016, '22': 527488, '39': 527488, '09': 139264, '28': 131072, '42': 0, '47': 0, '11': 4194320, '53': 0, '89': 0, '48': 32, '88': 262400, '46': 304, '06': 48, '08': 48, '34': 272, '36': 0, '43': 0, '55': 0, '73': 272, '07': 4096, '68': 304, '13': 288, '79': 272, '19': 48, '59': 0, '21': 0, '61': 4144, '70': 0, '03': 0, '44': 0, '93': 65536, '98': 0, '63': 0, '65': 0, '52': 0, '82': 0, '31': 4194336, '96': 262400, '50': 65536, '24': 65584, '85': 3145728, '12': 0, '45': 0, '86': 0, '92': 0, '51': 0, '62': 8404992, '90': 1048576, '74': 0, '95': 10485760, '94': 10485760}
STARTING PHASE 2: 0b0
----
[]
Function: 10.55770010462168, 4.837618920780819, 0.25082826614379883, 0.22232114070040795, 5.218238114058176, 0.008459962183855396, 0.020233700754624606
{10.55770010462168: []}
Best Cost: $10.55770010462168;
[6, 7, 10, 11, 13, 15, 17, 19, 4, 5, 8, 12, 16, 18, 22, 20, 21, 14, 23]
{'27': 166080, '42': 133248, '85': 7348448, '12': 4196480, '45': 4196528, '47': 166016, '86': 4196480, '11': 4325520, '53': 166016, '89': 166016, '48': 164064, '88': 426240, '46': 164272, '67': 166016, '06': 133296, '08': 164016, '34': 164240, '36': 166016, '22': 527488, '43': 163968, '39': 527488, '55': 133248, '73': 164240, '07': 137408, '92': 4196480, '68': 164272, '13': 164320, '79': 164240, '19': 166064, '59': 163968, '21': 527488, '61': 170160, '51': 4325504, '70': 163968, '03': 133248, '44': 133120, '62': 13123712, '93': 204800, '98': 133248, '63': 166016, '90': 5505280, '65': 166016, '09': 139264, '74': 4325520, '28': 131072, '52': 133248, '82': 134272, '31': 4325536, '96': 426240, '95': 14680224, '50': 229504, '24': 231472, '94': 14680224}
['41', '84', '30', '81', '91', '01', '83']
Excluding table catalog_sales and any queries that depend on it
[6, 7, 10, 11, 13, 15, 17, 19, 4, 5, 8, 12, 16, 18, 22, 20, 21, 14, 23]
dict_keys(['27', '42', '85', '12', '45', '47', '86', '11', '53', '89', '48', '88', '46', '67', '06', '08', '34', '36', '22', '43', '39', '55', '73', '07', '92', '68', '13', '79', '19', '59', '21', '61', '51', '70', '03', '44', '62', '93', '98', '63', '90', '65', '09', '74', '28', '52', '82', '31', '96', '95', '50', '24', '94'])
19
Optimal Subset: 0b111111111111110111110000
dict_keys(['27', '42', '85', '12', '45', '47', '86', '11', '53', '89', '48', '88', '46', '67', '06', '08', '34', '36', '22', '43', '39', '55', '73', '07', '92', '68', '13', '79', '19', '59', '21', '61', '51', '70', '03', '44', '62', '93', '98', '63', '90', '65', '09', '74', '28', '52', '82', '31', '96', '95', '50', '24', '94'])
Function: 10.55770010462168, 4.837618920780819, 0.25082826614379883, 0.22232114070040795, 5.218238114058176, 0.008459962183855396, 0.020233700754624606
Real: 10.55770010462168, 4.837618920780819, 0.25082826614379883, 0.22232114070040795, 5.218238114058176, 0.008459962183855396, 0.020233700754624606
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 53; Num Redshift Qs: 7
PLAN TYPE IS: multi
Moved Qs: $4.837618920780819; Stayed Qs: $0.25082826614379883; Migration Cost: $5.469252917697063
Movement Cost: $0.22232114070040795, Load Cost: $5.218238114058176, Storage Cost: $0.008459962183855396, API Cost: $0.020233700754624606
Final cost: $10.55770010462168, Baseline: $61.903661489486694, Diff: $51.345961384865014, %: 82.94495050762913%
