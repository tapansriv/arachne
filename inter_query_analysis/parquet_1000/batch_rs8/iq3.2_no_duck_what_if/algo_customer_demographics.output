Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $10.571281813770927, BigQuery Total: $103.97772192955017
01: $-0.053216558179855364
02: $-0.031875375076929724
03: $0.46225074385325116
04: $4.086595410804748
05: $1.3774780998261769
06: $0.3156157429854075
08: $0.48762544854164125
09: $4.267598117723465
11: $1.7474326745287576
12: $0.10837940103848775
14: $15.371164026819866
15: $0.18220076550165812
16: $0.5690129777526856
17: $1.0109230725765228
19: $0.6867483040714264
20: $0.23164465132395426
21: $0.13040914547920227
22: $0.7010737974611918
23: $0.9690291706689198
24: $1.4329938850339254
25: $1.1922297933006287
28: $5.065755438566208
29: $1.0155870588302611
30: $-0.06070611572265626
31: $1.7965831590811412
32: $0.48596438729286195
33: $1.0948081830120087
34: $0.6039280316289266
36: $2.5501932117144266
37: $0.14639244778315225
38: $0.3879267294565837
39: $0.27702829706509907
40: $0.4028677000713348
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
45: $0.11165965701738993
46: $1.2257707875823975
47: $0.4219892735958099
49: $1.7678878890864054
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
54: $0.7208397585646311
55: $0.49871100074450175
56: $1.0958423399066926
57: $0.2027771442572276
58: $0.8274850143432617
59: $0.4599690491803487
60: $1.1121361897977193
61: $1.6261143863296508
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
66: $0.7691510609022776
67: $5.390935244779587
68: $1.4640650397332509
70: $1.9079043164030711
71: $1.018561050154368
73: $0.6070841459401448
74: $0.8040276591714223
75: $2.740938346967697
76: $1.0589388700771332
77: $1.2807744638061522
78: $1.4438266993649802
79: $1.2055793523947398
80: $1.6337554561456045
81: $-0.055518914477030445
82: $0.23191760928789776
83: $0.018545273780822748
86: $0.3294791894944509
87: $0.32915039021492004
88: $2.910070013548533
89: $0.5879451856454213
90: $0.15635354908943175
92: $0.21465586846033732
93: $0.7695970211982727
94: $0.29105015072186785
95: $0.2871878468354543
96: $0.3593499286079407
97: $0.4526963858763377
98: $0.4373975418567657
99: $0.24868929240544635
!!!!!!: 93.6390047822412
Excluding table customer_demographics and any queries that depend on it
Total Keys: 85, Keys Considered: 80
[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'23': 4327576, '09': 139264, '94': 14680224, '90': 5505280, '37': 3208, '47': 166016, '22': 527488, '08': 164016, '36': 166016, '63': 166016, '93': 204800, '12': 4196480, '25': 231560, '68': 164272, '67': 166016, '56': 4327592, '80': 14915726, '42': 133248, '04': 4325528, '95': 14680224, '77': 7569548, '83': 2164868, '87': 4325528, '62': 13123712, '31': 4325536, '28': 131072, '05': 14909582, '78': 6488204, '58': 4327560, '11': 4325520, '52': 133248, '61': 170160, '51': 4325504, '19': 166064, '96': 426240, '24': 231472, '49': 6488204, '40': 526476, '38': 4325528, '21': 527488, '92': 4196480, '15': 184, '59': 163968, '73': 164240, '45': 4196528, '71': 4589704, '16': 173, '39': 527488, '32': 2184, '66': 4997256, '57': 2185, '65': 166016, '46': 164272, '33': 4327592, '44': 133120, '53': 166016, '82': 134272, '20': 2184, '06': 133296, '34': 164240, '76': 4327560, '17': 231560, '86': 4196480, '98': 133248, '99': 540809, '29': 231560, '97': 131208, '88': 426240, '14': 4327560, '55': 133248, '43': 163968, '03': 133248, '79': 164240, '50': 229504, '89': 166016, '74': 4325520, '54': 4360376, '60': 4327592, '75': 6490252, '70': 163968}
call_center: 0.006691021782804949, 1.0137883926325546
catalog_page: 0.007001473436037578, 3.0042320825357436
catalog_returns: 0.182443817817153, 11.052643088984706
catalog_sales: 2.1024119944242736, 43.12486283246794
customer: 0.02851696358746853, 18.96587037658307
customer_address: 0.033744755914461695, 14.466509866554485
date_dim: 0.006898420268877828, 77.7373667650205
household_demographics: 0.0061234659530395655, 8.526077382572325
income_band: 0.005805388755664771, -0.005805388755664771
income_band had no query dependencies
inventory: 0.15142412770499342, 1.3353971693715496
item: 0.012846926215646773, 52.50234600055997
promotion: 0.00910023518911767, 3.2507696072861374
reason: 0.00548245721892004, 5.0317126817028175
ship_mode: 0.005665830212225805, 1.1069085626373785
store: 0.007441962691781694, 35.0511204069473
store_returns: 0.32255641594139545, 16.01870571753931
store_sales: 3.283902920174643, 84.39584521879034
time_dim: 0.0072231245940970485, 5.206262477708454
warehouse: 0.006188463999876334, 2.617764868926556
web_page: 0.006228968496894818, 1.430899044398689
web_returns: 0.10019572623834604, 10.741248500296816
web_sales: 1.243558064300955, 44.34490525690799
web_site: 0.006924482583998785, 3.677281110486985
['income_band']
1
call_center: 0.0066910214170182595, 1.0137883929983413
catalog_page: 0.0070014190271337215, 3.0042321369446476
catalog_returns: 0.18205960769445553, 11.053027299107404
customer: 0.028492319677115276, 18.96589502049342
customer_address: 0.033739556567435526, 14.466515065901511
household_demographics: 0.006123464926111793, 8.526077383599253
promotion: 0.009100232856810268, 3.2507696096184446
ship_mode: 0.005665830159454687, 1.1069085626901496
store_returns: 0.3219518875806801, 16.019310245900023
time_dim: 0.0072230889481021895, 5.206262513354449
web_page: 0.006228966292676485, 1.4308990466029075
web_returns: 0.10000924015731194, 10.741434986377849
web_site: 0.006924482197486003, 3.6772811108734977
[]
0
{'09': 139264, '22': 527488, '67': 166016, '28': 131072, '39': 527488, '14': 4327560, '23': 16, '94': 10485792, '90': 1310976, '37': 0, '47': 0, '08': 48, '36': 0, '63': 0, '93': 65536, '12': 0, '25': 65536, '68': 304, '56': 32, '80': 10555398, '42': 0, '04': 16, '95': 10485792, '77': 3211268, '87': 16, '62': 8404992, '31': 32, '05': 10551302, '78': 2162692, '58': 0, '11': 16, '52': 0, '61': 4144, '51': 0, '19': 48, '96': 262400, '24': 65584, '49': 2162692, '40': 4, '38': 16, '21': 0, '92': 0, '15': 48, '59': 0, '73': 272, '45': 48, '71': 262144, '16': 37, '32': 0, '66': 278528, '57': 1, '65': 0, '46': 304, '33': 32, '44': 0, '53': 0, '82': 0, '20': 0, '06': 48, '34': 272, '76': 0, '17': 65536, '86': 0, '98': 0, '99': 16385, '29': 65536, '97': 0, '88': 262400, '55': 0, '43': 0, '03': 0, '79': 272, '50': 65536, '89': 0, '74': 16, '54': 48, '60': 32, '75': 2162692, '70': 0}
{}
{'09': 139264, '22': 527488, '67': 166016, '28': 131072, '39': 527488, '14': 4327560, '23': 16, '94': 10485792, '90': 1310976, '37': 0, '47': 0, '08': 48, '36': 0, '63': 0, '93': 65536, '12': 0, '25': 65536, '68': 304, '56': 32, '80': 10555398, '42': 0, '04': 16, '95': 10485792, '77': 3211268, '87': 16, '62': 8404992, '31': 32, '05': 10551302, '78': 2162692, '58': 0, '11': 16, '52': 0, '61': 4144, '51': 0, '19': 48, '96': 262400, '24': 65584, '49': 2162692, '40': 4, '38': 16, '21': 0, '92': 0, '15': 48, '59': 0, '73': 272, '45': 48, '71': 262144, '16': 37, '32': 0, '66': 278528, '57': 1, '65': 0, '46': 304, '33': 32, '44': 0, '53': 0, '82': 0, '20': 0, '06': 48, '34': 272, '76': 0, '17': 65536, '86': 0, '98': 0, '99': 16385, '29': 65536, '97': 0, '88': 262400, '55': 0, '43': 0, '03': 0, '79': 272, '50': 65536, '89': 0, '74': 16, '54': 48, '60': 32, '75': 2162692, '70': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 18.220379761066994, 9.914469167191186, 0.42424798011779785, 0.33909843165373116, 7.48943955133438, 0.02233269564480708, 0.03079193512509465
{18.220379761066994: []}
Best Cost: $18.220379761066994;
[3, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 4, 5, 8, 12, 14, 16, 18, 20, 21, 23]
{'23': 4327576, '09': 139264, '94': 14680224, '90': 5505280, '37': 3208, '47': 166016, '22': 527488, '08': 164016, '36': 166016, '63': 166016, '93': 204800, '12': 4196480, '25': 231560, '68': 164272, '67': 166016, '56': 4327592, '80': 14915726, '42': 133248, '04': 4325528, '95': 14680224, '77': 7569548, '83': 2164868, '87': 4325528, '62': 13123712, '31': 4325536, '28': 131072, '05': 14909582, '78': 6488204, '58': 4327560, '11': 4325520, '52': 133248, '61': 170160, '51': 4325504, '19': 166064, '96': 426240, '24': 231472, '49': 6488204, '40': 526476, '38': 4325528, '21': 527488, '92': 4196480, '15': 184, '59': 163968, '73': 164240, '45': 4196528, '71': 4589704, '16': 173, '39': 527488, '32': 2184, '66': 4997256, '57': 2185, '65': 166016, '46': 164272, '33': 4327592, '44': 133120, '53': 166016, '82': 134272, '20': 2184, '06': 133296, '34': 164240, '76': 4327560, '17': 231560, '86': 4196480, '98': 133248, '99': 540809, '29': 231560, '97': 131208, '88': 426240, '14': 4327560, '55': 133248, '43': 163968, '03': 133248, '79': 164240, '50': 229504, '89': 166016, '74': 4325520, '54': 4360376, '60': 4327592, '75': 6490252, '70': 163968}
['01', '81', '41', '02', '30']
Excluding table customer_demographics and any queries that depend on it
[3, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 4, 5, 8, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['23', '09', '94', '90', '37', '47', '22', '08', '36', '63', '93', '12', '25', '68', '67', '56', '80', '42', '04', '95', '77', '83', '87', '62', '31', '28', '05', '78', '58', '11', '52', '61', '51', '19', '96', '24', '49', '40', '38', '21', '92', '15', '59', '73', '45', '71', '16', '39', '32', '66', '57', '65', '46', '33', '44', '53', '82', '20', '06', '34', '76', '17', '86', '98', '99', '29', '97', '88', '14', '55', '43', '03', '79', '50', '89', '74', '54', '60', '75', '70'])
22
Optimal Subset: 0b111111111111110110111111
dict_keys(['23', '09', '94', '90', '37', '47', '22', '08', '36', '63', '93', '12', '25', '68', '67', '56', '80', '42', '04', '95', '77', '83', '87', '62', '31', '28', '05', '78', '58', '11', '52', '61', '51', '19', '96', '24', '49', '40', '38', '21', '92', '15', '59', '73', '45', '71', '16', '39', '32', '66', '57', '65', '46', '33', '44', '53', '82', '20', '06', '34', '76', '17', '86', '98', '99', '29', '97', '88', '14', '55', '43', '03', '79', '50', '89', '74', '54', '60', '75', '70'])
Function: 18.220379761066994, 9.914469167191186, 0.42424798011779785, 0.33909843165373116, 7.48943955133438, 0.02233269564480708, 0.03079193512509465
Real: 18.220379761066994, 9.914469167191186, 0.42424798011779785, 0.33909843165373116, 7.48943955133438, 0.02233269564480708, 0.03079193512509465
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 80; Num Redshift Qs: 5
PLAN TYPE IS: move
Moved Qs: $9.914469167191186; Stayed Qs: $0.42424798011779785; Migration Cost: $7.881662613758013
Movement Cost: $0.33909843165373116, Load Cost: $7.48943955133438, Storage Cost: $0.02233269564480708, API Cost: $0.03079193512509465
Final cost: $18.220379761066994, Baseline: $103.97772192955017, Diff: $85.75734216848318, %: 82.47665036034145%
