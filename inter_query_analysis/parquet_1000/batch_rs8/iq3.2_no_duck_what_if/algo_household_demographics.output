Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs8
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $8.688/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: household_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $11.287764655564624, BigQuery Total: $108.41442346572876
01: $-0.053216558179855364
02: $-0.031875375076929724
03: $0.46225074385325116
04: $4.086595410804748
05: $1.3774780998261769
06: $0.3156157429854075
07: $1.340530101292928
08: $0.48762544854164125
09: $4.267598117723465
10: $0.31066071114857996
11: $1.7474326745287576
12: $0.10837940103848775
14: $15.371164026819866
15: $0.18220076550165812
16: $0.5690129777526856
17: $1.0109230725765228
18: $3.9880419502385456
19: $0.6867483040714264
20: $0.23164465132395426
21: $0.13040914547920227
22: $0.7010737974611918
23: $0.9690291706689198
24: $1.4329938850339254
25: $1.1922297933006287
26: $0.6698881686592102
27: $4.0225541106828056
28: $5.065755438566208
29: $1.0155870588302611
30: $-0.06070611572265626
31: $1.7965831590811412
32: $0.48596438729286195
33: $1.0948081830120087
35: $0.38853899744351705
36: $2.5501932117144266
37: $0.14639244778315225
38: $0.3879267294565837
39: $0.27702829706509907
40: $0.4028677000713348
41: $-0.03124770300547282
42: $0.4782423514938354
43: $0.49939987057685853
44: $0.933021643184026
45: $0.11165965701738993
47: $0.4219892735958099
48: $1.067886776456833
49: $1.7678878890864054
50: $0.6567250735632578
51: $0.5606309763081868
52: $0.49541739279111224
53: $0.6035668335342407
54: $0.7208397585646311
55: $0.49871100074450175
56: $1.0958423399066926
57: $0.2027771442572276
58: $0.8274850143432617
59: $0.4599690491803487
60: $1.1121361897977193
61: $1.6261143863296508
62: $0.09473403954188028
63: $0.6001995995076498
65: $0.5388176846758524
66: $0.7691510609022776
67: $5.390935244779587
69: $0.1580370307509104
70: $1.9079043164030711
71: $1.018561050154368
74: $0.8040276591714223
75: $2.740938346967697
76: $1.0589388700771332
77: $1.2807744638061522
78: $1.4438266993649802
80: $1.6337554561456045
81: $-0.055518914477030445
82: $0.23191760928789776
83: $0.018545273780822748
85: $0.3062816962369283
86: $0.3294791894944509
87: $0.32915039021492004
89: $0.5879451856454213
92: $0.21465586846033732
93: $0.7695970211982727
94: $0.29105015072186785
95: $0.2871878468354543
97: $0.4526963858763377
98: $0.4373975418567657
99: $0.24868929240544635
!!!!!!: 97.3592234766261
Excluding table household_demographics and any queries that depend on it
Total Keys: 86, Keys Considered: 81
[0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'10': 4325624, '85': 7348448, '44': 133120, '23': 4327576, '51': 4325504, '49': 6488204, '07': 137408, '29': 231560, '93': 204800, '66': 4997256, '27': 166080, '62': 13123712, '35': 4325624, '19': 166064, '18': 2296, '24': 231472, '31': 4325536, '40': 526476, '65': 166016, '21': 527488, '17': 231560, '92': 4196480, '03': 133248, '06': 133296, '38': 4325528, '33': 4327592, '77': 7569548, '53': 166016, '99': 540809, '16': 173, '63': 166016, '89': 166016, '98': 133248, '05': 14909582, '28': 131072, '20': 2184, '86': 4196480, '14': 4327560, '43': 163968, '55': 133248, '69': 4325624, '80': 14915726, '61': 170160, '25': 231560, '94': 14680224, '70': 163968, '52': 133248, '48': 164064, '45': 4196528, '87': 4325528, '08': 164016, '09': 139264, '82': 134272, '95': 14680224, '37': 3208, '12': 4196480, '56': 4327592, '67': 166016, '36': 166016, '42': 133248, '32': 2184, '97': 131208, '15': 184, '71': 4589704, '59': 163968, '04': 4325528, '75': 6490252, '76': 4327560, '22': 527488, '39': 527488, '26': 6344, '83': 2164868, '47': 166016, '54': 4360376, '58': 4327560, '60': 4327592, '78': 6488204, '57': 2185, '74': 4325520, '11': 4325520, '50': 229504}
call_center: 0.006691021812094928, 1.0137883926032645
catalog_page: 0.0070014777927725775, 3.0042320781790086
catalog_returns: 0.18247458303332809, 11.052612323768532
catalog_sales: 2.102699177015609, 48.639742508117365
customer: 0.02851893692233044, 18.7047197355503
customer_address: 0.033745172246634585, 17.996120785181976
customer_demographics: 0.009095258692158301, 12.2433242842181
date_dim: 0.006898424862097702, 84.88335894605808
income_band: 0.005805388757270933, -0.005805388757270933
income_band had no query dependencies
inventory: 0.15143754562274073, 1.3353837514538023
item: 0.012847006067206535, 62.5233602515819
promotion: 0.0091002353758747, 5.261187877051519
reason: 0.005482457223203949, 5.337994377935463
ship_mode: 0.005665830216451396, 1.106908562633153
store: 0.0074419629391816655, 31.765713994403608
store_returns: 0.32260482290571696, 16.01865731057499
store_sales: 3.284283342823703, 83.30782522448092
time_dim: 0.007223127448412104, 1.7804889836082336
warehouse: 0.006188464009202278, 2.61776486891723
web_page: 0.006228968673395252, 1.5808271913696854
web_returns: 0.10021065891257226, 11.047515263859516
web_sales: 1.243703656618394, 45.35192455108107
web_site: 0.006924482614948384, 3.6772811104560352
['income_band']
1
call_center: 0.006691021427320778, 1.0137883929880387
catalog_page: 0.007001420559580887, 3.0042321354122006
catalog_returns: 0.1820704291165321, 11.053016477685327
promotion: 0.009100232922500581, 5.2611878795048925
ship_mode: 0.0056658301609410055, 1.1069085626886634
store_returns: 0.32196891434848784, 16.01929321913222
time_dim: 0.007223089952084993, 1.7804890211045605
web_page: 0.00622896635475912, 1.5808271936883214
web_returns: 0.10001449260766412, 11.047711430164425
web_site: 0.00692448220837228, 3.6772811108626113
[]
0
{'27': 166080, '18': 2296, '28': 131072, '14': 4327560, '09': 139264, '67': 166016, '22': 527488, '39': 527488, '10': 0, '85': 3145728, '44': 0, '23': 0, '51': 0, '49': 2162692, '07': 4096, '29': 65536, '93': 65536, '66': 278528, '62': 8404992, '35': 0, '19': 0, '24': 65536, '31': 0, '40': 4, '65': 0, '21': 0, '17': 65536, '92': 0, '03': 0, '06': 0, '38': 0, '33': 0, '77': 3211268, '53': 0, '99': 16385, '16': 5, '63': 0, '89': 0, '98': 0, '05': 10551302, '20': 0, '86': 0, '43': 0, '55': 0, '69': 0, '80': 10555398, '61': 4096, '25': 65536, '94': 10485760, '70': 0, '52': 0, '48': 0, '45': 0, '87': 0, '08': 0, '82': 0, '95': 10485760, '37': 0, '12': 0, '56': 0, '36': 0, '42': 0, '32': 0, '97': 0, '15': 0, '71': 262144, '59': 0, '04': 0, '75': 2162692, '76': 0, '26': 4096, '47': 0, '54': 0, '58': 0, '60': 0, '78': 2162692, '57': 1, '74': 0, '11': 0, '50': 65536}
{}
{'27': 166080, '18': 2296, '28': 131072, '14': 4327560, '09': 139264, '67': 166016, '22': 527488, '39': 527488, '10': 0, '85': 3145728, '44': 0, '23': 0, '51': 0, '49': 2162692, '07': 4096, '29': 65536, '93': 65536, '66': 278528, '62': 8404992, '35': 0, '19': 0, '24': 65536, '31': 0, '40': 4, '65': 0, '21': 0, '17': 65536, '92': 0, '03': 0, '06': 0, '38': 0, '33': 0, '77': 3211268, '53': 0, '99': 16385, '16': 5, '63': 0, '89': 0, '98': 0, '05': 10551302, '20': 0, '86': 0, '43': 0, '55': 0, '69': 0, '80': 10555398, '61': 4096, '25': 65536, '94': 10485760, '70': 0, '52': 0, '48': 0, '45': 0, '87': 0, '08': 0, '82': 0, '95': 10485760, '37': 0, '12': 0, '56': 0, '36': 0, '42': 0, '32': 0, '97': 0, '15': 0, '71': 262144, '59': 0, '04': 0, '75': 2162692, '76': 0, '26': 4096, '47': 0, '54': 0, '58': 0, '60': 0, '78': 2162692, '57': 1, '74': 0, '11': 0, '50': 65536}
STARTING PHASE 2: 0b0
----
[]
Function: 18.94076624611868, 10.630952008984883, 0.42424798011779785, 0.33910708002035966, 7.492409970976512, 0.02325649118737877, 0.030792714831748603
{18.94076624611868: []}
Best Cost: $18.94076624611868;
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 12, 14, 16, 18, 20, 21, 23]
{'10': 4325624, '85': 7348448, '44': 133120, '23': 4327576, '51': 4325504, '49': 6488204, '07': 137408, '29': 231560, '93': 204800, '66': 4997256, '27': 166080, '62': 13123712, '35': 4325624, '19': 166064, '18': 2296, '24': 231472, '31': 4325536, '40': 526476, '65': 166016, '21': 527488, '17': 231560, '92': 4196480, '03': 133248, '06': 133296, '38': 4325528, '33': 4327592, '77': 7569548, '53': 166016, '99': 540809, '16': 173, '63': 166016, '89': 166016, '98': 133248, '05': 14909582, '28': 131072, '20': 2184, '86': 4196480, '14': 4327560, '43': 163968, '55': 133248, '69': 4325624, '80': 14915726, '61': 170160, '25': 231560, '94': 14680224, '70': 163968, '52': 133248, '48': 164064, '45': 4196528, '87': 4325528, '08': 164016, '09': 139264, '82': 134272, '95': 14680224, '37': 3208, '12': 4196480, '56': 4327592, '67': 166016, '36': 166016, '42': 133248, '32': 2184, '97': 131208, '15': 184, '71': 4589704, '59': 163968, '04': 4325528, '75': 6490252, '76': 4327560, '22': 527488, '39': 527488, '26': 6344, '83': 2164868, '47': 166016, '54': 4360376, '58': 4327560, '60': 4327592, '78': 6488204, '57': 2185, '74': 4325520, '11': 4325520, '50': 229504}
['41', '81', '02', '30', '01']
Excluding table household_demographics and any queries that depend on it
[3, 4, 5, 6, 7, 10, 11, 13, 15, 17, 19, 22, 0, 1, 2, 12, 14, 16, 18, 20, 21, 23]
dict_keys(['10', '85', '44', '23', '51', '49', '07', '29', '93', '66', '27', '62', '35', '19', '18', '24', '31', '40', '65', '21', '17', '92', '03', '06', '38', '33', '77', '53', '99', '16', '63', '89', '98', '05', '28', '20', '86', '14', '43', '55', '69', '80', '61', '25', '94', '70', '52', '48', '45', '87', '08', '09', '82', '95', '37', '12', '56', '67', '36', '42', '32', '97', '15', '71', '59', '04', '75', '76', '22', '39', '26', '83', '47', '54', '58', '60', '78', '57', '74', '11', '50'])
22
Optimal Subset: 0b111111111111110011111111
dict_keys(['10', '85', '44', '23', '51', '49', '07', '29', '93', '66', '27', '62', '35', '19', '18', '24', '31', '40', '65', '21', '17', '92', '03', '06', '38', '33', '77', '53', '99', '16', '63', '89', '98', '05', '28', '20', '86', '14', '43', '55', '69', '80', '61', '25', '94', '70', '52', '48', '45', '87', '08', '09', '82', '95', '37', '12', '56', '67', '36', '42', '32', '97', '15', '71', '59', '04', '75', '76', '22', '39', '26', '83', '47', '54', '58', '60', '78', '57', '74', '11', '50'])
Function: 18.94076624611868, 10.630952008984883, 0.42424798011779785, 0.33910708002035966, 7.492409970976512, 0.02325649118737877, 0.030792714831748603
Real: 18.94076624611868, 10.630952008984883, 0.42424798011779785, 0.33910708002035966, 7.492409970976512, 0.02325649118737877, 0.030792714831748603
outputs_noduck_GCP_0.0_8.688_6.25.json
Num GCP Qs: 81; Num Redshift Qs: 5
PLAN TYPE IS: move
Moved Qs: $10.630952008984883; Stayed Qs: $0.42424798011779785; Migration Cost: $7.885566257015999
Movement Cost: $0.33910708002035966, Load Cost: $7.492409970976512, Storage Cost: $0.02325649118737877, API Cost: $0.030792714831748603
Final cost: $18.94076624611868, Baseline: $108.41442346572876, Diff: $89.47365721961008, %: 82.52929302150824%
