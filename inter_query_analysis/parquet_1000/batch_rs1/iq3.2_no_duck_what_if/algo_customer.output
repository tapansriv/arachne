Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $3.9937956229889386, BigQuery Total: $92.02776551246643
02: $0.1979243566441536
03: $0.4866440628564358
05: $1.5044740550923348
07: $1.3374056270329158
09: $4.248445393978358
12: $0.12269529073079427
13: $1.6977783234190942
14: $15.676966815438668
16: $0.562377244142294
17: $1.0243916837350526
20: $0.24317620974938076
21: $0.1387422318736712
22: $0.6777517994610468
25: $1.2151110610580445
26: $0.6627730558645726
27: $4.039140143409967
28: $5.05564576346914
29: $1.008115198913018
31: $1.8245650356054306
32: $0.5059927403712272
33: $1.1204768265342713
36: $2.580908335088094
37: $0.1680234264612198
39: $0.27729525789340337
40: $0.41494580126245817
41: $-0.0020452812047799434
42: $0.4939140515724818
43: $0.4999059917163849
44: $0.9402832753022512
47: $0.533098953530391
48: $1.1001106623999277
49: $1.8524754285796483
50: $0.636143891582489
51: $0.5666715289783477
52: $0.49561849385698636
53: $0.6177303631850084
55: $0.4950001102173328
56: $1.1193761416093508
57: $0.2881193407158057
58: $0.8547409833705425
59: $0.46271400184750555
60: $1.1203978869223594
62: $0.15670985938986143
63: $0.6185007683968544
65: $0.5998246012810866
66: $0.8397971375628313
67: $6.3270267018338044
70: $1.96793873002251
71: $1.1012624587861697
72: $0.44518852136810616
75: $2.824817998680671
76: $1.0871748799737295
77: $1.4439764900155863
78: $1.7110126293476422
80: $2.012618472306331
82: $0.23054074777682623
83: $0.05543757183273633
85: $0.31475607653776805
86: $0.3798482982075214
88: $2.9330518760355315
89: $0.6237626295518875
90: $0.19219698321262996
92: $0.25097833294153216
93: $0.7894184744238854
94: $0.3066015665193399
95: $0.3133311781525612
96: $0.36783203990538915
97: $0.5135906607317925
98: $0.5017486539173126
99: $0.2590039864985148
!!!!!!: 88.03601517068229
Excluding table customer and any queries that depend on it
Total Keys: 70, Keys Considered: 69
[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'52': 133248, '47': 166016, '43': 163968, '94': 14680224, '48': 164064, '32': 2184, '86': 4196480, '60': 4327592, '63': 166016, '85': 7348448, '25': 231560, '59': 163968, '13': 164320, '98': 133248, '28': 131072, '53': 166016, '05': 14909582, '77': 7569548, '66': 4997256, '56': 4327592, '67': 166016, '62': 13123712, '97': 131208, '90': 5505280, '29': 231560, '42': 133248, '55': 133248, '99': 540809, '76': 4327560, '58': 4327560, '26': 6344, '50': 229504, '89': 166016, '16': 173, '39': 527488, '20': 2184, '12': 4196480, '93': 204800, '07': 137408, '57': 2185, '96': 426240, '88': 426240, '78': 6488204, '82': 134272, '33': 4327592, '03': 133248, '49': 6488204, '72': 531916, '36': 166016, '95': 14680224, '02': 4194440, '71': 4589704, '70': 163968, '21': 527488, '31': 4325536, '40': 526476, '51': 4325504, '80': 14915726, '92': 4196480, '65': 166016, '17': 231560, '14': 4327560, '83': 2164868, '22': 527488, '44': 133120, '27': 166080, '75': 6490252, '37': 3208, '09': 139264}
call_center: 0.00024082692066681883, 1.1092597444359478
catalog_page: 0.0005952117455664422, 3.5164973156530994
catalog_returns: 0.1327215258551417, 12.694602686772667
catalog_sales: 1.486351018181938, 40.29195047355384
customer_address: 0.0053676667698191, 9.474403275072577
customer_demographics: 0.001549168714892175, 9.595603241317459
date_dim: 0.0009391657661062999, 73.50820219858898
household_demographics: 0.0008263356944779424, 5.635221408246273
income_band: 0.0006905003875370899, -0.0006905003875370899
income_band had no query dependencies
inventory: 0.12765515931805602, 1.8098868255162175
item: 0.0018181760402341972, 55.71574762883109
promotion: 0.001763964565682105, 4.456221712006244
reason: 0.0005364608719044012, 5.352083484068107
ship_mode: 0.0007108839861152904, 1.2548000994650923
store: 0.0008100557984510055, 33.81334491852784
store_returns: 0.2576998563252859, 15.820293099242154
store_sales: 2.1948395558076963, 78.06750934748115
time_dim: 0.0007268787559065486, 5.433413616746646
warehouse: 0.000969589750033402, 3.20846500555986
web_page: 0.0017170908716930735, 1.9492124588942912
web_returns: 0.07065212295641435, 12.268849344108204
web_sales: 0.8886281288493165, 38.00721858229076
web_site: 0.0008463060090755269, 4.292888825451353
['income_band']
1
call_center: 0.00024082501418879433, 1.1092597463424259
catalog_page: 0.0005949281666872268, 3.516497599231979
catalog_returns: 0.13071902500957708, 12.69660518761823
customer_address: 0.005340567804432191, 9.474430374037965
promotion: 0.0017639524097099789, 4.456221724162217
ship_mode: 0.0007108837110725424, 1.254800099740135
store_returns: 0.2545490581500553, 15.823443897417384
web_page: 0.0017170793833203952, 1.9492124703826639
web_returns: 0.06968015862519115, 12.269821308439427
web_site: 0.0008463039945732374, 4.2928888274658545
[]
0
{'28': 131072, '67': 166016, '39': 527488, '88': 426240, '36': 166016, '21': 527488, '14': 4327560, '22': 527488, '27': 166080, '09': 139264, '52': 0, '47': 0, '43': 0, '94': 10485792, '48': 32, '32': 0, '86': 0, '60': 32, '63': 0, '85': 3145760, '25': 65536, '59': 0, '13': 32, '98': 0, '53': 0, '05': 10551302, '77': 3211268, '66': 16384, '56': 32, '62': 8404992, '97': 0, '90': 1048576, '29': 65536, '42': 0, '55': 0, '99': 16385, '76': 0, '58': 0, '26': 4096, '50': 65536, '89': 0, '16': 37, '20': 0, '12': 0, '93': 65536, '07': 4096, '57': 1, '96': 0, '78': 2162692, '82': 0, '33': 32, '03': 0, '49': 2162692, '72': 4100, '95': 10485792, '02': 0, '71': 0, '70': 0, '31': 32, '40': 4, '51': 0, '80': 10555398, '92': 0, '65': 0, '17': 65536, '44': 0, '75': 2162692, '37': 0}
{}
{'28': 131072, '67': 166016, '39': 527488, '88': 426240, '36': 166016, '21': 527488, '14': 4327560, '22': 527488, '27': 166080, '09': 139264, '52': 0, '47': 0, '43': 0, '94': 10485792, '48': 32, '32': 0, '86': 0, '60': 32, '63': 0, '85': 3145760, '25': 65536, '59': 0, '13': 32, '98': 0, '53': 0, '05': 10551302, '77': 3211268, '66': 16384, '56': 32, '62': 8404992, '97': 0, '90': 1048576, '29': 65536, '42': 0, '55': 0, '99': 16385, '76': 0, '58': 0, '26': 4096, '50': 65536, '89': 0, '16': 37, '20': 0, '12': 0, '93': 65536, '07': 4096, '57': 1, '96': 0, '78': 2162692, '82': 0, '33': 32, '03': 0, '49': 2162692, '72': 4100, '95': 10485792, '02': 0, '71': 0, '70': 0, '31': 32, '40': 4, '51': 0, '80': 10555398, '92': 0, '65': 0, '17': 65536, '44': 0, '75': 2162692, '37': 0}
STARTING PHASE 2: 0b0
----
[]
Function: 9.508090811466092, 3.991601330172221, 0.00014901161193847656, 0.33838229111686813, 5.05456262727499, 0.09266818090486105, 0.030727370385214683
{9.508090811466092: []}
Best Cost: $9.508090811466092;
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
{'52': 133248, '47': 166016, '43': 163968, '94': 14680224, '48': 164064, '32': 2184, '86': 4196480, '60': 4327592, '63': 166016, '85': 7348448, '25': 231560, '59': 163968, '13': 164320, '98': 133248, '28': 131072, '53': 166016, '05': 14909582, '77': 7569548, '66': 4997256, '56': 4327592, '67': 166016, '62': 13123712, '97': 131208, '90': 5505280, '29': 231560, '42': 133248, '55': 133248, '99': 540809, '76': 4327560, '58': 4327560, '26': 6344, '50': 229504, '89': 166016, '16': 173, '39': 527488, '20': 2184, '12': 4196480, '93': 204800, '07': 137408, '57': 2185, '96': 426240, '88': 426240, '78': 6488204, '82': 134272, '33': 4327592, '03': 133248, '49': 6488204, '72': 531916, '36': 166016, '95': 14680224, '02': 4194440, '71': 4589704, '70': 163968, '21': 527488, '31': 4325536, '40': 526476, '51': 4325504, '80': 14915726, '92': 4196480, '65': 166016, '17': 231560, '14': 4327560, '83': 2164868, '22': 527488, '44': 133120, '27': 166080, '75': 6490252, '37': 3208, '09': 139264}
['41']
Excluding table customer and any queries that depend on it
[3, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 5, 12, 14, 16, 20, 21, 23]
dict_keys(['52', '47', '43', '94', '48', '32', '86', '60', '63', '85', '25', '59', '13', '98', '28', '53', '05', '77', '66', '56', '67', '62', '97', '90', '29', '42', '55', '99', '76', '58', '26', '50', '89', '16', '39', '20', '12', '93', '07', '57', '96', '88', '78', '82', '33', '03', '49', '72', '36', '95', '02', '71', '70', '21', '31', '40', '51', '80', '92', '65', '17', '14', '83', '22', '44', '27', '75', '37', '09'])
22
Optimal Subset: 0b111111111111110111101111
dict_keys(['52', '47', '43', '94', '48', '32', '86', '60', '63', '85', '25', '59', '13', '98', '28', '53', '05', '77', '66', '56', '67', '62', '97', '90', '29', '42', '55', '99', '76', '58', '26', '50', '89', '16', '39', '20', '12', '93', '07', '57', '96', '88', '78', '82', '33', '03', '49', '72', '36', '95', '02', '71', '70', '21', '31', '40', '51', '80', '92', '65', '17', '14', '83', '22', '44', '27', '75', '37', '09'])
Function: 9.508090811466092, 3.991601330172221, 0.00014901161193847656, 0.33838229111686813, 5.05456262727499, 0.09266818090486105, 0.030727370385214683
Real: 9.508090811466092, 3.991601330172221, 0.00014901161193847656, 0.33838229111686813, 5.05456262727499, 0.09266818090486105, 0.030727370385214683
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 69; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $3.991601330172221; Stayed Qs: $0.00014901161193847656; Migration Cost: $5.516340469681934
Movement Cost: $0.33838229111686813, Load Cost: $5.05456262727499, Storage Cost: $0.09266818090486105, API Cost: $0.030727370385214683
Final cost: $9.508090811466092, Baseline: $92.02776551246643, Diff: $82.51967470100034, %: 89.66823679949277%
