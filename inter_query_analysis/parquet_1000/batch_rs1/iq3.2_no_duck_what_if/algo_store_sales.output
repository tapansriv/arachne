Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs1
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: store_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $1.1749217638281986, BigQuery Total: $13.549596071243286
01: $0.037222000787258146
02: $0.1979243566441536
12: $0.12269529073079427
15: $0.2284794372812907
16: $0.562377244142294
18: $4.111526602065563
20: $0.24317620974938076
21: $0.1387422318736712
22: $0.6777517994610468
26: $0.6627730558645726
30: $0.009960597354968388
32: $0.5059927403712272
37: $0.1680234264612198
39: $0.27729525789340337
40: $0.41494580126245817
41: $-0.0020452812047799434
45: $0.1519291462512811
57: $0.2881193407158057
62: $0.15670985938986143
66: $0.8397971375628313
72: $0.44518852136810616
81: $0.019239308624267575
83: $0.05543757183273633
84: $0.012719620297749836
85: $0.31475607653776805
86: $0.3798482982075214
90: $0.19219698321262996
91: $0.03197660856405894
92: $0.25097833294153216
94: $0.3066015665193399
95: $0.3133311781525612
99: $0.2590039864985148
!!!!!!: 12.376719588619867
Excluding table store_sales and any queries that depend on it
Total Keys: 32, Keys Considered: 31
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23]
{'92': 4196480, '91': 501, '20': 2184, '99': 540809, '30': 2097328, '84': 66416, '26': 6344, '66': 4997256, '45': 4196528, '22': 527488, '40': 526476, '12': 4196480, '85': 7348448, '16': 173, '72': 531916, '81': 180, '62': 13123712, '86': 4196480, '83': 2164868, '57': 2185, '21': 527488, '95': 14680224, '94': 14680224, '39': 527488, '90': 5505280, '02': 4194440, '37': 3208, '01': 98448, '18': 2296, '32': 2184, '15': 184}
call_center: 0.00024082530768843464, 1.1412363546129851
catalog_page: 0.0005949718232612773, -0.0005949718232612773
catalog_page had no query dependencies
catalog_returns: 0.1310273072296504, 1.3981377485642705
catalog_sales: 1.470536076645738, 7.45679178334168
customer: 0.010528960791385862, 4.592524360435052
customer_address: 0.005344739652463951, 6.057552646138679
customer_demographics: 0.0015478675605294508, 5.577392617137289
date_dim: 0.0009389128207469385, 12.17086407228874
household_demographics: 0.0008263311661220855, 0.6812554022764228
income_band: 0.0006905002990868897, 0.012029119998662947
inventory: 0.12691624410831331, 1.5800849929491338
item: 0.001813778671496321, 8.892609848378823
promotion: 0.001763954281104981, 1.1061976229515738
reason: 0.0005364606359925967, 0.31421961590177544
ship_mode: 0.0007108837534149909, 1.2548000996977926
store: 0.000810042174310124, 0.03641195861294802
store_returns: 0.25503411914696544, -0.14965492622922114
time_dim: 0.0007267215708017162, 1.0312673992046595
warehouse: 0.0009695892364602281, 3.2084650060734328
web_page: 0.0017170811519393908, 0.5052359785984586
web_returns: 0.06982979118216372, 0.9302571992152102
web_sales: 0.8806104632320781, 2.346157762918196
web_site: 0.0008463043047030631, 0.7757962997570593
['catalog_page', 'store_returns']
2
call_center: 0.00024082463315937662, 1.1412363552875142
catalog_returns: 0.13031880443459296, 1.3434086795265918
household_demographics: 0.0008263292724156102, 0.6685357838723794
income_band: 0.0006905002620980307, -0.0006905002620980307
income_band had no query dependencies
promotion: 0.0017639499802128006, 1.1061976272524658
reason: 0.0005364605373369862, 0.3142196160004311
ship_mode: 0.0007108836561023949, 1.254800099795105
store: 0.0008100364768506878, -0.0008100364768506878
store had no query dependencies
time_dim: 0.0007266558377939216, 1.0312674649376674
web_page: 0.0017170770872498946, 0.5052359826631481
web_returns: 0.06948590146701426, 0.8751635170976233
web_sales: 0.8772575674403665, 2.349510658709908
web_site: 0.0008463035919540493, 0.7757963004698084
['income_band', 'store']
2
reason: 0.0005364605011480044, 0.31421961603662
time_dim: 0.0007266317255249297, 1.0312674890499363
web_page: 0.0017170755962351092, 0.5052359841541628
web_returns: 0.0693597553861727, 0.8752896631784649
web_sales: 0.8760276537646674, 2.350740572385607
web_site: 0.0008463033305025119, 0.7757963007312599
[]
0
reason: 0.0005364604999800979, 0.314219616037788
time_dim: 0.0007266309473632795, 1.031267489828098
web_page: 0.0017170755481164305, 0.5052359842022816
web_returns: 0.06935568434489225, 0.8752937342197453
web_sales: 0.8759879614546745, 2.3507802646956
web_site: 0.000846303322064834, 0.7757963007396976
[]
0
{'22': 527488, '21': 527488, '39': 527488, '18': 2296, '20': 0, '99': 16385, '26': 4096, '40': 4, '16': 5, '72': 4356, '57': 1, '37': 0, '32': 0, '15': 0, '91': 0, '81': 0}
{}
{'22': 527488, '21': 527488, '39': 527488, '18': 2296, '20': 0, '99': 16385, '26': 4096, '40': 4, '16': 5, '72': 4356, '57': 1, '37': 0, '32': 0, '15': 0, '91': 0, '81': 0}
STARTING PHASE 2: 0b111101000010000000000000
----
[13, 18, 20, 21, 22, 23]
Function: 4.1656446459243375, 1.128278468357325, 0.1499772071838379, 0.1815934308855406, 2.6683619911527634, 0.020871716245554905, 0.016561832099315523
reason: 0.0005364604999800979, 0.314219616037788
time_dim: 0.0007266309473632795, 1.031267489828098
web_page: 0.0017170755481164305, 0.5052359842022816
web_returns: 0.06935568434489225, 0.8752937342197453
web_sales: 0.8759879614546745, 2.3507802646956
web_site: 0.000846303322064834, 0.7757963007396976
time_dim: 0.000726630523034705, 1.0312674902524266
web_page: 0.0017170755218774989, 0.19047990769075246
web_returns: 0.06935346442163709, 0.5605398776052324
web_sales: 0.875966317389696, 2.0360458322228103
web_site: 0.0008463033174638004, 0.7757963007442986
[]
0
Function: 4.47979076292105, 1.1154354962805912, 0.47757625579833984, 0.18159342931203232, 2.6678355308536688, 0.0207982187189636, 0.01655183195745349
hiya: 0b111101000000000000000000, 4.47979076292105
time_dim: 0.000726630523034705, 1.0312674902524266
web_page: 0.0017170755218774989, 0.19047990769075246
web_returns: 0.06935346442163709, 0.5605398776052324
web_sales: 0.875966317389696, 2.0360458322228103
web_site: 0.0008463033174638004, 0.7757963007442986
time_dim: 0.0007266303347850851, 0.8390705072280462
web_returns: 0.06935247957231505, 0.5605408624545545
web_sales: 0.8759567151916602, 1.8438584512082161
web_site: 0.0008463033154225926, 0.7757963007463399
[]
0
Function: 4.6702379943266354, 1.1112113331003988, 0.6739974021911621, 0.18159336448224103, 2.6661284635821976, 0.020765604858011263, 0.016541826112625006
hiya: 0b111001000000000000000000, 4.6702379943266354
time_dim: 0.0007266303347850851, 0.8390705072280462
web_returns: 0.06935247957231505, 0.5605408624545545
web_sales: 0.8759567151916602, 1.8438584512082161
web_site: 0.0008463033154225926, 0.7757963007463399
time_dim: 0.0007266252973242533, 0.839070512265507
web_sales: 0.8756997654218194, 1.224182656306156
web_site: 0.0008463032608009442, 0.15586355612906047
[]
0
Function: 5.22402313841362, 1.0211401708853247, 1.3939619064331055, 0.1761084932577408, 2.5974830180215833, 0.019292220615028135, 0.016037329200837017
hiya: 0b110001000000000000000000, 5.22402313841362
time_dim: 0.0007266252973242533, 0.839070512265507
web_sales: 0.8756997654218194, 1.224182656306156
web_site: 0.0008463032608009442, 0.15586355612906047
time_dim: 0.0007266250495478191, 0.8390705125132835
web_sales: 0.8756871268922377, 1.067485435445876
[]
0
Function: 5.379845061581226, 1.0141697152574858, 1.5576422214508057, 0.17610848188974584, 2.5966467161508398, 0.019250598656410198, 0.01602732817593813
hiya: 0b10001000000000000000000, 5.379845061581226
time_dim: 0.0007266250495478191, 0.8390705125132835
web_sales: 0.8756871268922377, 1.067485435445876
web_sales: 0.8756191978162156, 0.22775622695906694
[]
0
Function: 6.218690744456413, 0.972926756537358, 2.4386823177337646, 0.17610743348071506, 2.595930219051043, 0.019026783998505117, 0.016017233655026556
hiya: 0b10000000000000000000000, 6.218690744456413
web_sales: 0.8756191978162156, 0.22775622695906694
Function: 6.385075104046864, 0.8307856426926454, 3.6841988563537598, 0.12263040047693842, 1.7267795268328987, 0.00949474732414399, 0.01118593036647737
hiya: 0b0, 6.385075104046864
{4.1656446459243375: [13, 18, 20, 21, 22, 23], 4.47979076292105: [18, 20, 21, 22, 23], 4.6702379943266354: [18, 21, 22, 23], 5.22402313841362: [18, 22, 23], 5.379845061581226: [18, 22], 6.218690744456413: [22], 6.385075104046864: []}
Best Cost: $4.1656446459243375;
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 10, 11, 19, 0, 2, 8, 12, 14]
{'92': 4196480, '91': 501, '20': 2184, '99': 540809, '30': 2097328, '26': 6344, '66': 4997256, '45': 4196528, '22': 527488, '40': 526476, '12': 4196480, '85': 7348448, '16': 173, '72': 531916, '81': 180, '62': 13123712, '86': 4196480, '57': 2185, '21': 527488, '95': 14680224, '94': 14680224, '39': 527488, '90': 5505280, '02': 4194440, '37': 3208, '18': 2296, '32': 2184, '15': 184}
['84', '41', '83', '01']
Excluding table store_sales and any queries that depend on it
[13, 18, 20, 21, 22, 23, 3, 4, 5, 6, 7, 10, 11, 19, 0, 2, 8, 12, 14]
dict_keys(['92', '91', '20', '99', '30', '26', '66', '45', '22', '40', '12', '85', '16', '72', '81', '62', '86', '57', '21', '95', '94', '39', '90', '02', '37', '18', '32', '15'])
19
Optimal Subset: 0b111111000111110111111101
dict_keys(['92', '91', '20', '99', '30', '26', '66', '45', '22', '40', '12', '85', '16', '72', '81', '62', '86', '57', '21', '95', '94', '39', '90', '02', '37', '18', '32', '15'])
Function: 4.1656446459243375, 1.128278468357325, 0.1499772071838379, 0.1815934308855406, 2.6683619911527634, 0.020871716245554905, 0.016561832099315523
Real: 4.1656446459243375, 1.128278468357325, 0.1499772071838379, 0.1815934308855406, 2.6683619911527634, 0.020871716245554905, 0.016561832099315523
outputs_noduck_GCP_0.0_1.086_6.25.json
Num GCP Qs: 28; Num Redshift Qs: 4
PLAN TYPE IS: multi
Moved Qs: $1.128278468357325; Stayed Qs: $0.1499772071838379; Migration Cost: $2.8873889703831743
Movement Cost: $0.1815934308855406, Load Cost: $2.6683619911527634, Storage Cost: $0.020871716245554905, API Cost: $0.016561832099315523
Final cost: $4.1656446459243375, Baseline: $13.549596071243286, Diff: $9.383951425318948, %: 69.2563186088978%
