Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs1
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $3.4031661968616667, Redshift-Calcite Total: $2.9418624704953036, BigQuery Total: $48.173699378967285
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 62
-0.2552255451487907
call_center: 9.615905582904816e-06, 0.0003980819541537262, 1.1867302910567994
catalog_page: 0.0017016949132084846, 0.0014781762095093175, -0.0014781762095093175
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.694877149989993, 2.0855066051673985
catalog_sales: 132.3057429259643, 17.39285771985594, -6.429283151111832
customer: 0.8535048151388764, 0.112642729095605, 11.8014961969487
customer_address: 0.2449320713058114, 0.03388944527327196, 12.015802060873714
customer_demographics: 0.011580578982830048, 0.002538136349820264, 10.645038578246131
date_dim: 0.001992875710129738, 0.0007718835803913771, 35.50157452891061
household_demographics: 3.5176053643226624e-05, 0.00034243931502136017, 10.140405668005046
income_band: 5.122274160385132e-07, 0.000347878836319059, 2.6919106603078795
inventory: 5.1357166497036815, 0.769574748883531, 0.7783187244178005
item: 0.03489831369370222, 0.005310119392868772, 27.750746238409285
promotion: 7.638614624738693e-05, 0.00045806259914201624, 5.378038100552519
reason: 1.4491379261016846e-06, 0.0003583095289498146, 2.9031569860679673
ship_mode: 1.3029202818870544e-06, 0.0003487830808873767, 0.254053956209509
store: 9.930133819580078e-05, 0.00046505537362095354, 29.640113718213925
store_returns: 20.850121902301908, 2.71885418503009, 4.685239926052462
store_sales: 174.69669486396015, 23.124638365759626, 15.897852614592534
time_dim: 0.0012146271765232086, 0.0008089629546856598, 2.637429449185525
warehouse: 2.907589077949524e-06, 0.00031938772713506827, 1.744634540953285
web_page: 7.394980639219284e-05, 0.00035020173241413457, -0.00035020173241413457
web_page had no query dependencies
web_returns: 6.285572262480855, 0.8118364174173633, -0.7503280394365748
web_site: 1.0454095900058746e-05, 0.00033023027492378923, -0.00033023027492378923
web_site had no query dependencies
-0.25489113164217264
call_center: 9.615905582904816e-06, 0.0003980813324775818, 0.021391437849966038
catalog_returns: 13.009788101539016, 1.6940360565707422, -1.645672838405106
customer: 0.8535048151388764, 0.11258754931268239, 6.6289453820723585
customer_address: 0.2449320713058114, 0.03387361021495042, 6.479909110377866
customer_demographics: 0.011580578982830048, 0.002537387655937047, 4.8421603069186565
date_dim: 0.001992875710129738, 0.0007717547393501478, 24.476491711026767
household_demographics: 3.5176053643226624e-05, 0.0003424370408607817, 7.079296125723069
income_band: 5.122274160385132e-07, 0.00034787880320313847, 0.012830558900247382
inventory: 5.1357166497036815, 0.7692427206103962, 0.26327248609851184
item: 0.03489831369370222, 0.005307863188404746, 17.908854843062734
promotion: 7.638614624738693e-05, 0.00045805766071531557, 1.9055345135588877
reason: 1.4491379261016846e-06, 0.00035830943526186487, 2.9031569861616555
ship_mode: 1.3029202818870544e-06, 0.00034878299665251704, -0.00034878299665251704
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.0004650489537083902, 24.376153173909177
store_returns: 20.850121902301908, 2.7175062076314016, -0.6249093849762009
store_sales: 174.69669486396015, 23.11334408185061, 10.242853047917517
time_dim: 0.0012146271765232086, 0.0008088844280473285, 2.637429527712163
warehouse: 2.907589077949524e-06, 0.00031938753915706125, 0.8481308948974521
-0.25481060368353287
call_center: 9.615905582904816e-06, 0.000398081182775761, -0.000398081182775761
call_center had no query dependencies
customer: 0.8535048151388764, 0.11257426182521849, 5.553711389478311
customer_address: 0.2449320713058114, 0.033869797076735784, 5.4690935175014
customer_demographics: 0.011580578982830048, 0.002537207367794169, 4.807192530320906
date_dim: 0.001992875710129738, 0.0007717237139703892, 23.826604798514353
household_demographics: 3.5176053643226624e-05, 0.0003424364932348474, 7.0443281693848006
income_band: 5.122274160385132e-07, 0.00034787879522870735, -0.00034787879522870735
income_band had no query dependencies
inventory: 5.1357166497036815, 0.7691627670244402, 0.26335243968446786
item: 0.03489831369370222, 0.005307319886366502, 16.95957763621918
promotion: 7.638614624738693e-05, 0.00045805647152464825, 1.9055345147480784
reason: 1.4491379261016846e-06, 0.00035830941270147425, 2.374540076750215
store: 9.930133819580078e-05, 0.000465047407770672, 22.82535169993736
store_sales: 174.69669486396015, 23.110624378221743, 8.23058224066147
time_dim: 0.0012146271765232086, 0.0008088655185542653, 2.637429546621656
warehouse: 2.907589077949524e-06, 0.00031938749389129036, 0.8481308949427179
-0.2548104949236649
customer: 0.8535048151388764, 0.11257424387933476, 5.553711407424195
customer_address: 0.2449320713058114, 0.0338697919267678, 5.4690935226513675
customer_demographics: 0.011580578982830048, 0.002537207124299674, 4.807192530564401
date_dim: 0.001992875710129738, 0.0007717236720679709, 23.826604798556257
household_demographics: 3.5176053643226624e-05, 0.00034243649249523193, 7.04432816938554
inventory: 5.1357166497036815, 0.7691626590403114, 0.2633525476685966
item: 0.03489831369370222, 0.005307319152590818, 16.959577636952954
promotion: 7.638614624738693e-05, 0.000458056469918545, 1.9055345147496845
reason: 1.4491379261016846e-06, 0.0003583094126710045, 2.374540076750246
store: 9.930133819580078e-05, 0.0004650474056827514, 22.82535169993945
store_sales: 174.69669486396015, 23.110620705030314, 8.230585913852899
time_dim: 0.0012146271765232086, 0.000808865493015384, 2.637429546647195
warehouse: 2.907589077949524e-06, 0.00031938749383015507, 0.8481308949427789
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 40.19507811567269, 1.9295199633042022, 14.054522514343262, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
-0.2548104949236649
customer: 0.8535048151388764, 0.11257424387933476, 5.553711407424195
customer_address: 0.2449320713058114, 0.0338697919267678, 5.4690935226513675
customer_demographics: 0.011580578982830048, 0.002537207124299674, 4.807192530564401
date_dim: 0.001992875710129738, 0.0007717236720679709, 23.826604798556257
household_demographics: 3.5176053643226624e-05, 0.00034243649249523193, 7.04432816938554
inventory: 5.1357166497036815, 0.7691626590403114, 0.2633525476685966
item: 0.03489831369370222, 0.005307319152590818, 16.959577636952954
promotion: 7.638614624738693e-05, 0.000458056469918545, 1.9055345147496845
reason: 1.4491379261016846e-06, 0.0003583094126710045, 2.374540076750246
store: 9.930133819580078e-05, 0.0004650474056827514, 22.82535169993945
store_sales: 174.69669486396015, 23.110620705030314, 8.230585913852899
time_dim: 0.0012146271765232086, 0.000808865493015384, 2.637429546647195
warehouse: 2.907589077949524e-06, 0.00031938749383015507, 0.8481308949427789
customer: 0.8535048151388764, 0.112569072312845, 5.553716578990684
customer_address: 0.2449320713058114, 0.033868307831458944, 5.469095006746676
customer_demographics: 0.011580578982830048, 0.0025371369551182737, 4.807192600733582
date_dim: 0.001992875710129738, 0.000771711596811853, 22.794089603922604
household_demographics: 3.5176053643226624e-05, 0.0003424362793560709, 7.044328169598679
item: 0.03489831369370222, 0.005307107696314947, 15.927062641700322
promotion: 7.638614624738693e-05, 0.00045805600707870246, 1.9055345152125245
reason: 1.4491379261016846e-06, 0.0003583094038903708, 2.3745400767590263
store: 9.930133819580078e-05, 0.0004650468039949063, 22.825351700541137
store_sales: 174.69669486396015, 23.10956218074667, 8.047579513864243
time_dim: 0.0012146271765232086, 0.000808858133332003, 2.637429554006878
warehouse: 2.907589077949524e-06, 0.00031938747621245686, -0.00031938747621245686
warehouse had no query dependencies
customer: 0.8535048151388764, 0.11256906466052756, 5.553716586643002
customer_address: 0.2449320713058114, 0.03386830563545732, 5.469095008942678
customer_demographics: 0.011580578982830048, 0.0025371368512896075, 4.807192600837411
date_dim: 0.001992875710129738, 0.000771711578944212, 22.79408960394047
household_demographics: 3.5176053643226624e-05, 0.0003424362790406909, 7.044328169598995
item: 0.03489831369370222, 0.005307107383425119, 15.927062642013212
promotion: 7.638614624738693e-05, 0.0004580560063938428, 1.9055345152132093
reason: 1.4491379261016846e-06, 0.00035830940387737817, 2.374540076759039
store: 9.930133819580078e-05, 0.00046504680310459454, 22.82535170054203
store_sales: 174.69669486396015, 23.109560614458417, 8.047581080152497
time_dim: 0.0012146271765232086, 0.0008088581224419499, 2.637429554017768
Function: 40.45212248572882, 1.8724622635189696, 15.144095420837402, 21.26992180922682, 2.1299214748930932, 0.020418506620915974, 0.015303010631626845
hiya: 0b1101011100111110000, 40.45212248572882
customer: 0.8535048151388764, 0.11256906466052756, 5.553716586643002
customer_address: 0.2449320713058114, 0.03386830563545732, 5.469095008942678
customer_demographics: 0.011580578982830048, 0.0025371368512896075, 4.807192600837411
date_dim: 0.001992875710129738, 0.000771711578944212, 22.79408960394047
household_demographics: 3.5176053643226624e-05, 0.0003424362790406909, 7.044328169598995
item: 0.03489831369370222, 0.005307107383425119, 15.927062642013212
promotion: 7.638614624738693e-05, 0.0004580560063938428, 1.9055345152132093
reason: 1.4491379261016846e-06, 0.00035830940387737817, 2.374540076759039
store: 9.930133819580078e-05, 0.00046504680310459454, 22.82535170054203
store_sales: 174.69669486396015, 23.109560614458417, 8.047581080152497
time_dim: 0.0012146271765232086, 0.0008088581224419499, 2.637429554017768
customer: 0.8535048151388764, 0.11256875159833946, 4.444634843569059
customer_address: 0.2449320713058114, 0.03386821579534298, 4.360013042646661
customer_demographics: 0.011580578982830048, 0.0025371326035790714, 4.010282090001649
date_dim: 0.001992875710129738, 0.0007717108479652891, 20.88809703345185
household_demographics: 3.5176053643226624e-05, 0.00034243626613825363, 7.044328169611897
item: 0.03489831369370222, 0.00530709458286178, 14.021070083594172
reason: 1.4491379261016846e-06, 0.00035830940334584014, 2.374540076759571
store: 9.930133819580078e-05, 0.0004650467666812567, 21.71626964444232
store_sales: 174.69669486396015, 23.109496536402176, 6.141652586989135
time_dim: 0.0012146271765232086, 0.0008088576769215089, 2.6374295544632886
Function: 42.35759242850546, 1.8602581565769516, 17.062292098999023, 21.269912569685875, 2.1294826006937027, 0.020353998518049025, 0.01529300403186381
hiya: 0b1101010100111110000, 42.35759242850546
customer: 0.8535048151388764, 0.11256875159833946, 4.444634843569059
customer_address: 0.2449320713058114, 0.03386821579534298, 4.360013042646661
customer_demographics: 0.011580578982830048, 0.0025371326035790714, 4.010282090001649
date_dim: 0.001992875710129738, 0.0007717108479652891, 20.88809703345185
household_demographics: 3.5176053643226624e-05, 0.00034243626613825363, 7.044328169611897
item: 0.03489831369370222, 0.00530709458286178, 14.021070083594172
reason: 1.4491379261016846e-06, 0.00035830940334584014, 2.374540076759571
store: 9.930133819580078e-05, 0.0004650467666812567, 21.71626964444232
store_sales: 174.69669486396015, 23.109496536402176, 6.141652586989135
time_dim: 0.0012146271765232086, 0.0008088576769215089, 2.6374295544632886
customer: 0.8535048151388764, 0.11256560875989698, 4.444637986407502
customer_address: 0.2449320713058114, 0.03386731388838728, 4.360013944553617
customer_demographics: 0.011580578982830048, 0.0025370899607161748, 4.0102821326445115
date_dim: 0.001992875710129738, 0.0007717035096512202, 20.88809704079016
household_demographics: 3.5176053643226624e-05, 0.00034243613661039194, 7.0443281697414255
item: 0.03489831369370222, 0.00530696607771464, 14.02107021209932
store: 9.930133819580078e-05, 0.00046504640102653803, 21.716269644807976
store_sales: 174.69669486396015, 23.108853255334918, 3.767397481893479
time_dim: 0.0012146271765232086, 0.0008088532043316465, 2.6374295589358785
Function: 44.73148499460953, 1.7336831159210206, 19.56376552581787, 21.26991239440057, 2.1291344654798507, 0.01970648908356001, 0.015283003906658292
hiya: 0b1101000100111110000, 44.73148499460953
customer: 0.8535048151388764, 0.11256560875989698, 4.444637986407502
customer_address: 0.2449320713058114, 0.03386731388838728, 4.360013944553617
customer_demographics: 0.011580578982830048, 0.0025370899607161748, 4.0102821326445115
date_dim: 0.001992875710129738, 0.0007717035096512202, 20.88809704079016
household_demographics: 3.5176053643226624e-05, 0.00034243613661039194, 7.0443281697414255
item: 0.03489831369370222, 0.00530696607771464, 14.02107021209932
store: 9.930133819580078e-05, 0.00046504640102653803, 21.716269644807976
store_sales: 174.69669486396015, 23.108853255334918, 3.767397481893479
time_dim: 0.0012146271765232086, 0.0008088532043316465, 2.6374295589358785
customer: 0.8535048151388764, 0.11256402147658266, 4.444639573690815
customer_address: 0.2449320713058114, 0.03386685838235729, 4.360014400059647
customer_demographics: 0.011580578982830048, 0.0025370684240365177, 4.0102821541811915
date_dim: 0.001992875710129738, 0.000771699803452607, 20.888097044496362
household_demographics: 3.5176053643226624e-05, 0.00034243607119264385, 4.406089757666632
item: 0.03489831369370222, 0.0053069011764861505, 14.021070277000549
store: 9.930133819580078e-05, 0.00046504621635346487, 19.07803123285244
store_sales: 174.69669486396015, 23.10852836771401, 1.1294839573741768
Function: 47.36858636872325, 1.6702337152560554, 22.265453338623047, 21.269765475121677, 2.1284816086006164, 0.019379332158982066, 0.01527289896287024
hiya: 0b101000100111110000, 47.36858636872325
customer: 0.8535048151388764, 0.11256402147658266, 4.444639573690815
customer_address: 0.2449320713058114, 0.03386685838235729, 4.360014400059647
customer_demographics: 0.011580578982830048, 0.0025370684240365177, 4.0102821541811915
date_dim: 0.001992875710129738, 0.000771699803452607, 20.888097044496362
household_demographics: 3.5176053643226624e-05, 0.00034243607119264385, 4.406089757666632
item: 0.03489831369370222, 0.0053069011764861505, 14.021070277000549
store: 9.930133819580078e-05, 0.00046504621635346487, 19.07803123285244
store_sales: 174.69669486396015, 23.10852836771401, 1.1294839573741768
customer: 0.8535048151388764, 0.11247040224792305, -0.11247040224792305
customer had no query dependencies
customer_address: 0.2449320713058114, 0.03383999227547315, -0.03383999227547315
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.0025357981735908562, -0.0025357981735908562
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0007714812089192341, -0.0007714812089192341
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0.00034243221280198105, -0.00034243221280198105
household_demographics had no query dependencies
item: 0.03489831369370222, 0.005303073250560515, -0.005303073250560515
item had no query dependencies
store: 9.930133819580078e-05, 0.0004650353241891538, -0.0004650353241891538
store had no query dependencies
Function: 48.173699378967285, 0, 48.173699378967285, 0.0, 0, 0.0, 0
hiya: 0b0, 48.173699378967285
{40.19507811567269: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 40.45212248572882: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 42.35759242850546: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 44.73148499460953: [4, 5, 6, 7, 8, 11, 15, 17, 18], 47.36858636872325: [4, 5, 6, 7, 8, 11, 15, 17], 48.173699378967285: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'48': 164064, '19': 166064, '79': 164240, '43': 163968, '42': 133248, '63': 166016, '70': 163968, '96': 426240, '73': 164240, '28': 131072, '08': 164016, '52': 133248, '53': 166016, '27': 166080, '03': 133248, '88': 426240, '68': 164272, '09': 139264, '22': 527488, '13': 164320, '67': 166016, '59': 163968, '34': 164240, '55': 133248, '39': 527488, '36': 166016, '82': 134272, '06': 133296, '61': 170160, '98': 133248, '65': 166016, '07': 137408, '44': 133120, '46': 164272, '21': 527488, '47': 166016, '89': 166016}
Best Cost: $40.19507811567269;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'48': 164064, '19': 166064, '79': 164240, '43': 163968, '42': 133248, '63': 166016, '70': 163968, '96': 426240, '73': 164240, '28': 131072, '08': 164016, '52': 133248, '53': 166016, '27': 166080, '03': 133248, '88': 426240, '68': 164272, '09': 139264, '22': 527488, '13': 164320, '67': 166016, '59': 163968, '34': 164240, '55': 133248, '39': 527488, '36': 166016, '82': 134272, '06': 133296, '61': 170160, '98': 133248, '65': 166016, '07': 137408, '44': 133120, '46': 164272, '21': 527488, '47': 166016, '89': 166016}
{'48': 164064, '19': 166064, '79': 164240, '43': 163968, '42': 133248, '63': 166016, '70': 163968, '96': 426240, '73': 164240, '28': 131072, '08': 164016, '52': 133248, '53': 166016, '27': 166080, '03': 133248, '88': 426240, '68': 164272, '09': 139264, '22': 527488, '13': 164320, '67': 166016, '59': 163968, '34': 164240, '55': 133248, '39': 527488, '36': 166016, '82': 134272, '06': 133296, '61': 170160, '98': 133248, '65': 166016, '07': 137408, '44': 133120, '46': 164272, '21': 527488, '47': 166016, '89': 166016}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 40.19507811567269, 1.9295199633042022, 14.054522514343262, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
40.19507811567269
Real: 40.19507811567269, 1.9295199633042022, 14.054522514343262, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
Num Redshift Qs: 37; Num GCP Qs: 26
Redshift Qs: $1.9295199633042022; GCP Qs: $14.054522514343262; Movement Cost: $21.891129887344352
Load Cost: $2.282025942227443, Storage Cost: $0.022113071652062725, API Cost: $0.01576673680137694
Final cost: $40.19507811567269, BQ Baseline: $48.173699378967285, Diff: $7.978621263294592, %: 16.562193408750485%
