Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs1
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $2.8692238019212084, Redshift-Calcite Total: $2.721336914876302, BigQuery Total: $41.535258293151855
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 59
-0.25507229445700824
call_center: 9.615905582904816e-06, 0.00039808166926003227, 0.02139143751318359
catalog_page: 0.0017016949132084846, 0.0014781257928173563, -0.0014781257928173563
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.694491704588408, -1.5985917487200845
customer: 0.8535048151388764, 0.11261744201916238, 8.376084397283615
customer_address: 0.2449320713058114, 0.033882188587778805, 8.435556862903242
customer_demographics: 0.011580578982830048, 0.002537793248081651, 5.018227549988444
date_dim: 0.001992875710129738, 0.0007718245367872535, 28.997297859478728
household_demographics: 3.5176053643226624e-05, 0.0003424382728484964, 7.233804470464969
income_band: 5.122274160385132e-07, 0.00034787882114312374, 0.012830558882307398
inventory: 5.1357166497036815, 0.7694225912656649, 0.2630926154432429
item: 0.03489831369370222, 0.005309085448700633, 18.49897703005143
promotion: 7.638614624738693e-05, 0.00045806033602377124, 1.9055345108835793
reason: 1.4491379261016846e-06, 0.00035830948601571407, 3.079224634772833
ship_mode: 1.3029202818870544e-06, 0.0003487830422853159, 0.12758067467505388
store: 9.930133819580078e-05, 0.0004650524315865499, 24.376153170431298
store_returns: 20.850121902301908, 2.7182364514016095, -0.5781028910437209
store_sales: 174.69669486396015, 23.11946256756969, 13.310833680418057
time_dim: 0.0012146271765232086, 0.0008089269685146187, 2.7919378311455847
warehouse: 2.907589077949524e-06, 0.0003193876409909412, 0.9760603525129574
web_page: 7.394980639219284e-05, 0.00035019954147815624, 0.3302257950943423
web_returns: 6.285572262480855, 0.8116501926375288, -0.03545922187138184
web_sales: 67.01082486007363, 8.804080392207627, -4.190274205965126
web_site: 1.0454095900058746e-05, 0.0003302299651967467, 0.6662141718755695
-0.2548107520855306
call_center: 9.615905582904816e-06, 0.00039808118305164096, -0.00039808118305164096
call_center had no query dependencies
customer: 0.8535048151388764, 0.11257428631223788, 5.553711364991291
customer_address: 0.2449320713058114, 0.03386980410382722, 5.469093510474308
customer_demographics: 0.011580578982830048, 0.002537207700040522, 4.80719252998866
date_dim: 0.001992875710129738, 0.0007717237711459146, 23.82660479845718
household_demographics: 3.5176053643226624e-05, 0.000342436494244047, 7.044328169383792
income_band: 5.122274160385132e-07, 0.00034787879524340317, -0.00034787879524340317
income_band had no query dependencies
inventory: 5.1357166497036815, 0.7691629143679478, 0.26335229234096
item: 0.03489831369370222, 0.005307320887597742, 16.95957763521795
promotion: 7.638614624738693e-05, 0.00045805647371616377, 1.9055345147458869
reason: 1.4491379261016846e-06, 0.00035830941274304993, 2.374540076750174
ship_mode: 1.3029202818870544e-06, 0.00034878297640584475, -0.00034878297640584475
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.00046504741061962344, 22.82535169993451
store_sales: 174.69669486396015, 23.11062939026301, 8.230577228620202
time_dim: 0.0012146271765232086, 0.0008088655534018709, 2.6374295465868083
warehouse: 2.907589077949524e-06, 0.000319387493974709, 0.8481308949426344
web_page: 7.394980639219284e-05, 0.000350195802359038, -0.000350195802359038
web_page had no query dependencies
web_site: 1.0454095900058746e-05, 0.00033022943660699445, -0.00033022943660699445
web_site had no query dependencies
-0.2548104949236649
customer: 0.8535048151388764, 0.11257424387933476, 5.553711407424195
customer_address: 0.2449320713058114, 0.0338697919267678, 5.4690935226513675
customer_demographics: 0.011580578982830048, 0.002537207124299674, 4.807192530564401
date_dim: 0.001992875710129738, 0.0007717236720679709, 23.826604798556257
household_demographics: 3.5176053643226624e-05, 0.00034243649249523193, 7.04432816938554
inventory: 5.1357166497036815, 0.7691626590403114, 0.2633525476685964
item: 0.03489831369370222, 0.005307319152590818, 16.959577636952957
promotion: 7.638614624738693e-05, 0.000458056469918545, 1.9055345147496845
reason: 1.4491379261016846e-06, 0.0003583094126710045, 2.374540076750246
store: 9.930133819580078e-05, 0.0004650474056827514, 22.82535169993945
store_sales: 174.69669486396015, 23.110620705030314, 8.230585913852899
time_dim: 0.0012146271765232086, 0.000808865493015384, 2.637429546647195
warehouse: 2.907589077949524e-06, 0.00031938749383015507, 0.8481308949427789
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 33.55663702985727, 1.929519963304202, 7.416081428527832, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
-0.2548104949236649
customer: 0.8535048151388764, 0.11257424387933476, 5.553711407424195
customer_address: 0.2449320713058114, 0.0338697919267678, 5.4690935226513675
customer_demographics: 0.011580578982830048, 0.002537207124299674, 4.807192530564401
date_dim: 0.001992875710129738, 0.0007717236720679709, 23.826604798556257
household_demographics: 3.5176053643226624e-05, 0.00034243649249523193, 7.04432816938554
inventory: 5.1357166497036815, 0.7691626590403114, 0.2633525476685964
item: 0.03489831369370222, 0.005307319152590818, 16.959577636952957
promotion: 7.638614624738693e-05, 0.000458056469918545, 1.9055345147496845
reason: 1.4491379261016846e-06, 0.0003583094126710045, 2.374540076750246
store: 9.930133819580078e-05, 0.0004650474056827514, 22.82535169993945
store_sales: 174.69669486396015, 23.110620705030314, 8.230585913852899
time_dim: 0.0012146271765232086, 0.000808865493015384, 2.637429546647195
warehouse: 2.907589077949524e-06, 0.00031938749383015507, 0.8481308949427789
customer: 0.8535048151388764, 0.112569072312845, 5.553716578990684
customer_address: 0.2449320713058114, 0.033868307831458944, 5.469095006746676
customer_demographics: 0.011580578982830048, 0.0025371369551182737, 4.807192600733582
date_dim: 0.001992875710129738, 0.000771711596811853, 22.794089603922604
household_demographics: 3.5176053643226624e-05, 0.0003424362793560709, 7.044328169598679
item: 0.03489831369370222, 0.005307107696314947, 15.927062641700326
promotion: 7.638614624738693e-05, 0.00045805600707870246, 1.9055345152125245
reason: 1.4491379261016846e-06, 0.0003583094038903708, 2.3745400767590263
store: 9.930133819580078e-05, 0.0004650468039949063, 22.825351700541137
store_sales: 174.69669486396015, 23.10956218074667, 8.047579513864243
time_dim: 0.0012146271765232086, 0.000808858133332003, 2.637429554006878
warehouse: 2.907589077949524e-06, 0.00031938747621245686, -0.00031938747621245686
warehouse had no query dependencies
customer: 0.8535048151388764, 0.11256906466052756, 5.553716586643002
customer_address: 0.2449320713058114, 0.03386830563545732, 5.469095008942678
customer_demographics: 0.011580578982830048, 0.0025371368512896075, 4.807192600837411
date_dim: 0.001992875710129738, 0.000771711578944212, 22.79408960394047
household_demographics: 3.5176053643226624e-05, 0.0003424362790406909, 7.044328169598995
item: 0.03489831369370222, 0.005307107383425119, 15.927062642013215
promotion: 7.638614624738693e-05, 0.0004580560063938428, 1.9055345152132093
reason: 1.4491379261016846e-06, 0.00035830940387737817, 2.374540076759039
store: 9.930133819580078e-05, 0.00046504680310459454, 22.82535170054203
store_sales: 174.69669486396015, 23.109560614458417, 8.047581080152497
time_dim: 0.0012146271765232086, 0.0008088581224419499, 2.637429554017768
Function: 33.81368139991339, 1.8724622635189696, 8.505654335021973, 21.26992180922682, 2.1299214748930932, 0.020418506620915974, 0.015303010631626845
hiya: 0b1101011100111110000, 33.81368139991339
customer: 0.8535048151388764, 0.11256906466052756, 5.553716586643002
customer_address: 0.2449320713058114, 0.03386830563545732, 5.469095008942678
customer_demographics: 0.011580578982830048, 0.0025371368512896075, 4.807192600837411
date_dim: 0.001992875710129738, 0.000771711578944212, 22.79408960394047
household_demographics: 3.5176053643226624e-05, 0.0003424362790406909, 7.044328169598995
item: 0.03489831369370222, 0.005307107383425119, 15.927062642013215
promotion: 7.638614624738693e-05, 0.0004580560063938428, 1.9055345152132093
reason: 1.4491379261016846e-06, 0.00035830940387737817, 2.374540076759039
store: 9.930133819580078e-05, 0.00046504680310459454, 22.82535170054203
store_sales: 174.69669486396015, 23.109560614458417, 8.047581080152497
time_dim: 0.0012146271765232086, 0.0008088581224419499, 2.637429554017768
customer: 0.8535048151388764, 0.11256875159833946, 4.444634843569058
customer_address: 0.2449320713058114, 0.03386821579534298, 4.360013042646661
customer_demographics: 0.011580578982830048, 0.0025371326035790714, 4.01028209000165
date_dim: 0.001992875710129738, 0.0007717108479652891, 20.88809703345185
household_demographics: 3.5176053643226624e-05, 0.00034243626613825363, 7.044328169611897
item: 0.03489831369370222, 0.00530709458286178, 14.021070083594175
reason: 1.4491379261016846e-06, 0.00035830940334584014, 2.374540076759571
store: 9.930133819580078e-05, 0.0004650467666812567, 21.71626964444232
store_sales: 174.69669486396015, 23.109496536402176, 6.141652586989132
time_dim: 0.0012146271765232086, 0.0008088576769215089, 2.6374295544632886
Function: 35.71915134269003, 1.8602581565769516, 10.423851013183594, 21.269912569685875, 2.1294826006937027, 0.020353998518049025, 0.01529300403186381
hiya: 0b1101010100111110000, 35.71915134269003
customer: 0.8535048151388764, 0.11256875159833946, 4.444634843569058
customer_address: 0.2449320713058114, 0.03386821579534298, 4.360013042646661
customer_demographics: 0.011580578982830048, 0.0025371326035790714, 4.01028209000165
date_dim: 0.001992875710129738, 0.0007717108479652891, 20.88809703345185
household_demographics: 3.5176053643226624e-05, 0.00034243626613825363, 7.044328169611897
item: 0.03489831369370222, 0.00530709458286178, 14.021070083594175
reason: 1.4491379261016846e-06, 0.00035830940334584014, 2.374540076759571
store: 9.930133819580078e-05, 0.0004650467666812567, 21.71626964444232
store_sales: 174.69669486396015, 23.109496536402176, 6.141652586989132
time_dim: 0.0012146271765232086, 0.0008088576769215089, 2.6374295544632886
customer: 0.8535048151388764, 0.11256560875989698, 4.444637986407501
customer_address: 0.2449320713058114, 0.03386731388838728, 4.360013944553617
customer_demographics: 0.011580578982830048, 0.0025370899607161748, 4.010282132644512
date_dim: 0.001992875710129738, 0.0007717035096512202, 20.88809704079016
household_demographics: 3.5176053643226624e-05, 0.00034243613661039194, 7.0443281697414255
item: 0.03489831369370222, 0.00530696607771464, 14.021070212099323
store: 9.930133819580078e-05, 0.00046504640102653803, 21.716269644807976
store_sales: 174.69669486396015, 23.108853255334918, 3.7673974818934752
time_dim: 0.0012146271765232086, 0.0008088532043316465, 2.6374295589358785
Function: 38.0930439087941, 1.7336831159210206, 12.925324440002441, 21.26991239440057, 2.1291344654798507, 0.01970648908356001, 0.015283003906658292
hiya: 0b1101000100111110000, 38.0930439087941
customer: 0.8535048151388764, 0.11256560875989698, 4.444637986407501
customer_address: 0.2449320713058114, 0.03386731388838728, 4.360013944553617
customer_demographics: 0.011580578982830048, 0.0025370899607161748, 4.010282132644512
date_dim: 0.001992875710129738, 0.0007717035096512202, 20.88809704079016
household_demographics: 3.5176053643226624e-05, 0.00034243613661039194, 7.0443281697414255
item: 0.03489831369370222, 0.00530696607771464, 14.021070212099323
store: 9.930133819580078e-05, 0.00046504640102653803, 21.716269644807976
store_sales: 174.69669486396015, 23.108853255334918, 3.7673974818934752
time_dim: 0.0012146271765232086, 0.0008088532043316465, 2.6374295589358785
customer: 0.8535048151388764, 0.11256402147658266, 4.444639573690814
customer_address: 0.2449320713058114, 0.03386685838235729, 4.360014400059647
customer_demographics: 0.011580578982830048, 0.0025370684240365177, 4.010282154181192
date_dim: 0.001992875710129738, 0.000771699803452607, 20.888097044496362
household_demographics: 3.5176053643226624e-05, 0.00034243607119264385, 4.406089757666632
item: 0.03489831369370222, 0.0053069011764861505, 14.021070277000552
store: 9.930133819580078e-05, 0.00046504621635346487, 19.07803123285244
store_sales: 174.69669486396015, 23.10852836771401, 1.1294839573741804
Function: 40.73014528290782, 1.6702337152560554, 15.627012252807617, 21.269765475121677, 2.1284816086006164, 0.019379332158982066, 0.01527289896287024
hiya: 0b101000100111110000, 40.73014528290782
customer: 0.8535048151388764, 0.11256402147658266, 4.444639573690814
customer_address: 0.2449320713058114, 0.03386685838235729, 4.360014400059647
customer_demographics: 0.011580578982830048, 0.0025370684240365177, 4.010282154181192
date_dim: 0.001992875710129738, 0.000771699803452607, 20.888097044496362
household_demographics: 3.5176053643226624e-05, 0.00034243607119264385, 4.406089757666632
item: 0.03489831369370222, 0.0053069011764861505, 14.021070277000552
store: 9.930133819580078e-05, 0.00046504621635346487, 19.07803123285244
store_sales: 174.69669486396015, 23.10852836771401, 1.1294839573741804
customer: 0.8535048151388764, 0.11247040224792305, -0.11247040224792305
customer had no query dependencies
customer_address: 0.2449320713058114, 0.03383999227547315, -0.03383999227547315
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.0025357981735908562, -0.0025357981735908562
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0007714812089192341, -0.0007714812089192341
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0.00034243221280198105, -0.00034243221280198105
household_demographics had no query dependencies
item: 0.03489831369370222, 0.005303073250560515, -0.005303073250560515
item had no query dependencies
store: 9.930133819580078e-05, 0.0004650353241891538, -0.0004650353241891538
store had no query dependencies
Function: 41.535258293151855, 0, 41.535258293151855, 0.0, 0, 0.0, 0
hiya: 0b0, 41.535258293151855
{33.55663702985727: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 33.81368139991339: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 35.71915134269003: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 38.0930439087941: [4, 5, 6, 7, 8, 11, 15, 17, 18], 40.73014528290782: [4, 5, 6, 7, 8, 11, 15, 17], 41.535258293151855: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'44': 133120, '43': 163968, '96': 426240, '67': 166016, '55': 133248, '65': 166016, '52': 133248, '07': 137408, '03': 133248, '53': 166016, '46': 164272, '63': 166016, '68': 164272, '27': 166080, '59': 163968, '70': 163968, '73': 164240, '36': 166016, '22': 527488, '09': 139264, '21': 527488, '34': 164240, '39': 527488, '79': 164240, '13': 164320, '88': 426240, '06': 133296, '61': 170160, '98': 133248, '08': 164016, '89': 166016, '19': 166064, '48': 164064, '28': 131072, '47': 166016, '82': 134272, '42': 133248}
Best Cost: $33.55663702985727;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'44': 133120, '43': 163968, '96': 426240, '67': 166016, '55': 133248, '65': 166016, '52': 133248, '07': 137408, '03': 133248, '53': 166016, '46': 164272, '63': 166016, '68': 164272, '27': 166080, '59': 163968, '70': 163968, '73': 164240, '36': 166016, '22': 527488, '09': 139264, '21': 527488, '34': 164240, '39': 527488, '79': 164240, '13': 164320, '88': 426240, '06': 133296, '61': 170160, '98': 133248, '08': 164016, '89': 166016, '19': 166064, '48': 164064, '28': 131072, '47': 166016, '82': 134272, '42': 133248}
{'44': 133120, '43': 163968, '96': 426240, '67': 166016, '55': 133248, '65': 166016, '52': 133248, '07': 137408, '03': 133248, '53': 166016, '46': 164272, '63': 166016, '68': 164272, '27': 166080, '59': 163968, '70': 163968, '73': 164240, '36': 166016, '22': 527488, '09': 139264, '21': 527488, '34': 164240, '39': 527488, '79': 164240, '13': 164320, '88': 426240, '06': 133296, '61': 170160, '98': 133248, '08': 164016, '89': 166016, '19': 166064, '48': 164064, '28': 131072, '47': 166016, '82': 134272, '42': 133248}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 33.55663702985727, 1.929519963304202, 7.416081428527832, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
33.55663702985727
Real: 33.55663702985727, 1.929519963304202, 7.416081428527832, 21.891129887344352, 2.282025942227443, 0.022113071652062725, 0.01576673680137694
Num Redshift Qs: 37; Num GCP Qs: 23
Redshift Qs: $1.929519963304202; GCP Qs: $7.416081428527832; Movement Cost: $21.891129887344352
Load Cost: $2.282025942227443, Storage Cost: $0.022113071652062725, API Cost: $0.01576673680137694
Final cost: $33.55663702985727, BQ Baseline: $41.535258293151855, Diff: $7.978621263294585, %: 19.209273256427693%
