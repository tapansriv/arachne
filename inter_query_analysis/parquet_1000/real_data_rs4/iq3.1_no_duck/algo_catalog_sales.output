Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs4
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: catalog_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $4.404826609036128, Redshift-Calcite Total: $3.8157755353800455, BigQuery Total: $41.535258293151855
Excluding table catalog_sales and any queries that depend on it
Total Keys: 60, Keys Considered: 57
-0.29715687590589174
call_center: 9.615905582904816e-06, 0.0012366217413877563, 0.016884545447892436
catalog_page: 0.0017016949132084846, 0.004872584951499494, -0.004872584951499494
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.7014108332813618, -1.6627095244444248
customer: 0.8535048151388764, 0.11666953086461848, 7.777826915376125
customer_address: 0.2449320713058114, 0.04976225770900213, 8.082467565314476
customer_demographics: 0.011580578982830048, 0.005958476734659243, 4.76772361454596
date_dim: 0.001992875710129738, 0.001942512022173991, 27.720017175433313
household_demographics: 3.5176053643226624e-05, 0.0012819890504719201, 7.120710226290461
income_band: 5.122274160385132e-07, 0.0011215779000817462, 0.006527115634451436
inventory: 5.1357166497036815, 0.8309853860427786, 0.22616387257557602
item: 0.03489831369370222, 0.00829456788425544, 17.939237040045604
promotion: 7.638614624738693e-05, 0.004892583464769694, 1.822792527474574
reason: 1.4491379261016846e-06, 0.0013672037274694464, 3.070815332097306
ship_mode: 1.3029202818870544e-06, 0.0013298831848180498, 0.12469009669424333
store: 9.930133819580078e-05, 0.0014200363052099079, 23.772345769401763
store_returns: 20.850121902301908, 2.8387786869847758, -0.7156086347393176
store_sales: 174.69669486396015, 23.52153384947469, 11.855417473977308
time_dim: 0.0012146271765232086, 0.0017928421286469347, 2.8057933880524115
warehouse: 2.907589077949524e-06, 0.001449330534686575, 0.9961841642827294
web_page: 7.394980639219284e-05, 0.0014304058553553873, 0.2900012648660166
web_returns: 6.285572262480855, 0.8143289156154764, -0.09343991547306096
web_sales: 67.01082486007363, 8.828053495804644, -4.669494699697669
web_site: 1.0454095900058746e-05, 0.0017744643593020808, 0.6814030853430244
-0.2970685825002249
call_center: 9.615905582904816e-06, 0.0012366215772499363, -0.0012366215772499363
call_center had no query dependencies
customer: 0.8535048151388764, 0.11665496204230187, 5.355119396945506
customer_address: 0.2449320713058114, 0.04975807686343079, 5.223623404661673
customer_demographics: 0.011580578982830048, 0.0059582790610263215, 4.598802662824286
date_dim: 0.001992875710129738, 0.0019424780049644744, 23.099319937858706
household_demographics: 3.5176053643226624e-05, 0.0012819884500374923, 6.946659984117203
income_band: 5.122274160385132e-07, 0.0011215778913383273, -0.0011215778913383273
income_band had no query dependencies
inventory: 5.1357166497036815, 0.8308977223975232, 0.22625153622083138
item: 0.03489831369370222, 0.008293972190684257, 16.426725255110593
promotion: 7.638614624738693e-05, 0.004892582160903363, 1.8227925287784403
reason: 1.4491379261016846e-06, 0.0013672037027335194, 2.39783282050311
ship_mode: 1.3029202818870544e-06, 0.0013298831625779713, -0.0013298831625779713
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.0014200346101948052, 22.207235776980948
store_sales: 174.69669486396015, 23.51855188023254, 7.117201540268216
time_dim: 0.0012146271765232086, 0.0017928213956795258, 2.6575130267355003
warehouse: 2.907589077949524e-06, 0.0014493304850557492, 0.8701641844532987
web_page: 7.394980639219284e-05, 0.001430404593075936, -0.001430404593075936
web_page had no query dependencies
web_site: 1.0454095900058746e-05, 0.0017744641808568476, -0.0017744641808568476
web_site had no query dependencies
-0.29706832620697854
customer: 0.8535048151388764, 0.11665491975272499, 5.355119439235083
customer_address: 0.2449320713058114, 0.049758064727502, 5.223623416797602
customer_demographics: 0.011580578982830048, 0.005958278487230162, 4.598802663398082
date_dim: 0.001992875710129738, 0.001942477906221188, 23.099319937957446
household_demographics: 3.5176053643226624e-05, 0.0012819884482945841, 6.946659984118947
inventory: 5.1357166497036815, 0.8308974679323109, 0.22625179068604373
item: 0.03489831369370222, 0.008293970461537691, 16.42672525683974
promotion: 7.638614624738693e-05, 0.004892582157118571, 1.822792528782225
reason: 1.4491379261016846e-06, 0.0013672037026617172, 2.397832820503182
store: 9.930133819580078e-05, 0.0014200346052746086, 22.20723577698587
store_sales: 174.69669486396015, 23.518543224336078, 7.117210196164677
time_dim: 0.0012146271765232086, 0.0017928213354970073, 2.657513026795683
warehouse: 2.907589077949524e-06, 0.0014493304849116837, 0.8701641844534428
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 34.74558360748205, 2.6118099291849144, 7.416081428527832, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
-0.29706832620697854
customer: 0.8535048151388764, 0.11665491975272499, 5.355119439235083
customer_address: 0.2449320713058114, 0.049758064727502, 5.223623416797602
customer_demographics: 0.011580578982830048, 0.005958278487230162, 4.598802663398082
date_dim: 0.001992875710129738, 0.001942477906221188, 23.099319937957446
household_demographics: 3.5176053643226624e-05, 0.0012819884482945841, 6.946659984118947
inventory: 5.1357166497036815, 0.8308974679323109, 0.22625179068604373
item: 0.03489831369370222, 0.008293970461537691, 16.42672525683974
promotion: 7.638614624738693e-05, 0.004892582157118571, 1.822792528782225
reason: 1.4491379261016846e-06, 0.0013672037026617172, 2.397832820503182
store: 9.930133819580078e-05, 0.0014200346052746086, 22.20723577698587
store_sales: 174.69669486396015, 23.518543224336078, 7.117210196164677
time_dim: 0.0012146271765232086, 0.0017928213354970073, 2.657513026795683
warehouse: 2.907589077949524e-06, 0.0014493304849116837, 0.8701641844534428
customer: 0.8535048151388764, 0.11665339455551232, 5.355120964432296
customer_address: 0.2449320713058114, 0.04975762703845113, 5.223623854486653
customer_demographics: 0.011580578982830048, 0.005958257792951146, 4.5988026840923615
date_dim: 0.001992875710129738, 0.0019424743449894006, 22.042170682900323
household_demographics: 3.5176053643226624e-05, 0.0012819883854356313, 6.946659984181806
item: 0.03489831369370222, 0.008293908098900914, 15.369576060584025
promotion: 7.638614624738693e-05, 0.00489258202061795, 1.8227925289187257
reason: 1.4491379261016846e-06, 0.0013672037000721348, 2.3978328205057715
store: 9.930133819580078e-05, 0.0014200344278249661, 22.20723577716332
store_sales: 174.69669486396015, 23.51823104459515, 6.931986632225605
time_dim: 0.0012146271765232086, 0.0017928191649808588, 2.657513028966199
warehouse: 2.907589077949524e-06, 0.0014493304797158762, -0.0014493304797158762
warehouse had no query dependencies
customer: 0.8535048151388764, 0.11665338564759335, 5.355120973340215
customer_address: 0.2449320713058114, 0.049757624482126894, 5.223623857042977
customer_demographics: 0.011580578982830048, 0.005958257672086146, 4.598802684213227
date_dim: 0.001992875710129738, 0.0019424743241900154, 22.042170682921125
household_demographics: 3.5176053643226624e-05, 0.0012819883850685033, 6.946659984182173
item: 0.03489831369370222, 0.008293907734671745, 15.369576060948255
promotion: 7.638614624738693e-05, 0.0048925820198207175, 1.822792528919523
reason: 1.4491379261016846e-06, 0.0013672037000570104, 2.3978328205057866
store: 9.930133819580078e-05, 0.001420034426788571, 22.207235777164353
store_sales: 174.69669486396015, 23.518229221308424, 6.931988455512332
time_dim: 0.0012146271765232086, 0.0017928191523039526, 2.657513028978876
Function: 34.96514826937377, 2.5793862813091284, 8.505654335021973, 21.26992180922682, 2.5882919938262305, 0.00659083935798959, 0.015303010631626845
hiya: 0b1101011100111110000, 34.96514826937377
customer: 0.8535048151388764, 0.11665338564759335, 5.355120973340215
customer_address: 0.2449320713058114, 0.049757624482126894, 5.223623857042977
customer_demographics: 0.011580578982830048, 0.005958257672086146, 4.598802684213227
date_dim: 0.001992875710129738, 0.0019424743241900154, 22.042170682921125
household_demographics: 3.5176053643226624e-05, 0.0012819883850685033, 6.946659984182173
item: 0.03489831369370222, 0.008293907734671745, 15.369576060948255
promotion: 7.638614624738693e-05, 0.0048925820198207175, 1.822792528919523
reason: 1.4491379261016846e-06, 0.0013672037000570104, 2.3978328205057866
store: 9.930133819580078e-05, 0.001420034426788571, 22.207235777164353
store_sales: 174.69669486396015, 23.518229221308424, 6.931988455512332
time_dim: 0.0012146271765232086, 0.0017928191523039526, 2.657513028978876
customer: 0.8535048151388764, 0.11665279517316007, 4.28983725352304
customer_address: 0.2449320713058114, 0.049757455032437295, 4.158339716201057
customer_demographics: 0.011580578982830048, 0.005958249660372925, 3.836401891577204
date_dim: 0.001992875710129738, 0.0019424729454723625, 20.2144855733605
household_demographics: 3.5176053643226624e-05, 0.0012819883607328934, 6.946659984206509
item: 0.03489831369370222, 0.008293883591208655, 13.541890974152372
reason: 1.4491379261016846e-06, 0.001367203699054463, 2.397832820506789
store: 9.930133819580078e-05, 0.0014200343580896013, 21.141951466941446
store_sales: 174.69669486396015, 23.51810836208178, 5.104424203799631
time_dim: 0.0012146271765232086, 0.0017928183119966913, 2.657513029819183
Function: 36.78781907147089, 2.488874714086851, 10.423851013183594, 21.269912569685875, 2.583418587606748, 0.006469182875957587, 0.01529300403186381
hiya: 0b1101010100111110000, 36.78781907147089
customer: 0.8535048151388764, 0.11665279517316007, 4.28983725352304
customer_address: 0.2449320713058114, 0.049757455032437295, 4.158339716201057
customer_demographics: 0.011580578982830048, 0.005958249660372925, 3.836401891577204
date_dim: 0.001992875710129738, 0.0019424729454723625, 20.2144855733605
household_demographics: 3.5176053643226624e-05, 0.0012819883607328934, 6.946659984206509
item: 0.03489831369370222, 0.008293883591208655, 13.541890974152372
reason: 1.4491379261016846e-06, 0.001367203699054463, 2.397832820506789
store: 9.930133819580078e-05, 0.0014200343580896013, 21.141951466941446
store_sales: 174.69669486396015, 23.51810836208178, 5.104424203799631
time_dim: 0.0012146271765232086, 0.0017928183119966913, 2.657513029819183
customer: 0.8535048151388764, 0.11665215365575395, 4.2898378950404465
customer_address: 0.2449320713058114, 0.04975727093483846, 4.158339900298656
customer_demographics: 0.011580578982830048, 0.005958240956095154, 3.8364019002814818
date_dim: 0.001992875710129738, 0.0019424714475728385, 20.214485574858397
household_demographics: 3.5176053643226624e-05, 0.0012819883342936158, 6.946659984232947
item: 0.03489831369370222, 0.008293857360688005, 13.541891000382893
store: 9.930133819580078e-05, 0.0014200342834520176, 21.141951467016085
store_sales: 174.69669486396015, 23.517977055299955, 2.705355486375609
time_dim: 0.0012146271765232086, 0.0017928173990499079, 2.65751303073213
Function: 39.185519720745376, 2.386601311473847, 12.925324440002441, 21.26991239440057, 2.5820615579827626, 0.006337012979093831, 0.015283003906658292
hiya: 0b1101000100111110000, 39.185519720745376
customer: 0.8535048151388764, 0.11665215365575395, 4.2898378950404465
customer_address: 0.2449320713058114, 0.04975727093483846, 4.158339900298656
customer_demographics: 0.011580578982830048, 0.005958240956095154, 3.8364019002814818
date_dim: 0.001992875710129738, 0.0019424714475728385, 20.214485574858397
household_demographics: 3.5176053643226624e-05, 0.0012819883342936158, 6.946659984232947
item: 0.03489831369370222, 0.008293857360688005, 13.541891000382893
store: 9.930133819580078e-05, 0.0014200342834520176, 21.141951467016085
store_sales: 174.69669486396015, 23.517977055299955, 2.705355486375609
time_dim: 0.0012146271765232086, 0.0017928173990499079, 2.65751303073213
customer: 0.8535048151388764, 0.11665188115977099, 4.28983816753643
customer_address: 0.2449320713058114, 0.04975719273609331, 4.158339978497401
customer_demographics: 0.011580578982830048, 0.0059582372587976135, 3.8364019039787793
date_dim: 0.001992875710129738, 0.0019424708113132464, 20.214485575494656
household_demographics: 3.5176053643226624e-05, 0.0012819883230630602, 4.287354136112998
item: 0.03489831369370222, 0.008293846218805587, 13.541891011524775
store: 9.930133819580078e-05, 0.0014200342517483703, 18.48264561891661
store_sales: 174.69669486396015, 23.51792128039776, 0.04610541314661987
Function: 41.8429754463445, 2.344219346799851, 15.627012252807617, 21.269765475121677, 2.580424644560814, 0.00628082809166792, 0.01527289896287024
hiya: 0b101000100111110000, 41.8429754463445
customer: 0.8535048151388764, 0.11665188115977099, 4.28983816753643
customer_address: 0.2449320713058114, 0.04975719273609331, 4.158339978497401
customer_demographics: 0.011580578982830048, 0.0059582372587976135, 3.8364019039787793
date_dim: 0.001992875710129738, 0.0019424708113132464, 20.214485575494656
household_demographics: 3.5176053643226624e-05, 0.0012819883230630602, 4.287354136112998
item: 0.03489831369370222, 0.008293846218805587, 13.541891011524775
store: 9.930133819580078e-05, 0.0014200342517483703, 18.48264561891661
store_sales: 174.69669486396015, 23.51792128039776, 0.04610541314661987
customer: 0.8535048151388764, 0.11662168921215141, -0.11662168921215141
customer had no query dependencies
customer_address: 0.2449320713058114, 0.04974852848940594, -0.04974852848940594
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.0059578276064701135, -0.0059578276064701135
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0019424003151684265, -0.0019424003151684265
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0.0012819870787425243, -0.0012819870787425243
household_demographics had no query dependencies
item: 0.03489831369370222, 0.008292611723064775, -0.008292611723064775
item had no query dependencies
store: 9.930133819580078e-05, 0.001420030739054888, -0.001420030739054888
store had no query dependencies
Function: 41.535258293151855, 0, 41.535258293151855, 0.0, 0, 0.0, 0
hiya: 0b0, 41.535258293151855
{34.74558360748205: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 34.96514826937377: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 36.78781907147089: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 39.185519720745376: [4, 5, 6, 7, 8, 11, 15, 17, 18], 41.8429754463445: [4, 5, 6, 7, 8, 11, 15, 17], 41.535258293151855: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'21': 527488, '63': 166016, '34': 164240, '19': 166064, '09': 139264, '88': 426240, '13': 164320, '48': 164064, '79': 164240, '73': 164240, '08': 164016, '27': 166080, '82': 134272, '61': 170160, '52': 133248, '28': 131072, '55': 133248, '67': 166016, '44': 133120, '22': 527488, '43': 163968, '96': 426240, '98': 133248, '89': 166016, '68': 164272, '36': 166016, '47': 166016, '65': 166016, '39': 527488, '46': 164272, '70': 163968, '53': 166016, '07': 137408, '42': 133248, '03': 133248, '59': 163968, '06': 133296}
Best Cost: $34.74558360748205;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'21': 527488, '63': 166016, '34': 164240, '19': 166064, '09': 139264, '88': 426240, '13': 164320, '48': 164064, '79': 164240, '73': 164240, '08': 164016, '27': 166080, '82': 134272, '61': 170160, '52': 133248, '28': 131072, '55': 133248, '67': 166016, '44': 133120, '22': 527488, '43': 163968, '96': 426240, '98': 133248, '89': 166016, '68': 164272, '36': 166016, '47': 166016, '65': 166016, '39': 527488, '46': 164272, '70': 163968, '53': 166016, '07': 137408, '42': 133248, '03': 133248, '59': 163968, '06': 133296}
{'21': 527488, '63': 166016, '34': 164240, '19': 166064, '09': 139264, '88': 426240, '13': 164320, '48': 164064, '79': 164240, '73': 164240, '08': 164016, '27': 166080, '82': 134272, '61': 170160, '52': 133248, '28': 131072, '55': 133248, '67': 166016, '44': 133120, '22': 527488, '43': 163968, '96': 426240, '98': 133248, '89': 166016, '68': 164272, '36': 166016, '47': 166016, '65': 166016, '39': 527488, '46': 164272, '70': 163968, '53': 166016, '07': 137408, '42': 133248, '03': 133248, '59': 163968, '06': 133296}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 34.74558360748205, 2.6118099291849144, 7.416081428527832, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
34.74558360748205
Real: 34.74558360748205, 2.6118099291849144, 7.416081428527832, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
Num Redshift Qs: 37; Num GCP Qs: 23
Redshift Qs: $2.6118099291849144; GCP Qs: $7.416081428527832; Movement Cost: $21.891129887344352
Load Cost: $2.803686996498108, Storage Cost: $0.007108629125463433, API Cost: $0.01576673680137694
Final cost: $34.74558360748205, BQ Baseline: $41.535258293151855, Diff: $6.789674685669809, %: 16.346773716318168%
