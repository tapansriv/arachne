Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs4
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $4.572590499275525, Redshift-Calcite Total: $4.055330068308512, BigQuery Total: $48.173699378967285
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 60

Round 0
call_center: 9.615905582904816e-06, 1.2304236888011297, 0.0012277806119021413, 1.2291959081892276
catalog_page: 0.0017016949132084846, 0, 0.00506766647972728, -0.00506766647972728
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 3.5842175299104047, 3.2693020023101327, 0.31491552760027197
catalog_sales: 132.3057429259643, 10.499952008808453, 33.43922946307892, -22.939277454270464
customer: 0.8535048151388764, 11.361371705803872, 0.21953137948840182, 11.14184032631547
customer_address: 0.2449320713058114, 11.533619843796096, 0.0792736445057882, 11.454346199290308
customer_demographics: 0.011580578982830048, 10.068355235673586, 0.007344271264191949, 10.061010964409395
date_dim: 0.001992875710129738, 34.211633282206854, 0.002172711178171669, 34.209460571028686
household_demographics: 3.5176053643226624e-05, 9.895235426780383, 0.001276228782532515, 9.89395919799785
income_band: 5.122274160385132e-07, 2.583531006541252, 0.0011116396383075682, 2.5824193669029443
inventory: 5.1357166497036815, 1.5371917422437669, 1.4499858228845766, 0.08720591935919031
item: 0.03489831369370222, 26.738960132215812, 0.01249087971901604, 26.726469252496795
promotion: 7.638614624738693e-05, 5.146828460319837, 0.004891790329262268, 5.141936669990574
reason: 1.4491379261016846e-06, 2.929031247153282, 0.0013573783928801477, 2.927673868760402
ship_mode: 1.3029202818870544e-06, 0.25043715144316353, 0.0013200402265461837, 0.24911711121661734
store: 9.930133819580078e-05, 28.85380213864644, 0.0014220051534081092, 28.852380133493032
store_returns: 20.850121902301908, 7.203206385184924, 5.3518965135770475, 1.8513098716078762
store_sales: 174.69669486396015, 38.184611754349085, 44.58145071986563, -6.396838965516544
time_dim: 0.0012146271765232086, 2.6593058481311798, 0.0019292671199813277, 2.6573765810111984
warehouse: 2.907589077949524e-06, 1.6818904627609252, 0.0014396810486143308, 1.6804507817123109
web_page: 7.394980639219284e-05, 0, 0.0014293206086446817, -0.0014293206086446817
web_page had no query dependencies
web_returns: 6.285572262480855, 0.020580141647656758, 1.5720561992823623, -1.5514760576347055
web_site: 1.0454095900058746e-05, 0, 0.0017657246199020771, -0.0017657246199020771
web_site had no query dependencies

Round 1
call_center: 9.615905582904816e-06, 0.018121167189280193, 0.0012277743755826252, 0.016893392813697568
catalog_returns: 13.009788101539016, 0.018121167189280193, 3.260864167588499, -3.242743000399219
customer: 0.8535048151388764, 0.06492295695622761, 0.21896793061805975, -0.15404497366183212
customer_address: 0.2449320713058114, 0.025769860723813376, 0.07911195039880727, -0.05334208967499389
customer_demographics: 0.011580578982830048, 0.025769860723813376, 0.007336626240953596, 0.01843323448285978
date_dim: 0.001992875710129738, 0.9288877783600489, 0.0021713955633705716, 0.9267163827966783
household_demographics: 3.5176053643226624e-05, 0.025769860723813376, 0.0012762055607447326, 0.024493655163068645
income_band: 5.122274160385132e-07, 0.007648693534533182, 0.0011116393001560382, 0.006537054234377144
inventory: 5.1357166497036815, 0.8716135149383544, 1.4465954334065727, -0.5749819184682183
item: 0.03489831369370222, 0.8716135149383544, 0.012467841283756175, 0.8591456736545982
promotion: 7.638614624738693e-05, 0, 0.004891739902261682, -0.004891739902261682
promotion had no query dependencies
reason: 1.4491379261016846e-06, 0, 0.0013573774362187288, -0.0013573774362187288
reason had no query dependencies
ship_mode: 1.3029202818870544e-06, 0, 0.001320039366411656, -0.001320039366411656
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.03915309623241424, 0.0014219395987377225, 0.037731156633676516
store_returns: 20.850121902301908, 0.04680178976694742, 5.338132118316507, -5.291330328549559
time_dim: 0.0012146271765232086, 0, 0.0019284429583495322, -0.0019284429583495322
time_dim had no query dependencies
warehouse: 2.907589077949524e-06, 0.8716135149383544, 0.001439679075726349, 0.870173835862628

Round 2
call_center: 9.615905582904816e-06, 0, 0.0012277742770175496, -0.0012277742770175496
call_center had no query dependencies
customer_demographics: 0.011580578982830048, 0, 0.007336493022564912, -0.007336493022564912
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0, 0.002171372638118618, -0.002171372638118618
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0, 0.0012762051560933595, -0.0012762051560933595
household_demographics had no query dependencies
income_band: 5.122274160385132e-07, 0, 0.0011116392942635773, -0.0011116392942635773
income_band had no query dependencies
item: 0.03489831369370222, 0, 0.012467385671700663, -0.012467385671700663
item had no query dependencies
store: 9.930133819580078e-05, 0, 0.0014219382968794518, -0.0014219382968794518
store had no query dependencies
store_returns: 20.850121902301908, 0, 5.3378587694962745, -5.3378587694962745
store_returns had no query dependencies
warehouse: 2.907589077949524e-06, 0, 0.0014396790375728167, -0.0014396790375728167
warehouse had no query dependencies

Round 3
store_returns: 20.850121902301908, 0, 5.337856448966751, -5.337856448966751
store_returns had no query dependencies
STARTING PHASE 2: 0b10000000000000000
----
[16]
Function: 53.533348645289436, 0, 48.173699378967285, 5.024010623375497, 0.3337767170111338, 5.047540316044241e-05, 0.0018114505323588849
Function: 48.173699378967285, 0, 48.173699378967285, 0.0, 0, 0.0, 0
hiya: 0b0, 48.173699378967285
{48.173699378967285: []}
NEW ENTRY: 48.173699378967285, 0b0
{53.533348645289436: [16], 48.173699378967285: []}
[16]
----
Best Cost: $48.173699378967285;
[]
[]
0
Optimal Subset: 0b0
Function: 48.173699378967285, 0, 48.173699378967285, 0.0, 0, 0.0, 0
48.173699378967285
Real: 48.173699378967285, 0, 48.173699378967285, 0.0, 0, 0.0, 0
Num Redshift Qs: 0; Num GCP Qs: 63
Redshift Qs: $0; GCP Qs: $48.173699378967285; Movement Cost: $0.0
Load Cost: $0, Storage Cost: $0.0, API Cost: $0
Final cost: $48.173699378967285, BQ Baseline: $48.173699378967285, Diff: $0.0, %: 0.0%
