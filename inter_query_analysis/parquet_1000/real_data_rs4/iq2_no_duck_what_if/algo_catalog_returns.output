Egress: $0.24/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs4
BigQuery Cost: $5.0/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: catalog_returns
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $7.3295900784572, Redshift-Calcite Total: $6.478135465868315, BigQuery Total: $77.67235279083252
Excluding table catalog_returns and any queries that depend on it
Total Keys: 86, Keys Considered: 84

Round 0
call_center: 9.615905582904816e-06, 0.802508409924507, 0.0012277844340086806, 0.8012806254904983
catalog_page: 0.0017016949132084846, 0, 0.0050683428652428435, -0.0050683428652428435
catalog_page had no query dependencies
catalog_sales: 132.3057429259643, 33.54392107810497, 33.49168524538201, 0.05223583272296395
customer: 0.8535048151388764, 15.206819008599915, 0.21986977192539994, 14.986949236674516
customer_address: 0.2449320713058114, 13.748120555669464, 0.07937075369490822, 13.668749801974556
customer_demographics: 0.011580578982830048, 8.122437475504876, 0.007348862662241896, 8.115088612842634
date_dim: 0.001992875710129738, 61.22717945672354, 0.0021735013015033995, 61.225005955422034
household_demographics: 3.5176053643226624e-05, 7.103871048151653, 0.0012762427289219262, 7.102594805422731
income_band: 5.122274160385132e-07, 0.007648693534533182, 0.0011116398413924021, 0.00653705369314078
inventory: 5.1357166497036815, 1.1915504617611568, 1.4520220008205411, -0.26047153905938436
item: 0.03489831369370222, 46.70711509499232, 0.012504715991768662, 46.69461037900055
promotion: 7.638614624738693e-05, 2.2253048668305078, 0.0048918206143804335, 2.220413046216127
reason: 1.4491379261016846e-06, 3.0721825358247754, 0.001357378967425605, 3.07082515685735
ship_mode: 1.3029202818870544e-06, 0.9048370413557687, 0.0013200407431201522, 0.9035170006126485
store: 9.930133819580078e-05, 26.773185001106263, 0.001422044523803253, 26.77176295658246
store_returns: 20.850121902301908, 4.606743930530548, 5.360163044048911, -0.7534191135183628
store_sales: 174.69669486396015, 64.06065160754999, 44.650713410903776, 19.40993819664621
time_dim: 0.0012146271765232086, 4.011702398384412, 0.0019297486880322835, 4.00977264969638
warehouse: 2.907589077949524e-06, 1.7764505562941233, 0.001439682201397697, 1.7750108740927255
web_page: 7.394980639219284e-05, 0.29143167072137194, 0.0014293499278175286, 0.2900023207935544
web_returns: 6.285572262480855, 0.7003088584947585, 1.5745482650306764, -0.8742394065359178
web_sales: 67.01082486007363, 30.748044086476966, 16.933267315802382, 13.814776770674584
web_site: 1.0454095900058746e-05, 0.6831775497023265, 0.0017657288236067874, 0.6814118208787197

Round 1
call_center: 9.615905582904816e-06, 0.802508409924507, 0.0012277829037299751, 0.8012806270207771
catalog_sales: 132.3057429259643, 33.40951987496217, 33.47062559143589, -0.061105716473718985
customer: 0.8535048151388764, 15.206819008599915, 0.2197339160233759, 14.987085092576539
customer_address: 0.2449320713058114, 13.047811697174707, 0.07933176684106552, 12.968479930333642
customer_demographics: 0.011580578982830048, 7.979286186833383, 0.007347019333445425, 7.971939167499937
date_dim: 0.001992875710129738, 59.33532013646763, 0.0021731840872095615, 59.33314695238042
household_demographics: 3.5176053643226624e-05, 7.103871048151653, 0.0012762371298035468, 7.1025948110218495
income_band: 5.122274160385132e-07, 0.007648693534533182, 0.0011116397598590394, 0.006537053774674143
item: 0.03489831369370222, 45.515564633231165, 0.012499106926716514, 45.50306552630445
promotion: 7.638614624738693e-05, 2.2253048668305078, 0.004891808337143569, 2.220413058493364
reason: 1.4491379261016846e-06, 2.929031247153282, 0.0013573787345115172, 2.9276738684187706
ship_mode: 1.3029202818870544e-06, 0.9048370413557687, 0.001320040533707036, 0.9035170008220617
store: 9.930133819580078e-05, 26.773185001106263, 0.0014220285635001108, 26.771762972542763
store_returns: 20.850121902301908, 4.606743930530548, 5.356811888141447, -0.7500679576108986
store_sales: 174.69669486396015, 63.875115863869986, 44.622635116505734, 19.252480747364253
time_dim: 0.0012146271765232086, 4.011702398384412, 0.0019295534659104635, 4.009772844918502
warehouse: 2.907589077949524e-06, 0.9048370413557687, 0.0014396817340726444, 0.9033973596216961
web_page: 7.394980639219284e-05, 0.14828038204987842, 0.001429338042163732, 0.1468510440077147
web_sales: 67.01082486007363, 30.04773522798221, 16.92246818670804, 13.125267041274167
web_site: 1.0454095900058746e-05, 0.12601997987906138, 0.0017657271388770229, 0.12425425274018435

Round 2
call_center: 9.615905582904816e-06, 0, 0.001227778873461434, -0.001227778873461434
call_center had no query dependencies
customer: 0.8535048151388764, 7.876375279051463, 0.21936630439338217, 7.657008974658081
customer_address: 0.2449320713058114, 7.41379979733944, 0.0792262725586978, 7.334573524780742
customer_demographics: 0.011580578982830048, 4.612409635419846, 0.007342031481659894, 4.605067603938187
date_dim: 0.001992875710129738, 25.92580026150544, 0.002172325739048917, 25.92362793576639
household_demographics: 3.5176053643226624e-05, 7.103871048151653, 0.0012762219791843737, 7.102594826172469
income_band: 5.122274160385132e-07, 0.007648693534533182, 0.0011116395392384265, 0.006537053995294756
item: 0.03489831369370222, 16.869802207663856, 0.012484075932452132, 16.857318131731404
promotion: 7.638614624738693e-05, 1.8276851109393437, 0.004891775436994404, 1.8227933355023493
reason: 1.4491379261016846e-06, 2.929031247153282, 0.0013573781103557473, 2.927673869042926
ship_mode: 1.3029202818870544e-06, 0.12601997987906138, 0.0013200399725284227, 0.12469993990653296
store: 9.930133819580078e-05, 23.77376580570698, 0.0014219857935869864, 23.77234381991339
store_returns: 20.850121902301908, 2.102589910597801, 5.347831567044106, -3.245241656446305
store_sales: 174.69669486396015, 35.19141557977199, 44.547391795537465, -9.355976215765473
time_dim: 0.0012146271765232086, 2.8075862301810584, 0.0019290303158727878, 2.8056571998651854
warehouse: 2.907589077949524e-06, 0.12601997987906138, 0.0014396804817498204, 0.12458029939731156
web_page: 7.394980639219284e-05, 0.14828038204987842, 0.0014293061913664272, 0.146851075858512
web_sales: 67.01082486007363, 3.4582499376122158, 16.89360606652184, -13.435356128909625
web_site: 1.0454095900058746e-05, 0.12601997987906138, 0.00176572263621088, 0.1242542572428505

Round 3
customer: 0.8535048151388764, 0.04680178976694742, 0.2189632018215017, -0.17216141205455426
customer_address: 0.2449320713058114, 0.007648693534533182, 0.07911059336611664, -0.07146189983158346
customer_demographics: 0.011580578982830048, 0.007648693534533182, 0.00733656207939169, 0.0003121314551414924
date_dim: 0.001992875710129738, 0.03915309623241424, 0.0021713845219521384, 0.0369817117104621
household_demographics: 3.5176053643226624e-05, 0.007648693534533182, 0.001276205365853739, 0.006372488168679443
income_band: 5.122274160385132e-07, 0.007648693534533182, 0.0011116392973180705, 0.006537054237215112
item: 0.03489831369370222, 0, 0.012467593775872927, -0.012467593775872927
item had no query dependencies
promotion: 7.638614624738693e-05, 0, 0.00489173936051134, -0.00489173936051134
promotion had no query dependencies
reason: 1.4491379261016846e-06, 0, 0.0013573774259410672, -0.0013573774259410672
reason had no query dependencies
ship_mode: 1.3029202818870544e-06, 0, 0.001320039357171008, -0.001320039357171008
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.03915309623241424, 0.001421938894466902, 0.03773115733794734
store_returns: 20.850121902301908, 0.04680178976694742, 5.3379842438494824, -5.291182454082535
time_dim: 0.0012146271765232086, 0, 0.0019284343438988733, -0.0019284343438988733
time_dim had no query dependencies
warehouse: 2.907589077949524e-06, 0, 0.0014396790551049737, -0.0014396790551049737
warehouse had no query dependencies
web_page: 7.394980639219284e-05, 0, 0.0014292699069715627, -0.0014292699069715627
web_page had no query dependencies
web_site: 1.0454095900058746e-05, 0, 0.001765717447850462, -0.001765717447850462
web_site had no query dependencies

Round 4
customer_demographics: 0.011580578982830048, 0, 0.007336492919633754, -0.007336492919633754
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0, 0.002171372620405427, -0.002171372620405427
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0, 0.0012762051557807057, -0.0012762051557807057
household_demographics had no query dependencies
income_band: 5.122274160385132e-07, 0, 0.0011116392942590245, -0.0011116392942590245
income_band had no query dependencies
store: 9.930133819580078e-05, 0, 0.0014219382930498149, -0.0014219382930498149
store had no query dependencies
store_returns: 20.850121902301908, 0, 5.3378579653943365, -5.3378579653943365
store_returns had no query dependencies

Round 5
store_returns: 20.850121902301908, 0, 5.337856448966751, -5.337856448966751
store_returns had no query dependencies
STARTING PHASE 2: 0b10000000000000000
----
[16]
Function: 83.03200205715467, 0, 77.67235279083252, 5.024010623375497, 0.3337767170111338, 5.047540316044241e-05, 0.0018114505323588849
Function: 77.67235279083252, 0, 77.67235279083252, 0.0, 0, 0.0, 0
hiya: 0b0, 77.67235279083252
{77.67235279083252: []}
NEW ENTRY: 77.67235279083252, 0b0
{83.03200205715467: [16], 77.67235279083252: []}
[16]
----
Best Cost: $77.67235279083252;
[]
[]
0
Optimal Subset: 0b0
Function: 77.67235279083252, 0, 77.67235279083252, 0.0, 0, 0.0, 0
77.67235279083252
Real: 77.67235279083252, 0, 77.67235279083252, 0.0, 0, 0.0, 0
Num Redshift Qs: 0; Num GCP Qs: 86
Redshift Qs: $0; GCP Qs: $77.67235279083252; Movement Cost: $0.0
Load Cost: $0, Storage Cost: $0.0, API Cost: $0
Final cost: $77.67235279083252, BQ Baseline: $77.67235279083252, Diff: $0.0, %: 0.0%
