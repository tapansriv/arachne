Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/real_data_rs4
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $4.5725904992755275, Redshift-Calcite Total: $4.055330068308513, BigQuery Total: $48.173699378967285
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 60
-0.2971987779849511
call_center: 9.615905582904816e-06, 0.0012366218192839012, 1.2291870669818457
catalog_page: 0.0017016949132084846, 0.004872598736521852, -0.004872598736521852
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.7015162224545033, 1.8827013074559023
catalog_sales: 132.3057429259643, 17.493682053533366, -6.993730044724913
customer: 0.8535048151388764, 0.11667644490242123, 11.244695260901452
customer_address: 0.2449320713058114, 0.04976424184496724, 11.483855601951127
customer_demographics: 0.011580578982830048, 0.005958570546152096, 10.062396665127435
date_dim: 0.001992875710129738, 0.001942528165982147, 34.20969075404086
household_demographics: 3.5176053643226624e-05, 0.001281989335424694, 9.893953437444958
income_band: 5.122274160385132e-07, 0.0011215779042311777, 2.5824094286370207
inventory: 5.1357166497036815, 0.8310269892516069, 0.70616475299216
item: 0.03489831369370222, 0.008294850587124657, 26.73066528162869
promotion: 7.638614624738693e-05, 0.004892584083555545, 5.141935876236282
reason: 1.4491379261016846e-06, 0.0013672037392085652, 2.9276640434140733
ship_mode: 1.3029202818870544e-06, 0.0013298831953726944, 0.24910726824779084
store: 9.930133819580078e-05, 0.0014200371096262322, 28.85238210153681
store_returns: 20.850121902301908, 2.8389475888216107, 4.364258796363314
store_sales: 174.69669486396015, 23.52294902550051, 14.661662728848555
time_dim: 0.0012146271765232086, 0.0017928519680503756, 2.6575129961631294
warehouse: 2.907589077949524e-06, 0.0014493305582402567, 1.680441132202685
web_page: 7.394980639219284e-05, 0.0014304064544050327, -0.0014304064544050327
web_page had no query dependencies
web_returns: 6.285572262480855, 0.8143798335288424, -0.7937996918811856
web_site: 1.0454095900058746e-05, 0.0017744644439882044, -0.0017744644439882044
web_site had no query dependencies
-0.297092476060126
call_center: 9.615905582904816e-06, 0.0012366216216681666, 0.016884545567612028
catalog_returns: 13.009788101539016, 1.7012488593018356, -1.6831276921125553
customer: 0.8535048151388764, 0.11665890459074116, 6.413430856771335
customer_address: 0.2449320713058114, 0.04975920826484567, 6.242784579402112
customer_demographics: 0.011580578982830048, 0.005958332554565883, 4.62457247005456
date_dim: 0.001992875710129738, 0.0019424872105470105, 23.689158644540196
household_demographics: 3.5176053643226624e-05, 0.0012819886125243264, 6.972429844678531
income_band: 5.122274160385132e-07, 0.0011215778937044315, 0.006527115640828751
inventory: 5.1357166497036815, 0.8309214455345258, 0.22622781308382878
item: 0.03489831369370222, 0.008294133394569397, 17.420117539324753
promotion: 7.638614624738693e-05, 0.004892582513749739, 1.822792528425594
reason: 1.4491379261016846e-06, 0.0013672037094274434, 2.927664043443855
ship_mode: 1.3029202818870544e-06, 0.0013298831685964801, -0.0013298831685964801
ship_mode had no query dependencies
store: 9.930133819580078e-05, 0.0014200350688920837, 23.77234577063808
store_returns: 20.850121902301908, 2.8385190995732232, -0.735929188975422
store_sales: 174.69669486396015, 23.519358847187462, 9.172182694144148
time_dim: 0.0012146271765232086, 0.0017928270063408767, 2.657513021124839
warehouse: 2.907589077949524e-06, 0.0014493304984866176, 0.8701641844398678
-0.29706841388292776
call_center: 9.615905582904816e-06, 0.0012366215769364758, -0.0012366215769364758
call_center had no query dependencies
customer: 0.8535048151388764, 0.11665493421966414, 5.355119424768144
customer_address: 0.2449320713058114, 0.04975806887910994, 5.223623412645994
customer_demographics: 0.011580578982830048, 0.0059582786835214166, 4.598802663201791
date_dim: 0.001992875710129738, 0.001942477940000507, 23.09931993792367
household_demographics: 3.5176053643226624e-05, 0.0012819884488908197, 6.946659984118351
income_band: 5.122274160385132e-07, 0.0011215778913216295, -0.0011215778913216295
income_band had no query dependencies
inventory: 5.1357166497036815, 0.8308975549829037, 0.22625170363545088
item: 0.03489831369370222, 0.008293971053065438, 16.42672525624822
promotion: 7.638614624738693e-05, 0.004892582158413319, 1.8227925287809303
reason: 1.4491379261016846e-06, 0.0013672037026862803, 2.397832820503157
store: 9.930133819580078e-05, 0.00142003460695777, 22.207235776984188
store_sales: 174.69669486396015, 23.518546185451715, 7.117207235049037
time_dim: 0.0012146271765232086, 0.0017928213560849842, 2.657513026775095
warehouse: 2.907589077949524e-06, 0.0014493304849609674, 0.8701641844533934
-0.29706832620697854
customer: 0.8535048151388764, 0.11665491975272499, 5.355119439235083
customer_address: 0.2449320713058114, 0.049758064727502, 5.223623416797602
customer_demographics: 0.011580578982830048, 0.005958278487230162, 4.598802663398082
date_dim: 0.001992875710129738, 0.001942477906221188, 23.09931993795745
household_demographics: 3.5176053643226624e-05, 0.0012819884482945841, 6.946659984118947
inventory: 5.1357166497036815, 0.8308974679323109, 0.22625179068604373
item: 0.03489831369370222, 0.008293970461537691, 16.426725256839745
promotion: 7.638614624738693e-05, 0.004892582157118571, 1.822792528782225
reason: 1.4491379261016846e-06, 0.0013672037026617172, 2.397832820503182
store: 9.930133819580078e-05, 0.0014200346052746086, 22.207235776985872
store_sales: 174.69669486396015, 23.518543224336078, 7.117210196164674
time_dim: 0.0012146271765232086, 0.0017928213354970073, 2.657513026795683
warehouse: 2.907589077949524e-06, 0.0014493304849116837, 0.8701641844534427
{}
{}
STARTING PHASE 2: 0b11101011110111110000
----
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
Function: 41.38402469329747, 2.6118099291849135, 14.054522514343262, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
-0.29706832620697854
customer: 0.8535048151388764, 0.11665491975272499, 5.355119439235083
customer_address: 0.2449320713058114, 0.049758064727502, 5.223623416797602
customer_demographics: 0.011580578982830048, 0.005958278487230162, 4.598802663398082
date_dim: 0.001992875710129738, 0.001942477906221188, 23.09931993795745
household_demographics: 3.5176053643226624e-05, 0.0012819884482945841, 6.946659984118947
inventory: 5.1357166497036815, 0.8308974679323109, 0.22625179068604373
item: 0.03489831369370222, 0.008293970461537691, 16.426725256839745
promotion: 7.638614624738693e-05, 0.004892582157118571, 1.822792528782225
reason: 1.4491379261016846e-06, 0.0013672037026617172, 2.397832820503182
store: 9.930133819580078e-05, 0.0014200346052746086, 22.207235776985872
store_sales: 174.69669486396015, 23.518543224336078, 7.117210196164674
time_dim: 0.0012146271765232086, 0.0017928213354970073, 2.657513026795683
warehouse: 2.907589077949524e-06, 0.0014493304849116837, 0.8701641844534427
customer: 0.8535048151388764, 0.11665339455551232, 5.355120964432296
customer_address: 0.2449320713058114, 0.04975762703845113, 5.223623854486653
customer_demographics: 0.011580578982830048, 0.005958257792951146, 4.5988026840923615
date_dim: 0.001992875710129738, 0.0019424743449894006, 22.042170682900323
household_demographics: 3.5176053643226624e-05, 0.0012819883854356313, 6.946659984181806
item: 0.03489831369370222, 0.008293908098900914, 15.369576060584023
promotion: 7.638614624738693e-05, 0.00489258202061795, 1.8227925289187257
reason: 1.4491379261016846e-06, 0.0013672037000721348, 2.3978328205057715
store: 9.930133819580078e-05, 0.0014200344278249661, 22.207235777163323
store_sales: 174.69669486396015, 23.51823104459515, 6.931986632225602
time_dim: 0.0012146271765232086, 0.0017928191649808588, 2.657513028966199
warehouse: 2.907589077949524e-06, 0.0014493304797158762, -0.0014493304797158762
warehouse had no query dependencies
customer: 0.8535048151388764, 0.11665338564759335, 5.355120973340215
customer_address: 0.2449320713058114, 0.049757624482126894, 5.223623857042977
customer_demographics: 0.011580578982830048, 0.005958257672086146, 4.598802684213227
date_dim: 0.001992875710129738, 0.0019424743241900154, 22.042170682921125
household_demographics: 3.5176053643226624e-05, 0.0012819883850685033, 6.946659984182173
item: 0.03489831369370222, 0.008293907734671745, 15.369576060948253
promotion: 7.638614624738693e-05, 0.0048925820198207175, 1.822792528919523
reason: 1.4491379261016846e-06, 0.0013672037000570104, 2.3978328205057866
store: 9.930133819580078e-05, 0.001420034426788571, 22.207235777164357
store_sales: 174.69669486396015, 23.518229221308424, 6.931988455512329
time_dim: 0.0012146271765232086, 0.0017928191523039526, 2.657513028978876
Function: 41.60358935518919, 2.5793862813091275, 15.144095420837402, 21.26992180922682, 2.5882919938262305, 0.00659083935798959, 0.015303010631626845
hiya: 0b1101011100111110000, 41.60358935518919
customer: 0.8535048151388764, 0.11665338564759335, 5.355120973340215
customer_address: 0.2449320713058114, 0.049757624482126894, 5.223623857042977
customer_demographics: 0.011580578982830048, 0.005958257672086146, 4.598802684213227
date_dim: 0.001992875710129738, 0.0019424743241900154, 22.042170682921125
household_demographics: 3.5176053643226624e-05, 0.0012819883850685033, 6.946659984182173
item: 0.03489831369370222, 0.008293907734671745, 15.369576060948253
promotion: 7.638614624738693e-05, 0.0048925820198207175, 1.822792528919523
reason: 1.4491379261016846e-06, 0.0013672037000570104, 2.3978328205057866
store: 9.930133819580078e-05, 0.001420034426788571, 22.207235777164357
store_sales: 174.69669486396015, 23.518229221308424, 6.931988455512329
time_dim: 0.0012146271765232086, 0.0017928191523039526, 2.657513028978876
customer: 0.8535048151388764, 0.11665279517316007, 4.28983725352304
customer_address: 0.2449320713058114, 0.049757455032437295, 4.158339716201058
customer_demographics: 0.011580578982830048, 0.005958249660372925, 3.836401891577204
date_dim: 0.001992875710129738, 0.0019424729454723625, 20.2144855733605
household_demographics: 3.5176053643226624e-05, 0.0012819883607328934, 6.946659984206509
item: 0.03489831369370222, 0.008293883591208655, 13.541890974152372
reason: 1.4491379261016846e-06, 0.001367203699054463, 2.397832820506789
store: 9.930133819580078e-05, 0.0014200343580896013, 21.141951466941446
store_sales: 174.69669486396015, 23.51810836208178, 5.104424203799628
time_dim: 0.0012146271765232086, 0.0017928183119966913, 2.657513029819183
Function: 43.42626015728632, 2.4888747140868506, 17.062292098999023, 21.269912569685875, 2.583418587606748, 0.006469182875957587, 0.01529300403186381
hiya: 0b1101010100111110000, 43.42626015728632
customer: 0.8535048151388764, 0.11665279517316007, 4.28983725352304
customer_address: 0.2449320713058114, 0.049757455032437295, 4.158339716201058
customer_demographics: 0.011580578982830048, 0.005958249660372925, 3.836401891577204
date_dim: 0.001992875710129738, 0.0019424729454723625, 20.2144855733605
household_demographics: 3.5176053643226624e-05, 0.0012819883607328934, 6.946659984206509
item: 0.03489831369370222, 0.008293883591208655, 13.541890974152372
reason: 1.4491379261016846e-06, 0.001367203699054463, 2.397832820506789
store: 9.930133819580078e-05, 0.0014200343580896013, 21.141951466941446
store_sales: 174.69669486396015, 23.51810836208178, 5.104424203799628
time_dim: 0.0012146271765232086, 0.0017928183119966913, 2.657513029819183
customer: 0.8535048151388764, 0.11665215365575395, 4.2898378950404465
customer_address: 0.2449320713058114, 0.04975727093483846, 4.158339900298657
customer_demographics: 0.011580578982830048, 0.005958240956095154, 3.8364019002814818
date_dim: 0.001992875710129738, 0.0019424714475728385, 20.214485574858397
household_demographics: 3.5176053643226624e-05, 0.0012819883342936158, 6.946659984232947
item: 0.03489831369370222, 0.008293857360688005, 13.541891000382893
store: 9.930133819580078e-05, 0.0014200342834520176, 21.141951467016085
store_sales: 174.69669486396015, 23.517977055299955, 2.705355486375609
time_dim: 0.0012146271765232086, 0.0017928173990499079, 2.65751303073213
Function: 45.823960806560805, 2.3866013114738465, 19.56376552581787, 21.26991239440057, 2.5820615579827626, 0.006337012979093831, 0.015283003906658292
hiya: 0b1101000100111110000, 45.823960806560805
customer: 0.8535048151388764, 0.11665215365575395, 4.2898378950404465
customer_address: 0.2449320713058114, 0.04975727093483846, 4.158339900298657
customer_demographics: 0.011580578982830048, 0.005958240956095154, 3.8364019002814818
date_dim: 0.001992875710129738, 0.0019424714475728385, 20.214485574858397
household_demographics: 3.5176053643226624e-05, 0.0012819883342936158, 6.946659984232947
item: 0.03489831369370222, 0.008293857360688005, 13.541891000382893
store: 9.930133819580078e-05, 0.0014200342834520176, 21.141951467016085
store_sales: 174.69669486396015, 23.517977055299955, 2.705355486375609
time_dim: 0.0012146271765232086, 0.0017928173990499079, 2.65751303073213
customer: 0.8535048151388764, 0.11665188115977099, 4.28983816753643
customer_address: 0.2449320713058114, 0.04975719273609331, 4.158339978497402
customer_demographics: 0.011580578982830048, 0.0059582372587976135, 3.8364019039787793
date_dim: 0.001992875710129738, 0.0019424708113132464, 20.214485575494656
household_demographics: 3.5176053643226624e-05, 0.0012819883230630602, 4.287354136112998
item: 0.03489831369370222, 0.008293846218805587, 13.541891011524775
store: 9.930133819580078e-05, 0.0014200342517483703, 18.48264561891661
store_sales: 174.69669486396015, 23.51792128039776, 0.04610541314662342
Function: 48.481416532159926, 2.344219346799851, 22.265453338623047, 21.269765475121677, 2.580424644560814, 0.00628082809166792, 0.01527289896287024
hiya: 0b101000100111110000, 48.481416532159926
customer: 0.8535048151388764, 0.11665188115977099, 4.28983816753643
customer_address: 0.2449320713058114, 0.04975719273609331, 4.158339978497402
customer_demographics: 0.011580578982830048, 0.0059582372587976135, 3.8364019039787793
date_dim: 0.001992875710129738, 0.0019424708113132464, 20.214485575494656
household_demographics: 3.5176053643226624e-05, 0.0012819883230630602, 4.287354136112998
item: 0.03489831369370222, 0.008293846218805587, 13.541891011524775
store: 9.930133819580078e-05, 0.0014200342517483703, 18.48264561891661
store_sales: 174.69669486396015, 23.51792128039776, 0.04610541314662342
customer: 0.8535048151388764, 0.11662168921215141, -0.11662168921215141
customer had no query dependencies
customer_address: 0.2449320713058114, 0.04974852848940594, -0.04974852848940594
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.0059578276064701135, -0.0059578276064701135
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0019424003151684265, -0.0019424003151684265
date_dim had no query dependencies
household_demographics: 3.5176053643226624e-05, 0.0012819870787425243, -0.0012819870787425243
household_demographics had no query dependencies
item: 0.03489831369370222, 0.008292611723064775, -0.008292611723064775
item had no query dependencies
store: 9.930133819580078e-05, 0.001420030739054888, -0.001420030739054888
store had no query dependencies
Function: 48.173699378967285, 0, 48.173699378967285, 0.0, 0, 0.0, 0
hiya: 0b0, 48.173699378967285
{41.38402469329747: [4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19], 41.60358935518919: [4, 5, 6, 7, 8, 11, 12, 13, 15, 17, 18], 43.42626015728632: [4, 5, 6, 7, 8, 11, 13, 15, 17, 18], 45.823960806560805: [4, 5, 6, 7, 8, 11, 15, 17, 18], 48.481416532159926: [4, 5, 6, 7, 8, 11, 15, 17], 48.173699378967285: []}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{'21': 527488, '09': 139264, '39': 527488, '68': 164272, '42': 133248, '08': 164016, '96': 426240, '43': 163968, '59': 163968, '19': 166064, '88': 426240, '65': 166016, '28': 131072, '73': 164240, '61': 170160, '53': 166016, '06': 133296, '89': 166016, '13': 164320, '67': 166016, '55': 133248, '34': 164240, '70': 163968, '63': 166016, '48': 164064, '03': 133248, '82': 134272, '47': 166016, '07': 137408, '44': 133120, '36': 166016, '79': 164240, '46': 164272, '52': 133248, '98': 133248, '27': 166080, '22': 527488}
Best Cost: $41.38402469329747;
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
{}
{'21': 527488, '09': 139264, '39': 527488, '68': 164272, '42': 133248, '08': 164016, '96': 426240, '43': 163968, '59': 163968, '19': 166064, '88': 426240, '65': 166016, '28': 131072, '73': 164240, '61': 170160, '53': 166016, '06': 133296, '89': 166016, '13': 164320, '67': 166016, '55': 133248, '34': 164240, '70': 163968, '63': 166016, '48': 164064, '03': 133248, '82': 134272, '47': 166016, '07': 137408, '44': 133120, '36': 166016, '79': 164240, '46': 164272, '52': 133248, '98': 133248, '27': 166080, '22': 527488}
{'21': 527488, '09': 139264, '39': 527488, '68': 164272, '42': 133248, '08': 164016, '96': 426240, '43': 163968, '59': 163968, '19': 166064, '88': 426240, '65': 166016, '28': 131072, '73': 164240, '61': 170160, '53': 166016, '06': 133296, '89': 166016, '13': 164320, '67': 166016, '55': 133248, '34': 164240, '70': 163968, '63': 166016, '48': 164064, '03': 133248, '82': 134272, '47': 166016, '07': 137408, '44': 133120, '36': 166016, '79': 164240, '46': 164272, '52': 133248, '98': 133248, '27': 166080, '22': 527488}
[4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 17, 18, 19]
13
Optimal Subset: 0b11101011110111110000
Function: 41.38402469329747, 2.6118099291849135, 14.054522514343262, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
41.38402469329747
Real: 41.38402469329747, 2.6118099291849135, 14.054522514343262, 21.891129887344352, 2.803686996498108, 0.007108629125463433, 0.01576673680137694
Num Redshift Qs: 37; Num GCP Qs: 26
Redshift Qs: $2.6118099291849135; GCP Qs: $14.054522514343262; Movement Cost: $21.891129887344352
Load Cost: $2.803686996498108, Storage Cost: $0.007108629125463433, API Cost: $0.01576673680137694
Final cost: $41.38402469329747, BQ Baseline: $48.173699378967285, Diff: $6.789674685669816, %: 14.09415256291112%
