Egress: $0.12/GB
Benchmark: tpcds
Data Path: parquet_1000/internal_rs1
BigQuery Cost: $5/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $1.086/hr
Use Duck: False
Excluded Table: household_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.965635168103377, Redshift-Calcite Total: $5.303812342617514, BigQuery Total: $37.53030300140381
!!!!!!: 33.154922008354276
Excluding table household_demographics and any queries that depend on it
Total Keys: 86, Keys Considered: 83
-0.7056568687217925
call_center: 9.615905582904816e-06, 0.00039808220497355133, 0.6428088517626963
catalog_page: 0.0017016949132084846, 0.0014782205962617573, 2.055433092793278
catalog_returns: 13.009788101539016, 1.695216495332848, 4.797698651198417
catalog_sales: 132.3057429259643, 17.396308762820244, 2.073200222647504
customer: 0.8535048151388764, 0.11266499178596252, 6.4549141487949315
customer_address: 0.2449320713058114, 0.03389583404433147, 8.235673509396996
customer_demographics: 0.011580578982830048, 0.0025384384158888824, 4.281388069548245
date_dim: 0.001992875710129738, 0.0007719355622596323, 31.49369064963027
income_band: 5.122274160385132e-07, 0.0003478788496799214, -0.0003478788496799214
income_band had no query dependencies
inventory: 5.1357166497036815, 0.7697087081389544, -0.16667941763807514
item: 0.03489831369370222, 0.005311029675198739, 19.886285814750405
promotion: 7.638614624738693e-05, 0.0004580645915866883, 3.066024529005984
reason: 1.4491379261016846e-06, 0.0003583095667489088, 0.8777342324704203
ship_mode: 1.3029202818870544e-06, 0.00034878311487255203, 0.921443949838358
store: 9.930133819580078e-05, 0.0004650579637820225, 12.913340284965978
store_returns: 20.850121902301908, 2.7193980364525943, 7.33940264330818
store_sales: 174.69669486396015, 23.1291951278953, 5.720769087504522
time_dim: 0.0012146271765232086, 0.0008089946368370094, 1.2534902843074964
warehouse: 2.907589077949524e-06, 0.0003193878029761815, 1.467160351739826
web_page: 7.394980639219284e-05, 0.0003502036613096868, 0.933513908234649
web_returns: 6.285572262480855, 0.8120003693324755, 5.638852509488023
web_sales: 67.01082486007363, 8.80781364483686, 7.651524906589467
web_site: 1.0454095900058746e-05, 0.0003302305476068437, 2.487410572268148
call_center: 9.615905582904816e-06, 0.00039808214570097945, 0.6428088518219688
catalog_page: 0.0017016949132084846, 0.001478210106991333, 2.055433103282548
catalog_returns: 13.009788101539016, 1.6951363028233095, 4.797778843707956
catalog_sales: 132.3057429259643, 17.39549322843423, 1.9406669335564892
customer: 0.8535048151388764, 0.11265973077075653, 6.454919409810137
customer_address: 0.2449320713058114, 0.033894324279736446, 8.235675019161592
customer_demographics: 0.011580578982830048, 0.0025383670330436513, 4.2813881409310905
date_dim: 0.001992875710129738, 0.0007719232781468438, 30.8906613714135
item: 0.03489831369370222, 0.005310814561521875, 19.2832567393632
promotion: 7.638614624738693e-05, 0.00045806412074145134, 3.0660245294768296
reason: 1.4491379261016846e-06, 0.00035830955781640305, 0.8777342324793528
ship_mode: 1.3029202818870544e-06, 0.0003487831068413338, 0.9214439498463891
store: 9.930133819580078e-05, 0.00046505735168723294, 12.913340285578071
store_returns: 20.850121902301908, 2.7192695160196347, 7.339531163741139
store_sales: 174.69669486396015, 23.128118295109108, 5.537780996018416
time_dim: 0.0012146271765232086, 0.0008089871498586913, 1.2534902917944748
warehouse: 2.907589077949524e-06, 0.0003193877850537632, 1.1815448090061975
web_page: 7.394980639219284e-05, 0.0003502032054820816, 0.9335139086904766
web_returns: 6.285572262480855, 0.811961624980171, 5.638891253840328
web_sales: 67.01082486007363, 8.807400589207528, 7.651937962218799
web_site: 1.0454095900058746e-05, 0.0003302304831676554, 2.487410572332587
{}
{}
STARTING PHASE 2: 0b111111111111100011111111
----
[0, 1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Function: 60.094284625101956, 2.9115500845758135, 2.0668601989746094, 50.235065741262666, 4.752374284910759, 0.09234163114762602, 0.0360926842304796
call_center: 9.615905582904816e-06, 0.00039808214570097945, 0.6428088518219688
catalog_page: 0.0017016949132084846, 0.001478210106991333, 2.055433103282548
catalog_returns: 13.009788101539016, 1.6951363028233095, 4.797778843707956
catalog_sales: 132.3057429259643, 17.39549322843423, 1.9406669335564892
customer: 0.8535048151388764, 0.11265973077075653, 6.454919409810137
customer_address: 0.2449320713058114, 0.033894324279736446, 8.235675019161592
customer_demographics: 0.011580578982830048, 0.0025383670330436513, 4.2813881409310905
date_dim: 0.001992875710129738, 0.0007719232781468438, 30.8906613714135
item: 0.03489831369370222, 0.005310814561521875, 19.2832567393632
promotion: 7.638614624738693e-05, 0.00045806412074145134, 3.0660245294768296
reason: 1.4491379261016846e-06, 0.00035830955781640305, 0.8777342324793528
ship_mode: 1.3029202818870544e-06, 0.0003487831068413338, 0.9214439498463891
store: 9.930133819580078e-05, 0.00046505735168723294, 12.913340285578071
store_returns: 20.850121902301908, 2.7192695160196347, 7.339531163741139
store_sales: 174.69669486396015, 23.128118295109108, 5.537780996018416
time_dim: 0.0012146271765232086, 0.0008089871498586913, 1.2534902917944748
warehouse: 2.907589077949524e-06, 0.0003193877850537632, 1.1815448090061975
web_page: 7.394980639219284e-05, 0.0003502032054820816, 0.9335139086904766
web_returns: 6.285572262480855, 0.811961624980171, 5.638891253840328
web_sales: 67.01082486007363, 8.807400589207528, 7.651937962218799
web_site: 1.0454095900058746e-05, 0.0003302304831676554, 2.487410572332587
catalog_page: 0.0017016949132084846, 0.0014782003520558671, 2.0554331130374837
catalog_returns: 13.009788101539016, 1.6950617244471449, 4.539059031152593
catalog_sales: 132.3057429259643, 17.39473478814391, 1.2982184398791397
customer: 0.8535048151388764, 0.11265483806976363, 6.45492430251113
customer_address: 0.2449320713058114, 0.03389292021104555, 7.976882032298755
customer_demographics: 0.011580578982830048, 0.002538300647583039, 4.281388207316551
date_dim: 0.001992875710129738, 0.0007719118540226997, 30.247454448869956
item: 0.03489831369370222, 0.005310614507566664, 19.153247135671407
promotion: 7.638614624738693e-05, 0.00045806368285924266, 3.0660245299147117
reason: 1.4491379261016846e-06, 0.00035830954950924596, 0.8777342324876599
ship_mode: 1.3029202818870544e-06, 0.00034878309937236675, 0.6670412105634618
store: 9.930133819580078e-05, 0.00046505678244409876, 12.913340286147315
store_returns: 20.850121902301908, 2.7191499930710537, 7.33965068668972
store_sales: 174.69669486396015, 23.127116849449685, 5.538782441677839
time_dim: 0.0012146271765232086, 0.0008089801870302606, 1.2534902987573031
warehouse: 2.907589077949524e-06, 0.00031938776838606113, 0.927142069732469
web_page: 7.394980639219284e-05, 0.0003502027815661473, 0.9335139091143925
web_returns: 6.285572262480855, 0.8119255930502931, 5.638927285770206
web_sales: 67.01082486007363, 8.807016450859962, 7.652322100566366
web_site: 1.0454095900058746e-05, 0.0003302304232397388, 2.4874105723925153
Function: 60.73471271728235, 2.714345832325222, 2.907271385192871, 50.235064578138754, 4.751987359642585, 0.089960878583254, 0.03608268339966536
hiya: 0b111111111111100011111110, 60.73471271728235
catalog_page: 0.0017016949132084846, 0.0014782003520558671, 2.0554331130374837
catalog_returns: 13.009788101539016, 1.6950617244471449, 4.539059031152593
catalog_sales: 132.3057429259643, 17.39473478814391, 1.2982184398791397
customer: 0.8535048151388764, 0.11265483806976363, 6.45492430251113
customer_address: 0.2449320713058114, 0.03389292021104555, 7.976882032298755
customer_demographics: 0.011580578982830048, 0.002538300647583039, 4.281388207316551
date_dim: 0.001992875710129738, 0.0007719118540226997, 30.247454448869956
item: 0.03489831369370222, 0.005310614507566664, 19.153247135671407
promotion: 7.638614624738693e-05, 0.00045806368285924266, 3.0660245299147117
reason: 1.4491379261016846e-06, 0.00035830954950924596, 0.8777342324876599
ship_mode: 1.3029202818870544e-06, 0.00034878309937236675, 0.6670412105634618
store: 9.930133819580078e-05, 0.00046505678244409876, 12.913340286147315
store_returns: 20.850121902301908, 2.7191499930710537, 7.33965068668972
store_sales: 174.69669486396015, 23.127116849449685, 5.538782441677839
time_dim: 0.0012146271765232086, 0.0008089801870302606, 1.2534902987573031
warehouse: 2.907589077949524e-06, 0.00031938776838606113, 0.927142069732469
web_page: 7.394980639219284e-05, 0.0003502027815661473, 0.9335139091143925
web_returns: 6.285572262480855, 0.8119255930502931, 5.638927285770206
web_sales: 67.01082486007363, 8.807016450859962, 7.652322100566366
web_site: 1.0454095900058746e-05, 0.0003302304232397388, 2.4874105723925153
catalog_page: 0.0017016949132084846, 0.0014781997552442059, 2.0554331136342956
catalog_returns: 13.009788101539016, 1.6950571617060863, 4.539063593893652
catalog_sales: 132.3057429259643, 17.39468838640079, 0.7588043056767653
customer: 0.8535048151388764, 0.11265453873195479, 6.454924601848939
customer_address: 0.2449320713058114, 0.03389283430944518, 7.976882118200355
customer_demographics: 0.011580578982830048, 0.0025382965860885095, 4.2813882113780455
date_dim: 0.001992875710129738, 0.0007719111550892692, 29.580064455906058
item: 0.03489831369370222, 0.005310602268169103, 19.153247147910808
promotion: 7.638614624738693e-05, 0.00045806365606939774, 3.0660245299415014
reason: 1.4491379261016846e-06, 0.0003583095490010101, 0.8777342324881682
store: 9.930133819580078e-05, 0.000465056747617529, 12.913340286182141
store_returns: 20.850121902301908, 2.719142680599356, 7.3396579991614175
store_sales: 174.69669486396015, 23.127055580520764, 5.538843710606759
time_dim: 0.0012146271765232086, 0.0008089797610410557, 0.7140297632377973
warehouse: 2.907589077949524e-06, 0.00031938776736632307, 0.2597520760706546
web_page: 7.394980639219284e-05, 0.00035020275563076573, 0.9335139091403278
web_returns: 6.285572262480855, 0.8119233885994277, 5.638929490221072
web_sales: 67.01082486007363, 8.806992949090404, 6.98495560867309
web_site: 1.0454095900058746e-05, 0.0003302304195733199, 2.3594811146788426
Function: 61.40160827113718, 2.7025957350456733, 3.586411476135254, 50.23506442053969, 4.751648733288447, 0.08981522284102107, 0.036072683287093045
hiya: 0b111111111011100011111110, 61.40160827113718
catalog_page: 0.0017016949132084846, 0.0014781997552442059, 2.0554331136342956
catalog_returns: 13.009788101539016, 1.6950571617060863, 4.539063593893652
catalog_sales: 132.3057429259643, 17.39468838640079, 0.7588043056767653
customer: 0.8535048151388764, 0.11265453873195479, 6.454924601848939
customer_address: 0.2449320713058114, 0.03389283430944518, 7.976882118200355
customer_demographics: 0.011580578982830048, 0.0025382965860885095, 4.2813882113780455
date_dim: 0.001992875710129738, 0.0007719111550892692, 29.580064455906058
item: 0.03489831369370222, 0.005310602268169103, 19.153247147910808
promotion: 7.638614624738693e-05, 0.00045806365606939774, 3.0660245299415014
reason: 1.4491379261016846e-06, 0.0003583095490010101, 0.8777342324881682
store: 9.930133819580078e-05, 0.000465056747617529, 12.913340286182141
store_returns: 20.850121902301908, 2.719142680599356, 7.3396579991614175
store_sales: 174.69669486396015, 23.127055580520764, 5.538843710606759
time_dim: 0.0012146271765232086, 0.0008089797610410557, 0.7140297632377973
warehouse: 2.907589077949524e-06, 0.00031938776736632307, 0.2597520760706546
web_page: 7.394980639219284e-05, 0.00035020275563076573, 0.9335139091403278
web_returns: 6.285572262480855, 0.8119233885994277, 5.638929490221072
web_sales: 67.01082486007363, 8.806992949090404, 6.98495560867309
web_site: 1.0454095900058746e-05, 0.0003302304195733199, 2.3594811146788426
catalog_page: 0.0017016949132084846, 0.0014781989136799021, 2.0554331144758597
catalog_returns: 13.009788101539016, 1.6950507277835412, 4.278998563978175
catalog_sales: 132.3057429259643, 17.3946229552888, 0.498798272950733
customer: 0.8535048151388764, 0.11265411663562012, 6.454925023945274
customer_address: 0.2449320713058114, 0.033892713179572556, 7.976882239330227
customer_demographics: 0.011580578982830048, 0.0025382908589738464, 4.28138821710516
date_dim: 0.001992875710129738, 0.0007719101695230279, 29.319992993053603
item: 0.03489831369370222, 0.0053105850093909035, 18.893175701331565
promotion: 7.638614624738693e-05, 0.0004580636182930293, 3.066024529979278
reason: 1.4491379261016846e-06, 0.0003583095482843465, 0.8777342324888848
store: 9.930133819580078e-05, 0.0004650566985085725, 12.91334028623125
store_returns: 20.850121902301908, 2.719132369280807, 7.339668310479967
store_sales: 174.69669486396015, 23.126969185185587, 5.538930105941937
time_dim: 0.0012146271765232086, 0.0008089791603535493, 0.7140297638384849
web_page: 7.394980639219284e-05, 0.0003502027190592764, 0.9335139091768994
web_returns: 6.285572262480855, 0.8119202801025964, 5.638932598717902
web_sales: 67.01082486007363, 8.806959809238052, 6.984988748525442
web_site: 1.0454095900058746e-05, 0.0003302304144033016, 2.3594811146840122
Function: 61.661154955614684, 2.685858460175198, 3.86322021484375, 50.23506406884256, 4.751339695311785, 0.08960983340551358, 0.03606268303587735
hiya: 0b111101111011100011111110, 61.661154955614684
catalog_page: 0.0017016949132084846, 0.0014781989136799021, 2.0554331144758597
catalog_returns: 13.009788101539016, 1.6950507277835412, 4.278998563978175
catalog_sales: 132.3057429259643, 17.3946229552888, 0.498798272950733
customer: 0.8535048151388764, 0.11265411663562012, 6.454925023945274
customer_address: 0.2449320713058114, 0.033892713179572556, 7.976882239330227
customer_demographics: 0.011580578982830048, 0.0025382908589738464, 4.28138821710516
date_dim: 0.001992875710129738, 0.0007719101695230279, 29.319992993053603
item: 0.03489831369370222, 0.0053105850093909035, 18.893175701331565
promotion: 7.638614624738693e-05, 0.0004580636182930293, 3.066024529979278
reason: 1.4491379261016846e-06, 0.0003583095482843465, 0.8777342324888848
store: 9.930133819580078e-05, 0.0004650566985085725, 12.91334028623125
store_returns: 20.850121902301908, 2.719132369280807, 7.339668310479967
store_sales: 174.69669486396015, 23.126969185185587, 5.538930105941937
time_dim: 0.0012146271765232086, 0.0008089791603535493, 0.7140297638384849
web_page: 7.394980639219284e-05, 0.0003502027190592764, 0.9335139091768994
web_returns: 6.285572262480855, 0.8119202801025964, 5.638932598717902
web_sales: 67.01082486007363, 8.806959809238052, 6.984988748525442
web_site: 1.0454095900058746e-05, 0.0003302304144033016, 2.3594811146840122
catalog_page: 0.0017016949132084846, 0.0014780601926954091, -0.0014780601926954091
catalog_page had no query dependencies
catalog_returns: 13.009788101539016, 1.6939901789157723, -1.6412849622616306
customer: 0.8535048151388764, 0.11258453951735609, 2.8685400277191464
customer_address: 0.2449320713058114, 0.03387274648765749, 3.7100689897837236
customer_demographics: 0.011580578982830048, 0.0025373468182383254, 2.421435947901219
date_dim: 0.001992875710129738, 0.000771747711682709, 11.426571927271894
item: 0.03489831369370222, 0.00530774012315709, 7.919868395991441
promotion: 7.638614624738693e-05, 0.00045805739134757224, 1.3991906722755212
reason: 1.4491379261016846e-06, 0.0003583094301516318, 0.8777342326070176
store: 9.930133819580078e-05, 0.00046504860353262283, 6.984325890797457
store_returns: 20.850121902301908, 2.7174326818605548, -1.1648136111470349
store_sales: 174.69669486396015, 23.112728032255582, -10.890461290586007
time_dim: 0.0012146271765232086, 0.0008088801447918222, -0.0008088801447918222
time_dim had no query dependencies
web_page: 7.394980639219284e-05, 0.00035019669072254805, 0.17552194873634552
web_returns: 6.285572262480855, 0.811407884628187, -0.2818990809152627
web_sales: 67.01082486007363, 8.801497133452793, -6.606716847520173
web_site: 1.0454095900058746e-05, 0.0003302295621926826, 0.30256980214668355
customer: 0.8535048151388764, 0.11247042971068508, -0.11247042971068508
customer had no query dependencies
customer_address: 0.2449320713058114, 0.03384000015651971, -0.03384000015651971
customer_address had no query dependencies
customer_demographics: 0.011580578982830048, 0.0025357985462128724, -0.0025357985462128724
customer_demographics had no query dependencies
date_dim: 0.001992875710129738, 0.0007714812730429162, -0.0007714812730429162
date_dim had no query dependencies
item: 0.03489831369370222, 0.005303074373464648, -0.005303074373464648
item had no query dependencies
promotion: 7.638614624738693e-05, 0.00045804717885875436, -0.00045804717885875436
promotion had no query dependencies
reason: 1.4491379261016846e-06, 0.00035830923640832105, -0.00035830923640832105
reason had no query dependencies
store: 9.930133819580078e-05, 0.0004650353273843192, -0.0004650353273843192
store had no query dependencies
web_page: 7.394980639219284e-05, 0.0003501868039615584, -0.0003501868039615584
web_page had no query dependencies
web_site: 1.0454095900058746e-05, 0.000330228164526447, -0.000330228164526447
web_site had no query dependencies
Function: 37.53030300140381, 0, 37.53030300140381, 0.0, 0, 0.0, 0
hiya: 0b0, 37.53030300140381
{60.094284625101956: [0, 1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 60.73471271728235: [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 61.40160827113718: [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23], 61.661154955614684: [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23], 37.53030300140381: []}
[]
{}
Best Cost: $37.53030300140381;
[]
{}
{}
{}
[]
0
Optimal Subset: 0b0
Function: 37.53030300140381, 0, 37.53030300140381, 0.0, 0, 0.0, 0
37.53030300140381
Real: 37.53030300140381, 0, 37.53030300140381, 0.0, 0, 0.0, 0
Num Redshift Qs: 0; Num GCP Qs: 86
Redshift Qs: $0; GCP Qs: $37.53030300140381; Movement Cost: $0.0
Load Cost: $0, Storage Cost: $0.0, API Cost: $0
Final cost: $37.53030300140381, BQ Baseline: $37.53030300140381, Diff: $0.0, %: 0.0%
