Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: customer_demographics
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $9.756788056681955, BigQuery Total: $103.97772192955017
01: $0.04251913135846455
02: $0.25014779800891873
03: $0.47502096817970274
04: $3.8661244323968886
05: $1.4304585849189757
06: $0.3632350847975413
08: $0.4728430971686045
09: $4.166115921802521
11: $1.6160064807542165
12: $0.1233327794043223
14: $15.638491943470637
15: $0.25032848659515383
16: $0.7151701463317871
17: $0.9640249739869435
19: $0.7144547079753876
20: $0.25383286993821463
21: $0.13902823099136352
22: $0.6999924237171808
23: $0.1203815823284784
24: $1.4943556775426865
25: $1.1788075348933538
28: $4.860953305471738
29: $0.954251956636111
30: $0.012125212178230286
31: $1.7751692107454935
32: $0.5117330439758301
33: $1.1213197820679346
34: $0.6075768459717432
36: $2.4807855692911147
37: $0.16629489990234375
38: $0.3463533362611135
39: $0.27900081528663634
40: $0.41604152888298035
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
45: $0.15160362540721894
46: $1.1849251066462199
47: $0.48158571960449215
49: $1.8010069972499212
50: $0.661454455537796
51: $0.5829390027141571
52: $0.4759971203915278
53: $0.5979665479230881
54: $0.7558387576993306
55: $0.4760878943316142
56: $1.1214404756466547
57: $0.27304382418314616
58: $0.8539149026123682
59: $0.4287443129523595
60: $1.1220686246951421
61: $1.6324246692927677
62: $0.1538115687449773
63: $0.597844746427536
65: $0.5961180507278443
66: $0.8382468031756083
67: $6.203618795018196
68: $1.4156545792627335
70: $1.8907469585673014
71: $1.0642372519636154
73: $0.6095429498179754
74: $0.779892116077741
75: $2.7449614957491555
76: $1.0597011683511735
77: $1.3902296223608652
78: $1.1057289998229343
79: $1.1831403943077723
80: $1.7595691417249042
81: $0.022080078539848325
82: $0.22990267293135325
83: $0.06329148495833078
86: $0.3697533963696162
87: $0.32961105404376984
88: $2.8978831026617686
89: $0.5970417350339889
90: $0.18988620407740275
92: $0.24658876627922058
93: $0.7705190082454682
94: $0.3080027531592051
95: $0.31277829689025877
96: $0.361907244758606
97: $0.4646914958365758
98: $0.4751735880470276
99: $0.22156503650188447
!!!!!!: 94.22237300143242
Excluding table customer_demographics and any queries that depend on it
Total Keys: 85, Keys Considered: 84
[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
{'15': 184, '93': 204800, '23': 4327576, '59': 163968, '70': 163968, '36': 166016, '25': 231560, '89': 166016, '17': 231560, '79': 164240, '68': 164272, '12': 4196480, '76': 4327560, '08': 164016, '14': 4327560, '53': 166016, '75': 6490252, '81': 180, '03': 133248, '74': 4325520, '83': 2164868, '32': 2184, '77': 7569548, '24': 231472, '46': 164272, '51': 4325504, '80': 14915726, '97': 131208, '43': 163968, '05': 14909582, '45': 4196528, '30': 2097328, '31': 4325536, '92': 4196480, '99': 540809, '52': 133248, '61': 170160, '38': 4325528, '42': 133248, '02': 4194440, '34': 164240, '94': 14680224, '95': 14680224, '37': 3208, '50': 229504, '04': 4325528, '96': 426240, '20': 2184, '22': 527488, '09': 139264, '65': 166016, '40': 526476, '71': 4589704, '49': 6488204, '55': 133248, '58': 4327560, '33': 4327592, '67': 166016, '57': 2185, '88': 426240, '90': 5505280, '63': 166016, '11': 4325520, '44': 133120, '19': 166064, '47': 166016, '21': 527488, '28': 131072, '06': 133296, '86': 4196480, '60': 4327592, '56': 4327592, '01': 98448, '87': 4325528, '16': 173, '54': 4360376, '39': 527488, '78': 6488204, '98': 133248, '29': 231560, '62': 13123712, '66': 4997256, '82': 134272, '73': 164240}
call_center: 0.001569664710542387, 1.2082093423062754
catalog_page: 0.002285449789761533, 3.1877422768541184
catalog_returns: 0.13565451744912577, 11.312883563090576
catalog_sales: 1.7806895602091415, 43.30892899200358
customer: 0.01430151804518885, 17.956715888378696
customer_address: 0.018062824913605155, 14.927755547728593
date_dim: 0.002849474627312775, 78.59053604255027
household_demographics: 0.0020465230852649446, 8.448469904418955
income_band: 0.0019052423279873538, -0.0019052423279873538
income_band had no query dependencies
inventory: 0.12975408055883045, 1.3844649622700471
item: 0.0057646505630709315, 53.400998683967124
promotion: 0.005425072965193163, 3.3865687380524787
reason: 0.001962879277237201, 4.934672050770752
ship_mode: 0.002293837850493716, 1.2113295705719764
store: 0.0024364891543305514, 36.08260801589983
store_returns: 0.33659868662579445, 16.024580378360117
store_sales: 2.7721464987144024, 84.44002729785988
time_dim: 0.002535811483358474, 5.349624795153643
warehouse: 0.002364072146898819, 2.7453223351537326
web_page: 0.003958722554669388, 1.5761571038835986
web_returns: 0.07204378952811731, 10.856108799484664
web_sales: 1.080602875222388, 44.248994079949824
web_site: 0.0030121774646689426, 3.961608167973653
['income_band']
1
call_center: 0.0015696641197052458, 1.2082093428971126
catalog_page: 0.0022853619057512623, 3.1877423647381287
catalog_returns: 0.13503392184847696, 11.313504158691225
customer: 0.014261711956164857, 17.95675569446772
customer_address: 0.018054426665615148, 14.927763945976581
promotion: 0.00542506919793242, 3.3865687418197394
ship_mode: 0.002293837765255141, 1.2113295706572151
store_returns: 0.33562222187652285, 16.02555684310939
web_page: 0.003958718994304578, 1.5761571074439633
web_returns: 0.0717425677886705, 10.85641002122411
web_site: 0.003012176840353971, 3.9616081685979676
[]
0
{'14': 4327560, '22': 527488, '09': 139264, '67': 166016, '88': 426240, '28': 131072, '39': 527488, '15': 48, '93': 65536, '23': 16, '59': 0, '70': 0, '36': 0, '25': 65536, '89': 0, '17': 65536, '79': 16, '68': 48, '12': 0, '76': 0, '08': 48, '53': 0, '75': 2162692, '03': 0, '74': 16, '32': 0, '77': 3211268, '24': 65584, '46': 48, '51': 0, '80': 10555398, '97': 0, '43': 0, '05': 10551302, '45': 48, '31': 32, '92': 0, '99': 16385, '52': 0, '61': 4144, '38': 16, '42': 0, '02': 0, '34': 16, '94': 10485792, '95': 10485792, '37': 0, '50': 65536, '04': 16, '96': 0, '20': 0, '65': 0, '40': 4, '71': 0, '49': 2162692, '55': 0, '58': 0, '33': 32, '57': 1, '90': 1048576, '63': 0, '11': 16, '44': 0, '19': 48, '47': 0, '21': 0, '06': 48, '86': 0, '60': 32, '56': 32, '87': 16, '16': 37, '54': 48, '78': 2162692, '98': 0, '29': 65536, '62': 8404992, '66': 16384, '82': 0, '73': 16}
{}
{'14': 4327560, '22': 527488, '09': 139264, '67': 166016, '88': 426240, '28': 131072, '39': 527488, '15': 48, '93': 65536, '23': 16, '59': 0, '70': 0, '36': 0, '25': 65536, '89': 0, '17': 65536, '79': 16, '68': 48, '12': 0, '76': 0, '08': 48, '53': 0, '75': 2162692, '03': 0, '74': 16, '32': 0, '77': 3211268, '24': 65584, '46': 48, '51': 0, '80': 10555398, '97': 0, '43': 0, '05': 10551302, '45': 48, '31': 32, '92': 0, '99': 16385, '52': 0, '61': 4144, '38': 16, '42': 0, '02': 0, '34': 16, '94': 10485792, '95': 10485792, '37': 0, '50': 65536, '04': 16, '96': 0, '20': 0, '65': 0, '40': 4, '71': 0, '49': 2162692, '55': 0, '58': 0, '33': 32, '57': 1, '90': 1048576, '63': 0, '11': 16, '44': 0, '19': 48, '47': 0, '21': 0, '06': 48, '86': 0, '60': 32, '56': 32, '87': 16, '16': 37, '54': 48, '78': 2162692, '98': 0, '29': 65536, '62': 8404992, '66': 16384, '82': 0, '73': 16}
STARTING PHASE 2: 0b0
----
[]
Function: 16.4728016727613, 9.755199916505818, 0.00014901161193847656, 0.33909843165373116, 6.30634203663826, 0.041220341226456986, 0.03079193512509465
{16.4728016727613: []}
Best Cost: $16.4728016727613;
[3, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 5, 12, 14, 16, 20, 21, 23]
{'15': 184, '93': 204800, '23': 4327576, '59': 163968, '70': 163968, '36': 166016, '25': 231560, '89': 166016, '17': 231560, '79': 164240, '68': 164272, '12': 4196480, '76': 4327560, '08': 164016, '14': 4327560, '53': 166016, '75': 6490252, '81': 180, '03': 133248, '74': 4325520, '83': 2164868, '32': 2184, '77': 7569548, '24': 231472, '46': 164272, '51': 4325504, '80': 14915726, '97': 131208, '43': 163968, '05': 14909582, '45': 4196528, '30': 2097328, '31': 4325536, '92': 4196480, '99': 540809, '52': 133248, '61': 170160, '38': 4325528, '42': 133248, '02': 4194440, '34': 164240, '94': 14680224, '95': 14680224, '37': 3208, '50': 229504, '04': 4325528, '96': 426240, '20': 2184, '22': 527488, '09': 139264, '65': 166016, '40': 526476, '71': 4589704, '49': 6488204, '55': 133248, '58': 4327560, '33': 4327592, '67': 166016, '57': 2185, '88': 426240, '90': 5505280, '63': 166016, '11': 4325520, '44': 133120, '19': 166064, '47': 166016, '21': 527488, '28': 131072, '06': 133296, '86': 4196480, '60': 4327592, '56': 4327592, '01': 98448, '87': 4325528, '16': 173, '54': 4360376, '39': 527488, '78': 6488204, '98': 133248, '29': 231560, '62': 13123712, '66': 4997256, '82': 134272, '73': 164240}
['41']
Excluding table customer_demographics and any queries that depend on it
[3, 7, 8, 10, 11, 13, 15, 17, 18, 19, 22, 0, 1, 2, 4, 5, 12, 14, 16, 20, 21, 23]
dict_keys(['15', '93', '23', '59', '70', '36', '25', '89', '17', '79', '68', '12', '76', '08', '14', '53', '75', '81', '03', '74', '83', '32', '77', '24', '46', '51', '80', '97', '43', '05', '45', '30', '31', '92', '99', '52', '61', '38', '42', '02', '34', '94', '95', '37', '50', '04', '96', '20', '22', '09', '65', '40', '71', '49', '55', '58', '33', '67', '57', '88', '90', '63', '11', '44', '19', '47', '21', '28', '06', '86', '60', '56', '01', '87', '16', '54', '39', '78', '98', '29', '62', '66', '82', '73'])
22
Optimal Subset: 0b111111111111110110111111
dict_keys(['15', '93', '23', '59', '70', '36', '25', '89', '17', '79', '68', '12', '76', '08', '14', '53', '75', '81', '03', '74', '83', '32', '77', '24', '46', '51', '80', '97', '43', '05', '45', '30', '31', '92', '99', '52', '61', '38', '42', '02', '34', '94', '95', '37', '50', '04', '96', '20', '22', '09', '65', '40', '71', '49', '55', '58', '33', '67', '57', '88', '90', '63', '11', '44', '19', '47', '21', '28', '06', '86', '60', '56', '01', '87', '16', '54', '39', '78', '98', '29', '62', '66', '82', '73'])
Function: 16.4728016727613, 9.755199916505818, 0.00014901161193847656, 0.33909843165373116, 6.30634203663826, 0.041220341226456986, 0.03079193512509465
Real: 16.4728016727613, 9.755199916505818, 0.00014901161193847656, 0.33909843165373116, 6.30634203663826, 0.041220341226456986, 0.03079193512509465
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 84; Num Redshift Qs: 1
PLAN TYPE IS: move
Moved Qs: $9.755199916505818; Stayed Qs: $0.00014901161193847656; Migration Cost: $6.717452744643543
Movement Cost: $0.33909843165373116, Load Cost: $6.30634203663826, Storage Cost: $0.041220341226456986, API Cost: $0.03079193512509465
Final cost: $16.4728016727613, Baseline: $103.97772192955017, Diff: $87.50492025678886, %: 84.15737393831112%
