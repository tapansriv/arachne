Data Starting In: gcp
Egress: $0.0/GB
Benchmark: tpcds
Data Path: parquet_1000/batch_rs4
BigQuery Cost: $6.25/TB; DuckDB Cost: $1.48/hr; Redshift Cost: $4.344/hr
Use Duck: False
Using calcite profiles: False
Excluded Table: web_sales
Excluded Query: None

Starting analysis without using DuckDB
Redshift Total: $5.433061331386567, BigQuery Total: $70.70410251617432
01: $0.04251913135846455
03: $0.47502096817970274
06: $0.3632350847975413
07: $1.2739325496244431
08: $0.4728430971686045
09: $4.166115921802521
13: $1.633325179608663
15: $0.25032848659515383
16: $0.7151701463317871
17: $0.9640249739869435
18: $3.9372784649689994
19: $0.7144547079753876
20: $0.25383286993821463
21: $0.13902823099136352
22: $0.6999924237171808
24: $1.4943556775426865
25: $1.1788075348933538
26: $0.6572775177415212
27: $3.8892385180123648
28: $4.860953305471738
29: $0.954251956636111
30: $0.012125212178230286
32: $0.5117330439758301
34: $0.6075768459717432
36: $2.4807855692911147
37: $0.16629489990234375
39: $0.27900081528663634
40: $0.41604152888298035
41: $-0.001439128564198812
42: $0.47523548619747163
43: $0.49872953498522443
44: $0.8873670196946462
46: $1.1849251066462199
47: $0.48158571960449215
48: $1.0463716178750992
50: $0.661454455537796
52: $0.4759971203915278
53: $0.5979665479230881
55: $0.4760878943316142
57: $0.27304382418314616
59: $0.4287443129523595
61: $1.6324246692927677
63: $0.597844746427536
64: $3.5569928172620138
65: $0.5961180507278443
67: $6.203618795018196
68: $1.4156545792627335
70: $1.8907469585673014
72: $0.3371178349939982
73: $0.6095429498179754
79: $1.1831403943077723
81: $0.022080078539848325
82: $0.22990267293135325
83: $0.06329148495833078
84: $0.014300001715024312
88: $2.8978831026617686
89: $0.5970417350339889
91: $0.03386976528962453
93: $0.7705190082454682
96: $0.361907244758606
97: $0.4646914958365758
98: $0.4751735880470276
99: $0.22156503650188447
!!!!!!: 65.27248031335195
Excluding table web_sales and any queries that depend on it
Total Keys: 63, Keys Considered: 62
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23]
{'50': 229504, '79': 164240, '20': 2184, '30': 2097328, '09': 139264, '40': 526476, '36': 166016, '47': 166016, '03': 133248, '42': 133248, '97': 131208, '06': 133296, '89': 166016, '96': 426240, '63': 166016, '08': 164016, '13': 164320, '91': 501, '01': 98448, '99': 540809, '61': 170160, '21': 527488, '19': 166064, '25': 231560, '28': 131072, '52': 133248, '67': 166016, '26': 6344, '39': 527488, '17': 231560, '83': 2164868, '53': 166016, '68': 164272, '22': 527488, '59': 163968, '07': 137408, '64': 236540, '46': 164272, '93': 204800, '44': 133120, '88': 426240, '27': 166080, '48': 164064, '72': 531916, '15': 184, '55': 133248, '24': 231472, '37': 3208, '81': 180, '65': 166016, '73': 164240, '32': 2184, '82': 134272, '84': 66416, '34': 164240, '70': 163968, '18': 2296, '29': 231560, '57': 2185, '16': 173, '43': 163968, '98': 133248}
call_center: 0.0015696642717277357, 1.2420791080347144
catalog_page: 0.0022853845183209887, -0.0022853845183209887
catalog_page had no query dependencies
catalog_returns: 0.13519360119456378, 5.00937005506402
catalog_sales: 1.7763870673022015, 13.082065365328656
customer: 0.01427195406915918, 17.533375116621635
customer_address: 0.01805658753614971, 18.481678105514234
customer_demographics: 0.003680082719450718, 16.3760241843723
date_dim: 0.002849405812918994, 49.81622962564657
household_demographics: 0.0020465218533148354, 13.834189300442828
income_band: 0.001905242303924264, 3.5693875766731136
inventory: 0.1295530568976635, 1.7217838209252125
item: 0.00576345424832259, 38.799633889115434
promotion: 0.005425070167249204, 7.452320318747495
reason: 0.001962879213056827, 4.934672050834933
ship_mode: 0.00229383778718704, 0.21927119871469744
store: 0.002436485447850235, 40.872440045660376
store_returns: 0.3358734664107695, 9.364643575725426
store_sales: 2.766447108157311, 53.46014240714407
time_dim: 0.002535768720772405, 3.257254578699602
warehouse: 0.002364072007180001, 2.090381798366864
web_page: 0.0039587199103870065, -0.0039587199103870065
web_page had no query dependencies
web_returns: 0.07182007218981629, 0.0035966249467447864
web_site: 0.003012177000990312, -0.003012177000990312
web_site had no query dependencies
['catalog_page', 'web_page', 'web_site']
3
call_center: 0.0015696637350191887, 1.2420791085714231
catalog_returns: 0.13462986046145875, 5.009933795797124
income_band: 0.001905242274493009, 3.5693875767025447
promotion: 0.005425066745119994, 7.452320322169625
ship_mode: 0.0022938377097574594, 0.219271198792127
store_returns: 0.3349864589085731, 9.365530583227622
web_returns: 0.07154644639542558, 0.003870250741135492
[]
0
web_returns: 0.07138251359707179, 0.004034183539489283
[]
0
web_returns: 0.0713806379839926, 0.004036059152568466
[]
0
{'09': 139264, '28': 131072, '67': 166016, '39': 527488, '22': 527488, '88': 426240, '27': 166080, '18': 2296, '50': 65536, '79': 0, '20': 0, '40': 4, '36': 0, '47': 0, '03': 0, '42': 0, '97': 0, '06': 0, '89': 0, '96': 0, '63': 0, '08': 0, '13': 0, '99': 16385, '61': 4096, '21': 0, '19': 0, '25': 65536, '52': 0, '26': 4096, '17': 65536, '53': 0, '68': 0, '59': 0, '07': 4096, '64': 70148, '46': 0, '93': 65536, '44': 0, '48': 0, '72': 4100, '15': 0, '55': 0, '24': 65536, '37': 0, '65': 0, '73': 0, '32': 0, '82': 0, '34': 0, '70': 0, '29': 65536, '57': 1, '16': 5, '43': 0, '98': 0, '91': 0, '01': 0, '81': 0, '84': 0}
{}
{'09': 139264, '28': 131072, '67': 166016, '39': 527488, '22': 527488, '88': 426240, '27': 166080, '18': 2296, '50': 65536, '79': 0, '20': 0, '40': 4, '36': 0, '47': 0, '03': 0, '42': 0, '97': 0, '06': 0, '89': 0, '96': 0, '63': 0, '08': 0, '13': 0, '99': 16385, '61': 4096, '21': 0, '19': 0, '25': 65536, '52': 0, '26': 4096, '17': 65536, '53': 0, '68': 0, '59': 0, '07': 4096, '64': 70148, '46': 0, '93': 65536, '44': 0, '48': 0, '72': 4100, '15': 0, '55': 0, '24': 65536, '37': 0, '65': 0, '73': 0, '32': 0, '82': 0, '34': 0, '70': 0, '29': 65536, '57': 1, '16': 5, '43': 0, '98': 0, '91': 0, '01': 0, '81': 0, '84': 0}
STARTING PHASE 2: 0b1000000000000000000000
----
[21]
Function: 10.999666058446275, 5.43147319121043, 0.00014901161193847656, 0.2856284013544985, 5.233409673245747, 0.0230545178476319, 0.02595126317602992
web_returns: 0.0713806379839926, 0.004036059152568466
Function: 10.997591229123996, 5.414162942469916, 0.09287595748901367, 0.28014353012999826, 5.162537192742031, 0.022424840028795162, 0.02544676626424193
hiya: 0b0, 10.997591229123996
{10.999666058446275: [21], 10.997591229123996: []}
Best Cost: $10.997591229123996;
[3, 4, 5, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 0, 2, 9, 12, 14, 16]
{'50': 229504, '79': 164240, '20': 2184, '09': 139264, '40': 526476, '36': 166016, '47': 166016, '03': 133248, '42': 133248, '97': 131208, '06': 133296, '89': 166016, '96': 426240, '63': 166016, '08': 164016, '13': 164320, '91': 501, '01': 98448, '99': 540809, '61': 170160, '21': 527488, '19': 166064, '25': 231560, '28': 131072, '52': 133248, '67': 166016, '26': 6344, '39': 527488, '17': 231560, '53': 166016, '68': 164272, '22': 527488, '59': 163968, '07': 137408, '64': 236540, '46': 164272, '93': 204800, '44': 133120, '88': 426240, '27': 166080, '48': 164064, '72': 531916, '15': 184, '55': 133248, '24': 231472, '37': 3208, '81': 180, '65': 166016, '73': 164240, '32': 2184, '82': 134272, '84': 66416, '34': 164240, '70': 163968, '18': 2296, '29': 231560, '57': 2185, '16': 173, '43': 163968, '98': 133248}
['30', '83', '41']
Excluding table web_sales and any queries that depend on it
[3, 4, 5, 6, 7, 8, 10, 11, 13, 15, 17, 18, 19, 0, 2, 9, 12, 14, 16]
dict_keys(['50', '79', '20', '09', '40', '36', '47', '03', '42', '97', '06', '89', '96', '63', '08', '13', '91', '01', '99', '61', '21', '19', '25', '28', '52', '67', '26', '39', '17', '53', '68', '22', '59', '07', '64', '46', '93', '44', '88', '27', '48', '72', '15', '55', '24', '37', '81', '65', '73', '32', '82', '84', '34', '70', '18', '29', '57', '16', '43', '98'])
19
Optimal Subset: 0b11111111111111111101
dict_keys(['50', '79', '20', '09', '40', '36', '47', '03', '42', '97', '06', '89', '96', '63', '08', '13', '91', '01', '99', '61', '21', '19', '25', '28', '52', '67', '26', '39', '17', '53', '68', '22', '59', '07', '64', '46', '93', '44', '88', '27', '48', '72', '15', '55', '24', '37', '81', '65', '73', '32', '82', '84', '34', '70', '18', '29', '57', '16', '43', '98'])
Function: 10.997591229123996, 5.414162942469916, 0.09287595748901367, 0.28014353012999826, 5.162537192742031, 0.022424840028795162, 0.02544676626424193
Real: 10.997591229123996, 5.414162942469916, 0.09287595748901367, 0.28014353012999826, 5.162537192742031, 0.022424840028795162, 0.02544676626424193
outputs_noduck_GCP_0.0_4.344_6.25.json
Num GCP Qs: 60; Num Redshift Qs: 3
PLAN TYPE IS: multi
Moved Qs: $5.414162942469916; Stayed Qs: $0.09287595748901367; Migration Cost: $5.490552329165066
Movement Cost: $0.28014353012999826, Load Cost: $5.162537192742031, Storage Cost: $0.022424840028795162, API Cost: $0.02544676626424193
Final cost: $10.997591229123996, Baseline: $70.70410251617432, Diff: $59.70651128705032, %: 84.44561088006431%
